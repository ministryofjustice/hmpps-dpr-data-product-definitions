{
  "id": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
  "name": "MIS Activities Allocated with Protected Characteristics and Graphs for Excel",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "ACT0048"
    ]
  },
  "description": "<br/>This report details Activities allocated along with protected chars. Each protected char has a graphical and tabular illustration. <br/><br/>ACT0048 - v2.0 Last Modified: 17/01/2023",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP9",
      "name": "ActivitIes A-L",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, floor((months_between(( trunc(sysdate) ), ( CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END ))) / 12), CASE WHEN AT_DIM_ETHNICITY_CODES.CODE='MERGE' Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE='W8' then 'W3' WHEN AT_DIM_ETHNICITY_CODES.CODE='O1' then 'A4' ELSE AT_DIM_ETHNICITY_CODES.CODE END , NVL(AT_OFFENDER_BOOKING.RELIGION_CODE,'Not Specified'), CASE WHEN AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassified' ELSE AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL END, nvl(AT_OFFENDER_BOOKING.IEP_BAND,'** Incentive Level Missing **'), DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE, AT_DIM_PROGRAMME_SERVICE.DESCRIPTION, AT_DIM_PROGRAMME_TYPE.DESCRIPTION, AT_FACT_OFFENDER_ACTIVITY.SUSPENDED_FLAG, AT_FACT_OFFENDER_ACTIVITY.OFFENDER_START_DATE, AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_OFFENDER_BOOKING.GENDER_CODE, AT_OFFENDER_BOOKING.MATERNITY_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.MARITAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, CASE when AT_DIM_ETHNICITY_CODES.DESCRIPTION= 'Chinese' then 'Asian/Asian British: Chinese' when AT_DIM_ETHNICITY_CODES.DESCRIPTION='White : Irish Traveller/Gypsy' then 'White: Gypsy or Irish Traveller' when AT_DIM_ETHNICITY_CODES.DESCRIPTION is null then 'Code Missing' else AT_DIM_ETHNICITY_CODES.DESCRIPTION END, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_DESCRIPTION, DT_ADMISSION.MOVEMENT_TIME FROM BODIMIS.FACT_OFFENDER_ACTIVITY AT_FACT_OFFENDER_ACTIVITY, ( Select ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk , fme.from_location_type, max(fme.MOVEMENT_SEQ ) as MOVEMENT_SEQ, max(d.day_date) as MOVEMENT_TIME, trunc(ETL.LOAD_END_DATETIME) as LOAD_DATE From BODIMIS.FACT_MOVEMENT_EXTERNAL fme, BODIMIS.DIM_OFFENDER_BOOKING ob, BODIMIS.DIM_ESTABLISHMENT est, BODIMIS.ETL_LOAD_LOG ETL, BODIMIS.DIM_DATE d Where ob.ESTABLISHMENT_SK=est.ESTABLISHMENT_SK and d.date_sk=fme.date_sk and fme.offender_booking_sk=ob.offender_booking_sk and ob.active_status IN('Active In','Active Out') And ob.MIS_CURRENT_RECORD_IND = 'Y' and ob.ACTIVE_FLAG = 'Y' and ETL.LOAD_ID=(select max(LOAD_ID) from BODIMIS.ETL_LOAD_LOG WHERE LOAD_END_DATETIME IS NOT NULL) And ob.ESTABLISHMENT_SK=fme.to_location_sk and fme.movement_seq= (select max(fme2.movement_seq ) from BODIMIS.FACT_MOVEMENT_EXTERNAL fme2 where fme.offender_booking_sk=fme2.offender_booking_sk and fme2.direction_code='IN' And fme2.TYPE='Admission' And fme2.To_location_type='Establishment' and fme2.reason_code <> 'R') GROUP BY ob.offender_id_display, fme.offender_booking_sk,est.establishment_code_nk,fme.to_location_sk,fme.from_location_sk,fme.from_location_type,ETL.LOAD_END_DATETIME ) DT_ADMISSION, BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ESTABLISHMENT AT_ACTIVITY_ESTABLISHMENT, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_CURRENT_SECURITY_CATEGORY, (   Select AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK as OFFENDER_BOOKING_SK, case when AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE From --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE where --AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK=AT_FACT_SENTENCE.OFFENDER_BOOKING_SK(+) AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK=AT_RELEASE_DATE.DATE_SK(+) and AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG='Y' --and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' ) DT_CURRENT_RELEASE_DATE, BODIMIS.DIM_PROGRAMME_SERVICE AT_DIM_PROGRAMME_SERVICE, BODIMIS.DIM_PROGRAMME_TYPE AT_DIM_PROGRAMME_TYPE WHERE ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.BIRTH_DATE_SK=AT_DOB.DATE_SK ) AND ( AT_DIM_ETHNICITY_CODES.CODE(+)=AT_OFFENDER_BOOKING.ETHNICITY_CODE ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_ADMISSION.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=AT_FACT_OFFENDER_ACTIVITY.OFFENDER_BOOKING_SK ) AND ( AT_DIM_PROGRAMME_TYPE.PROGRAMME_TYPE_SK=AT_FACT_OFFENDER_ACTIVITY.PROGRAMME_TYPE_SK ) AND ( AT_ACTIVITY_ESTABLISHMENT.ESTABLISHMENT_SK=AT_FACT_OFFENDER_ACTIVITY.ESTABLISHMENT_SK ) AND ( AT_DIM_PROGRAMME_SERVICE.PROGRAMME_SERVICE_SK=AT_FACT_OFFENDER_ACTIVITY.PROGRAMME_SERVICE_SK ) AND ( AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_FLAG(+)='Y' ) AND ( AT_CURRENT_SECURITY_CATEGORY.OFFENDER_BOOKING_SK(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK ) AND ( AT_OFFENDER_BOOKING.LIVING_UNIT_SK=AT_DIM_LOCATION.UNIT_4_SK(+) ) AND ( ( AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND='Y' ) AND ( AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y' ) AND AT_OFFENDER_BOOKING.SURNAME < 'M' AND ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK =(SELECT establishment_code from prompt_) ) AND AT_ACTIVITY_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code from prompt_) AND ( (AT_DIM_PROGRAMME_TYPE.SCHEDULE_END_DATE IS NULL OR AT_DIM_PROGRAMME_TYPE.SCHEDULE_END_DATE > trunc(sysdate)) ) AND TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_START_DATE) <= trunc(sysdate) AND ( CASE WHEN TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE) <> '31/12/9999' THEN TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE) END > trunc(sysdate) OR CASE WHEN TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE) <> '31/12/9999' THEN TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE) END Is Null ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3375368/DP14",
      "name": "MIS Load",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP14.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP15",
      "name": "Disability",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END AS DISABILITY_ACTIVE_FLAG FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_PERSONAL_CARE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_PERSONAL_CARE.OFFENDER_BOOKING_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END IN ('Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, DISABILITY_ACTIVE_FLAG FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP15.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DISABILITY_ACTIVE_FLAG",
            "type": "string",
            "display": "Disability Active Flag",
            "legacyId": "DP15.DOa9d",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP16",
      "name": "Population",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'W3' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'A4' ELSE AT_DIM_ETHNICITY_CODES.CODE END AS ETHNIC_CODE, COALESCE(AT_OFFENDER_BOOKING.RELIGION_CODE, 'Not Specified') AS RELIGION_CODE, CASE WHEN AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassified' ELSE AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL END AS CURRENT_SECURITY_CATEGORY, COALESCE(AT_OFFENDER_BOOKING.IEP_BAND, '** Incentive Level Missing **') AS IEP_BAND, AT_OFFENDER_BOOKING.MATERNITY_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.MARITAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, CASE WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'Chinese' THEN 'Asian/Asian British: Chinese' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'White : Irish Traveller/Gypsy' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION IS NULL THEN 'Code Missing' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_GROUP FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_CURRENT_SECURITY_CATEGORY WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_FLAG (+) = 'Y') AND (AT_CURRENT_SECURITY_CATEGORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND ((AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OFFENDER_AGE, ETHNIC_CODE, RELIGION_CODE, CURRENT_SECURITY_CATEGORY, IEP_BAND, MATERNITY_STATUS_DESCRIPTION, MARITAL_STATUS_DESCRIPTION, SEX_ORIENTATION_DESCRIPTION, ETHNIC_GROUP FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP16.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP16.DO10082",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DP16.DO1009b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "RELIGION_CODE",
            "type": "string",
            "display": "Religion Code",
            "legacyId": "DP16.DO100b2",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "CURRENT_SECURITY_CATEGORY",
            "type": "string",
            "display": "Current Security Category",
            "legacyId": "DP16.DO100e1",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "IEP_BAND",
            "type": "string",
            "display": "IEP Band",
            "legacyId": "DP16.DO100e4",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "MATERNITY_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Maternity Status",
            "legacyId": "DP16.DO100b0",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "MARITAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Marital Status Description",
            "legacyId": "DP16.DO100af",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "SEX_ORIENTATION_DESCRIPTION",
            "type": "string",
            "display": "Sexual Orientation Description",
            "legacyId": "DP16.DO10970",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "ETHNIC_GROUP",
            "type": "string",
            "display": "Ethnic Group",
            "legacyId": "DP16.DO1009c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP17",
      "name": "Age 18-20",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) BETWEEN 18 AND 20)), dataset_ AS (SELECT OFFENDER_AGE, OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP17.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP17.DO76",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP18",
      "name": "Age 21-24",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) BETWEEN 21 AND 24)), dataset_ AS (SELECT OFFENDER_AGE, OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP18.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP18.DO76",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP19",
      "name": "Age 25-29",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) BETWEEN 25 AND 29)), dataset_ AS (SELECT OFFENDER_AGE, OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP19.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP19.DO76",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP1a",
      "name": "Age 30-39",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) BETWEEN 30 AND 39)), dataset_ AS (SELECT OFFENDER_AGE, OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP1a.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP1a.DO76",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP1b",
      "name": "Age 40-49",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) BETWEEN 40 AND 49)), dataset_ AS (SELECT OFFENDER_AGE, OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP1b.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP1b.DO76",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP1c",
      "name": "Age 50-59",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) BETWEEN 50 AND 59)), dataset_ AS (SELECT OFFENDER_AGE, OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP1c.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP1c.DO76",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP1d",
      "name": "Age 60",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) >= 60)), dataset_ AS (SELECT OFFENDER_AGE, OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP1d.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP1d.DO76",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP1e",
      "name": "Unallocated",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND NOT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A0051EW', 'A0180DW', 'A0317EW', 'A0360DH', 'A0494DR', 'A0502EX', 'A0523EX', 'A0615DF', 'A0626AL', 'A0637EJ', 'A0637EV', 'A0726AW', 'A0733AP', 'A0817EW', 'A0932DD', 'A1011AP', 'A1017EX', 'A1018EX', 'A1066EW', 'A1069AP', 'A1083DN', 'A1152CA', 'A1209AP', 'A1245EW', 'A1252AP', 'A1304EN', 'A1385AR', 'A1419AQ', 'A1427AP', 'A1487AP', 'A1551EW', 'A1555EX', 'A1604AP', 'A1610AP', 'A1618EQ', 'A1627DV', 'A1650EV', 'A1683EG', 'A1740CG', 'A1755AH', 'A1761EN', 'A1773AP', 'A1789CY', 'A1790AX', 'A1828EX', 'A1829EX', 'A1844DF', 'A1851EC', 'A1855EC', 'A1887AP', 'A1890AP', 'A1917EE', 'A1949CJ', 'A1984AT', 'A2020AM', 'A2061AV', 'A2112ET', 'A2163DY', 'A2212EK', 'A2293CH', 'A2319EX', 'A2331AV', 'A2344EW', 'A2350ET', 'A2397AA', 'A2430CQ', 'A2442DW', 'A2456CD', 'A2505DH', 'A2550EA', 'A2582EX', 'A2624ET', 'A2648AP', 'A2670EK', 'A2734AT', 'A2745DT', 'A2781AK', 'A2881EM', 'A2886AA', 'A2907AN', 'A2995EK', 'A3016EQ', 'A3018EQ', 'A3105EQ', 'A3130DC', 'A3159EX', 'A3173EN', 'A3229EQ', 'A3246EW', 'A3247EW', 'A3340EW', 'A3411EC', 'A3455AV', 'A3457CK', 'A3480EX', 'A3481AQ', 'A3505AD', 'A3538EM', 'A3571DK', 'A3595EF', 'A3684EV', 'A3704EX', 'A3706EV', 'A3805EX', 'A3812AN', 'A3962CW', 'A4022EF', 'A4031EW', 'A4064CV', 'A4111EX', 'A4118AV', 'A4174AN', 'A4220AN', 'A4260DX', 'A4280DY', 'A4308EX', 'A4323ER', 'A4337CT', 'A4349EX', 'A4352AN', 'A4566EX', 'A4585DN', 'A4600AN', 'A4633EX', 'A4636EV', 'A4647CQ', 'A4673EX', 'A4687ED', 'A4726CP', 'A4757EX', 'A4758EX', 'A4764ER', 'A4783EX', 'A4787ER', 'A4808EV', 'A4892EV', 'A4909EQ', 'A4916DR', 'A4934EW', 'A4953EW', 'A5002CM', 'A5022DK', 'A5026CQ', 'A5054AP', 'A5104EC', 'A5122AC', 'A5259ER', 'A5292EV', 'A5327AQ', 'A5417EW', 'A5436EM', 'A5449AJ', 'A5456AE', 'A5501EW', 'A5507DN', 'A5515DP', 'A5525AY', 'A5526AH', 'A5608DQ', 'A5658EM', 'A5695DQ', 'A5705CZ', 'A5783AW', 'A5812AV', 'A5831AF', 'A5859AH', 'A5871AD', 'A5885EV', 'A5897EV', 'A5919AH', 'A5928AA', 'A5954AX', 'A5954EW', 'A6060ET', 'A6136EV', 'A6190EA', 'A6213EW', 'A6264AG', 'A6301DF', 'A6303AC', 'A6331AP', 'A6408DY', 'A6415AK', 'A6447DN', 'A6471AL', 'A6493EW', 'A6501DM', 'A6618EN', 'A6747CF', 'A6816EW', 'A6847EG', 'A6894EW', 'A6935AQ', 'A6945DL', 'A6950EW', 'A6964EV', 'A7040DW', 'A7066EV', 'A7143AN', 'A7146CA', 'A7265EH', 'A7280EQ', 'A7466EF', 'A7472CD', 'A7487ER', 'A7498DY', 'A7562AN', 'A7562CL', 'A7579EJ', 'A7622EW', 'A7630AY', 'A7632AY', 'A7641DW', 'A7649DT', 'A7666DY', 'A7680DE', 'A7691CW', 'A7772EC', 'A7804EW', 'A7832AY', 'A7840CE', 'A7906EW', 'A7908DL', 'A7925CZ', 'A8069EW', 'A8078CV', 'A8088AL', 'A8094ET', 'A8095ET', 'A8100ER', 'A8104AR', 'A8145EP', 'A8164AT', 'A8170AX', 'A8185AP', 'A8270AN', 'A8370EN', 'A8374EQ', 'A8377EQ', 'A8406DZ', 'A8589EJ', 'A8591AG', 'A8605AQ', 'A8645AN', 'A8652EK', 'A8674EW', 'A8727ET', 'A8730DC', 'A8755EW', 'A8797ET', 'A8822EW', 'A8855ET', 'A8910EK', 'A8911DD', 'A8970CM', 'A8995AW', 'A9103EV', 'A9107EQ', 'A9137EW', 'A9198EW', 'A9247DJ', 'A9261AM', 'A9408EQ', 'A9423CC', 'A9463EW', 'A9501ED', 'A9565AJ', 'A9568CQ', 'A9660AN', 'A9672AM', 'A9744EW', 'A9755EV', 'A9826ET', 'A9853AR', 'A9884ET', 'A9905CP', 'A9913EW', 'A9930AA', 'A9958AL') AND NOT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A0078EW', 'A0116CP', 'A0170AW', 'A0184DT', 'A0194AW', 'A0198EX', 'A0244ER', 'A0330EX', 'A0336EE', 'A0366EN', 'A0367DA', 'A0391CF', 'A0424AJ', 'A0434CK', 'A0458EK', 'A0524DR', 'A0569CG', 'A0646AK', 'A0656EC', 'A0667DM', 'A0714AD', 'A0735CJ', 'A0794EV', 'A0866EX', 'A0916EW', 'A0950ET', 'A1126AP', 'A1140AL', 'A1145EW', 'A1147EW', 'A1162EX', 'A1222EW', 'A1246AP', 'A1279AP', 'A1342EW', 'A1421EX', 'A1449AK', 'A1525CF', 'A1562AP', 'A1663DM', 'A1685AP', 'A1734EX', 'A1735EX', 'A1754AV', 'A1796ER', 'A1940EX', 'A2009EX', 'A2076EK', 'A2077AK', 'A2109AY', 'A2114EF', 'A2193AX', 'A2198EW', 'A2218CZ', 'A2304AT', 'A2364DZ', 'A2389AN', 'A2406AN', 'A2424EE', 'A2470ET', 'A2523CD', 'A2532DX', 'A2569EP', 'A2632AN', 'A2716EJ', 'A2717EX', 'A2730CP', 'A2744EL', 'A2749EX', 'A2877EX', 'A2942ED', 'A2985AQ', 'A3043DF', 'A3054AN', 'A3071EW', 'A3072EX', 'A3077DX', 'A3109CD', 'A3116EX', 'A3117AP', 'A3123AA', 'A3140AA', 'A3143EV', 'A3163EF', 'A3334AN', 'A3355EW', 'A3466AQ', 'A3470AN', 'A3508EF', 'A3572CL', 'A3607EX', 'A3701EV', 'A3702ER', 'A3722ET', 'A3737AT', 'A3753AP', 'A3774AN', 'A3799EX', 'A3806EX', 'A3808EX', 'A3958AP', 'A3985EX', 'A3987EX', 'A3989CK', 'A3990EX', 'A4028EX', 'A4061AD', 'A4089EX', 'A4159AN', 'A4171AX', 'A4388DQ', 'A4422CZ', 'A4453EX', 'A4456EW', 'A4467EX', 'A4471AN', 'A4480EX', 'A4503AN', 'A4513CZ', 'A4624AA', 'A4670EX', 'A4676EL', 'A4679EX', 'A4691EW', 'A4763CZ', 'A4776EK', 'A4792EX', 'A4822ET', 'A4852AJ', 'A4877EX', 'A4900CG', 'A4923EW', 'A5014CW', 'A5037EM', 'A5042AK', 'A5048AY', 'A5144AG', 'A5154CF', 'A5246DX', 'A5321CX', 'A5413DM', 'A5414EW', 'A5433CE', 'A5451EV', 'A5476EV', 'A5477EV', 'A5533CV', 'A5568CE', 'A5602EV', 'A5618DN', 'A5697CK', 'A5788EV', 'A5852EW', 'A5869EW', 'A5989CC', 'A6006EA', 'A6124AD', 'A6172DP', 'A6200AT', 'A6236AQ', 'A6260CL', 'A6305AC', 'A6323AA', 'A6363CF', 'A6405EM', 'A6458EN', 'A6463DQ', 'A6483ED', 'A6547CW', 'A6569EV', 'A6633EM', 'A6755AM', 'A6762EW', 'A6812AE', 'A6837EJ', 'A6875EA', 'A6897AM', 'A6967DP', 'A6973EF', 'A7035DX', 'A7195AW', 'A7241AC', 'A7431EN', 'A7526DT', 'A7533EW', 'A7638EQ', 'A7645EW', 'A7660CM', 'A7792EP', 'A7852EL', 'A7937EW', 'A7992CW', 'A8062EW', 'A8142EV', 'A8177AP', 'A8238EW', 'A8304AZ', 'A8384EQ', 'A8497AR', 'A8503EP', 'A8549CJ', 'A8578CA', 'A8633CY', 'A8645AP', 'A8673CZ', 'A8739EQ', 'A8765AX', 'A8773AW', 'A8787EG', 'A8861ET', 'A8880EQ', 'A8894CE', 'A9018AC', 'A9104AG', 'A9131EV', 'A9133AR', 'A9350EJ', 'A9356EF', 'A9426DY', 'A9530ET', 'A9560AG', 'A9645EL', 'A9719EQ', 'A9766DC', 'A9771EW', 'A9776EV', 'A9890ET', 'A9902EW', 'A9916AA', 'A9916CG', 'A9999EW'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP1e.DO76",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP1f",
      "name": "Activities M-Z",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, floor((months_between(( trunc(sysdate) ), ( CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END ))) / 12), CASE WHEN AT_DIM_ETHNICITY_CODES.CODE='MERGE' Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE='W8' then 'W3' WHEN AT_DIM_ETHNICITY_CODES.CODE='O1' then 'A4' ELSE AT_DIM_ETHNICITY_CODES.CODE END , NVL(AT_OFFENDER_BOOKING.RELIGION_CODE,'Not Specified'), CASE WHEN AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassified' ELSE AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL END, nvl(AT_OFFENDER_BOOKING.IEP_BAND,'** Incentive Level Missing **'), DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE, AT_DIM_PROGRAMME_SERVICE.DESCRIPTION, AT_DIM_PROGRAMME_TYPE.DESCRIPTION, AT_FACT_OFFENDER_ACTIVITY.SUSPENDED_FLAG, AT_FACT_OFFENDER_ACTIVITY.OFFENDER_START_DATE, AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_OFFENDER_BOOKING.GENDER_CODE, AT_OFFENDER_BOOKING.MATERNITY_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.MARITAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, CASE when AT_DIM_ETHNICITY_CODES.DESCRIPTION= 'Chinese' then 'Asian/Asian British: Chinese' when AT_DIM_ETHNICITY_CODES.DESCRIPTION='White : Irish Traveller/Gypsy' then 'White: Gypsy or Irish Traveller' when AT_DIM_ETHNICITY_CODES.DESCRIPTION is null then 'Code Missing' else AT_DIM_ETHNICITY_CODES.DESCRIPTION END, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_DESCRIPTION, DT_ADMISSION.MOVEMENT_TIME FROM BODIMIS.FACT_OFFENDER_ACTIVITY AT_FACT_OFFENDER_ACTIVITY, ( Select ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk , fme.from_location_type, max(fme.MOVEMENT_SEQ ) as MOVEMENT_SEQ, max(d.day_date) as MOVEMENT_TIME, trunc(ETL.LOAD_END_DATETIME) as LOAD_DATE From BODIMIS.FACT_MOVEMENT_EXTERNAL fme, BODIMIS.DIM_OFFENDER_BOOKING ob, BODIMIS.DIM_ESTABLISHMENT est, BODIMIS.ETL_LOAD_LOG ETL, BODIMIS.DIM_DATE d Where ob.ESTABLISHMENT_SK=est.ESTABLISHMENT_SK and d.date_sk=fme.date_sk and fme.offender_booking_sk=ob.offender_booking_sk and ob.active_status IN('Active In','Active Out') And ob.MIS_CURRENT_RECORD_IND = 'Y' and ob.ACTIVE_FLAG = 'Y' and ETL.LOAD_ID=(select max(LOAD_ID) from BODIMIS.ETL_LOAD_LOG WHERE LOAD_END_DATETIME IS NOT NULL) And ob.ESTABLISHMENT_SK=fme.to_location_sk and fme.movement_seq= (select max(fme2.movement_seq ) from BODIMIS.FACT_MOVEMENT_EXTERNAL fme2 where fme.offender_booking_sk=fme2.offender_booking_sk and fme2.direction_code='IN' And fme2.TYPE='Admission' And fme2.To_location_type='Establishment' and fme2.reason_code <> 'R') GROUP BY ob.offender_id_display, fme.offender_booking_sk,est.establishment_code_nk,fme.to_location_sk,fme.from_location_sk,fme.from_location_type,ETL.LOAD_END_DATETIME ) DT_ADMISSION, BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ESTABLISHMENT AT_ACTIVITY_ESTABLISHMENT, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_CURRENT_SECURITY_CATEGORY, (   Select AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK as OFFENDER_BOOKING_SK, case when AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE From --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE where --AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK=AT_FACT_SENTENCE.OFFENDER_BOOKING_SK(+) AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK=AT_RELEASE_DATE.DATE_SK(+) and AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG='Y' --and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' ) DT_CURRENT_RELEASE_DATE, BODIMIS.DIM_PROGRAMME_SERVICE AT_DIM_PROGRAMME_SERVICE, BODIMIS.DIM_PROGRAMME_TYPE AT_DIM_PROGRAMME_TYPE WHERE ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.BIRTH_DATE_SK=AT_DOB.DATE_SK ) AND ( AT_DIM_ETHNICITY_CODES.CODE(+)=AT_OFFENDER_BOOKING.ETHNICITY_CODE ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_ADMISSION.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=AT_FACT_OFFENDER_ACTIVITY.OFFENDER_BOOKING_SK ) AND ( AT_DIM_PROGRAMME_TYPE.PROGRAMME_TYPE_SK=AT_FACT_OFFENDER_ACTIVITY.PROGRAMME_TYPE_SK ) AND ( AT_ACTIVITY_ESTABLISHMENT.ESTABLISHMENT_SK=AT_FACT_OFFENDER_ACTIVITY.ESTABLISHMENT_SK ) AND ( AT_DIM_PROGRAMME_SERVICE.PROGRAMME_SERVICE_SK=AT_FACT_OFFENDER_ACTIVITY.PROGRAMME_SERVICE_SK ) AND ( AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_FLAG(+)='Y' ) AND ( AT_CURRENT_SECURITY_CATEGORY.OFFENDER_BOOKING_SK(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK ) AND ( AT_OFFENDER_BOOKING.LIVING_UNIT_SK=AT_DIM_LOCATION.UNIT_4_SK(+) ) AND ( ( AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND='Y' ) AND ( AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y' ) AND AT_OFFENDER_BOOKING.SURNAME >= 'M' AND ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK =(SELECT establishment_code from prompt_) ) AND AT_ACTIVITY_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code from prompt_) AND ( (AT_DIM_PROGRAMME_TYPE.SCHEDULE_END_DATE IS NULL OR AT_DIM_PROGRAMME_TYPE.SCHEDULE_END_DATE > trunc(sysdate)) ) AND TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_START_DATE) <= trunc(sysdate) AND ( CASE WHEN TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE) <> '31/12/9999' THEN TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE) END > trunc(sysdate) OR CASE WHEN TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE) <> '31/12/9999' THEN TRUNC(AT_FACT_OFFENDER_ACTIVITY.OFFENDER_END_DATE) END Is Null ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": []
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "208193.RS",
      "name": "All Allocations",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "231073.RS",
      "name": "Age Group Table",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "232675.RS",
      "name": "Age Group Graph",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "232432.RS",
      "name": "Ethnic Group Table",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "231321.RS",
      "name": "Ethnic Group Graph",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "265980.RS",
      "name": "Ethnic Group Prot Chars",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "258890.RS",
      "name": "Ethnic Group Table - %Pop",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "231594.RS",
      "name": "Religion Table",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "231719.RS",
      "name": "Religion Graph",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "275058.RS",
      "name": "Religion Prot Chars",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "273635.RS",
      "name": "Religion Group Table - %Pop",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "233124.RS",
      "name": "Maternity Table",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "233666.RS",
      "name": "Marital Status Table",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "233735.RS",
      "name": "Marital Graph",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "278758.RS",
      "name": "Marital Status Prot Chars",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "281015.RS",
      "name": "Marital Status Table - %Pop",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "234139.RS",
      "name": "Sex Orientation Table",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "234233.RS",
      "name": "Sex Orientation Graph",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "282028.RS",
      "name": "Sexual Orientation Prot Chars",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "282617.RS",
      "name": "Sexual Orientation Table - %Pop",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "234508.RS",
      "name": "Disability Table",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "234727.RS",
      "name": "Disability Graph",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "285011.RS",
      "name": "Disability Prot Chars",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      }
    },
    {
      "id": "286409.RS",
      "name": "Disability Table - %Pop",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "230886.RS",
      "name": "Suspended Table",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "289061.RS",
      "name": "Suspended % Pop",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expected table name but got None. Line 1, Col: 3465.\n  hen AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE \u001b[4mFrom\u001b[0m --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENT]",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expected table name but got None. Line 1, Col: 3465.\n  hen AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE \u001b[4mFrom\u001b[0m --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENT]",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[0] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[1] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[2] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[3] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[4] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[4].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[5] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[5].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[6] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[7] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[8] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[8].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[9] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[9].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[10] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[11] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[12] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[13] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[13].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[14] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[14].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[15] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[16] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[17] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[17].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[18] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[18].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[19] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[20] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[21] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[21].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[22] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[22].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[23] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[24] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[25] requires property \"dataset\"",
      "entityId": "FjSXawA23AwALwwwAAAHDn4AACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report Variant 208193.RS does not have corresponding dataset undefined",
      "entityId": "208193.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 231073.RS does not have corresponding dataset undefined",
      "entityId": "231073.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 232675.RS does not have corresponding dataset undefined",
      "entityId": "232675.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 232432.RS does not have corresponding dataset undefined",
      "entityId": "232432.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 231321.RS does not have corresponding dataset undefined",
      "entityId": "231321.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 265980.RS does not have corresponding dataset undefined",
      "entityId": "265980.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 258890.RS does not have corresponding dataset undefined",
      "entityId": "258890.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 231594.RS does not have corresponding dataset undefined",
      "entityId": "231594.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 231719.RS does not have corresponding dataset undefined",
      "entityId": "231719.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 275058.RS does not have corresponding dataset undefined",
      "entityId": "275058.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 273635.RS does not have corresponding dataset undefined",
      "entityId": "273635.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 233124.RS does not have corresponding dataset undefined",
      "entityId": "233124.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 233666.RS does not have corresponding dataset undefined",
      "entityId": "233666.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 233735.RS does not have corresponding dataset undefined",
      "entityId": "233735.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 278758.RS does not have corresponding dataset undefined",
      "entityId": "278758.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 281015.RS does not have corresponding dataset undefined",
      "entityId": "281015.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 234139.RS does not have corresponding dataset undefined",
      "entityId": "234139.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 234233.RS does not have corresponding dataset undefined",
      "entityId": "234233.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 282028.RS does not have corresponding dataset undefined",
      "entityId": "282028.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 282617.RS does not have corresponding dataset undefined",
      "entityId": "282617.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 234508.RS does not have corresponding dataset undefined",
      "entityId": "234508.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 234727.RS does not have corresponding dataset undefined",
      "entityId": "234727.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 285011.RS does not have corresponding dataset undefined",
      "entityId": "285011.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 286409.RS does not have corresponding dataset undefined",
      "entityId": "286409.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 230886.RS does not have corresponding dataset undefined",
      "entityId": "230886.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 289061.RS does not have corresponding dataset undefined",
      "entityId": "289061.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "unable to generate test sql",
      "entityId": "3375368/DP9",
      "entityType": "dataset"
    }
  ]
}