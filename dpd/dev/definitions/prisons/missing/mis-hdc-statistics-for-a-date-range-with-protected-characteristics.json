{
  "id": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
  "name": "MIS HDC Statistics for a Date Range with Protected Characteristics",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "PDD0228"
    ]
  },
  "description": "Shows protected characteristics for HDC decisions reached between A HDC Decision date range specified at runtime. Although this report will look at HDC decisions in the past the protected chars will be the current ones as per NOMIS. Most of these chars do not change over time. <br/>PDD0228 v00.00.01 Last Modified: 22/03/2022",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP4",
      "name": "HDC Decisions",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT CASE WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) IS NULL THEN NULL WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 1 THEN 'Under 1 year' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 1 AND 6 THEN '1 to 6 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 7 AND 11 THEN '7 to 11 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 12 AND 16 THEN '12 to 16 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) > 16 AND (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 18 THEN '16 to 17 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 18 AND 21 THEN '18 to 21 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 22 AND 29 THEN '22 to 29 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 30 AND 39 THEN '30 to 39 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 40 AND 49 THEN '40 to 49 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 50 AND 59 THEN '50 to 59 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 60 AND 69 THEN '60 to 69 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) >= 70 THEN '70 or over' END AS AGE_BAND, AT_OFFENDER_BOOKING.MARITAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.GENDER_DESCRIPTION, CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END AS DISABILITY_ACTIVE_FLAG, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, AT_OFFENDER_BOOKING.MATERNITY_STATUS_DESCRIPTION, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'Chinese' THEN 'Asian/Asian British: Chinese' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'White : Irish Traveller/Gypsy' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION IS NULL THEN 'Code Missing' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_GROUP, CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END AS HDC_DECISION_DATE, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC FROM BODIMIS.DIM_DATE AT_DIM_DECISION_DATE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_PERSONAL_CARE WHERE (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.DECISION_DATE_SK = AT_DIM_DECISION_DATE.DATE_SK) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_PERSONAL_CARE.OFFENDER_BOOKING_SK (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_STATUS = 'O') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC <> 'Inactive/Merged                         ' AND CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END >= TO_DATE('01-03-2022 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END <= TO_DATE('21-03-2022 00:00:00', 'DD-MM-YYYY HH24:MI:SS')) UNION SELECT CASE WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) IS NULL THEN NULL WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 1 THEN 'Under 1 year' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 1 AND 6 THEN '1 to 6 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 7 AND 11 THEN '7 to 11 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 12 AND 16 THEN '12 to 16 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) > 16 AND (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 18 THEN '16 to 17 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 18 AND 21 THEN '18 to 21 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 22 AND 29 THEN '22 to 29 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 30 AND 39 THEN '30 to 39 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 40 AND 49 THEN '40 to 49 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 50 AND 59 THEN '50 to 59 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 60 AND 69 THEN '60 to 69 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) >= 70 THEN '70 or over' END AS AGE_BAND, AT_OFFENDER_BOOKING.MARITAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.GENDER_DESCRIPTION, CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END AS DISABILITY_ACTIVE_FLAG, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, AT_OFFENDER_BOOKING.MATERNITY_STATUS_DESCRIPTION, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'Chinese' THEN 'Asian/Asian British: Chinese' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'White : Irish Traveller/Gypsy' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION IS NULL THEN 'Code Missing' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_GROUP, CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END AS HDC_DECISION_DATE, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC FROM BODIMIS.DIM_DATE AT_DIM_DECISION_DATE, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_PERSONAL_CARE, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM WHERE (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.DECISION_DATE_SK = AT_DIM_DECISION_DATE.DATE_SK) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_PERSONAL_CARE.OFFENDER_BOOKING_SK (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_STATUS = 'C') AND AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC <> 'Inactive/Merged' AND CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END >= TO_DATE('01-03-2022 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END <= TO_DATE('21-03-2022 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_))), dataset_ AS (SELECT AGE_BAND, MARITAL_STATUS_DESCRIPTION, GENDER_DESCRIPTION, DISABILITY_ACTIVE_FLAG, SEX_ORIENTATION_DESCRIPTION, MATERNITY_STATUS_DESCRIPTION, OFFENDER_AGE, RELIGION_DESCRIPTION, OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, ETHNIC_GROUP, HDC_DECISION_DATE, HDC_ASSMENT_APP_STATUS_DESC, COUNT(V_CONCAT_NOMS_DATE) AS V_COUNT_CONCAT, 'TBD' AS V_CUSTOM_AGE_RANGE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "AGE_BAND",
            "type": "string",
            "display": "Age Band",
            "legacyId": "DP4.DO107fd",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "MARITAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Marital Status Description",
            "legacyId": "DP4.DO100af",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "GENDER_DESCRIPTION",
            "type": "string",
            "display": "Gender Description",
            "legacyId": "DP4.DO100a9",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DISABILITY_ACTIVE_FLAG",
            "type": "string",
            "display": "Disability Active Flag",
            "legacyId": "DP4.DO10a9d",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "SEX_ORIENTATION_DESCRIPTION",
            "type": "string",
            "display": "Sexual Orientation Description",
            "legacyId": "DP4.DO10970",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "MATERNITY_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Maternity Status",
            "legacyId": "DP4.DO100b0",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP4.DO10082",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DP4.DO100b3",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP4.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP4.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP4.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "ETHNIC_GROUP",
            "type": "string",
            "display": "Ethnic Group",
            "legacyId": "DP4.DO1009c",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "HDC_DECISION_DATE",
            "type": "date",
            "display": "HDC Decision Date",
            "legacyId": "DP4.DO3b0",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "HDC_ASSMENT_APP_STATUS_DESC",
            "type": "string",
            "display": "HDC Status",
            "legacyId": "DP4.DO54",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "V_COUNT_CONCAT",
            "type": "string",
            "display": "V_COUNT_CONCAT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 15,
            "name": "V_CUSTOM_AGE_RANGE",
            "type": "string",
            "display": "V_CUSTOM_AGE_RANGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP1c",
      "name": "MIS Load",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP1c.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP22",
      "name": "HDC Refusals",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'Chinese' THEN 'Asian/Asian British: Chinese' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'White : Irish Traveller/Gypsy' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION IS NULL THEN 'Code Missing' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_GROUP, CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END AS HDC_DECISION_DATE, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC, AT_DIM_HDC_STATUS_REASON.HDC_STATUS_REASON FROM BODIMIS.DIM_DATE AT_DIM_DECISION_DATE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.DIM_HDC_STATUS_REASON AT_DIM_HDC_STATUS_REASON, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.DECISION_DATE_SK = AT_DIM_DECISION_DATE.DATE_SK) AND (AT_CURFEW_ASSESSMENT.OFFENDER_CURFEW_ID = AT_DIM_HDC_STATUS_REASON.OFFENDER_CURFEW_ID (+)) AND (AT_DIM_HDC_STATUS_REASON.HDC_STATUS_TYPE = 'Refusal') AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_STATUS = 'O') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC <> 'Inactive/Merged                         ' AND CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END >= TO_DATE('01-03-2022 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END <= TO_DATE('21-03-2022 00:00:00', 'DD-MM-YYYY HH24:MI:SS')) UNION SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'Chinese' THEN 'Asian/Asian British: Chinese' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'White : Irish Traveller/Gypsy' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION IS NULL THEN 'Code Missing' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_GROUP, CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END AS HDC_DECISION_DATE, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC, AT_DIM_HDC_STATUS_REASON.HDC_STATUS_REASON FROM BODIMIS.DIM_DATE AT_DIM_DECISION_DATE, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.DIM_HDC_STATUS_REASON AT_DIM_HDC_STATUS_REASON, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM WHERE (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.DECISION_DATE_SK = AT_DIM_DECISION_DATE.DATE_SK) AND (AT_CURFEW_ASSESSMENT.OFFENDER_CURFEW_ID = AT_DIM_HDC_STATUS_REASON.OFFENDER_CURFEW_ID (+)) AND (AT_DIM_HDC_STATUS_REASON.HDC_STATUS_TYPE = 'Refusal') AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_STATUS = 'C') AND AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC <> 'Inactive/Merged' AND CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END >= TO_DATE('01-03-2022 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END <= TO_DATE('21-03-2022 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, ETHNIC_GROUP, HDC_DECISION_DATE, HDC_ASSMENT_APP_STATUS_DESC, HDC_STATUS_REASON FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP22.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP22.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP22.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ETHNIC_GROUP",
            "type": "string",
            "display": "Ethnic Group",
            "legacyId": "DP22.DO1009c",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "HDC_DECISION_DATE",
            "type": "date",
            "display": "HDC Decision Date",
            "legacyId": "DP22.DO3b0",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "HDC_ASSMENT_APP_STATUS_DESC",
            "type": "string",
            "display": "HDC Status",
            "legacyId": "DP22.DO54",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "HDC_STATUS_REASON",
            "type": "string",
            "display": "Reasons for Refusal",
            "legacyId": "DP22.DO5b",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "135205.RS",
      "name": "Age",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "crosstab",
        "field": [
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Count([V_Count_Concat]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO54"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_CUSTOM_AGE_RANGE",
            "display": "=Sum(Count(([NOMS Number]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")))",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Offender Age] Between(21;29);\"21 - 29 years\";If([Offender Age] Between(30;39);\"30 - 39 years\";If([Offender Age] Between(40;49);\"40 - 49 years\";If([Offender Age] Between(50;59);\"50 - 59 years\";If([Offender Age] Between(60;69);\"60 - 69 years\";If([Offender Age] >70;\"70 years +\";If([Offender Age] <21;\"Under 21 years\")))))))"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          }
        ]
      }
    },
    {
      "id": "135314.RS",
      "name": "Age - Bar Chart",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "133926.RS",
      "name": "Ethnic Group",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "crosstab",
        "field": [
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Count([V_Count_Concat]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO54"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:ETHNIC_GROUP",
            "display": "Ethnic Group",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO1009c"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          }
        ]
      }
    },
    {
      "id": "135389.RS",
      "name": "Ethnic Group - Bar Chart",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "135284.RS",
      "name": "Gender",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "crosstab",
        "field": [
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Count([V_Count_Concat]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO54"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100a9"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          }
        ]
      }
    },
    {
      "id": "135508.RS",
      "name": "Gender - Bar Chart",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "135286.RS",
      "name": "Marital",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "crosstab",
        "field": [
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Count([V_Count_Concat]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO54"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:MARITAL_STATUS_DESCRIPTION",
            "display": "Marital Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100af"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          }
        ]
      }
    },
    {
      "id": "135565.RS",
      "name": "Marital - Bar Chart",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "135285.RS",
      "name": "Maternity",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "crosstab",
        "field": [
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Count([V_Count_Concat]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO54"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:MATERNITY_STATUS_DESCRIPTION",
            "display": "Maternity Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100b0"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          }
        ]
      }
    },
    {
      "id": "135626.RS",
      "name": "Maternity - Bar Chart",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "135206.RS",
      "name": "Religion",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "crosstab",
        "field": [
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Count([V_Count_Concat]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO54"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:RELIGION_DESCRIPTION",
            "display": "Religion Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100b3"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          }
        ]
      }
    },
    {
      "id": "135627.RS",
      "name": "Religion - Bar Chart",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "135287.RS",
      "name": "Sexual Orientation",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "crosstab",
        "field": [
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Count([V_Count_Concat]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO54"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:SEX_ORIENTATION_DESCRIPTION",
            "display": "Sexual Orientation Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10970"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          }
        ]
      }
    },
    {
      "id": "135744.RS",
      "name": "Sexual Orientation - Bar Chart",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "135288.RS",
      "name": "Disability",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "crosstab",
        "field": [
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Count([V_Count_Concat]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO54"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "No. Prisoners Refused Due to Insufficient Time",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:DISABILITY_ACTIVE_FLAG",
            "display": "Disability Active Flag",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10a9d"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "=Sum(Count(([NOMS Number]) Where([vRefusalReasons]=\"Insufficient Time to Assess\")))",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          },
          {
            "name": "$ref:V_COUNT_CONCAT",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([V_Concat_NOMS_Date])"
          }
        ]
      }
    },
    {
      "id": "135803.RS",
      "name": "Disability - Bar Chart",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "chart",
        "field": []
      },
      "dataset": "MISSING"
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_CUSTOM_AGE_RANGE :: Error: =If([Offender Age] Between(21;29);\"21 - 29 years\";If([Offender Age] Between(30;39);\"30 - 39 years\";If([Offender Age] Between(40;49);\"40 - 49 years\";If([Offender Age] Between(50;59);\"50 - 59 years\";If([Offender Age] Between(60;69);\"60 - 69 years\";If([Offender Age] >70;\"70 years +\";If([Offender Age] <21;\"Under 21 years\"))))))) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_CUSTOM_AGE_RANGE :: Error: =If([Offender Age] Between(21;29);\"21 - 29 years\";If([Offender Age] Between(30;39);\"30 - 39 years\";If([Offender Age] Between(40;49);\"40 - 49 years\";If([Offender Age] Between(50;59);\"50 - 59 years\";If([Offender Age] Between(60;69);\"60 - 69 years\";If([Offender Age] >70;\"70 years +\";If([Offender Age] <21;\"Under 21 years\"))))))) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[0].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[1] requires property \"dataset\"",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[1].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[2].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[3] requires property \"dataset\"",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[3].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[4].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[5] requires property \"dataset\"",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[5].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[6].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[7] requires property \"dataset\"",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[7].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[8].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[9] requires property \"dataset\"",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[9].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[10].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[11] requires property \"dataset\"",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[11].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[12].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[13] requires property \"dataset\"",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[13].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[14].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[15] requires property \"dataset\"",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[15].specification.template is not one of enum values: list,list-section,list-tab,summary,summary-section,parent-child,parent-child-section",
      "entityId": "Fvh8HwGpRwkAkTsAAAA3fwWlACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report Variant 135314.RS does not have corresponding dataset undefined",
      "entityId": "135314.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 135389.RS does not have corresponding dataset undefined",
      "entityId": "135389.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 135508.RS does not have corresponding dataset undefined",
      "entityId": "135508.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 135565.RS does not have corresponding dataset undefined",
      "entityId": "135565.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 135626.RS does not have corresponding dataset undefined",
      "entityId": "135626.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 135627.RS does not have corresponding dataset undefined",
      "entityId": "135627.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 135744.RS does not have corresponding dataset undefined",
      "entityId": "135744.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 135803.RS does not have corresponding dataset undefined",
      "entityId": "135803.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP4",
      "entityType": "dataset"
    }
  ]
}