{
  "id": "Fr1w0wEf0wQAj2QFAABXXZ3.ACJIAGE1",
  "name": "MIS Switchback Selection List",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "switchback"
    ]
  },
  "description": "ADH0001 v1.3  This report is designed for use only by the Switchback team.",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP10",
      "name": "Main_Data",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_OFFENDER_BOOKING.SURNAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END, AT_OFFENDER_BOOKING.FIRST_NAME, floor((months_between(( trunc(sysdate) ), ( CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END ))) / 12), AT_OFFENDER_BOOKING.BIRTH_PLACE, AT_OFFENDER_BOOKING.BIRTH_COUNTRY, Case When DT_LIFEFLAG.LIFE_SENTENCE_FLAG='Y' then 'Life' Else FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH End, AT_DIM_OFFENCE.OFFENCE_CODE_NK, AT_DIM_OFFENCE.OFFENCE_NAME, CASE WHEN AT_OFFENCE_DATE.DAY_DATE < '31/12/9000' THEN AT_OFFENCE_DATE.DAY_DATE END, AT_COURT_CASE.COURT_CASE_NUMBER,  CASE WHEN ( FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE )<( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE ) Then ( FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE ) WHEN( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE )<( FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE ) Then ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE ) WHEN ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE )<( FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE ) then ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE ) WHEN ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE )<( FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE ) then ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE ) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END , FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE FROM BODIMIS.DIM_DATE AT_OFFENCE_DATE, BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, (  SELECT distinct BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE ( BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK=dss.sentence_status_sk) AND dss.sentence_status='Active' AND ( BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK=BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK ) AND ( BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK=BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK ) AND ( BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK=BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK ) and BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG='Y' ) DT_LIFEFLAG, FACT_CURR_KEY_DATES_SENT, BODIMIS.DIM_COURT_CASE AT_COURT_CASE, (   Select AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK as OFFENDER_BOOKING_SK, case when AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE From --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE where --AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK=AT_FACT_SENTENCE.OFFENDER_BOOKING_SK(+) AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK=AT_RELEASE_DATE.DATE_SK(+) and AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG='Y' --and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' ) DT_CURRENT_RELEASE_DATE WHERE ( AT_FACT_COURT_CHARGE.OFFENCE_SK=AT_DIM_OFFENCE.OFFENCE_SK(+) ) AND ( AT_FACT_COURT_CHARGE.OFFENCE_DATE_SK=AT_OFFENCE_DATE.DATE_SK(+) ) AND ( AT_COURT_CASE.COURT_CASE_SK=AT_FACT_COURT_CHARGE.COURT_CASE_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_LIFEFLAG.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK(+) ) AND ( AT_COURT_CASE.OFFENDER_BOOKING_SK(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK ) AND ( AT_OFFENDER_BOOKING.BIRTH_DATE_SK=AT_DOB.DATE_SK ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.LIVING_UNIT_SK=AT_DIM_LOCATION.UNIT_4_SK(+) ) AND ( ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK in ((SELECT establishment_code from prompt_)) Or 'All' in ((SELECT establishment_code from prompt_)) ) AND floor((months_between(( trunc(sysdate) ), ( CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END ))) / 12) BETWEEN 18 AND 30 AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY NOT IN ( SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE ( AT_FACT_COURT_CHARGE.OFFENCE_SK=AT_DIM_OFFENCE.OFFENCE_SK(+) ) AND ( AT_COURT_CASE.COURT_CASE_SK=AT_FACT_COURT_CHARGE.COURT_CASE_SK(+) ) AND ( AT_COURT_CASE.OFFENDER_BOOKING_SK(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK in ((SELECT establishment_code from prompt_)) Or 'All' in ((SELECT establishment_code from prompt_)) ) AND ( AT_DIM_OFFENCE.OFFENCE_CODE_NK LIKE 'SX%' OR AT_DIM_OFFENCE.OFFENCE_CODE_NK IN ( '''CD71003'',''CD71003A'',''CD71003C'',''CD71015'',''CD71015A'',''CD71015B'',''CD71015C'',''CD71016'',''CD71016A'',''CD71016C'',''CD71017'',''CD98001'',''CJ88115'',''CJ88115A'',''CL77015'',''CL77021'',''CL77032'',''COML064'',''IC60003'',''IC60004'',''IC60005'',''IC60006'',''IC60007'',''IC60008'',''MH59005'',''MH59005-007N'',''MH59006'',''MH59007'',''MH59008'',''MH59008-010N'',''MH59009'',''MH59010'',''PK78001'',''PK78001-008N'',''PK78001-008NA'',''PK78002'',''PK78003'',''PK78003A'',''PK78004'',''PK78005'',''PK78006'',''PK78007'',''PK78008'',''SA00001'',''SA00002'',''SF97011'',''SO56000-001N'',''SO59001'',''SO59002'',''SO59003'',''SO59004'',''SO96008'',''SO96009'',''SO96010'',''SO96011'',''SO96012'',''SO96013'',''SO96014'',''SO96015'',''TH68026'',''TH68026A'',''TH68026C'',''TH68027'',''TH68027A'',''TH68027B'',''TH68027C'',''TH68028'',''TH68028A'',''TH68028C'',''TH68029'',''TH68029A'',''TH68029C'',''TH68030C'',''TH68031'',''TH68031A'',''TH68031C'',''TH68031N'',''TH68032'',''TH68032A'',''TH68032C'',''TH68033'',''TH68033A'',''TH68033C'',''TH68036'',''TH68037'',''TH68038'',''TH68039'',''TH68040'',''TH68041'',''TH68044'',''TH68045'',''TH68045A'',''TH68046'',''TH68047'',''TH68048'',''TH68081'',''IA99000-001N''' ) OR AT_DIM_OFFENCE.OFFENCE_CODE_NK IN ( '''AS00113'',''BED0003'',''CA81S98'',''CC000070'',''CC000071'',''CC000072'',''CC000073'',''CC00057'',''CL77015'',''CMLO252'',''COML064'',''CX00037'',''DB0023'',''DB0037'',''DB0063'',''DB0077'',''DB0078'',''DB0094'',''DB0102'',''DB0131'',''DB0135'',''DB124'',''DC00006'',''DC00007'',''DC00008'',''DC00016'',''DC00041'',''DC00067'',''GL07056'',''GL07065'',''GL07088'',''GL07089'',''GL07091'',''GL08002'',''GL08003'',''GL08034'',''GL08057'',''GM000052'',''GM000115'',''GM000150'',''GM000163'',''GM000164'',''GM000165'',''HERT016'',''HI00088'',''HI00089'',''IC60001'',''IC60002'',''IC60002N'',''IC60003'',''IC60004'',''IC60004N'',''IC60005'',''IC60006'',''IC60006A'',''IC60007'',''IC60008'',''IC6001A'',''IC60GW01'',''IC60GW02'',''KE00041'',''KE00053'',''KE00066'',''KE00070'',''KE00099'',''KE00111'',''KE00137'',''KE00164'',''KE00180'',''KE00181'',''LAN0056'',''LO018'',''LO31072'',''LO31108'',''LO31111'',''LO31112'',''LO31119'',''LO31120'',''LO31121'',''LO31124'',''MH59005'',''MH59006'',''MH59007'',''MH59008'',''MH59009'',''MH59010'',''NO36069'',''NORF041'',''NORF042'',''SA00001'',''SA00002'',''SC15003'',''SF00028'',''SF97005'',''SF97006'',''SF97007'',''SF97008'',''SO81003'',''SO96014G'',''SY000013'',''SY00050'',''SY00051'',''TV00009'',''TV00025'',''TV00031'',''TV00044'',''WI00004'',''WI00005'',''WI00043'',''WI00047'',''WI00048'',''WI00088'',''WI00109'',''WI00111'',''WI00177'',''WI00178'',''WM00116'',''WY010609'',''YY000062'',''YY000070'',''YY0001'',''YY00174'',''YY00210'',''YY00211'',''YY00212'',''YY00213'',''YY00214'',''YY0022'',''YY0023'',''YY00316'',''YY00339'',''YY0047'',''YY0048'',''YY0102'',''ZZ00090'',''ZZ00111'',''ZZ00112''' ) ) ) ) AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY NOT IN ( SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_ALERT AT_ALERT WHERE ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK(+) ) AND ( AT_ALERT.ALERT_SK(+)=AT_OFFENDER_ALERT.ALERT_SK ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK in ((SELECT establishment_code from prompt_)) Or 'All' in ((SELECT establishment_code from prompt_)) ) AND ( AT_OFFENDER_ALERT.ALERT_STATUS='ACTIVE' ) AND AT_ALERT.ALERT_CODE_NK IN ( 'XNR' ) ) ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3375368/DP4",
      "name": "Alert",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK, AT_ALERT.ALERT_DESCRIPTION, AT_OFFENDER_ALERT.ALERT_STATUS, CASE WHEN AT_ALERT_EXPIRY_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EXPIRY_DATE.DAY_DATE ELSE NULL END AS ALERT_EXPIRY_DATE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EXPIRY_DATE, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_EXPIRY_DATE_SK = AT_ALERT_EXPIRY_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) BETWEEN 18 AND 30 AND (AT_OFFENDER_BOOKING.BOOKING_STATUS = 'O') AND (AT_OFFENDER_BOOKING.ACTIVE_STATUS IN ('Active Out', 'Active In', 'Active In Transit', 'Active UAL')) AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A0052DE', 'A0070EA', 'A0136EE', 'A0151EZ', 'A0162EL', 'A0179CN', 'A0208AT', 'A0354EE', 'A0362EZ', 'A0481EP', 'A0539EC', 'A0567AY', 'A0577CM', 'A0629AZ', 'A0709DX', 'A0732DJ', 'A0782EL', 'A0873EG', 'A0878DP', 'A0906EX', 'A0912EY', 'A0983EP', 'A0995DR', 'A1014EA', 'A1015DJ', 'A1053DZ', 'A1130EV', 'A1139ER', 'A1190CZ', 'A1194EZ', 'A1279AD', 'A1338EY', 'A1348DZ', 'A1365EY', 'A1453DW', 'A1536DE', 'A1558DV', 'A1618EX', 'A1647CY', 'A1658CN', 'A1710DX', 'A1746DF', 'A1846CY', 'A1856EZ', 'A1863EQ', 'A1868EZ', 'A1930EM', 'A1951EF', 'A1985EG', 'A2089EA', 'A2096EE', 'A2181EZ', 'A2213EG', 'A2243DQ', 'A2300CL', 'A2411CQ', 'A2418EK', 'A2460EF', 'A2562DE', 'A2670DT', 'A2934EX', 'A2942CV', 'A2964EJ', 'A2989EF', 'A3031DE', 'A3061DA', 'A3078DE', 'A3091EX', 'A3126DY', 'A3173EN', 'A3286CR', 'A3357EJ', 'A3358CH', 'A3463EY', 'A3551CQ', 'A3605CR', 'A3647CE', 'A3662DY', 'A3673ET', 'A3719CF', 'A3766DG', 'A3851EZ', 'A3881EC', 'A3926EX', 'A3933EN', 'A3943DX', 'A4051EG', 'A4139EY', 'A4184DA', 'A4209DY', 'A4230CR', 'A4262ET', 'A4338CT', 'A4390EZ', 'A4391EG', 'A4432DL', 'A4470ET', 'A4506CZ', 'A4512EA', 'A4569AY', 'A4576EJ', 'A4608EJ', 'A4616CJ', 'A4655EF', 'A4724CV', 'A4730CE', 'A4789EV', 'A4850EM', 'A4876EV', 'A4896EX', 'A4931EY', 'A4957EN', 'A4977EQ', 'A4987CR', 'A5041DA', 'A5042DR', 'A5065DV', 'A5213DY', 'A5222DP', 'A5228EZ', 'A5401EM', 'A5427EX', 'A5431EM', 'A5442EY', 'A5448CP', 'A5475EK', 'A5498ER', 'A5641EX', 'A5748DL', 'A5756CA', 'A5956CT', 'A6123DV', 'A6142ET', 'A6183EW', 'A6304AD', 'A6341DT', 'A6343CX', 'A6354EW', 'A6399CY', 'A6470DL', 'A6540EY', 'A6584DD', 'A6726EZ', 'A6953EH', 'A6980CL', 'A6981EY', 'A6987CM', 'A7004DW', 'A7005CP', 'A7011CT', 'A7016EX', 'A7135DR', 'A7229DT', 'A7279EY', 'A7294CJ', 'A7353CE', 'A7465CJ', 'A7530EE', 'A7820EL', 'A7834EF', 'A7962DW', 'A8017EP', 'A8045ER', 'A8049EK', 'A8055EG', 'A8065EK', 'A8085DH', 'A8160EW', 'A8175EY', 'A8323EY', 'A8330EY', 'A8335DK', 'A8387EJ', 'A8396AQ', 'A8458DN', 'A8480AW', 'A8695EX', 'A8740CW', 'A8788CR', 'A8836EM', 'A8902EX', 'A8952EY', 'A8960EQ', 'A8962EZ', 'A8963DG', 'A8975EZ', 'A8984EC', 'A9015EY', 'A9074EP', 'A9102DJ', 'A9178EC', 'A9205EW', 'A9227CF', 'A9289EK', 'A9319AQ', 'A9359EJ', 'A9500CK', 'A9583DR', 'A9591EP', 'A9600DT', 'A9679DN', 'A9762EA', 'A9772CH', 'A9797EP', 'A9854EX', 'A9887EK', 'A9956ER') AND NOT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND AT_ALERT.ALERT_CODE_NK IN ('XNR')))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK, ALERT_DESCRIPTION, ALERT_STATUS, ALERT_EXPIRY_DATE, OFFENDER_SURNAME AS V_DETAIL_SURNAME FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP4.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP4.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DP4.DO10090",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP4.DO10094",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ALERT_EXPIRY_DATE",
            "type": "date",
            "display": "Alert Expiry Date",
            "legacyId": "DP4.DO10096",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "V_DETAIL_SURNAME",
            "type": "string",
            "display": "V_DETAIL_SURNAME",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP11",
      "name": "Probation_Officer",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS OTHER_CONTACT_NAME, DT_OFFENDER_CONTACT_ADDRESS.FLAT || ' ' || DT_OFFENDER_CONTACT_ADDRESS.PREMISE AS OTHER_CONTACT_HOUSE_INFORMAT31, DT_OFFENDER_CONTACT_ADDRESS.STREET, DT_OFFENDER_CONTACT_ADDRESS.locality || (CASE WHEN DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.city WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.city IS NULL THEN NULL WHEN DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.city IS NULL THEN NULL WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL THEN ', ' || DT_OFFENDER_CONTACT_ADDRESS.city ELSE ', ' || DT_OFFENDER_CONTACT_ADDRESS.city END) || (CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.county IS NULL AND NOT DT_OFFENDER_CONTACT_ADDRESS.city IS NULL THEN ', ' || DT_OFFENDER_CONTACT_ADDRESS.county WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.county IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.city IS NULL AND NOT DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL THEN ', ' || DT_OFFENDER_CONTACT_ADDRESS.county WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.county IS NULL AND NOT DT_OFFENDER_CONTACT_ADDRESS.city IS NULL THEN ', ' || DT_OFFENDER_CONTACT_ADDRESS.county WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.county IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.city IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.county ELSE NULL END) AS OTHER_CONTACT_AREA, DT_OFFENDER_CONTACT_ADDRESS.POST_CODE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) BETWEEN 18 AND 30 AND (AT_OFFENDER_BOOKING.BOOKING_STATUS = 'O') AND (AT_OFFENDER_BOOKING.ACTIVE_STATUS IN ('Active Out', 'Active In', 'Active In Transit', 'Active UAL')) AND DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP IN ('Probation Officer') AND (DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG (+) = 'Y') AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A0052DE', 'A0070EA', 'A0136EE', 'A0151EZ', 'A0162EL', 'A0179CN', 'A0208AT', 'A0354EE', 'A0362EZ', 'A0481EP', 'A0539EC', 'A0567AY', 'A0577CM', 'A0629AZ', 'A0709DX', 'A0732DJ', 'A0782EL', 'A0873EG', 'A0878DP', 'A0906EX', 'A0912EY', 'A0983EP', 'A0995DR', 'A1014EA', 'A1015DJ', 'A1053DZ', 'A1130EV', 'A1139ER', 'A1190CZ', 'A1194EZ', 'A1279AD', 'A1338EY', 'A1348DZ', 'A1365EY', 'A1453DW', 'A1536DE', 'A1558DV', 'A1618EX', 'A1647CY', 'A1658CN', 'A1710DX', 'A1746DF', 'A1846CY', 'A1856EZ', 'A1863EQ', 'A1868EZ', 'A1930EM', 'A1951EF', 'A1985EG', 'A2089EA', 'A2096EE', 'A2181EZ', 'A2213EG', 'A2243DQ', 'A2300CL', 'A2411CQ', 'A2418EK', 'A2460EF', 'A2562DE', 'A2670DT', 'A2934EX', 'A2942CV', 'A2964EJ', 'A2989EF', 'A3031DE', 'A3061DA', 'A3078DE', 'A3091EX', 'A3126DY', 'A3173EN', 'A3286CR', 'A3357EJ', 'A3358CH', 'A3463EY', 'A3551CQ', 'A3605CR', 'A3647CE', 'A3662DY', 'A3673ET', 'A3719CF', 'A3766DG', 'A3851EZ', 'A3881EC', 'A3926EX', 'A3933EN', 'A3943DX', 'A4051EG', 'A4139EY', 'A4184DA', 'A4209DY', 'A4230CR', 'A4262ET', 'A4338CT', 'A4390EZ', 'A4391EG', 'A4432DL', 'A4470ET', 'A4506CZ', 'A4512EA', 'A4569AY', 'A4576EJ', 'A4608EJ', 'A4616CJ', 'A4655EF', 'A4724CV', 'A4730CE', 'A4789EV', 'A4850EM', 'A4876EV', 'A4896EX', 'A4931EY', 'A4957EN', 'A4977EQ', 'A4987CR', 'A5041DA', 'A5042DR', 'A5065DV', 'A5213DY', 'A5222DP', 'A5228EZ', 'A5401EM', 'A5427EX', 'A5431EM', 'A5442EY', 'A5448CP', 'A5475EK', 'A5498ER', 'A5641EX', 'A5748DL', 'A5756CA', 'A5956CT', 'A6123DV', 'A6142ET', 'A6183EW', 'A6304AD', 'A6341DT', 'A6343CX', 'A6354EW', 'A6399CY', 'A6470DL', 'A6540EY', 'A6584DD', 'A6726EZ', 'A6953EH', 'A6980CL', 'A6981EY', 'A6987CM', 'A7004DW', 'A7005CP', 'A7011CT', 'A7016EX', 'A7135DR', 'A7229DT', 'A7279EY', 'A7294CJ', 'A7353CE', 'A7465CJ', 'A7530EE', 'A7820EL', 'A7834EF', 'A7962DW', 'A8017EP', 'A8045ER', 'A8049EK', 'A8055EG', 'A8065EK', 'A8085DH', 'A8160EW', 'A8175EY', 'A8323EY', 'A8330EY', 'A8335DK', 'A8387EJ', 'A8396AQ', 'A8458DN', 'A8480AW', 'A8695EX', 'A8740CW', 'A8788CR', 'A8836EM', 'A8902EX', 'A8952EY', 'A8960EQ', 'A8962EZ', 'A8963DG', 'A8975EZ', 'A8984EC', 'A9015EY', 'A9074EP', 'A9102DJ', 'A9178EC', 'A9205EW', 'A9227CF', 'A9289EK', 'A9319AQ', 'A9359EJ', 'A9500CK', 'A9583DR', 'A9591EP', 'A9600DT', 'A9679DN', 'A9762EA', 'A9772CH', 'A9797EP', 'A9854EX', 'A9887EK', 'A9956ER'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, RELATIONSHIP, OTHER_CONTACT_NAME, OTHER_CONTACT_HOUSE_INFORMAT31, STREET, OTHER_CONTACT_AREA, POST_CODE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP11.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "RELATIONSHIP",
            "type": "string",
            "display": "Other Contact Relationship",
            "legacyId": "DP11.DO10a1c",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OTHER_CONTACT_NAME",
            "type": "string",
            "display": "Other Contact Name",
            "legacyId": "DP11.DO10a1b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "OTHER_CONTACT_HOUSE_INFORMAT31",
            "type": "string",
            "display": "Other Contact House Information",
            "legacyId": "DP11.DO10a1d",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "STREET",
            "type": "string",
            "display": "Other Contact Street",
            "legacyId": "DP11.DO10a1e",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "OTHER_CONTACT_AREA",
            "type": "string",
            "display": "Other Contact Area",
            "legacyId": "DP11.DO10a1f",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "POST_CODE",
            "type": "string",
            "display": "Other Contact Post Code",
            "legacyId": "DP11.DO10a20",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP12",
      "name": "Offender_Address",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, DT_OFFENDER_ADDRESSES.POSTAL_CODE, DT_OFFENDER_ADDRESSES.COUNTY_DESC, DT_OFFENDER_ADDRESSES.CITY_DESC, DT_OFFENDER_ADDRESSES.LOCALITY, DT_OFFENDER_ADDRESSES.STREET, DT_OFFENDER_ADDRESSES.PREMISE, DT_OFFENDER_ADDRESSES.FLAT, DT_OFFENDER_ADDRESSES.NO_FIXED_ADDRESS_FLAG, BODIMIS.DIM_REGION.REGION_CODE_NK, DT_OFFENDER_ADDRESSES.ADDRESS_ACTIVE_FLAG FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, ( select ROW_NUMBER() OVER (PARTITION BY ss.OWNER_ID ORDER BY PRIMARY_FLAG desc, ss.address_active_flag desc, ss.USAGE_ACTIVE_FLAG desc, ss.usages_dttm DESC nulls last) row_seq_filter, ss.* from ( select * from ( select AT_DIM_ADDRESSES.OWNER_ID, AT_DIM_ADDRESS_USAGES.ADDRESS_ID_NK, AT_DIM_ADDRESS_USAGES.ADDRESS_USAGE, AT_DIM_ADDRESS_USAGES.ADDR_USAGE_DESCRIPTION, AT_DIM_ADDRESS_USAGES.ACTIVE_FLAG as USAGE_ACTIVE_FLAG, AT_DIM_ADDRESSES.flat, AT_DIM_ADDRESSES.premise, AT_DIM_ADDRESSES.Street, AT_DIM_ADDRESSES.locality, AT_DIM_ADDRESSES.city_code, AT_DIM_ADDRESSES.city_desc, AT_DIM_ADDRESSES.county_code, AT_DIM_ADDRESSES.county_desc, AT_DIM_ADDRESSES.postal_code, AT_DIM_ADDRESSES.COUNTRY_CODE, AT_DIM_ADDRESSES.country_desc, AT_DIM_ADDRESSES.HOME_TEL_NO, AT_DIM_ADDRESSES.HOME_EXT_NO, AT_DIM_ADDRESSES.NO_FIXED_ADDRESS_FLAG, AT_DIM_ADDRESSES.establishment_sk, AT_DIM_ADDRESSES.PRIMARY_FLAG, AT_DIM_ADDRESSES.active_flag as address_active_flag, AT_DIM_ADDRESS_USAGES.CREATE_DATETIME, AT_DIM_ADDRESS_USAGES.MODIFY_DATETIME, COALESCE(AT_DIM_ADDRESS_USAGES.modify_datetime, AT_DIM_ADDRESS_USAGES.create_datetime) as usages_dttm from BODIMIS.DIM_ADDRESS_USAGES AT_DIM_ADDRESS_USAGES inner join BODIMIS.dim_addresses AT_DIM_ADDRESSES on AT_DIM_ADDRESS_USAGES.address_id_nk = AT_DIM_ADDRESSES.address_id_nk and AT_DIM_ADDRESSES.owner_class='OFF'  ) Addr_usages --where Addr_usages.usages_dttm is not null ) ss ) DT_OFFENDER_ADDRESSES, BODIMIS.DIM_REGION, BODIMIS.DIM_DATE AT_DOB, BODISTAGING.REF_OFFENDERS AT_BODISTAG_REF_OFFENDERS, BODIMIS.DIM_REFERENCE_CODES AT_DIM_REFERENCE_CODES WHERE ( AT_OFFENDER_BOOKING.BIRTH_DATE_SK=AT_DOB.DATE_SK ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.OFFENDER_ID=AT_BODISTAG_REF_OFFENDERS.OFFENDER_ID(+) ) AND ( AT_BODISTAG_REF_OFFENDERS.ROOT_OFFENDER_ID=DT_OFFENDER_ADDRESSES.OWNER_ID(+) ) AND ( rtrim(DT_OFFENDER_ADDRESSES.COUNTY_CODE)=AT_DIM_REFERENCE_CODES.CODE(+) ) AND ( AT_DIM_REFERENCE_CODES.CODE_DOMAIN(+)='COUNTY' ) AND ( AT_DIM_REFERENCE_CODES.PARENT_CODE=BODIMIS.DIM_REGION.REGION_CODE_NK(+) ) AND ( ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK in ((SELECT establishment_code from prompt_)) Or 'All' in ((SELECT establishment_code from prompt_)) ) AND floor((months_between(( trunc(sysdate) ), ( CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END ))) / 12) BETWEEN 18 AND 30 AND ( AT_OFFENDER_BOOKING.BOOKING_STATUS = 'O' ) AND ( AT_OFFENDER_BOOKING.ACTIVE_STATUS in ('Active Out','Active In','Active In Transit','Active UAL') ) AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A0052DE', 'A0070EA', 'A0136EE', 'A0151EZ', 'A0162EL', 'A0179CN', 'A0208AT', 'A0354EE', 'A0362EZ', 'A0481EP', 'A0539EC', 'A0567AY', 'A0577CM', 'A0629AZ', 'A0709DX', 'A0732DJ', 'A0782EL', 'A0873EG', 'A0878DP', 'A0906EX', 'A0912EY', 'A0983EP', 'A0995DR', 'A1014EA', 'A1015DJ', 'A1053DZ', 'A1130EV', 'A1139ER', 'A1190CZ', 'A1194EZ', 'A1279AD', 'A1338EY', 'A1348DZ', 'A1365EY', 'A1453DW', 'A1536DE', 'A1558DV', 'A1618EX', 'A1647CY', 'A1658CN', 'A1710DX', 'A1746DF', 'A1846CY', 'A1856EZ', 'A1863EQ', 'A1868EZ', 'A1930EM', 'A1951EF', 'A1985EG', 'A2089EA', 'A2096EE', 'A2181EZ', 'A2213EG', 'A2243DQ', 'A2300CL', 'A2411CQ', 'A2418EK', 'A2460EF', 'A2562DE', 'A2670DT', 'A2934EX', 'A2942CV', 'A2964EJ', 'A2989EF', 'A3031DE', 'A3061DA', 'A3078DE', 'A3091EX', 'A3126DY', 'A3173EN', 'A3286CR', 'A3357EJ', 'A3358CH', 'A3463EY', 'A3551CQ', 'A3605CR', 'A3647CE', 'A3662DY', 'A3673ET', 'A3719CF', 'A3766DG', 'A3851EZ', 'A3881EC', 'A3926EX', 'A3933EN', 'A3943DX', 'A4051EG', 'A4139EY', 'A4184DA', 'A4209DY', 'A4230CR', 'A4262ET', 'A4338CT', 'A4390EZ', 'A4391EG', 'A4432DL', 'A4470ET', 'A4506CZ', 'A4512EA', 'A4569AY', 'A4576EJ', 'A4608EJ', 'A4616CJ', 'A4655EF', 'A4724CV', 'A4730CE', 'A4789EV', 'A4850EM', 'A4876EV', 'A4896EX', 'A4931EY', 'A4957EN', 'A4977EQ', 'A4987CR', 'A5041DA', 'A5042DR', 'A5065DV', 'A5213DY', 'A5222DP', 'A5228EZ', 'A5401EM', 'A5427EX', 'A5431EM', 'A5442EY', 'A5448CP', 'A5475EK', 'A5498ER', 'A5641EX', 'A5748DL', 'A5756CA', 'A5956CT', 'A6123DV', 'A6142ET', 'A6183EW', 'A6304AD', 'A6341DT', 'A6343CX', 'A6354EW', 'A6399CY', 'A6470DL', 'A6540EY', 'A6584DD', 'A6726EZ', 'A6953EH', 'A6980CL', 'A6981EY', 'A6987CM', 'A7004DW', 'A7005CP', 'A7011CT', 'A7016EX', 'A7135DR', 'A7229DT', 'A7279EY', 'A7294CJ', 'A7353CE', 'A7465CJ', 'A7530EE', 'A7820EL', 'A7834EF', 'A7962DW', 'A8017EP', 'A8045ER', 'A8049EK', 'A8055EG', 'A8065EK', 'A8085DH', 'A8160EW', 'A8175EY', 'A8323EY', 'A8330EY', 'A8335DK', 'A8387EJ', 'A8396AQ', 'A8458DN', 'A8480AW', 'A8695EX', 'A8740CW', 'A8788CR', 'A8836EM', 'A8902EX', 'A8952EY', 'A8960EQ', 'A8962EZ', 'A8963DG', 'A8975EZ', 'A8984EC', 'A9015EY', 'A9074EP', 'A9102DJ', 'A9178EC', 'A9205EW', 'A9227CF', 'A9289EK', 'A9319AQ', 'A9359EJ', 'A9500CK', 'A9583DR', 'A9591EP', 'A9600DT', 'A9679DN', 'A9762EA', 'A9772CH', 'A9797EP', 'A9854EX', 'A9887EK', 'A9956ER') )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3375368/DP8",
      "name": "Latest Date Available",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP8.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "201249.RS",
      "name": "Prisoner List",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP10",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_DETAIL_AGE_EXCLUSION IN ('INCLUDE') AND V_DETAIL_ALERT_EXCLUSION IN ('INCLUDE')))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP10_DO1007B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10080",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10088",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10086",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10085",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10082",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10A7C",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "131836.RS",
      "name": "Details",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP10",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_DETAIL_AGE_EXCLUSION IN ('INCLUDE') AND V_DETAIL_ALERT_EXCLUSION IN ('INCLUDE') AND V_OFFENCE_EXCLUSION IN ('Y')))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP10_DO1007B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10080",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10082",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10085",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO51",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO4A",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO4B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO50",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO70",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO565",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP10_DO10A7C",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "202246.RS",
      "name": "Address",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP12",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_DETAIL_AGE_EXCLUSION IN ('INCLUDE') AND V_DETAIL_ALERT_EXCLUSION IN ('INCLUDE')))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_DETAIL_SURNAME",
            "display": "Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offender Surname]"
          },
          {
            "name": "$ref:DP12_DO10945",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO10947",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO10948",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO10949",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO1094A",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO1094B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO1094C",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO1094E",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO10969",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "202320.RS",
      "name": "Probation",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP11",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_DETAIL_AGE_EXCLUSION IN ('INCLUDE') AND V_DETAIL_ALERT_EXCLUSION IN ('INCLUDE')))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OTHER_CONTACT_NAME",
            "display": "Other Contact Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP11.DO10a1b"
          },
          {
            "name": "$ref:OTHER_CONTACT_HOUSE_INFORMAT31",
            "display": "Other Contact House Information",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP11.DO10a1d"
          },
          {
            "name": "$ref:STREET",
            "display": "Other Contact Street",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP11.DO10a1e"
          },
          {
            "name": "$ref:OTHER_CONTACT_AREA",
            "display": "Other Contact Area",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP11.DO10a1f"
          },
          {
            "name": "$ref:POST_CODE",
            "display": "Other Contact Post Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP11.DO10a20"
          }
        ]
      }
    },
    {
      "id": "202394.RS",
      "name": "Alert",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_DETAIL_AGE_EXCLUSION IN ('INCLUDE') AND V_DETAIL_ALERT_EXCLUSION IN ('INCLUDE')))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_DETAIL_SURNAME",
            "display": "Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offender Surname]"
          },
          {
            "name": "$ref:ALERT_CODE_NK",
            "display": "Alert Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO1008e"
          },
          {
            "name": "$ref:ALERT_DESCRIPTION",
            "display": "Alert Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10090"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expected table name but got None. Line 1, Col: 2603.\n  hen AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE \u001b[4mFrom\u001b[0m --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENT]",
      "entityId": "Fr1w0wEf0wQAj2QFAABXXZ3.ACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_DETAIL_SURNAME :: ReferenceError: error is not defined",
      "entityId": "Fr1w0wEf0wQAj2QFAABXXZ3.ACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DETAIL_SURNAME :: ReferenceError: error is not defined",
      "entityId": "Fr1w0wEf0wQAj2QFAABXXZ3.ACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expecting ). Line 1, Col: 1857.\n  ESS_USAGES.address_id_nk = AT_DIM_ADDRESSES.address_id_nk and AT_DIM_ADDRESSES.owner_class='OFF'  ) \u001b[4mAddr_usages\u001b[0m --where Addr_usages.usages_dttm is not null ) ss ) DT_OFFENDER_ADDRESSES, BODIMIS.DIM_REGION, BODIM]",
      "entityId": "Fr1w0wEf0wQAj2QFAABXXZ3.ACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DETAIL_SURNAME :: ReferenceError: error is not defined",
      "entityId": "Fr1w0wEf0wQAj2QFAABXXZ3.ACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Dataset does not have any schema fields (comments -- in query)",
      "entityId": "3375368/DP10",
      "entityType": "dataset"
    },
    {
      "type": "schema",
      "error": "Dataset does not have any schema fields (comments -- in query)",
      "entityId": "3375368/DP12",
      "entityType": "dataset"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO1007B does not have corresponding dataset schema field",
      "entityId": "201249.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10080 does not have corresponding dataset schema field",
      "entityId": "201249.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10088 does not have corresponding dataset schema field",
      "entityId": "201249.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10086 does not have corresponding dataset schema field",
      "entityId": "201249.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10085 does not have corresponding dataset schema field",
      "entityId": "201249.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10082 does not have corresponding dataset schema field",
      "entityId": "201249.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10A7C does not have corresponding dataset schema field",
      "entityId": "201249.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO1007B does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10080 does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10082 does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10085 does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO51 does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO4A does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO4B does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO50 does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO70 does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO565 does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP10_DO10A7C does not have corresponding dataset schema field",
      "entityId": "131836.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DETAIL_SURNAME does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO10945 does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO10947 does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO10948 does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO10949 does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO1094A does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO1094B does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO1094C does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO1094E does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO10969 does not have corresponding dataset schema field",
      "entityId": "202246.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "unable to generate test sql",
      "entityId": "3375368/DP10",
      "entityType": "dataset"
    }
  ]
}