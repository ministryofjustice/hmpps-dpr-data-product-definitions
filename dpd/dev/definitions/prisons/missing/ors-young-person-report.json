{
  "id": "klbrzWkAAUbfQrQBAsgAISgWcQA",
  "name": "ORS Young Person Report",
  "description": "This report returns all prisoners designated as Juvenile or Young Person and Lists the Religion and Ethnicity for a YOI Return.<br/>PDD0060 v00.00.01 Last Modified: 01/03/2016",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "PDD0060 v00.00.01"
    ]
  },
  "datasource": [
    {
      "id": "nomis",
      "name": "NOMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "nomis"
    }
  ],
  "dataset": [
    {
      "id": "3377299/DP3",
      "name": "Young Person",
      "description": "Demographic",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER.LAST_NAME, AT_OFFENDER.FIRST_NAME, AT_OFFENDER.BIRTH_DATE, CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('LR', 'LR_HDC', 'LR_ES', 'LR_YOI', 'LR_LIFE', 'LR_S53', 'LR_S53_2', 'LR_YOI', 'LR_DPP', 'LR_EPP', 'LR_IPP', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_MLP', 'FTR_HDC') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('A_CFINE', 'CIV_RMD', 'CIVIL', 'CIVIL_CON', 'CIVIL_DT', 'YO_CFINE', 'YOC_CONT') THEN 'Civil prisoners' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('RX', 'S35MHA', 'S36MHA', 'S37MHA', 'S48MHA', 'SEC43', 'TRL', 'BOBC', 'UNFIT', 'SINE_DIE', 'SINE DIE') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('DET', 'DEPORT', 'EXTRAD', 'REC_DEP') THEN 'Detainee' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('BOAR', 'BOBC', 'JR', 'LR', 'REFER', 'S38MHA', 'S41MHA', 'S43MHA', 'S45MHA', 'SEC10_3', 'SEC17_3', 'SEC18_2', 'SEC19_3B', 'SEC2_1', 'SEC24_2A', 'SEC30', 'SEC37', 'SEC38', 'SEC39', 'SEC42', 'SEC45', 'SEC5', 'SEC56', 'SEC6', 'SEC6_4', 'SEC6B', 'SEC8_6', 'UNK_CONV', 'DEF', 'SEC6B', 'SEC6_4', 'SEC6', 'SEC5', 'SEC19_3B') THEN 'Convicted unsentenced' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('A_FINE', 'A_FINE1', 'A_FINE2', 'AFIXED', 'CFLIFE', 'CJCON08', 'CUSTPLUS', 'DEATH', 'DIED', 'DLF', 'DTO', 'DTTO', 'DTO_YOI', 'DTOR_104', 'DTOR_105', 'EXSENT', 'EXSENT03', 'EXSENT08', 'FTR/08', 'HMP', 'INT_CUST', 'IPP', 'L_W', 'LIFE', 'PPEXT_SENT', 'S47MHA', 'SEC53', 'SEC53_2', 'SEC90', 'SEC90_03', 'SEC91', 'SEC91_03', 'SEC93', 'SEC93_03', 'SEC94', 'SENT', 'SENT_EXL', 'SENT03', 'SENTCJ03', 'YOFINE', 'YOFINE1', 'YOFINE2', 'YOFIXED', (SELECT establishment_code FROM prompt_), 'UNK_SENT', 'MLP', 'ALP', 'DLP', 'DPP', 'HMPL', 'ALP_LASPO', 'DFL', 'DLF', 'LASPO_AR', 'LASPO_DR', 'S47MHA', 'FTR_SCH1') THEN 'Sentenced' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_OFFENDER_RELIGION.PROFILE_CODE, CASE WHEN AT_OFFENDER.RACE_CODE = 'W8' THEN 'W3' WHEN AT_OFFENDER.RACE_CODE = 'O1' THEN 'A4' ELSE AT_OFFENDER.RACE_CODE END AS ETHNIC_CODE, CASE WHEN TRUNC(MONTHS_BETWEEN(CURRENT_TIMESTAMP, AT_OFFENDER.BIRTH_DATE) / 12) <= 17 THEN 'Juvenile' WHEN TRUNC(MONTHS_BETWEEN(CURRENT_TIMESTAMP, AT_OFFENDER.BIRTH_DATE) / 12) >= 18 AND TRUNC(MONTHS_BETWEEN(CURRENT_TIMESTAMP, AT_OFFENDER.BIRTH_DATE) / 12) <= 20 THEN 'Young Person' ELSE 'Adult' END AS ADULT_YOUNG_PERSON_JUVENILE_37, TRUNC(MONTHS_BETWEEN(CURRENT_TIMESTAMP, AT_OFFENDER.BIRTH_DATE) / 12) AS AGE_IN_YEARS, AT_OFFENDERS_LOCATIONS.AGY_LOC_ID, CASE WHEN AT_ETHNICITY_DESC.CODE = 'W8' THEN 'White: Gypsy or Irish Traveller' WHEN AT_ETHNICITY_DESC.CODE = 'O1' THEN 'Asian/Asian British: Chinese' ELSE AT_ETHNICITY_DESC.DESCRIPTION END AS ETHNIC_DESC_, CASE WHEN AT_OFFENDER.RACE_CODE = 'W8' THEN 'W3' WHEN AT_OFFENDER.RACE_CODE = 'O1' THEN 'A4' ELSE AT_OFFENDER.RACE_CODE END || '-' || CASE WHEN AT_ETHNICITY_DESC.CODE = 'W8' THEN 'White: Gypsy or Irish Traveller' WHEN AT_ETHNICITY_DESC.CODE = 'O1' THEN 'Asian/Asian British: Chinese' ELSE AT_ETHNICITY_DESC.DESCRIPTION END AS ETHNIC_DESCRIPTION, AT_RELIGION.DESCRIPTION, CASE WHEN AT_OFFENDER.SEX_CODE = 'M' THEN 'Male' WHEN AT_OFFENDER.SEX_CODE = 'F' THEN 'Female' ELSE 'Unknown' END AS GENDER_DESCRIPTION FROM OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.REFERENCE_CODES AT_ETHNICITY_DESC, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.OFFENDER_PROFILE_DETAILS AT_OFFENDER_RELIGION, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS, OMS_OWNER.IMPRISONMENT_STATUSES AT_IMPRISON_STATUSES, USER_ACCESSIBLE_CASELOADS, OMS_OWNER.PROFILE_CODES AT_RELIGION, OMS_OWNER.LIVING_UNITS AT_LIVING_UNITS, OMS_OWNER.OFFENDER_IMPRISON_STATUSES AT_OFFENDER_IMPRISON_STATUSES WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_ID = AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID) AND (AT_ETHNICITY_DESC.DOMAIN (+) = 'ETHNICITY') AND (AT_ETHNICITY_DESC.CODE (+) = AT_OFFENDER.RACE_CODE) AND (AT_OFFENDER_RELIGION.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_RELIGION.PROFILE_TYPE (+) = 'RELF') AND (AT_OFFENDER_IMPRISON_STATUSES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS = 'Y' OR AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS IS NULL) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = USER_ACCESSIBLE_CASELOADS.CASELOAD_ID) AND (AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID = AT_LIVING_UNITS.LIVING_UNIT_ID) AND (NOT AT_LIVING_UNITS.HOUSING_UNIT_TYPE IN ('OU', 'REC')) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS (+) = AT_OFFENDER_IMPRISON_STATUSES.IMPRISONMENT_STATUS) AND (AT_RELIGION.PROFILE_CODE (+) = AT_OFFENDER_RELIGION.PROFILE_CODE) AND (AT_RELIGION.PROFILE_TYPE (+) = AT_OFFENDER_RELIGION.PROFILE_TYPE) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = (SELECT establishment_code FROM prompt_)) AND (AT_LIVING_UNITS.AGY_LOC_ID || '-' || AT_LIVING_UNITS.LEVEL_1_CODE IN ('All') OR 'All' IN ('All')) AND CASE WHEN TRUNC(MONTHS_BETWEEN(CURRENT_TIMESTAMP, AT_OFFENDER.BIRTH_DATE) / 12) <= 17 THEN 'Juvenile' WHEN TRUNC(MONTHS_BETWEEN(CURRENT_TIMESTAMP, AT_OFFENDER.BIRTH_DATE) / 12) >= 18 AND TRUNC(MONTHS_BETWEEN(CURRENT_TIMESTAMP, AT_OFFENDER.BIRTH_DATE) / 12) <= 20 THEN 'Young Person' ELSE 'Adult' END IN ('Young Person', 'Juvenile'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, LAST_NAME, FIRST_NAME, BIRTH_DATE, LEGAL_STATUS_GROUPING, PROFILE_CODE, ETHNIC_CODE, ADULT_YOUNG_PERSON_JUVENILE_37, AGE_IN_YEARS, AGY_LOC_ID, ETHNIC_DESC_, ETHNIC_DESCRIPTION, DESCRIPTION, GENDER_DESCRIPTION, CASE WHEN ETHNIC_CODE = 'A1' THEN 'A1 - Indian' ELSE CASE WHEN ETHNIC_CODE = 'A2' THEN 'A2 - Pakistani' ELSE CASE WHEN ETHNIC_CODE = 'A3' THEN 'A3 - Bangladeshi' ELSE CASE WHEN ETHNIC_CODE = 'A4' THEN '01 - Chinese' ELSE CASE WHEN ETHNIC_CODE = 'A9' THEN 'A9 - Other (Asian)' ELSE CASE WHEN ETHNIC_CODE = 'B1' THEN 'B1 - Caribbean' ELSE CASE WHEN ETHNIC_CODE = 'B2' THEN 'B2 - African' ELSE CASE WHEN ETHNIC_CODE = 'B9' THEN 'B9 - Any other Black background' ELSE CASE WHEN ETHNIC_CODE = 'M1' THEN 'M1- White and Black Caribbean' ELSE CASE WHEN ETHNIC_CODE = 'M2' THEN 'M2 - White and Black African' ELSE CASE WHEN ETHNIC_CODE = 'M3' THEN 'M3 - White and Asian' ELSE CASE WHEN ETHNIC_CODE = 'M9' THEN 'M9 - Any other mixed background' ELSE CASE WHEN ETHNIC_CODE = 'NS' THEN 'Non stated' ELSE CASE WHEN ETHNIC_CODE = 'O2' THEN '09 - Other Ethnic Group' ELSE CASE WHEN ETHNIC_CODE = 'O9' THEN '09 - Other Ethnic Group' ELSE CASE WHEN ETHNIC_CODE = 'W1' THEN 'W1 - White British' ELSE CASE WHEN ETHNIC_CODE = 'W2' THEN 'W2 - White Irish' ELSE CASE WHEN ETHNIC_CODE = 'W3' THEN 'W9 - Any other White background' ELSE CASE WHEN ETHNIC_CODE = 'W9' THEN 'W9 - Any other White background' ELSE CASE WHEN ETHNIC_CODE IS NULL THEN 'Non Stated' ELSE 'Error' END END END END END END END END END END END END END END END END END END END END AS V_CONVERT_ETHNICITY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP3.DO44",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LAST_NAME",
            "type": "string",
            "display": "Last Name",
            "legacyId": "DP3.DO45",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "First Name",
            "legacyId": "DP3.DO46",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "BIRTH_DATE",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP3.DO75",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP3.DO108a",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "PROFILE_CODE",
            "type": "string",
            "display": "Religion",
            "legacyId": "DP3.DOb0",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DP3.DO88",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ADULT_YOUNG_PERSON_JUVENILE_37",
            "type": "string",
            "display": "Adult / Young Person / Juvenile Indicator",
            "legacyId": "DP3.DO8b9",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "AGE_IN_YEARS",
            "type": "double",
            "display": "Age in Years",
            "legacyId": "DP3.DOa15",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "AGY_LOC_ID",
            "type": "string",
            "display": "Establishment Code",
            "legacyId": "DP3.DO43b",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "ETHNIC_DESC_",
            "type": "string",
            "display": "Ethnic Desc.",
            "legacyId": "DP3.DOc28",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "ETHNIC_DESCRIPTION",
            "type": "string",
            "display": "Ethnic Description",
            "legacyId": "DP3.DO9d",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DP3.DOc29",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "GENDER_DESCRIPTION",
            "type": "string",
            "display": "Gender Description",
            "legacyId": "DP3.DOae",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "V_CONVERT_ETHNICITY",
            "type": "string",
            "display": "V_CONVERT_ETHNICITY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "166972.RS",
      "name": "Young Person",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377299/DP3",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO44"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "First Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO46"
          },
          {
            "name": "$ref:LAST_NAME",
            "display": "Last Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO45"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DOae"
          },
          {
            "name": "$ref:BIRTH_DATE",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO75"
          },
          {
            "name": "$ref:LEGAL_STATUS_GROUPING",
            "display": "Legal Status Grouping",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO108a"
          },
          {
            "name": "$ref:V_CONVERT_RELIGION",
            "display": "Religion",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "= If [Religion]=\"ADV\" Then \"Other - Seven Day Adventist\"\n Else If [Religion]=\"AGNO\" Then \"Agnostic\"\n Else If [Religion]=\"APO\" Then \"Anglican - Episcopalian\"\n Else If [Religion]=\"ATHE\" Then \"Atheist\"\n Else If [Religion]=\"BAPT\" Then \"Free Church - Baptist\"\n Else If [Religion]=\"BLAC\" Then \"Muslim\" \n Else If [Religion]=\"BUDD\" Then \"Buddhist\"\n Else If [Religion]=\"CALV\" Then \"Free Church - United Reform Church\"\n Else If [Religion]=\"CCOG\" Then \"Free Church - Celestial Church of God\"\n Else If [Religion]=\"CE\" Then \"Other - Christadelphian\"\n Else If [Religion]=\"CHRST\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"CHSC\" Then \"Other - Christian Scientist\"\n Else If [Religion]=\"CINCW\" Then \"Anglican - Church of Wales\"\n Else If [Religion]=\"COFE\" Then \"Anglican - Church of England\"\n Else If [Religion]=\"COFI\" Then \"Anglican - Church of Ireland\"\n Else If [Religion]=\"COFN\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"COFS\" Then \"Free Church - Church of Scotland\"\n Else If [Religion]=\"CONG\" Then \"Free Church - Congregational\"\n Else If [Religion]=\"COPT\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"CSW\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"DRU\" Then \"Other - Other non-Christian Religions\"\n Else If [Religion]=\"EODX\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"EORTH\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"EPIS\" Then \"Anglican - Episcopalian\"\n Else If [Religion]=\"ETHO\" Then \"Other - Ethiopian Orthodox\"\n Else If [Religion]=\"EVAN\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"GOSP\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"GROX\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"HARE\" Then \"Other - Other non-Christian Religions\"\n Else If [Religion]=\"HIND\" Then \"Hindu\"\n Else If [Religion]=\"JAIN\" Then \"Other - Other non-Christian Religions\"\n Else If [Religion]=\"JEHV\" Then \"Other - Jehovah's Witness\"\n Else If [Religion]=\"JEW\" Then \"Jewish\"\n Else If [Religion]=\"LUTH\" Then \"Other - Protestant\"\n Else If [Religion]=\"METH\" Then \"Free Church - Methodist\"\n Else If [Religion]=\"MORM\" Then \"Mormon\"\n Else If [Religion]=\"MOS\" Then \"Muslim\"\n Else If [Religion]=\"NIL\" Then \"None\"\n Else If [Religion]=\"NONC\" Then \"Free Church - Non Conformist\"\n Else If [Religion]=\"NONP\" Then \"None\"\n Else If [Religion]=\"OORTH\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"ORTH\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"OTH\" Then \"Unknown\"\n Else If [Religion]=\"PAG\" Then \"Pagan\"\n Else If [Religion]=\"PENT\" Then \"Free Church - Pentecostal\"\n Else If [Religion]=\"PRES\" Then \"Free Church - Presbyterian\"\n Else If [Religion]=\"PROT\" Then \"Other - Protestant\"\n Else If [Religion]=\"QUAK\" Then \"Free Church - Quaker\"\n Else If [Religion]=\"RAST\" Then \"Rastafarian\"\n Else If [Religion]=\"RC\" Then \"Roman Catholic\"\n Else If [Religion]=\"RUSS\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"SALV\" Then \"Free Church - Salvation army\"\n Else If [Religion]=\"SATN\" Then \"Other - Other non-Christian Religions\"\n Else If [Religion]=\"SCIE\" Then \"Other - Christian Scientist\"\n Else If [Religion]=\"SDAY\" Then \"Other - Seven Day Adventist\"\n Else If [Religion]=\"SHIA\" Then \"Muslim\"\n Else If [Religion]=\"SHIN\" Then \"Other - Other non-Christian Religions\"\n Else If [Religion]=\"SIKH\" Then \"Sikh\"\n Else If [Religion]=\"SPIR\" Then \"Other - Spiritualist\"\n Else If [Religion]=\"SUNI\" Then \"Muslim\"\n Else If [Religion]=\"TAO\" Then \"Other - Other non-Christian Religions\"\n Else If [Religion]=\"UNIF\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"UNIT\" Then \"Other - Other Christian Religions\"\n Else If [Religion]=\"UNKN\" Then \"Unknown\"\n Else If [Religion]=\"UR\" Then \"Free Church - United Reform Church\"\n Else If [Religion]=\"WELS\" Then \"Free Church - Welsh Independent\"\n Else If [Religion]=\"ZORO\" Then \"Other - Other non-Christian Religions\"\n Else If IsNull([Religion]) Then \"Unknown\"\n Else \"Error\""
          },
          {
            "name": "$ref:V_CONVERT_ETHNICITY",
            "display": "Ethnicity",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If [Ethnic Code]=\"A1\" Then \"A1 - Indian\" Else \nIf [Ethnic Code]=\"A2\" Then \"A2 - Pakistani\" Else \nIf [Ethnic Code]=\"A3\" Then \"A3 - Bangladeshi\" Else\nIf [Ethnic Code]=\"A4\" Then \"01 - Chinese\" Else \nIf [Ethnic Code]=\"A9\" Then \"A9 - Other (Asian)\" Else \nIf [Ethnic Code]=\"B1\" Then \"B1 - Caribbean\" Else \nIf [Ethnic Code]=\"B2\" Then \"B2 - African\" Else \nIf [Ethnic Code]=\"B9\" Then \"B9 - Any other Black background\" Else \nIf [Ethnic Code]=\"M1\" Then \"M1- White and Black Caribbean\" Else \nIf [Ethnic Code]=\"M2\" Then \"M2 - White and Black African\" Else \nIf [Ethnic Code]=\"M3\" Then \"M3 - White and Asian\" Else \nIf [Ethnic Code]=\"M9\" Then \"M9 - Any other mixed background\" Else \nIf [Ethnic Code]=\"NS\" Then \"Non stated\" Else \nIf [Ethnic Code]=\"O2\" Then \"09 - Other Ethnic Group\" Else \nIf [Ethnic Code]=\"O9\" Then \"09 - Other Ethnic Group\" Else \nIf [Ethnic Code]=\"W1\" Then \"W1 - White British\" Else \nIf [Ethnic Code]=\"W2\" Then \"W2 - White Irish\" Else \nIf [Ethnic Code]=\"W3\" Then \"W9 - Any other White background\" Else \nIf [Ethnic Code]=\"W9\" Then \"W9 - Any other White background\" Else \nIf IsNull([Ethnic Code]) Then \"Non Stated\"\nElse \"Error\""
          },
          {
            "name": "$ref:ADULT_YOUNG_PERSON_JUVENILE_37",
            "display": "Adult / Young Person / Juvenile Indicator",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO8b9"
          },
          {
            "name": "$ref:AGE_IN_YEARS",
            "display": "Age in Years",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DOa15"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_CONVERT_RELIGION :: Error: Error tokenizing 'ND END END END END END END END END END END END EN': Missing ' from 1:4907",
      "entityId": "klbrzWkAAUbfQrQBAsgAISgWcQA",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report field V_CONVERT_RELIGION does not have corresponding dataset schema field",
      "entityId": "166972.RS",
      "entityType": "variant"
    }
  ]
}