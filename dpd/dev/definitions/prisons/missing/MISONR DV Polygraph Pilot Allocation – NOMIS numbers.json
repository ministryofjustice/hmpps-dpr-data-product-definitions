{
  "id": "FoNirgEUOgwAOdkDAABHTc0AACJIAGE1",
  "name": "MISONR DV Polygraph Pilot Allocation â€“ NOMIS numbers",
  "description": "Test to run up to 6 months of data for all releases/HDCED/PED for all Rehab Providers and all prisons",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "v1.1"
    ]
  },
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP2",
      "name": "Sentence",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, Case When DT_LIFEFLAG.LIFE_SENTENCE_FLAG='Y' then 'Life' Else FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH End, FACT_CURR_KEY_DATES_SENT.SSD, CASE WHEN AT_SENT_START_DATE.DAY_DATE < '31/12/9000' THEN AT_SENT_START_DATE.DAY_DATE END, DT_ADMISSION.MOVEMENT_TIME, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL THEN COALESCE(TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH,1,2)*12),0)+ COALESCE(TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH,4,2)),0)+ COALESCE((TRUNC(TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH,7,2))/30)),0) ELSE 99*12 END, /* DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE */ CASE WHEN ( FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE )<( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE ) Then ( FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE ) WHEN( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE )<( FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE ) Then ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE ) WHEN ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE )<( FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE ) then ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE ) WHEN ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE )<( FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE ) then ( FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE ) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END , FACT_CURR_KEY_DATES_SENT.CURR_PED_DATE, Case When DT_LIFEFLAG.LIFE_SENTENCE_FLAG='Y' then 'Sentenced' when FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH='00/00/00' then 'Unsentenced' when FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH is null then 'Unsentenced' else 'Sentenced' End, FACT_CURR_KEY_DATES_SENT.CURR_APD_DATE, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION, FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END, CASE when AT_DIM_ETHNICITY_CODES.DESCRIPTION= 'Chinese' then 'Asian/Asian British: Chinese' when AT_DIM_ETHNICITY_CODES.DESCRIPTION='White : Irish Traveller/Gypsy' then 'White: Gypsy or Irish Traveller' when AT_DIM_ETHNICITY_CODES.DESCRIPTION is null then 'Code Missing' else AT_DIM_ETHNICITY_CODES.DESCRIPTION END, FACT_CURR_KEY_DATES_SENT.CURR_LED_DATE, FACT_CURR_KEY_DATES_SENT.SED, AT_OFFENDER_BOOKING.GENDER_DESCRIPTION, FACT_CURR_KEY_DATES_SENT.CURR_HDCAD_DATE, Case when AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE In ('14FTR_ORA','14FTRHDC_ORA','CUR_ORA','FTR/08','FTR_HDC','FTR_HDC_ORA','FTR_ORA','FTR_SCH15','FTRSCH15_ORA','HDR_ORA','LR','LR_ALP','LR_ALP_LASPO','LR_DLP','LR_DPP','LR_EPP','LR_ES','LR_HDC','LR_IPP','LR_LASPO_AR','LR_LASPO_DR','LR_LIFE','LR_MLP','LR_ORA','LR_SEC236A','LR_SEC91_ORA','LR_YOI','LR_YOI_ORA','FTRSCH18_ORA','FTRSCH18','LR_EDS18','LR_EDS21','LR_SOPC18','LR_SOPC21','LRSEC250_ORA','LR_ALP_CDE18','LR_ALP_CDE21','LR_EDSU18') then 'Recall' when AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '0' then 'Dead' when AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '1' then 'Indeterminate Sentence' when AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND in ('2','3') then 'Sentenced' when AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND in ('4','5','6','7') then 'Convicted Unsentenced' when AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND in ('9','10') or AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'CIV_RMD' then 'Civil Prisoner' when AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND in ('8','11') then 'Immigration Detainee' when AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND in ('12','13','14') then 'Remand' when AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'UNKNOWN' then 'Unknown' Else 'Other' End , FACT_CURR_KEY_DATES_SENT.TARIFF FROM BODIMIS.DIM_DATE AT_SENT_START_DATE, ( Select ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk , fme.from_location_type, max(fme.MOVEMENT_SEQ ) as MOVEMENT_SEQ, max(d.day_date) as MOVEMENT_TIME, trunc(ETL.LOAD_END_DATETIME) as LOAD_DATE From BODIMIS.FACT_MOVEMENT_EXTERNAL fme, BODIMIS.DIM_OFFENDER_BOOKING ob, BODIMIS.DIM_ESTABLISHMENT est, BODIMIS.ETL_LOAD_LOG ETL, BODIMIS.DIM_DATE d Where ob.ESTABLISHMENT_SK=est.ESTABLISHMENT_SK and d.date_sk=fme.date_sk and fme.offender_booking_sk=ob.offender_booking_sk and ob.active_status IN('Active In','Active Out') And ob.MIS_CURRENT_RECORD_IND = 'Y' and ob.ACTIVE_FLAG = 'Y' and ETL.LOAD_ID=(select max(LOAD_ID) from BODIMIS.ETL_LOAD_LOG WHERE LOAD_END_DATETIME IS NOT NULL) And ob.ESTABLISHMENT_SK=fme.to_location_sk and fme.movement_seq= (select max(fme2.movement_seq ) from BODIMIS.FACT_MOVEMENT_EXTERNAL fme2 where fme.offender_booking_sk=fme2.offender_booking_sk and fme2.direction_code='IN' And fme2.TYPE='Admission' And fme2.To_location_type='Establishment' and fme2.reason_code <> 'R') GROUP BY ob.offender_id_display, fme.offender_booking_sk,est.establishment_code_nk,fme.to_location_sk,fme.from_location_sk,fme.from_location_type,ETL.LOAD_END_DATETIME ) DT_ADMISSION, BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, ( --derives a single 'Y' if a prisoner has one or more life sentences where the sentence status is active. The table is outer-joined to dim_offender_booking in the universe. SELECT distinct BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE ( BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK=dss.sentence_status_sk) AND dss.sentence_status='Active' AND ( BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK=BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK ) AND ( BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK=BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK ) AND ( BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK=BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK ) and BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG='Y' ) DT_LIFEFLAG, FACT_CURR_KEY_DATES_SENT, ( --Changes by S.Stow to remove the FACT_CASE_SENTENCE table as part of the Nationality report changes and address changes . --It causes duplicate rows to be returned per booking. Select AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK as OFFENDER_BOOKING_SK, case when AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE From --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE where --AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK=AT_FACT_SENTENCE.OFFENDER_BOOKING_SK(+) AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK=AT_RELEASE_DATE.DATE_SK(+) and AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG='Y' --and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' ) DT_CURRENT_RELEASE_DATE, BODIMIS.DIM_DATE AT_DOB, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK(+) ) AND ( AT_FACT_SENTENCE.SENTENCE_START_DATE_SK=AT_SENT_START_DATE.DATE_SK(+) ) AND ( AT_COURT_CASE.COURT_CASE_STATUS_SK=AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_LIFEFLAG.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK(+) ) AND ( AT_COURT_CASE.OFFENDER_BOOKING_SK(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK ) AND ( AT_OFFENDER_BOOKING.BIRTH_DATE_SK=AT_DOB.DATE_SK ) AND ( AT_COURT_CASE.COURT_CASE_SK=AT_FACT_SENTENCE.COURT_CASE_SK(+) ) AND ( AT_DIM_ETHNICITY_CODES.CODE(+)=AT_OFFENDER_BOOKING.ETHNICITY_CODE ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /*= #Variable('BOUSER') */ )) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /*= #Variable('BOUSER') */ )) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_ADMISSION.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN (SELECT PRISONER_NUMBER FROM prompt_ /*= #prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0) */ ) AND ( AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND='Y' ) AND ( AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y' ) AND ( AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active' ) AND ( AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG='Y' ) AND Case When DT_LIFEFLAG.LIFE_SENTENCE_FLAG='Y' then 'Life' Else FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH End >= '01/00/00' AND Case When DT_LIFEFLAG.LIFE_SENTENCE_FLAG='Y' then 'Sentenced' when FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH='00/00/00' then 'Unsentenced' when FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH is null then 'Unsentenced' else 'Sentenced' End = 'Sentenced' )), dataset_ AS (SELECT  FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter value(s) for NOMS Number:",
          "description": "@prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3375896/DPc",
      "name": "OASys",
      "description": "ONR - Ad-hoc Reports",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT OFFENDER.OFFENDER_ID_DISPLAY AS OFFENDER_ID_DISPLAY, SUBSTR(ASSESSMENT.CALC_HIGHEST_RISK, 4) AS RISK_LEVEL_, REP_OFFENDER_HISTORY.CONTROLLING_OWNER AS CONTROLLING_OWNER, CASE WHEN ASSESSMENT_SECTION2.S2Q3D_VIOLENCE_TO_PARTNER = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3D_VIOLENCE_TO_PARTNER = '1' THEN 'Yes' END AS PHYSICAL_VIOLENCE_TO_PARTNER_, ASSESSMENT_SARA.VIOLENCE_TO_PARTNER_RISK AS VIOLENCE_TO_PARTNER_RISK, ASSESSMENT.DATE_COMPLETED AS DATE_COMPLETED, OFFENDER.CRAMS_NUMBER AS CRAMS_NUMBER, CASE WHEN ASSESSMENT_ROH_SUMMARY.R10Q6_ADULT_COMM = 'V' THEN 'V High' WHEN ASSESSMENT_ROH_SUMMARY.R10Q6_ADULT_COMM = 'H' THEN 'High' WHEN ASSESSMENT_ROH_SUMMARY.R10Q6_ADULT_COMM = 'M' THEN 'Med' WHEN ASSESSMENT_ROH_SUMMARY.R10Q6_ADULT_COMM = 'L' THEN 'Low' END AS RISK_TO_ADULT_, CASE WHEN ASSESSMENT_ROH_SUMMARY.R10Q6_PUBLIC_COMM = 'V' THEN 'V High' WHEN ASSESSMENT_ROH_SUMMARY.R10Q6_PUBLIC_COMM = 'H' THEN 'High' WHEN ASSESSMENT_ROH_SUMMARY.R10Q6_PUBLIC_COMM = 'M' THEN 'Med' WHEN ASSESSMENT_ROH_SUMMARY.R10Q6_PUBLIC_COMM = 'L' THEN 'Low' END AS RISK_TO_PUBLIC_, VICTIM_PERPETRATOR.DESCRIPTION AS DESCRIPTION FROM OFFENDER, ASSESSMENT, REP_OFFENDER_HISTORY, ASSESSMENT_SECTION2, ASSESSMENT_SARA, ASSESSMENT_ROH_SUMMARY, VICTIM_PERPETRATOR, ASSESSMENT_VICTIM WHERE (VICTIM_PERPETRATOR.VICTIM_PERPETRATOR_OPOL_ID (+) = ASSESSMENT_VICTIM.VICTIM_PERPETRATOR_OPOL_ID) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SECTION2.ASSESSMENT_ID) AND (ASSESSMENT_ROH_SUMMARY.ASSESSMENT_ID (+) = ASSESSMENT.ASSESSMENT_ID) AND (ASSESSMENT_SECTION2.ASSESSMENT_ID = ASSESSMENT_VICTIM.ASSESSMENT_ID (+)) AND (OFFENDER.OFFENDER_ID = ASSESSMENT.OFFENDER_ID (+)) AND (OFFENDER.OFFENDER_ID = REP_OFFENDER_HISTORY.OFFENDER_ID (+)) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SARA.ASSESSMENT_ID (+)) AND (OFFENDER.LIMIT_ACCESS_OFFENDER_INDICAT = 0) AND (SUBSTR(OFFENDER.OFFENDER_ID_DISPLAY, 1, 10) = TAGMIS_CASELOAD_SECURITY((SELECT username FROM context_ /* = #Variable('BOUSER') */), OFFENDER.OFFENDER_ID_DISPLAY)) AND ASSESSMENT.ASSESSMENT_ID IN (SELECT LAST_VALUE(ASSESSMENT.assessment_id) OVER (PARTITION BY ASSESSMENT.offender_id ORDER BY ASSESSMENT.date_completed rows BETWEEN CURRENT ROW AND UNBOUNDED following) AS last_ass_for_offender FROM ASSESSMENT, OFFENDER, PURPOSE_OF_ASSESSMENT WHERE (PURPOSE_OF_ASSESSMENT.PURPOSE_OF_ASSESSMENT_CODE (+) = ASSESSMENT.PURPOSE_OF_ASSESSMENT_CODE) AND (OFFENDER.OFFENDER_ID = ASSESSMENT.OFFENDER_ID (+)) AND (ASSESSMENT.single_date_completed = 'Y' AND completed_assessment <> 'Abandoned' AND NOT OFFENDER.Offender_id IS NULL) AND (OFFENDER.LIMIT_ACCESS_OFFENDER_INDICAT = 0) AND (SUBSTR(OFFENDER.OFFENDER_ID_DISPLAY, 1, 10) = TAGMIS_CASELOAD_SECURITY((SELECT username FROM context_ /* = #Variable('BOUSER') */), OFFENDER.OFFENDER_ID_DISPLAY)) AND (COALESCE(ASSESSMENT.COMPLETED_ASSESSMENT, 'Not Specified') = 'True' AND OFFENDER.HISTORIC_OFFENDER_CALC = 'Current' AND NOT COALESCE(PURPOSE_OF_ASSESSMENT.DESCRIPTION, 'Not Specified') IN ('PSR', 'PSR Addendum', 'PSR - FDR', 'PSR - Oral', 'PSR - SDR', 'Nil Report') AND OFFENDER.OFFENDER_ID_DISPLAY IN (SELECT PRISONER_NUMBER FROM prompt_ /* = #prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0) */)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, RISK_LEVEL_, CONTROLLING_OWNER, PHYSICAL_VIOLENCE_TO_PARTNER_, VIOLENCE_TO_PARTNER_RISK, DATE_COMPLETED, CRAMS_NUMBER, RISK_TO_ADULT_, RISK_TO_PUBLIC_, DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter value(s) for NOMS Number:",
          "description": "@prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPc.DO264",
            "legacySqlClass": "alias"
          },
          {
            "index": 1,
            "name": "RISK_LEVEL_",
            "type": "string",
            "display": "Risk Level (10.6)",
            "legacyId": "DPc.DOf2f",
            "legacySqlClass": "alias"
          },
          {
            "index": 2,
            "name": "CONTROLLING_OWNER",
            "type": "string",
            "display": "Controlling Owner",
            "legacyId": "DPc.DO114b",
            "legacySqlClass": "alias"
          },
          {
            "index": 3,
            "name": "PHYSICAL_VIOLENCE_TO_PARTNER_",
            "type": "string",
            "display": "Physical Violence to Partner (2.3d)",
            "legacyId": "DPc.DOacb",
            "legacySqlClass": "alias"
          },
          {
            "index": 4,
            "name": "VIOLENCE_TO_PARTNER_RISK",
            "type": "string",
            "display": "Violence To Partner Risk",
            "legacyId": "DPc.DO11a0",
            "legacySqlClass": "alias"
          },
          {
            "index": 5,
            "name": "DATE_COMPLETED",
            "type": "date",
            "display": "Date Completed",
            "legacyId": "DPc.DO5e5",
            "legacySqlClass": "alias"
          },
          {
            "index": 6,
            "name": "CRAMS_NUMBER",
            "type": "string",
            "display": "Case Index Number",
            "legacyId": "DPc.DOa93",
            "legacySqlClass": "alias"
          },
          {
            "index": 7,
            "name": "RISK_TO_ADULT_",
            "type": "string",
            "display": "Risk to Adult (Community) (R10.6)",
            "legacyId": "DPc.DO657",
            "legacySqlClass": "alias"
          },
          {
            "index": 8,
            "name": "RISK_TO_PUBLIC_",
            "type": "string",
            "display": "Risk to Public (Community) (R10.6)",
            "legacyId": "DPc.DO655",
            "legacySqlClass": "alias"
          },
          {
            "index": 9,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Victim Perpetrator Relationship (2.4)",
            "legacyId": "DPc.DO850",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP4",
      "name": "MIS Load Log",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE AS BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP4.DO104dd",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DPe",
      "name": "Offences 1",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY AS OFFENDER_ID_DISPLAY, CASE WHEN AT_DIM_OFFENCE.OFFENCE_SK > 0 THEN (AT_DIM_OFFENCE.OFFENCE_CODE_NK) ELSE '-' END AS OFFENCE_CJIT_CODE, AT_DIM_OFFENCE.OFFENCE_NAME AS OFFENCE_NAME, AT_DIM_REF_CODES_CRG_RESULT1.DESCRIPTION AS DESCRIPTION, AT_DIM_REF_CODES_CRG_RESULT2.DESCRIPTION AS RESULT_2_INDICATOR, AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_DESCRIPTION AS OUTCOME_REASON_DESCRIPTION, AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_DESCRIPTION AS RESULT_2_DESCRIPTION FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_RSN_CRG_RESULT1, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_RSN_CRG_RESULT2, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_REFERENCE_CODES AT_DIM_REF_CODES_CRG_RESULT1, BODIMIS.DIM_REFERENCE_CODES AT_DIM_REF_CODES_CRG_RESULT2, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_1_DESC_SK = AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_1_IND_SK = AT_DIM_REF_CODES_CRG_RESULT1.REFERENCE_CODE_SK (+) AND AT_DIM_REF_CODES_CRG_RESULT1.CODE_DOMAIN (+) = 'OFF_RESULT') AND (AT_FACT_COURT_CHARGE.RESULT_2_DESC_SK = AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_2_IND_SK = AT_DIM_REF_CODES_CRG_RESULT2.REFERENCE_CODE_SK (+) AND AT_DIM_REF_CODES_CRG_RESULT2.CODE_DOMAIN (+) = 'OFF_RESULT') AND (AT_COURT_CASE.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN (SELECT PRISONER_NUMBER FROM prompt_ /* = #prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0) */) AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active') AND AT_DIM_REF_CODES_CRG_RESULT1.DESCRIPTION IN ('Final', 'Partial') AND AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_DESCRIPTION IN ('Imprisonment') AND CASE WHEN AT_DIM_OFFENCE.OFFENCE_SK > 0 THEN (AT_DIM_OFFENCE.OFFENCE_CODE_NK) ELSE '-' END IN ('COML025A', 'COML026A', 'IC01001A', 'IC01001B', 'IC01002A', 'IC01002B', 'OF61014', 'COML025C', 'COML026C', 'IC01001C', 'IC01002C', 'IC01004', 'IC01005', 'IC01007', 'IC01008', 'OF61002', 'OF61003', 'OF61003A', 'NA', 'COML022', 'OF61004', 'OF61005', 'OF61008', 'OF61009', 'IN38001', 'IL29001', 'DB0047', 'RT88001', 'RT88025', 'RT88500', 'COML023', 'HC57001', 'RT88027', 'RT88028', 'RT88029', 'RT88337', 'RT88338', 'RT88501', 'RT88502', 'RT88527', 'RT88554', 'RT88583', 'DV04001', 'RT88564', 'RT88565', 'RT88565B', 'CM07001', 'DV04002', 'RT88526', 'RT88526A', 'RT88526B', 'RT88526C', 'RT88528', 'RT88965', 'OF61016', 'OF61016A', 'OF61017', 'OF61017A', 'OF61017C', 'OF61018', 'OF61019', 'OF61020', 'OF61022', 'OF61025', 'OF61026', 'OF61027', 'OF61028', 'OF61029', 'OF61030', 'OF61031', 'OF61032', 'OF61033', 'OF61034', 'OF61035', 'OF61038', 'OF61039', 'OF61023', 'OF61024', 'OF61126', 'OF61050', 'OF61051', 'OF61055', 'OF61056', 'OF61057', 'OF61058', 'OF61059', 'OF61063', 'OF61065', 'OF61066', 'OF61067', 'OF61068', 'OF61073', 'OF61074', 'OF61075', 'OF61076', 'OF61099', 'OF61100', 'OF61103', 'OF61104', 'OF61105', 'OF61128', 'OF61129', 'OF61130', 'OF61080', 'OF61060', 'OF61061', 'OF61062', 'EX83005', 'EX83006', 'EX83017', 'EX83022', 'EX83023', 'EX83027', 'EX83029', 'EX83030', 'FI68059', 'FI68059C', 'FI68060', 'FI68063', 'FI68061', 'FI68062', 'FI68064', 'FI68065', 'FI68066', 'FI68067', 'AT01002', 'AT01003', 'AT01004', 'AT01005', 'AT01006', 'AT01007', 'AT01008', 'AT01018', 'AT01019', 'AT01020', 'AT01022', 'AT01034', 'AV90002', 'AV90003', 'AV90004', 'AV90005', 'AV90009', 'CJ88002', 'OF61085', 'OF61117', 'OF61118', 'OF61119', 'OF61120', 'OF61121', 'OF61122', 'OF61123', 'CT94005', 'CT94006', 'CT94007', 'CT94008', 'CT94009', 'CT94010', 'CT94011', 'CT94012', 'CT94013', 'CT94014', 'CT94015', 'CT94016', 'AV90015', 'AV90016', 'AV90017', 'AV90018', 'AV90019', 'AV90020', 'AV90021', 'AV90022', 'AV90023', 'AV90024', 'AV90025', 'AV90026', 'AV90027', 'AV90028', 'AV90029', 'AV90030', 'AV90031', 'AV90032', 'AV90033', 'AV90034', 'AV90035', 'AV90036', 'AV90037', 'AV90038', 'DB0018', 'OF61021', 'OF61131', 'OF61131A', 'OF61083', 'OF61089', 'OF61090', 'OF61091', 'OF61092', 'OF61094', 'CL77999G', 'COML002', 'KE00147', 'OF61101', 'OF61102', 'OF61102A', 'OF61102B', 'OF61102C', 'ZZ00076', 'FI68068', 'FI68069', 'FI68072', 'FI68073', 'FI68070', 'FI68074', 'FI68071', 'FI68075', 'FI68076', 'FI68077', 'FI68077C', 'FI68080', 'FI68081', 'FI68084', 'FI68085', 'FI68078', 'FI68082', 'FI68086', 'FI68079', 'FI68083', 'FI68087', 'OF61095', 'FI68320', 'FI68320A', 'FI68321', 'FI68322', 'FI68323', 'CA81005', 'GL08064', 'GL09104', 'PH97002', 'PH97009', 'WM00042', 'CD98003', 'CD98005', 'CD98006', 'CD98009', 'CD98011G', 'CD98017', 'DB0022', 'GL08060', 'GL09085', 'YY02001', 'CD98028', 'CD98029', 'CD98030', 'CD98031', 'CD98035', 'CD98036', 'CD98041', 'CD98044', 'CD98042', 'FG03001', 'FG03002', 'FG03003', 'CD98070', 'CD98072', 'CD98073', 'CY33001', 'CY33002', 'CY33003', 'CY33004', 'CY33005', 'CY33006', 'CY33007', 'CY33008', 'CY33009', 'CY33010', 'CY33033', 'CY33034', 'CY33035', 'CY33036', 'CY33037', 'CY33038', 'CY33039', 'CY33040', 'CY33041', 'CY33042', 'CY33045', 'CY33046', 'CY33047', 'CY33048', 'CY33049', 'CY33050', 'WI00080', 'OF61048', 'OF61049', 'TH68026G', 'TH68030', 'TH68030A', 'TH68030C', 'TH68034', 'TH68042', 'NA', 'TH68045', 'TH68045A', 'TH68047', 'TH68031', 'TH68031A', 'TH68031C', 'TH68035', 'TH68043', 'TH68046', 'TH68046B', 'TH68048', 'TH68022', 'TH68023', 'TH68023A', 'TH68023C', 'TH68134', 'TH68025', 'NA', 'COML020', 'COML020A', 'COML020C', 'GM000153', 'AV82001', 'AV82002', 'AV82003', 'AV82004', 'AV82005', 'AV82006', 'AV82007', 'AV82008', 'AV82009', 'AV82010', 'AV82011', 'AV82015', 'AV82016', 'AV82069', 'AV82070', 'AV82071', 'AV90013', 'AV90014', 'CT94001', 'CT94002', 'CT94003', 'CT94004', 'CT94017', 'CT94018', 'CT94019', 'CT94020', 'CT94021', 'CAMB003', 'COML017', 'TH82001', 'TH82002', 'AS14012', 'AS14013', 'MS15001', 'MS15001C', 'MS15002', 'MS15002C', 'MS15003', 'MS15003C', 'MS15004', 'MS15005', 'MS15006', 'MS15007', 'MS15008', 'MS15009', 'TH68091', 'TH68092', 'TH68093', 'TH68162', 'TH68163', 'TH68164', 'CD71003', 'CD71003A', 'CD71003C', 'CD71015G', 'CD71016', 'CD71016A', 'CD71016C', 'CD71017', 'CD71017A', 'CD71017B', 'CD71017G', 'CD71015', 'CD71015A', 'CD71015B', 'CD71015C', 'CD98022', 'ZZ00097', 'AS00065', 'CD71011', 'CD71012', 'CD71013', 'CD71014', 'CD71041', 'CD71041A', 'CD71042', 'EX83001', 'EX83003', 'EX83012', 'EX83014', 'EX83016', 'EX83018', 'EX83019', 'EX83026', 'EX83028', 'MD21025', 'MD21026', 'MD21027', 'MD21028', 'MD61001', 'MD61005', 'MD61009', 'MD61013', 'MD61017', 'MD61020', 'MD61021', 'MD61022', 'MD61023', 'MD61024', 'MD61025', 'MD61026', 'MD61027', 'MD61028', 'NA', 'NA', 'NA', 'NA', 'NA', 'NA', 'NA', 'NA', 'NA', 'NA', 'CD98014', 'CD98032', 'CD98045', 'NA', 'PU86001', 'NA', 'PU86002', 'PU86002C', 'PU86003', 'PU86003B', 'TR06007', 'TR06008', 'TR06010', 'TR06012', 'TR06013', 'TR06014', 'TR06015', 'TR06016', 'TR06011', 'AV82012', 'AV82013', 'AV82014', 'MH83009', 'MH83010', 'MH83011', 'MH83012'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OFFENCE_CJIT_CODE, OFFENCE_NAME, DESCRIPTION, RESULT_2_INDICATOR, OUTCOME_REASON_DESCRIPTION, RESULT_2_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter value(s) for NOMS Number:",
          "description": "@prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPe.DO10076",
            "legacySqlClass": "alias"
          },
          {
            "index": 1,
            "name": "OFFENCE_CJIT_CODE",
            "type": "string",
            "display": "Offence CJIT Code",
            "legacyId": "DPe.DO49",
            "legacySqlClass": "alias"
          },
          {
            "index": 2,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DPe.DO4b",
            "legacySqlClass": "alias"
          },
          {
            "index": 3,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Result 1 Indicator",
            "legacyId": "DPe.DO331",
            "legacySqlClass": "alias"
          },
          {
            "index": 4,
            "name": "RESULT_2_INDICATOR",
            "type": "string",
            "display": "Result 2 Indicator",
            "legacyId": "DPe.DO5e5",
            "legacySqlClass": "alias"
          },
          {
            "index": 5,
            "name": "OUTCOME_REASON_DESCRIPTION",
            "type": "string",
            "display": "Result 1 Description",
            "legacyId": "DPe.DO5e4",
            "legacySqlClass": "alias"
          },
          {
            "index": 6,
            "name": "RESULT_2_DESCRIPTION",
            "type": "string",
            "display": "Result 2 Description",
            "legacyId": "DPe.DO5e6",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DPf",
      "name": "Offences 1 Other",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY AS OFFENDER_ID_DISPLAY, CASE WHEN AT_DIM_OFFENCE.OFFENCE_SK > 0 THEN (AT_DIM_OFFENCE.OFFENCE_CODE_NK) ELSE '-' END AS OFFENCE_CJIT_CODE, AT_DIM_OFFENCE.OFFENCE_NAME AS OFFENCE_NAME, AT_DIM_REF_CODES_CRG_RESULT1.DESCRIPTION AS DESCRIPTION, AT_DIM_REF_CODES_CRG_RESULT2.DESCRIPTION AS RESULT_2_INDICATOR, AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_DESCRIPTION AS OUTCOME_REASON_DESCRIPTION, AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_DESCRIPTION AS RESULT_2_DESCRIPTION FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_RSN_CRG_RESULT1, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_RSN_CRG_RESULT2, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_REFERENCE_CODES AT_DIM_REF_CODES_CRG_RESULT1, BODIMIS.DIM_REFERENCE_CODES AT_DIM_REF_CODES_CRG_RESULT2, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_1_DESC_SK = AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_1_IND_SK = AT_DIM_REF_CODES_CRG_RESULT1.REFERENCE_CODE_SK (+) AND AT_DIM_REF_CODES_CRG_RESULT1.CODE_DOMAIN (+) = 'OFF_RESULT') AND (AT_FACT_COURT_CHARGE.RESULT_2_DESC_SK = AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_2_IND_SK = AT_DIM_REF_CODES_CRG_RESULT2.REFERENCE_CODE_SK (+) AND AT_DIM_REF_CODES_CRG_RESULT2.CODE_DOMAIN (+) = 'OFF_RESULT') AND (AT_COURT_CASE.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN (SELECT PRISONER_NUMBER FROM prompt_ /* = #prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0) */) AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active') AND AT_DIM_REF_CODES_CRG_RESULT1.DESCRIPTION IN ('Final', 'Partial') AND AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_DESCRIPTION IN ('Imprisonment') AND CASE WHEN AT_DIM_OFFENCE.OFFENCE_SK > 0 THEN (AT_DIM_OFFENCE.OFFENCE_CODE_NK) ELSE '-' END IN ('COML025', 'COML025A', 'COML025N', 'COML026', 'COML026A', 'COML026C', 'PH97003', 'PH97003A', 'PH97005', 'PH97007', 'PH97008', 'PH97009', 'PH97010', 'PH97011', 'SC15004', 'SC07005', 'SC07009', 'SC07013', 'COML025C', 'OF61003', 'OF61003A', 'SC15005', 'SC15006', 'SC15006A', 'CD98080', 'CD98081'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OFFENCE_CJIT_CODE, OFFENCE_NAME, DESCRIPTION, RESULT_2_INDICATOR, OUTCOME_REASON_DESCRIPTION, RESULT_2_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter value(s) for NOMS Number:",
          "description": "@prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPf.DO10076",
            "legacySqlClass": "alias"
          },
          {
            "index": 1,
            "name": "OFFENCE_CJIT_CODE",
            "type": "string",
            "display": "Offence CJIT Code",
            "legacyId": "DPf.DO49",
            "legacySqlClass": "alias"
          },
          {
            "index": 2,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DPf.DO4b",
            "legacySqlClass": "alias"
          },
          {
            "index": 3,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Result 1 Indicator",
            "legacyId": "DPf.DO331",
            "legacySqlClass": "alias"
          },
          {
            "index": 4,
            "name": "RESULT_2_INDICATOR",
            "type": "string",
            "display": "Result 2 Indicator",
            "legacyId": "DPf.DO5e5",
            "legacySqlClass": "alias"
          },
          {
            "index": 5,
            "name": "OUTCOME_REASON_DESCRIPTION",
            "type": "string",
            "display": "Result 1 Description",
            "legacyId": "DPf.DO5e4",
            "legacySqlClass": "alias"
          },
          {
            "index": 6,
            "name": "RESULT_2_DESCRIPTION",
            "type": "string",
            "display": "Result 2 Description",
            "legacyId": "DPf.DO5e6",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP10",
      "name": "Rehab",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY AS OFFENDER_ID_DISPLAY, CASE WHEN BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK > 0 THEN BODIMIS.DIM_REHAB_PROVIDER.CODE_NK END AS REHAB_PROVIDER_CODE, CASE WHEN BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK > 0 THEN BODIMIS.DIM_REHAB_PROVIDER.DESCRIPTION END AS REHAB_PROVIDER_DESCRIPTION FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_REHAB_PROVIDER, BODIMIS.FACT_OFFENDER_REHAB WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.FACT_OFFENDER_REHAB.OFFENDER_BOOKING_SK (+)) AND (BODIMIS.FACT_OFFENDER_REHAB.REHAB_PROVIDER_SK = BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN (SELECT PRISONER_NUMBER FROM prompt_ /* = #prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0) */) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (BODIMIS.FACT_OFFENDER_REHAB.PROVIDER_ACTIVE_FLAG = 'Y' OR BODIMIS.FACT_OFFENDER_REHAB.PROVIDER_ACTIVE_FLAG IS NULL) AND (BODIMIS.FACT_OFFENDER_REHAB.DECISION_ACTIVE_FLAG = 'Y' OR BODIMIS.FACT_OFFENDER_REHAB.DECISION_ACTIVE_FLAG IS NULL))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, REHAB_PROVIDER_CODE, REHAB_PROVIDER_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter value(s) for NOMS Number:",
          "description": "@prompt('Enter value(s) for NOMS Number:','A',,Multi,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP10.DO10076",
            "legacySqlClass": "alias"
          },
          {
            "index": 1,
            "name": "REHAB_PROVIDER_CODE",
            "type": "string",
            "display": "Rehab Provider Code",
            "legacyId": "DP10.DO10b37",
            "legacySqlClass": "alias"
          },
          {
            "index": 2,
            "name": "REHAB_PROVIDER_DESCRIPTION",
            "type": "string",
            "display": "Rehab Provider Description",
            "legacyId": "DP10.DO10b38",
            "legacySqlClass": "alias"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "83107.RS",
      "name": "Due for release in next 6 months",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP2.DO107b1",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO10076",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:CRN",
            "display": "",
            "formula": "=[Case Index Number]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO1007b",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO10080",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO10085",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO100a9",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO1009c",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO107ce",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO32d",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_latest_sent_date",
            "display": "",
            "formula": "=Max([Sentence Start Date])",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO2d0",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Date_Completed",
            "display": "",
            "formula": "=[Date Completed]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Has_Offence?",
            "display": "",
            "formula": "=If(IsNull([Offence CJIT Code]);\"No\";\"Yes\") In ([NOMS Number])",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Max_Concat_offence",
            "display": "",
            "formula": "=[v_concat_offence] Where ([v_CJIT_And_Offence_Description]= [v_max_offence]) In ([NOMS Number])",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Physical Violence to Partner (d)",
            "display": "",
            "formula": "=[Physical Violence to Partner (2.3d)]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Max_Concat_auto_eligible_15_no_23d",
            "display": "",
            "formula": "=[v_concat_auto_eligible_15_no_23d] Where ([v_Auto_Eligible_15_No_23d]= [v_max_Auto_Eligible_15_No_23d]) In ([NOMS Number])",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Max_Concat_Victim_Perp",
            "display": "",
            "formula": "=[v_concat_victim_perp] Where ([v_Victim_Perpetrator]= [v_max_Victim_Perp]) In ([NOMS Number])",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Violence_to_Partner_Risk_Bands",
            "display": "",
            "formula": "=If([Violence To Partner Risk]=\"1\";\"Low\";If([Violence To Partner Risk]=\"2\";\"Medium\";If([Violence To Partner Risk]=\"3\";\"High\";\"\")))",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_ROSH",
            "display": "",
            "formula": "=[Risk Level (10.6)]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_RoSH_Known_Adult(Comm)",
            "display": "",
            "formula": "=[Risk to Adult (Community) (R10.6)]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_RoSH_Public_(Comm)",
            "display": "",
            "formula": "=[Risk to Public (Community) (R10.6)]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Rehab_Provider",
            "display": "",
            "formula": "=([Rehab Provider Code] + \" \" + [Rehab Provider Description])",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO565",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Age_at_Release_Date_TRUNC",
            "display": "",
            "formula": "=Truncate((MonthsBetween([Date of Birth];[Release Date (Current)])/12);0)",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO70",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO97",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO87",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO88",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO6a",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO46",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO107cb",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP2.DO3b1",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          }
        ]
      }
    }
  ]
}