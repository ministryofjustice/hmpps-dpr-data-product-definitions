{
  "id": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
  "name": "MIS OASys Section 2 Report test counts all offenders",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "OAS0029 v0.1"
    ]
  },
  "description": "Lists sentenced offenders in an establishment with details of Section 2 from their latest OASys assessment.<br/>OAS0029 - v0.1",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP4",
      "name": "Prisoners",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION, CASE WHEN AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassified' ELSE AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL END AS CURRENT_SECURITY_CATEGORY, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' WHEN SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '99' THEN 'Life' WHEN FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH = '00/00/00' THEN 'No sentence' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 6 THEN 'Less than 6 Months' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 12 THEN '6 Months to less than 1 Year' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) <> '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 2 THEN '1 Year to less than 2 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 3 THEN '2 Years to less than 3 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 4 THEN '3 Years to less than 4 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02', '03') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 10 THEN '4 Years to less than 10 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) >= 10 THEN '10 Years or more and Less than Life' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH IS NULL THEN 'No sentence' ELSE 'Not Categorised' END AS CURRENT_SENTENCE_LENGTH_BAND, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.PNC_ID, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_DIM_OFFENCE.OFFENCE_SEVERITY_RANKING, AT_FACT_COURT_CHARGE.OFFENDER_CHARGE_ID_NK, AT_FACT_COURT_CHARGE.MOST_SERIOUS_FLAG, AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.SURNAME, FACT_CURR_KEY_DATES_SENT.SSD, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, DT_ADMISSION.MOVEMENT_TIME, FACT_CURR_KEY_DATES_SENT.CURR_RELEASE_DATE FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, (SELECT ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk, fme.from_location_type, MAX(fme.MOVEMENT_SEQ) AS MOVEMENT_SEQ, MAX(d.day_date) AS MOVEMENT_TIME, TRUNC(ETL.LOAD_END_DATETIME) AS LOAD_DATE FROM BODIMIS.FACT_MOVEMENT_EXTERNAL fme, BODIMIS.DIM_OFFENDER_BOOKING ob, BODIMIS.DIM_ESTABLISHMENT est, BODIMIS.ETL_LOAD_LOG ETL, BODIMIS.DIM_DATE d WHERE ob.ESTABLISHMENT_SK = est.ESTABLISHMENT_SK AND d.date_sk = fme.date_sk AND fme.offender_booking_sk = ob.offender_booking_sk AND ob.active_status IN ('Active In', 'Active Out') AND ob.MIS_CURRENT_RECORD_IND = 'Y' AND ob.ACTIVE_FLAG = 'Y' AND ETL.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL) AND ob.ESTABLISHMENT_SK = fme.to_location_sk AND fme.movement_seq = (SELECT MAX(fme2.movement_seq) FROM BODIMIS.FACT_MOVEMENT_EXTERNAL fme2 WHERE fme.offender_booking_sk = fme2.offender_booking_sk AND fme2.direction_code = 'IN' AND fme2.TYPE = 'Admission' AND fme2.To_location_type = 'Establishment' AND fme2.reason_code <> 'R') GROUP BY ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk, fme.from_location_type, ETL.LOAD_END_DATETIME) DT_ADMISSION, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_CURRENT_SECURITY_CATEGORY, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, FACT_CURR_KEY_DATES_SENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_CELL AT_CELL, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_CELL.ESTABLISHMENT_SK = AT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_ESTABLISHMENT.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_ADMISSION.OFFENDER_BOOKING_SK (+)) AND (AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_FLAG (+) = 'Y') AND (AT_CURRENT_SECURITY_CATEGORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND ((AT_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' WHEN SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '99' THEN 'Life' WHEN FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH = '00/00/00' THEN 'No sentence' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 6 THEN 'Less than 6 Months' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 12 THEN '6 Months to less than 1 Year' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) <> '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 2 THEN '1 Year to less than 2 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 3 THEN '2 Years to less than 3 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 4 THEN '3 Years to less than 4 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02', '03') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 10 THEN '4 Years to less than 10 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) >= 10 THEN '10 Years or more and Less than Life' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH IS NULL THEN 'No sentence' ELSE 'Not Categorised' END <> 'No sentence' AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' WHEN SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '99' THEN 'Life' WHEN FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH = '00/00/00' THEN 'No sentence' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 6 THEN 'Less than 6 Months' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 12 THEN '6 Months to less than 1 Year' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) <> '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 2 THEN '1 Year to less than 2 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 3 THEN '2 Years to less than 3 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 4 THEN '3 Years to less than 4 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02', '03') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 10 THEN '4 Years to less than 10 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) >= 10 THEN '10 Years or more and Less than Life' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH IS NULL THEN 'No sentence' ELSE 'Not Categorised' END IN ('Life', '4 Years to less than 10 Years', '3 Years to less than 4 Years', '2 Years to less than 3 Years', '1 Year to less than 2 Years', '10 Years or more and Less than Life') OR CASE WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) <= 17 THEN 'Juvenile' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 18 AND 20 THEN 'Young Person' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) >= 21 THEN 'Adult' END <> 'Adult'))), dataset_ AS (SELECT ESTABLISHMENT_DESCRIPTION, CURRENT_SECURITY_CATEGORY, CURRENT_SENTENCE_LENGTH_BAND, OFFENDER_ID_DISPLAY, PNC_ID, DATE_OF_BIRTH, OFFENCE_SEVERITY_RANKING, OFFENDER_CHARGE_ID_NK, MOST_SERIOUS_FLAG, FIRST_NAME, SURNAME, SSD, MAIN_LEGAL_STATUS_CODE, MOVEMENT_TIME, CURR_RELEASE_DATE, DATE_COMPLETED AS V_DATE_COMPLETED_MGE, CALC_PURPOSE_OF_ASSMNT_GROUPS AS V_PURPOSE_OF_ASSESSMENT_GROUP, PURPOSE_OF_ASSESSMENT AS V_PURPOSE_OF_ASSESSMENT, RISK_LEVEL_ AS V_RISK_LEVEL_MGE, V_CONTROLLING_OWNER_NPS_CRC_OR_HMPS AS V_NPS_OR_HMPS_MGE, OFFENDER_MANAGER AS V_OASYS_OFF_MANAGER_MGE, OTHER_CONTACT_NAME AS V_OTHER_CONTACT_NAME_MGE, MOVEMENT_TIME AS V_ADMISSION_DATE_MGE, CASE WHEN V_LATEST_ASSESSMENT_AFTER_SENTENCE >= V_ADMISSION_DATE_MGE THEN 'Y' ELSE 'N' END AS OASYS_POST_ADMISSION, CASE WHEN V_LATEST_ASSESSMENT_AFTER_SENTENCE IS NULL THEN 'N' ELSE 'Y' END AS OASYS_POST_SENTENCE, CARRYING_OR_USE_OF_WEAPON_ AS V_CARRY_USE_WEAPON, VIOLENCE_OR_THREAT_OF_VIOLEN31 AS V_VIOLENCE_USED, EXCESSIVE_OR_SADISTIC_VIOLEN31 AS V_EXCESSIVE_SADISTIC_VIOLENCE, ARSON_ AS V_ARSON, PHYSICAL_DAMAGE_TO_PROPERTY_ AS V_PROPERTY_DAMAGE, SEXUAL_ELEMENT_ AS V_SEXUAL_ELEMENT, DIRECT_VICTIM_TARGETING_ AS V_DIRECT_VICTIMS, RACIAL_MOTIVATION_OR_HATRED_ AS V_RACIAL_MOTIVATION_OR_HATRED, SPECIFIC_VICTIM_REVENGE_ AS V_SPECIFIC_VICTIM_REVENGE, PHYSICAL_VIOLENCE_TO_PARTNER_ AS V_VIOLENCE_TO_PARTNER, REPEAT_VICTIMISATION_OF_PERS31 AS V_REPEAT_VICTIMISATION, VICTIM_WAS_A_STRANGER_TO_OFF34 AS V_VICTIM_STRANGER, DESCRIPTION AS V_VICTIM_AGE_RANGE, VICTIM_GENDER_CODE AS V_VICTIM_GENDER, VICTIM_ETHNIC_GROUP AS V_VICTIM_ETHNIC_GROUP, VICTIM_PERPETRATOR_RELATIONS31 AS V_VICTIM_PERPETRATOR_RELATIO33, OFFENDER_RECOGNISES_IMPACT_ AS V_RECOGNISES_IMPACT, OTHER_OFFENDERS_INVOLVED_ AS V_OTHER_OFFENDERS_INVOLVED, S2Q7_NUMBER_OF_OFFENDERS AS V_NUM_OF_OTHERS_INVOLVED, PEER_GROUP_INFLUENCE_ AS V_PEER_GROUP_INFLUENCE, SEXUAL_MOTIVATION_ AS V_SEXUAL_MOTIVATION, FINANCIAL_MOTIVATION_ AS V_FINANCIAL_MOTIVATION, ADDICTION_ AS V_ADDICTIONS_PERCEIVED_NEEDS, EMOTIONAL_STATE_ AS V_EMOTIONAL_STATE_OF_OFFENDER, RACIAL_OR_HATRED_ AS V_RACIAL_OR_HATRED_MOTIVATION, THRILL_SEEKING_ AS V_THRILL_SEEKING, OTHER_MOTIVATION_ AS V_OTHER_MOTIVATION, ALCOHOL_ AS V_ALCOHOL, PORNOGRAPHY_ AS V_PORNOGRAPHY, NON_COMPLIANCE_WITH_MEDICATI31 AS V_MEDICATION, PSYCHIATRIC_PROBLEMS_ AS V_PSYCHIATRIC_PROBLEMS, EMOTIONAL_STATE_ AS V_EMOTIONAL_STATE, DRUGS_ AS V_DRUGS, TRAUMATIC_LIFE_EVENT_ AS V_TRAUMATIC_EVENT, OFFENDER_ACCEPTS_RESPONSIBIL32 AS V_ACCEPTS_RESPONSIBILITY, OFFENCE_IS_AN_ESCALATION_IN_40 AS V_ESCALATION_IN_SERIOUSNESS, V_PART_OF_ESTABLISHED_PATTERN AS V_PART_OF_PATTERN, DISCLOSURE_MISSING_ AS V_DISCLOSED, SECTION_2_ISSUES_LINKED_TO_R31 AS V_SECTION2_ISSUES_LINKED_TO_32, 'TBD' AS V_MOST_SERIOUS_OFFENCE_MATCH FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Establishment Name",
            "legacyId": "DP4.DO10129",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "CURRENT_SECURITY_CATEGORY",
            "type": "string",
            "display": "Current Security Category",
            "legacyId": "DP4.DO100e1",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "CURRENT_SENTENCE_LENGTH_BAND",
            "type": "string",
            "display": "Current Sentence Length Band",
            "legacyId": "DP4.DO1ef",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP4.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "PNC_ID",
            "type": "string",
            "display": "PNC ID",
            "legacyId": "DP4.DO100db",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP4.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "OFFENCE_SEVERITY_RANKING",
            "type": "string",
            "display": "Offence Severity Ranking",
            "legacyId": "DP4.DO4e",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "OFFENDER_CHARGE_ID_NK",
            "type": "double",
            "display": "Offender Charge Id Nk",
            "legacyId": "DP4.DO1d9",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "MOST_SERIOUS_FLAG",
            "type": "string",
            "display": "Main Offence Flag",
            "legacyId": "DP4.DO4f",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP4.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP4.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "SSD",
            "type": "date",
            "display": "Current Sentence Start Date",
            "legacyId": "DP4.DO32d",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "MAIN_LEGAL_STATUS_CODE",
            "type": "string",
            "display": "Main Legal Status Code",
            "legacyId": "DP4.DO100de",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Admission Date",
            "legacyId": "DP4.DO107ce",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "CURR_RELEASE_DATE",
            "type": "date",
            "display": "Current Release Date",
            "legacyId": "DP4.DO2e6",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "V_DATE_COMPLETED_MGE",
            "type": "string",
            "display": "V_DATE_COMPLETED_MGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 16,
            "name": "V_PURPOSE_OF_ASSESSMENT_GROUP",
            "type": "string",
            "display": "V_PURPOSE_OF_ASSESSMENT_GROUP",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 17,
            "name": "V_PURPOSE_OF_ASSESSMENT",
            "type": "string",
            "display": "V_PURPOSE_OF_ASSESSMENT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 18,
            "name": "V_RISK_LEVEL_MGE",
            "type": "string",
            "display": "V_RISK_LEVEL_MGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 19,
            "name": "V_NPS_OR_HMPS_MGE",
            "type": "string",
            "display": "V_NPS_OR_HMPS_MGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 20,
            "name": "V_OASYS_OFF_MANAGER_MGE",
            "type": "string",
            "display": "V_OASYS_OFF_MANAGER_MGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 21,
            "name": "V_OTHER_CONTACT_NAME_MGE",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 22,
            "name": "V_ADMISSION_DATE_MGE",
            "type": "string",
            "display": "V_ADMISSION_DATE_MGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 23,
            "name": "OASYS_POST_ADMISSION",
            "type": "string",
            "display": "OASYS_POST_ADMISSION",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 24,
            "name": "OASYS_POST_SENTENCE",
            "type": "string",
            "display": "OASYS_POST_SENTENCE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 25,
            "name": "V_CARRY_USE_WEAPON",
            "type": "string",
            "display": "V_CARRY_USE_WEAPON",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 26,
            "name": "V_VIOLENCE_USED",
            "type": "string",
            "display": "V_VIOLENCE_USED",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 27,
            "name": "V_EXCESSIVE_SADISTIC_VIOLENCE",
            "type": "string",
            "display": "V_EXCESSIVE_SADISTIC_VIOLENCE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 28,
            "name": "V_ARSON",
            "type": "string",
            "display": "V_ARSON",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 29,
            "name": "V_PROPERTY_DAMAGE",
            "type": "string",
            "display": "V_PROPERTY_DAMAGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 30,
            "name": "V_SEXUAL_ELEMENT",
            "type": "string",
            "display": "V_SEXUAL_ELEMENT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 31,
            "name": "V_DIRECT_VICTIMS",
            "type": "string",
            "display": "V_DIRECT_VICTIMS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 32,
            "name": "V_RACIAL_MOTIVATION_OR_HATRED",
            "type": "string",
            "display": "V_RACIAL_MOTIVATION_OR_HATRED",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 33,
            "name": "V_SPECIFIC_VICTIM_REVENGE",
            "type": "string",
            "display": "V_SPECIFIC_VICTIM_REVENGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 34,
            "name": "V_VIOLENCE_TO_PARTNER",
            "type": "string",
            "display": "V_VIOLENCE_TO_PARTNER",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 35,
            "name": "V_REPEAT_VICTIMISATION",
            "type": "string",
            "display": "V_REPEAT_VICTIMISATION",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 36,
            "name": "V_VICTIM_STRANGER",
            "type": "string",
            "display": "V_VICTIM_STRANGER",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 37,
            "name": "V_VICTIM_AGE_RANGE",
            "type": "string",
            "display": "V_VICTIM_AGE_RANGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 38,
            "name": "V_VICTIM_GENDER",
            "type": "string",
            "display": "V_VICTIM_GENDER",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 39,
            "name": "V_VICTIM_ETHNIC_GROUP",
            "type": "string",
            "display": "V_VICTIM_ETHNIC_GROUP",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 40,
            "name": "V_VICTIM_PERPETRATOR_RELATIO33",
            "type": "string",
            "display": "V_VICTIM_PERPETRATOR_RELATIO33",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 41,
            "name": "V_RECOGNISES_IMPACT",
            "type": "string",
            "display": "V_RECOGNISES_IMPACT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 42,
            "name": "V_OTHER_OFFENDERS_INVOLVED",
            "type": "string",
            "display": "V_OTHER_OFFENDERS_INVOLVED",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 43,
            "name": "V_NUM_OF_OTHERS_INVOLVED",
            "type": "string",
            "display": "V_NUM_OF_OTHERS_INVOLVED",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 44,
            "name": "V_PEER_GROUP_INFLUENCE",
            "type": "string",
            "display": "V_PEER_GROUP_INFLUENCE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 45,
            "name": "V_SEXUAL_MOTIVATION",
            "type": "string",
            "display": "V_SEXUAL_MOTIVATION",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 46,
            "name": "V_FINANCIAL_MOTIVATION",
            "type": "string",
            "display": "V_FINANCIAL_MOTIVATION",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 47,
            "name": "V_ADDICTIONS_PERCEIVED_NEEDS",
            "type": "string",
            "display": "V_ADDICTIONS_PERCEIVED_NEEDS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 48,
            "name": "V_EMOTIONAL_STATE_OF_OFFENDER",
            "type": "string",
            "display": "V_EMOTIONAL_STATE_OF_OFFENDER",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 49,
            "name": "V_RACIAL_OR_HATRED_MOTIVATION",
            "type": "string",
            "display": "V_RACIAL_OR_HATRED_MOTIVATION",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 50,
            "name": "V_THRILL_SEEKING",
            "type": "string",
            "display": "V_THRILL_SEEKING",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 51,
            "name": "V_OTHER_MOTIVATION",
            "type": "string",
            "display": "V_OTHER_MOTIVATION",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 52,
            "name": "V_ALCOHOL",
            "type": "string",
            "display": "V_ALCOHOL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 53,
            "name": "V_PORNOGRAPHY",
            "type": "string",
            "display": "V_PORNOGRAPHY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 54,
            "name": "V_MEDICATION",
            "type": "string",
            "display": "V_MEDICATION",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 55,
            "name": "V_PSYCHIATRIC_PROBLEMS",
            "type": "string",
            "display": "V_PSYCHIATRIC_PROBLEMS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 56,
            "name": "V_EMOTIONAL_STATE",
            "type": "string",
            "display": "V_EMOTIONAL_STATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 57,
            "name": "V_DRUGS",
            "type": "string",
            "display": "V_DRUGS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 58,
            "name": "V_TRAUMATIC_EVENT",
            "type": "string",
            "display": "V_TRAUMATIC_EVENT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 59,
            "name": "V_ACCEPTS_RESPONSIBILITY",
            "type": "string",
            "display": "V_ACCEPTS_RESPONSIBILITY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 60,
            "name": "V_ESCALATION_IN_SERIOUSNESS",
            "type": "string",
            "display": "V_ESCALATION_IN_SERIOUSNESS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 61,
            "name": "V_PART_OF_PATTERN",
            "type": "string",
            "display": "V_PART_OF_PATTERN",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 62,
            "name": "V_DISCLOSED",
            "type": "string",
            "display": "V_DISCLOSED",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 63,
            "name": "V_SECTION2_ISSUES_LINKED_TO_32",
            "type": "string",
            "display": "V_SECTION2_ISSUES_LINKED_TO_32",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 64,
            "name": "V_MOST_SERIOUS_OFFENCE_MATCH",
            "type": "string",
            "display": "V_MOST_SERIOUS_OFFENCE_MATCH",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375896/DP22",
      "name": "OASys",
      "description": "ONR - Ad-hoc Reports",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT ASSESSMENT.DATE_COMPLETED, COUNT(DISTINCT OFFENDER.OFFENDER_ID) AS COUNT_OF_OFFENDERS, OFFENDER.OFFENDER_ID_DISPLAY, REP_OFFENDER_HISTORY.CONTROLLING_OWNER, SUBSTR(ASSESSMENT.CALC_HIGHEST_RISK, 4) AS RISK_LEVEL_, ASSESSMENT.CALC_MAPPA, REP_OFFENDER_HISTORY.OFFENDER_MANAGER, ASSESSMENT.CALC_PURPOSE_OF_ASSMNT_GROUPS, CASE WHEN OFFENDER.PROLIFIC_OFFENDER = '1' THEN 'Yes' WHEN OFFENDER.PROLIFIC_OFFENDER = '0' THEN 'No' END AS PROLIFIC_OFFENDER, COALESCE(PURPOSE_OF_ASSESSMENT.DESCRIPTION, 'Not Specified') AS PURPOSE_OF_ASSESSMENT, CASE WHEN ASSESSMENT_SECTION2.S2Q2A_CARRY_USE_WEAPON = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2A_CARRY_USE_WEAPON = '1' THEN 'Yes' END AS CARRYING_OR_USE_OF_WEAPON_, CASE WHEN ASSESSMENT_SECTION2.S2Q2B_VIOLENCE_THREAT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2B_VIOLENCE_THREAT = '1' THEN 'Yes' END AS VIOLENCE_OR_THREAT_OF_VIOLEN31, CASE WHEN ASSESSMENT_SECTION2.S2Q2C_EXCESSIVE_VIOLENCE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2C_EXCESSIVE_VIOLENCE = '1' THEN 'Yes' END AS EXCESSIVE_OR_SADISTIC_VIOLEN31, CASE WHEN ASSESSMENT_SECTION2.S2Q2D_ARSON = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2D_ARSON = '1' THEN 'Yes' END AS ARSON_, CASE WHEN ASSESSMENT_SECTION2.S2Q2E_PROPERTY_DAMAGE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2E_PROPERTY_DAMAGE = '1' THEN 'Yes' END AS PHYSICAL_DAMAGE_TO_PROPERTY_, CASE WHEN ASSESSMENT_SECTION2.S2Q2F_SEXUAL_ELEMENT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2F_SEXUAL_ELEMENT = '1' THEN 'Yes' END AS SEXUAL_ELEMENT_, CASE WHEN ASSESSMENT_SECTION2.S2Q3A_DIRECT_VICTIM = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3A_DIRECT_VICTIM = '1' THEN 'Yes' END AS DIRECT_VICTIM_TARGETING_, CASE WHEN ASSESSMENT_SECTION2.S2Q3B_RACIAL_HATE_MOTIVATION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3B_RACIAL_HATE_MOTIVATION = '1' THEN 'Yes' END AS RACIAL_MOTIVATION_OR_HATRED_, CASE WHEN ASSESSMENT_SECTION2.S2Q3C_RESPONSE_TO_VICTIM = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3C_RESPONSE_TO_VICTIM = '1' THEN 'Yes' END AS SPECIFIC_VICTIM_REVENGE_, CASE WHEN ASSESSMENT_SECTION2.S2Q3D_VIOLENCE_TO_PARTNER = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3D_VIOLENCE_TO_PARTNER = '1' THEN 'Yes' END AS PHYSICAL_VIOLENCE_TO_PARTNER_, CASE WHEN ASSESSMENT_SECTION2.S2Q3E_REPEAT_VICTIMISATION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3E_REPEAT_VICTIMISATION = '1' THEN 'Yes' END AS REPEAT_VICTIMISATION_OF_PERS31, CASE WHEN ASSESSMENT_SECTION2.S2Q3F_VICTIM_STRANGER = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3F_VICTIM_STRANGER = '1' THEN 'Yes' END AS VICTIM_WAS_A_STRANGER_TO_OFF34, VICTIM_AGE_RANGE.DESCRIPTION, ASSESSMENT_VICTIM.VICTIM_GENDER_CODE, ETHNIC_GROUP.DESCRIPTION AS VICTIM_ETHNIC_GROUP, VICTIM_PERPETRATOR.DESCRIPTION AS VICTIM_PERPETRATOR_RELATIONS31, CASE WHEN ASSESSMENT_SECTION2.S2Q6_OFFENDER_RECOGNISE_IMPACT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q6_OFFENDER_RECOGNISE_IMPACT = '1' THEN 'Yes' END AS OFFENDER_RECOGNISES_IMPACT_, CASE WHEN ASSESSMENT_SECTION2.S2Q7_OTHER_OFFENDERS_INVOLVED = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q7_OTHER_OFFENDERS_INVOLVED = '1' THEN 'Yes' END AS OTHER_OFFENDERS_INVOLVED_, ASSESSMENT_SECTION2.S2Q7_NUMBER_OF_OFFENDERS, CASE WHEN ASSESSMENT_SECTION2.S2Q7_PEER_GROUP_INFLUENCE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q7_PEER_GROUP_INFLUENCE = '1' THEN 'Yes' END AS PEER_GROUP_INFLUENCE_, CASE WHEN ASSESSMENT_SECTION2.S2Q9_SEXUAL_MOTIVATION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_SEXUAL_MOTIVATION = '1' THEN 'Yes' END AS SEXUAL_MOTIVATION_, CASE WHEN ASSESSMENT_SECTION2.S2Q9_FINANCIAL_MOTIVATION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_FINANCIAL_MOTIVATION = '1' THEN 'Yes' END AS FINANCIAL_MOTIVATION_, CASE WHEN ASSESSMENT_SECTION2.S2Q9_ADDICTION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_ADDICTION = '1' THEN 'Yes' END AS ADDICTION_, CASE WHEN ASSESSMENT_SECTION2.S2Q9_EMOTIONAL = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_EMOTIONAL = '1' THEN 'Yes' END AS EMOTIONAL_STATE_, CASE WHEN ASSESSMENT_SECTION2.S2Q9_RACIAL_HATE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_RACIAL_HATE = '1' THEN 'Yes' END AS RACIAL_OR_HATRED_, CASE WHEN ASSESSMENT_SECTION2.S2Q9_THRILL_SEEKING = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_THRILL_SEEKING = '1' THEN 'Yes' END AS THRILL_SEEKING_, CASE WHEN ASSESSMENT_SECTION2.S2Q9_EVIDENCE_OTHER = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_EVIDENCE_OTHER = '1' THEN 'Yes' END AS OTHER_MOTIVATION_, CASE WHEN ASSESSMENT_SECTION2.S2Q10_ALCOHOL = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_ALCOHOL = '1' THEN 'Yes' END AS ALCOHOL_, CASE WHEN ASSESSMENT_SECTION2.S2Q10_EMOTIONAL = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_EMOTIONAL = '1' THEN 'Yes' END AS EMOTIONAL_STATE_, CASE WHEN ASSESSMENT_SECTION2.S2Q10_PORNOGRAPHY = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_PORNOGRAPHY = '1' THEN 'Yes' END AS PORNOGRAPHY_, CASE WHEN ASSESSMENT_SECTION2.S2Q10_DRUGS = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_DRUGS = '1' THEN 'Yes' END AS DRUGS_, CASE WHEN ASSESSMENT_SECTION2.S2Q10_MEDICATION_NON_COMP = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_MEDICATION_NON_COMP = '1' THEN 'Yes' END AS NON_COMPLIANCE_WITH_MEDICATI31, CASE WHEN ASSESSMENT_SECTION2.S2Q10_TRAUMATIC_LIFE_EVENT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_TRAUMATIC_LIFE_EVENT = '1' THEN 'Yes' END AS TRAUMATIC_LIFE_EVENT_, CASE WHEN ASSESSMENT_SECTION2.S2Q10_PSYCHIATRIC_PROBLEMS = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_PSYCHIATRIC_PROBLEMS = '1' THEN 'Yes' END AS PSYCHIATRIC_PROBLEMS_, CASE WHEN ASSESSMENT_SECTION2.S2Q11_RESP_OF_OFFENCE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q11_RESP_OF_OFFENCE = '1' THEN 'Yes' END AS OFFENDER_ACCEPTS_RESPONSIBIL32, CASE WHEN ASSESSMENT_SECTION2.S2Q13_ESCALATION_SERIOUSNESS = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q13_ESCALATION_SERIOUSNESS = '1' THEN 'Yes' END AS OFFENCE_IS_AN_ESCALATION_IN_40, ASSESSMENT_SECTION2.S2Q14_ESTABLISHED_PATTERN, CASE WHEN ASSESSMENT_SECTION2.S2Q14_DISCLOSURE_MISSING = 0 THEN 'Missing' WHEN ASSESSMENT_SECTION2.S2Q14_DISCLOSURE_MISSING = 1 THEN 'Disclosed' END AS DISCLOSURE_MISSING_, CASE WHEN ASSESSMENT_SECTION2.S2_ISSUES_LINKED_TO_RISK = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2_ISSUES_LINKED_TO_RISK = '1' THEN 'Yes' END AS SECTION_2_ISSUES_LINKED_TO_R31, OFFENDER.OFFENDER_ID FROM ASSESSMENT, OFFENDER, REP_OFFENDER_HISTORY, PURPOSE_OF_ASSESSMENT, ASSESSMENT_SECTION2, VICTIM_AGE_RANGE, ASSESSMENT_VICTIM, ETHNIC_GROUP, VICTIM_PERPETRATOR WHERE (PURPOSE_OF_ASSESSMENT.PURPOSE_OF_ASSESSMENT_CODE (+) = ASSESSMENT.PURPOSE_OF_ASSESSMENT_CODE) AND (ASSESSMENT_VICTIM.VICTIM_AGE_RANGE_OPOL_ID = VICTIM_AGE_RANGE.VICTIM_AGE_RANGE_OPOL_ID (+)) AND (VICTIM_PERPETRATOR.VICTIM_PERPETRATOR_OPOL_ID (+) = ASSESSMENT_VICTIM.VICTIM_PERPETRATOR_OPOL_ID) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SECTION2.ASSESSMENT_ID) AND (ASSESSMENT_SECTION2.ASSESSMENT_ID = ASSESSMENT_VICTIM.ASSESSMENT_ID (+)) AND (OFFENDER.OFFENDER_ID = ASSESSMENT.OFFENDER_ID (+)) AND (ASSESSMENT_VICTIM.VICTIM_ETHNIC_GROUP_OPOL_ID = ETHNIC_GROUP.ETHNIC_GROUP_OPOL_ID (+)) AND (OFFENDER.OFFENDER_ID = REP_OFFENDER_HISTORY.OFFENDER_ID (+)) AND (SUBSTR(OFFENDER.OFFENDER_ID_DISPLAY, 1, 10) = TAGMIS_CASELOAD_SECURITY('AQG36H', OFFENDER.OFFENDER_ID_DISPLAY)) AND (ASSESSMENT.ASSESSMENT_ID IN (SELECT LAST_VALUE(ASSESSMENT.assessment_id) OVER (PARTITION BY ASSESSMENT.offender_id ORDER BY ASSESSMENT.date_completed rows BETWEEN CURRENT ROW AND UNBOUNDED following) AS last_ass_for_offender FROM ASSESSMENT, OFFENDER, REP_OFFENDER_HISTORY WHERE (OFFENDER.OFFENDER_ID = ASSESSMENT.OFFENDER_ID (+)) AND (OFFENDER.OFFENDER_ID = REP_OFFENDER_HISTORY.OFFENDER_ID (+)) AND (ASSESSMENT.single_date_completed = 'Y' AND completed_assessment <> 'Abandoned' AND NOT OFFENDER.Offender_id IS NULL) AND (SUBSTR(OFFENDER.OFFENDER_ID_DISPLAY, 1, 10) = TAGMIS_CASELOAD_SECURITY('AQG36H', OFFENDER.OFFENDER_ID_DISPLAY)) AND (COALESCE(ASSESSMENT.COMPLETED_ASSESSMENT, 'Not Specified') = 'True' AND OFFENDER.HISTORIC_OFFENDER_CALC = 'Current' AND (REP_OFFENDER_HISTORY.LATEST_OWNERSHIP_RANK = 1) AND REP_OFFENDER_HISTORY.PHYSICAL_LOCATION = 'Belmarsh (HMP)')) AND (REP_OFFENDER_HISTORY.LATEST_OWNERSHIP_RANK = 1)) GROUP BY ASSESSMENT.DATE_COMPLETED, OFFENDER.OFFENDER_ID_DISPLAY, REP_OFFENDER_HISTORY.CONTROLLING_OWNER, SUBSTR(ASSESSMENT.CALC_HIGHEST_RISK, 4), ASSESSMENT.CALC_MAPPA, REP_OFFENDER_HISTORY.OFFENDER_MANAGER, ASSESSMENT.CALC_PURPOSE_OF_ASSMNT_GROUPS, CASE WHEN OFFENDER.PROLIFIC_OFFENDER = '1' THEN 'Yes' WHEN OFFENDER.PROLIFIC_OFFENDER = '0' THEN 'No' END, COALESCE(PURPOSE_OF_ASSESSMENT.DESCRIPTION, 'Not Specified'), CASE WHEN ASSESSMENT_SECTION2.S2Q2A_CARRY_USE_WEAPON = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2A_CARRY_USE_WEAPON = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q2B_VIOLENCE_THREAT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2B_VIOLENCE_THREAT = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q2C_EXCESSIVE_VIOLENCE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2C_EXCESSIVE_VIOLENCE = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q2D_ARSON = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2D_ARSON = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q2E_PROPERTY_DAMAGE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2E_PROPERTY_DAMAGE = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q2F_SEXUAL_ELEMENT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2F_SEXUAL_ELEMENT = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q3A_DIRECT_VICTIM = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3A_DIRECT_VICTIM = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q3B_RACIAL_HATE_MOTIVATION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3B_RACIAL_HATE_MOTIVATION = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q3C_RESPONSE_TO_VICTIM = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3C_RESPONSE_TO_VICTIM = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q3D_VIOLENCE_TO_PARTNER = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3D_VIOLENCE_TO_PARTNER = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q3E_REPEAT_VICTIMISATION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3E_REPEAT_VICTIMISATION = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q3F_VICTIM_STRANGER = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q3F_VICTIM_STRANGER = '1' THEN 'Yes' END, VICTIM_AGE_RANGE.DESCRIPTION, ASSESSMENT_VICTIM.VICTIM_GENDER_CODE, ETHNIC_GROUP.DESCRIPTION, VICTIM_PERPETRATOR.DESCRIPTION, CASE WHEN ASSESSMENT_SECTION2.S2Q6_OFFENDER_RECOGNISE_IMPACT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q6_OFFENDER_RECOGNISE_IMPACT = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q7_OTHER_OFFENDERS_INVOLVED = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q7_OTHER_OFFENDERS_INVOLVED = '1' THEN 'Yes' END, ASSESSMENT_SECTION2.S2Q7_NUMBER_OF_OFFENDERS, CASE WHEN ASSESSMENT_SECTION2.S2Q7_PEER_GROUP_INFLUENCE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q7_PEER_GROUP_INFLUENCE = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q9_SEXUAL_MOTIVATION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_SEXUAL_MOTIVATION = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q9_FINANCIAL_MOTIVATION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_FINANCIAL_MOTIVATION = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q9_ADDICTION = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_ADDICTION = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q9_EMOTIONAL = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_EMOTIONAL = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q9_RACIAL_HATE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_RACIAL_HATE = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q9_THRILL_SEEKING = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_THRILL_SEEKING = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q9_EVIDENCE_OTHER = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q9_EVIDENCE_OTHER = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q10_ALCOHOL = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_ALCOHOL = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q10_EMOTIONAL = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_EMOTIONAL = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q10_PORNOGRAPHY = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_PORNOGRAPHY = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q10_DRUGS = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_DRUGS = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q10_MEDICATION_NON_COMP = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_MEDICATION_NON_COMP = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q10_TRAUMATIC_LIFE_EVENT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_TRAUMATIC_LIFE_EVENT = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q10_PSYCHIATRIC_PROBLEMS = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q10_PSYCHIATRIC_PROBLEMS = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q11_RESP_OF_OFFENCE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q11_RESP_OF_OFFENCE = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q13_ESCALATION_SERIOUSNESS = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q13_ESCALATION_SERIOUSNESS = '1' THEN 'Yes' END, ASSESSMENT_SECTION2.S2Q14_ESTABLISHED_PATTERN, CASE WHEN ASSESSMENT_SECTION2.S2Q14_DISCLOSURE_MISSING = 0 THEN 'Missing' WHEN ASSESSMENT_SECTION2.S2Q14_DISCLOSURE_MISSING = 1 THEN 'Disclosed' END, CASE WHEN ASSESSMENT_SECTION2.S2_ISSUES_LINKED_TO_RISK = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2_ISSUES_LINKED_TO_RISK = '1' THEN 'Yes' END, OFFENDER.OFFENDER_ID), dataset_ AS (SELECT DATE_COMPLETED, COUNT_OF_OFFENDERS, OFFENDER_ID_DISPLAY, CONTROLLING_OWNER, RISK_LEVEL_, CALC_MAPPA, OFFENDER_MANAGER, CALC_PURPOSE_OF_ASSMNT_GROUPS, PROLIFIC_OFFENDER, PURPOSE_OF_ASSESSMENT, CARRYING_OR_USE_OF_WEAPON_, VIOLENCE_OR_THREAT_OF_VIOLEN31, EXCESSIVE_OR_SADISTIC_VIOLEN31, ARSON_, PHYSICAL_DAMAGE_TO_PROPERTY_, SEXUAL_ELEMENT_, DIRECT_VICTIM_TARGETING_, RACIAL_MOTIVATION_OR_HATRED_, SPECIFIC_VICTIM_REVENGE_, PHYSICAL_VIOLENCE_TO_PARTNER_, REPEAT_VICTIMISATION_OF_PERS31, VICTIM_WAS_A_STRANGER_TO_OFF34, DESCRIPTION, VICTIM_GENDER_CODE, VICTIM_ETHNIC_GROUP, VICTIM_PERPETRATOR_RELATIONS31, OFFENDER_RECOGNISES_IMPACT_, OTHER_OFFENDERS_INVOLVED_, S2Q7_NUMBER_OF_OFFENDERS, PEER_GROUP_INFLUENCE_, SEXUAL_MOTIVATION_, FINANCIAL_MOTIVATION_, ADDICTION_, EMOTIONAL_STATE_, RACIAL_OR_HATRED_, THRILL_SEEKING_, OTHER_MOTIVATION_, ALCOHOL_, EMOTIONAL_STATE_, PORNOGRAPHY_, DRUGS_, NON_COMPLIANCE_WITH_MEDICATI31, TRAUMATIC_LIFE_EVENT_, PSYCHIATRIC_PROBLEMS_, OFFENDER_ACCEPTS_RESPONSIBIL32, OFFENCE_IS_AN_ESCALATION_IN_40, S2Q14_ESTABLISHED_PATTERN, DISCLOSURE_MISSING_, SECTION_2_ISSUES_LINKED_TO_R31, OFFENDER_ID FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "DATE_COMPLETED",
            "type": "date",
            "display": "Date Completed",
            "legacyId": "DP22.DO5e5",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "COUNT_OF_OFFENDERS",
            "type": "double",
            "display": "Count of Offenders",
            "legacyId": "DP22.DOcbd",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP22.DO264",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CONTROLLING_OWNER",
            "type": "string",
            "display": "Controlling Owner",
            "legacyId": "DP22.DO114b",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "RISK_LEVEL_",
            "type": "string",
            "display": "Risk Level (10 6)",
            "legacyId": "DP22.DOf2f",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "CALC_MAPPA",
            "type": "string",
            "display": "MAPPP Level",
            "legacyId": "DP22.DO1000",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "OFFENDER_MANAGER",
            "type": "string",
            "display": "Offender Manager",
            "legacyId": "DP22.DO114a",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "CALC_PURPOSE_OF_ASSMNT_GROUPS",
            "type": "string",
            "display": "Purpose Of Assessment Groups",
            "legacyId": "DP22.DO1006",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "PROLIFIC_OFFENDER",
            "type": "string",
            "display": "Prolific Offender",
            "legacyId": "DP22.DOaab",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "PURPOSE_OF_ASSESSMENT",
            "type": "string",
            "display": "Purpose Of Assessment",
            "legacyId": "DP22.DOa0d",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "CARRYING_OR_USE_OF_WEAPON_",
            "type": "string",
            "display": "Carrying or Use of Weapon (a)",
            "legacyId": "DP22.DOac1",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "VIOLENCE_OR_THREAT_OF_VIOLEN31",
            "type": "string",
            "display": "Violence or Threat of Violence (b)",
            "legacyId": "DP22.DOac3",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "EXCESSIVE_OR_SADISTIC_VIOLEN31",
            "type": "string",
            "display": "Excessive or Sadistic Violence (c)",
            "legacyId": "DP22.DOac4",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "ARSON_",
            "type": "string",
            "display": "Arson (d)",
            "legacyId": "DP22.DOac5",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "PHYSICAL_DAMAGE_TO_PROPERTY_",
            "type": "string",
            "display": "Physical Damage to Property (e)",
            "legacyId": "DP22.DOac6",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "SEXUAL_ELEMENT_",
            "type": "string",
            "display": "Sexual Element (f)",
            "legacyId": "DP22.DOac7",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "DIRECT_VICTIM_TARGETING_",
            "type": "string",
            "display": "Direct Victim Targeting (a)",
            "legacyId": "DP22.DOac8",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "RACIAL_MOTIVATION_OR_HATRED_",
            "type": "string",
            "display": "Racial Motivation or Hatred (b)",
            "legacyId": "DP22.DOac9",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "SPECIFIC_VICTIM_REVENGE_",
            "type": "string",
            "display": "Specific Victim / Revenge (c)",
            "legacyId": "DP22.DOaca",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "PHYSICAL_VIOLENCE_TO_PARTNER_",
            "type": "string",
            "display": "Physical Violence to Partner (d)",
            "legacyId": "DP22.DOacb",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "REPEAT_VICTIMISATION_OF_PERS31",
            "type": "string",
            "display": "Repeat Victimisation of Person (e)",
            "legacyId": "DP22.DOacc",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "VICTIM_WAS_A_STRANGER_TO_OFF34",
            "type": "string",
            "display": "Victim was a Stranger to Offender (f)",
            "legacyId": "DP22.DOacd",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Victim Age Range",
            "legacyId": "DP22.DO84f",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "VICTIM_GENDER_CODE",
            "type": "string",
            "display": "Victim Gender",
            "legacyId": "DP22.DO891",
            "legacySqlClass": "column"
          },
          {
            "index": 24,
            "name": "VICTIM_ETHNIC_GROUP",
            "type": "string",
            "display": "Victim Ethnic Group",
            "legacyId": "DP22.DOd6d",
            "legacySqlClass": "column"
          },
          {
            "index": 25,
            "name": "VICTIM_PERPETRATOR_RELATIONS31",
            "type": "string",
            "display": "Victim Perpetrator Relationship",
            "legacyId": "DP22.DO850",
            "legacySqlClass": "column"
          },
          {
            "index": 26,
            "name": "OFFENDER_RECOGNISES_IMPACT_",
            "type": "string",
            "display": "Offender Recognises Impact (6)",
            "legacyId": "DP22.DOad1",
            "legacySqlClass": "column"
          },
          {
            "index": 27,
            "name": "OTHER_OFFENDERS_INVOLVED_",
            "type": "string",
            "display": "Other Offenders Involved (7)",
            "legacyId": "DP22.DOad2",
            "legacySqlClass": "column"
          },
          {
            "index": 28,
            "name": "S2Q7_NUMBER_OF_OFFENDERS",
            "type": "double",
            "display": "Number Of Others Involved (7)",
            "legacyId": "DP22.DOad3",
            "legacySqlClass": "column"
          },
          {
            "index": 29,
            "name": "PEER_GROUP_INFLUENCE_",
            "type": "string",
            "display": "Peer Group Influence (7)",
            "legacyId": "DP22.DOad4",
            "legacySqlClass": "column"
          },
          {
            "index": 30,
            "name": "SEXUAL_MOTIVATION_",
            "type": "string",
            "display": "Sexual Motivation (a)",
            "legacyId": "DP22.DOad7",
            "legacySqlClass": "column"
          },
          {
            "index": 31,
            "name": "FINANCIAL_MOTIVATION_",
            "type": "string",
            "display": "Financial Motivation (b)",
            "legacyId": "DP22.DOad8",
            "legacySqlClass": "column"
          },
          {
            "index": 32,
            "name": "ADDICTION_",
            "type": "string",
            "display": "Addiction (c)",
            "legacyId": "DP22.DOad9",
            "legacySqlClass": "column"
          },
          {
            "index": 33,
            "name": "EMOTIONAL_STATE_",
            "type": "string",
            "display": "Emotional State (d)",
            "legacyId": "DP22.DOada",
            "legacySqlClass": "column"
          },
          {
            "index": 34,
            "name": "RACIAL_OR_HATRED_",
            "type": "string",
            "display": "Racial or Hatred (e)",
            "legacyId": "DP22.DOadb",
            "legacySqlClass": "column"
          },
          {
            "index": 35,
            "name": "THRILL_SEEKING_",
            "type": "string",
            "display": "Thrill Seeking (f)",
            "legacyId": "DP22.DOadc",
            "legacySqlClass": "column"
          },
          {
            "index": 36,
            "name": "OTHER_MOTIVATION_",
            "type": "string",
            "display": "Other Motivation (g)",
            "legacyId": "DP22.DOadd",
            "legacySqlClass": "column"
          },
          {
            "index": 37,
            "name": "ALCOHOL_",
            "type": "string",
            "display": "Alcohol (a)",
            "legacyId": "DP22.DOae0",
            "legacySqlClass": "column"
          },
          {
            "index": 38,
            "name": "EMOTIONAL_STATE_",
            "type": "string",
            "display": "Emotional State (b)",
            "legacyId": "DP22.DOae1",
            "legacySqlClass": "column"
          },
          {
            "index": 39,
            "name": "PORNOGRAPHY_",
            "type": "string",
            "display": "Pornography (c)",
            "legacyId": "DP22.DOae2",
            "legacySqlClass": "column"
          },
          {
            "index": 40,
            "name": "DRUGS_",
            "type": "string",
            "display": "Drugs (d)",
            "legacyId": "DP22.DOae3",
            "legacySqlClass": "column"
          },
          {
            "index": 41,
            "name": "NON_COMPLIANCE_WITH_MEDICATI31",
            "type": "string",
            "display": "Non Compliance with Medication (e)",
            "legacyId": "DP22.DOae4",
            "legacySqlClass": "column"
          },
          {
            "index": 42,
            "name": "TRAUMATIC_LIFE_EVENT_",
            "type": "string",
            "display": "Traumatic Life Event (f)",
            "legacyId": "DP22.DOae5",
            "legacySqlClass": "column"
          },
          {
            "index": 43,
            "name": "PSYCHIATRIC_PROBLEMS_",
            "type": "string",
            "display": "Psychiatric Problems (g)",
            "legacyId": "DP22.DOae6",
            "legacySqlClass": "column"
          },
          {
            "index": 44,
            "name": "OFFENDER_ACCEPTS_RESPONSIBIL32",
            "type": "string",
            "display": "Offender Accepts Responsibility (11)",
            "legacyId": "DP22.DOae7",
            "legacySqlClass": "column"
          },
          {
            "index": 45,
            "name": "OFFENCE_IS_AN_ESCALATION_IN_40",
            "type": "string",
            "display": "Offence is an Escalation in Seriousness (13)",
            "legacyId": "DP22.DOaea",
            "legacySqlClass": "column"
          },
          {
            "index": 46,
            "name": "S2Q14_ESTABLISHED_PATTERN",
            "type": "double",
            "display": "Offence Part of Established Pattern (14)",
            "legacyId": "DP22.DOaeb",
            "legacySqlClass": "column"
          },
          {
            "index": 47,
            "name": "DISCLOSURE_MISSING_",
            "type": "string",
            "display": "Disclosure Missing (14)",
            "legacyId": "DP22.DOaec",
            "legacySqlClass": "column"
          },
          {
            "index": 48,
            "name": "SECTION_2_ISSUES_LINKED_TO_R31",
            "type": "string",
            "display": "Section 2 Issues Linked To Risk",
            "legacyId": "DP22.DOaee",
            "legacySqlClass": "column"
          },
          {
            "index": 49,
            "name": "OFFENDER_ID",
            "type": "double",
            "display": "Offender Id",
            "legacyId": "DP22.DOa89",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP24",
      "name": "MIS Load",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP24.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP25",
      "name": "Demog",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS OTHER_CONTACT_NAME FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS, BODIMIS.DIM_CELL AT_CELL WHERE (AT_CELL.ESTABLISHMENT_SK = AT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_ESTABLISHMENT.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP = 'Offender Supervisor' AND (DT_OFFENDER_CONTACT_ADDRESS.ROW_SEQ_FILTER (+) = 1) AND (DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG (+) = 'Y') AND (AT_OFFENDER_BOOKING.BOOKING_SEQ = 1))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OTHER_CONTACT_NAME FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP25.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OTHER_CONTACT_NAME",
            "type": "string",
            "display": "Other Contact Name",
            "legacyId": "DP25.DOa1b",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "135135.RS",
      "name": "Report description",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_DESCRIPTION",
            "display": "Establishment Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10129"
          }
        ]
      }
    },
    {
      "id": "130164.RS",
      "name": "Offender Listing",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:CURRENT_SENTENCE_LENGTH_BAND",
            "display": "Current Sentence Length Band",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO1ef"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100de"
          },
          {
            "name": "$ref:V_DATE_COMPLETED_MGE",
            "display": "Latest OASys",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Date Completed]"
          },
          {
            "name": "$ref:V_PURPOSE_OF_ASSESSMENT_GROUP",
            "display": "Assessment Type",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Purpose Of Assessment Groups]"
          },
          {
            "name": "$ref:V_PURPOSE_OF_ASSESSMENT",
            "display": "Purpose of Assessment",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Purpose Of Assessment]"
          },
          {
            "name": "$ref:V_RISK_LEVEL_MGE",
            "display": "Risk Level",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Risk Level (10 6)]"
          },
          {
            "name": "$ref:V_NPS_OR_HMPS_MGE",
            "display": "Owner",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v Controlling Owner NPS, CRC or HMPS]"
          },
          {
            "name": "$ref:V_OASYS_OFF_MANAGER_MGE",
            "display": "Offender Mgr",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offender Manager]"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE",
            "display": "Supervising Officer",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Other Contact Name]"
          },
          {
            "name": "$ref:V_ADMISSION_DATE_MGE",
            "display": "Admission Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Admission Date]"
          },
          {
            "name": "$ref:SSD",
            "display": "Current Sentence Start Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO32d"
          },
          {
            "name": "$ref:OASYS_POST_ADMISSION",
            "display": "OASys Post Admission",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_latest_assessment_after_sentence]>=[v_Admission Date mge];\"Y\";\"N\")"
          },
          {
            "name": "$ref:OASYS_POST_SENTENCE",
            "display": "OASys Post Sentence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_latest_assessment_after_sentence]);\"N\";\"Y\")"
          },
          {
            "name": "$ref:CURR_RELEASE_DATE",
            "display": "Current Release Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO2e6"
          },
          {
            "name": "$ref:CURRENT_SECURITY_CATEGORY",
            "display": "Current Security Category",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100e1"
          },
          {
            "name": "$ref:V_CARRY_USE_WEAPON",
            "display": "2.2a Carry or Use Weapon",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Carrying or Use of Weapon (a)]"
          },
          {
            "name": "$ref:V_VIOLENCE_USED",
            "display": "2.2b Violence or Threat Used",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Violence or Threat of Violence (b)]"
          },
          {
            "name": "$ref:V_EXCESSIVE_SADISTIC_VIOLENCE",
            "display": "2.2c Excessive or Sadistic Violence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Excessive or Sadistic Violence (c)]"
          },
          {
            "name": "$ref:V_ARSON",
            "display": "2.2d Arson",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Arson (d)]"
          },
          {
            "name": "$ref:V_PROPERTY_DAMAGE",
            "display": "2.2e Property Damage",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Physical Damage to Property (e)]"
          },
          {
            "name": "$ref:V_SEXUAL_ELEMENT",
            "display": "2.2f Sexual Element",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Sexual Element (f)]"
          },
          {
            "name": "$ref:V_DIRECT_VICTIMS",
            "display": "2.3a Direct Victim(s)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Direct Victim Targeting (a)]"
          },
          {
            "name": "$ref:V_RACIAL_MOTIVATION_OR_HATRED",
            "display": "2.3b Racial Motivation or Hatred",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Racial Motivation or Hatred (b)]"
          },
          {
            "name": "$ref:V_SPECIFIC_VICTIM_REVENGE",
            "display": "2.3c Specific Victim/Revenge",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Specific Victim / Revenge (c)]"
          },
          {
            "name": "$ref:V_VIOLENCE_TO_PARTNER",
            "display": "2.3d Violence to Partner",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Physical Violence to Partner (d)]"
          },
          {
            "name": "$ref:V_REPEAT_VICTIMISATION",
            "display": "2.3e Repeat Victimisation",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Repeat Victimisation of Person (e)]"
          },
          {
            "name": "$ref:V_VICTIM_STRANGER",
            "display": "2.3f Victim was Stranger",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Victim was a Stranger to Offender (f)]"
          },
          {
            "name": "$ref:V_VICTIM_AGE_RANGE",
            "display": "2.4a Victim Age Range",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Victim Age Range]"
          },
          {
            "name": "$ref:V_VICTIM_GENDER",
            "display": "2.4b Victim Gender",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Victim Gender]"
          },
          {
            "name": "$ref:V_VICTIM_ETHNIC_GROUP",
            "display": "2.4c Victim Ethnic Group",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Victim Ethnic Group]"
          },
          {
            "name": "$ref:V_VICTIM_PERPETRATOR_RELATIO33",
            "display": "2.4d Victim Perpetrator Relationship",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Victim Perpetrator Relationship]"
          },
          {
            "name": "$ref:V_RECOGNISES_IMPACT",
            "display": "2.6 Recognises Impact",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offender Recognises Impact (6)]"
          },
          {
            "name": "$ref:V_OTHER_OFFENDERS_INVOLVED",
            "display": "2.7a Other Offenders Involved",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Other Offenders Involved (7)]"
          },
          {
            "name": "$ref:V_NUM_OF_OTHERS_INVOLVED",
            "display": "Num of Others Involved",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Number Of Others Involved (7)]"
          },
          {
            "name": "$ref:V_PEER_GROUP_INFLUENCE",
            "display": "2.7b Peer Group Influence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Peer Group Influence (7)]"
          },
          {
            "name": "$ref:V_SEXUAL_MOTIVATION",
            "display": "2.9a Sexual Motivation",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Sexual Motivation (a)]"
          },
          {
            "name": "$ref:V_FINANCIAL_MOTIVATION",
            "display": "2.9b Financial Motivation",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Financial Motivation (b)]"
          },
          {
            "name": "$ref:V_ADDICTIONS_PERCEIVED_NEEDS",
            "display": "2.9c Addictions/Perceived Needs",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Addiction (c)]"
          },
          {
            "name": "$ref:V_EMOTIONAL_STATE_OF_OFFENDER",
            "display": "2.9d Emotional State of Offender",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Emotional State (d)]"
          },
          {
            "name": "$ref:V_RACIAL_OR_HATRED_MOTIVATION",
            "display": "2.9e Racial or Hatred Motivation",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Racial or Hatred (e)]"
          },
          {
            "name": "$ref:V_THRILL_SEEKING",
            "display": "2.9f Thrill Seeking",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Thrill Seeking (f)]"
          },
          {
            "name": "$ref:V_OTHER_MOTIVATION",
            "display": "2.9g Other Motivation",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Other Motivation (g)]"
          },
          {
            "name": "$ref:V_ALCOHOL",
            "display": "2.10a Alcohol Disinhibitor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alcohol (a)]"
          },
          {
            "name": "$ref:V_PORNOGRAPHY",
            "display": "2.10b Pornography Disinhibitor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Pornography (c)]"
          },
          {
            "name": "$ref:V_MEDICATION",
            "display": "2.10c Medication Non Compliance",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Non Compliance with Medication (e)]"
          },
          {
            "name": "$ref:V_PSYCHIATRIC_PROBLEMS",
            "display": "2.10d Psychiatric Problems",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Psychiatric Problems (g)]"
          },
          {
            "name": "$ref:V_EMOTIONAL_STATE",
            "display": "2.10e Emotional State",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Emotional State (b)]"
          },
          {
            "name": "$ref:V_DRUGS",
            "display": "2.10f Drugs Disinhibitor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Drugs (d)]"
          },
          {
            "name": "$ref:V_TRAUMATIC_EVENT",
            "display": "2.10g Traumatic Event",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Traumatic Life Event (f)]"
          },
          {
            "name": "$ref:V_ACCEPTS_RESPONSIBILITY",
            "display": "2.11 Accepts Responsibility",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offender Accepts Responsibility (11)]"
          },
          {
            "name": "$ref:V_ESCALATION_IN_SERIOUSNESS",
            "display": "2.13 Escalation in Seriousness",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offence is an Escalation in Seriousness (13)]"
          },
          {
            "name": "$ref:V_PART_OF_PATTERN",
            "display": "2.14a Part of Established Pattern",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_Part_of_Established_Pattern]"
          },
          {
            "name": "$ref:V_DISCLOSED",
            "display": "2.14b Disclosed",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Disclosure Missing (14)]"
          },
          {
            "name": "$ref:V_SECTION2_ISSUES_LINKED_TO_32",
            "display": "Section 2 Issues Linked to Risk",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Section 2 Issues Linked To Risk]"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10080"
          },
          {
            "name": "$ref:OFFENCE_SEVERITY_RANKING",
            "display": "Offence Severity Ranking",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO4e"
          },
          {
            "name": "$ref:V_MOST_SERIOUS_OFFENCE_MATCH",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If [Offence Severity Ranking] = [v_lowest_severity_no] \nAnd \n[Offender Charge Id Nk] = [v_highest_charge_id] \nAnd\n[Main Offence Flag] = [v_main_offence]\nThen 1"
          },
          {
            "name": "$ref:MOST_SERIOUS_FLAG",
            "display": "Main Offence Flag",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO4f"
          },
          {
            "name": "$ref:PNC_ID",
            "display": "PNC ID",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100db"
          },
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10076"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10085"
          }
        ]
      }
    },
    {
      "id": "137131.RS",
      "name": "OASys Summary",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      },
      "dataset": "MISSING"
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_DATE_COMPLETED_MGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_PURPOSE_OF_ASSESSMENT_GROUP :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_PURPOSE_OF_ASSESSMENT :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_OASYS_OFF_MANAGER_MGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_OTHER_CONTACT_NAME_MGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_VICTIM_AGE_RANGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_VICTIM_GENDER :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_VICTIM_ETHNIC_GROUP :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MOST_SERIOUS_OFFENCE_MATCH :: Error: =If [Offence Severity Ranking] = [v_lowest_severity_no] \nAnd \n[Offender Charge Id Nk] = [v_highest_charge_id] \nAnd\n[Main Offence Flag] = [v_main_offence]\nThen 1 ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DATE_COMPLETED_MGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_PURPOSE_OF_ASSESSMENT :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RISK_LEVEL_MGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OASYS_OFF_MANAGER_MGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OTHER_CONTACT_NAME_MGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_CARRY_USE_WEAPON :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_VIOLENCE_USED :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_EXCESSIVE_SADISTIC_VIOLENCE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_ARSON :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_PROPERTY_DAMAGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_SEXUAL_ELEMENT :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DIRECT_VICTIMS :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RACIAL_MOTIVATION_OR_HATRED :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_SPECIFIC_VICTIM_REVENGE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_VIOLENCE_TO_PARTNER :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_REPEAT_VICTIMISATION :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_VICTIM_STRANGER :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_VICTIM_ETHNIC_GROUP :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_VICTIM_PERPETRATOR_RELATIO33 :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RECOGNISES_IMPACT :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OTHER_OFFENDERS_INVOLVED :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_PEER_GROUP_INFLUENCE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_SEXUAL_MOTIVATION :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_FINANCIAL_MOTIVATION :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_ADDICTIONS_PERCEIVED_NEEDS :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_EMOTIONAL_STATE_OF_OFFENDER :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RACIAL_OR_HATRED_MOTIVATION :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_THRILL_SEEKING :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OTHER_MOTIVATION :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_ALCOHOL :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_PORNOGRAPHY :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MEDICATION :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_PSYCHIATRIC_PROBLEMS :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_EMOTIONAL_STATE :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DRUGS :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_TRAUMATIC_EVENT :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_ACCEPTS_RESPONSIBILITY :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_ESCALATION_IN_SERIOUSNESS :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DISCLOSED :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_SECTION2_ISSUES_LINKED_TO_32 :: ReferenceError: error is not defined",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MOST_SERIOUS_OFFENCE_MATCH :: Error: =If [Offence Severity Ranking] = [v_lowest_severity_no] \nAnd \n[Offender Charge Id Nk] = [v_highest_charge_id] \nAnd\n[Main Offence Flag] = [v_main_offence]\nThen 1 ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[2] requires property \"dataset\"",
      "entityId": "FrFpeV.VcQYA11IBAHCLBV8KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report Variant 137131.RS does not have corresponding dataset undefined",
      "entityId": "137131.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP4",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375896/DP22",
      "entityType": "dataset"
    }
  ]
}