{
  "id": "FtPH6Vo_Vg0A12gAAHDrTV8AACJIAFJ8",
  "name": "MIS Prisoners Sentenced on Current or Past Bookings",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "SEN0039"
    ]
  },
  "description": "<br/>This report shows all prisoners at an establishment who either have an active sentence on a current booking or were sentenced on a previous booking. The report contains input controls which allows the user to only show prisoners of a certain nationality.<br/><br/>This report is designed to assist establishments submit ex-FNO figures to ministers. <br/>SEN0039 v1.0 Last Modified: 18/05/2018",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP2",
      "name": "Estab Prisoners A-L",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.BOOKING_NUMBER, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION IN ('British', 'Afghan', 'Albanian', 'Algerian', 'American', 'American Samoan', 'Angolan', 'Anguillan', 'Antiguan, Barbudan', 'Argentine', 'Armenian', 'Aruban', 'Australian', 'Austrian', 'Azerbaijani', 'Bahamian', 'Bahraini', 'Bangladeshi', 'Barbadian or Bajuns', 'Basotho', 'Belarusian', 'Belgian', 'Belizean', 'Beninese', 'Bermudian', 'Bhutanese', 'Bolivian', 'Bosnian, Herzegovinian', 'Brazilian', 'Bruneian', 'Bulgarian', 'Burkinabe', 'Burmese', 'Burundian', 'Cambodian', 'Cameroonian', 'Canadian', 'Cape Verdian', 'Caymanian', 'Central African', 'Chadian', 'Chilean', 'Chinese', 'Christmas Island', 'Cocos Islander', 'Colombian', 'Comoran', 'Congolese', 'Congolese (Congo, Democratic Republic)', 'Congolese (Congo, Republic of)', 'Costa Rican', 'Croat', 'Cuban', 'Cypriot', 'Czech', 'Danish', 'Djibouti', 'Dominican', 'Dutch', 'Dutch Antillean', 'East Timorese', 'Ecuadorian', 'Egyptian', 'Emirian', 'Equatoguinean', 'Eritrean', 'Estonian', 'Ethiopian', 'Fijian', 'Filipino', 'Finnish', 'French', 'French Guyanese', 'French Polynesian', 'Gabonese', 'Gambian', 'Georgian', 'German', 'Ghanaian', 'Gibraltar', 'Greek', 'Grenadian', 'Guadeloupe', 'Guamanian', 'Guatemalan', 'Guinean', 'Guyanese', 'Haitian', 'Honduran', 'Hungarian', 'I-Kiribati', 'Icelandic', 'Indian', 'Indonesian', 'Iranian', 'Iraqi', 'Irish', 'Israeli', 'Italian', 'Ivorian', 'Jamaican', 'Japanese', 'Jordanian', 'Kazakhstani', 'Kenyan', 'Kittitian or Nevisian', 'Kosovan', 'Kuwaiti', 'Kyrgyzstani', 'Laotian', 'Latvian', 'Lebanese', 'Liberian', 'Libyan', 'Lithuanian', 'Luxembourger'))), dataset_ AS (SELECT SURNAME, BOOKING_NUMBER, OFFENDER_ID_DISPLAY, UNIT_4_SHORT_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP2.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP2.DO10077",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP2.DO10a7c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPa",
      "name": "Estab Prisoners M-Z",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.BOOKING_NUMBER, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION IN ('Macedonian', 'Malagasy', 'Malawian', 'Malaysian', 'Maldivian', 'Malian', 'Maltese', 'Martiniquais', 'Mauritanian', 'Mauritian', 'Mexican', 'Micronesian', 'Moldovan', 'Monacan', 'Mongolian', 'Montenegrin', 'Montserratian', 'Moroccan', 'Motswana', 'Mozambican', 'Namibian', 'Nepalese', 'New Caledonian', 'New Zealander', 'Nicaraguan', 'Nigerian', 'Nigerien', 'North Korean', 'Norwegian', 'Omani', 'Pakistani', 'Palauan', 'Palestinian', 'Panamanian', 'Papua New Guinean', 'Paraguayan', 'Peruvian', 'Polish', 'Portuguese', 'Puerto Rican', 'Qatari', 'Refused', 'Reunionese', 'Romanian', 'Russian', 'Rwandan', 'Sahrawi', 'Saint Helenian', 'Saint Lucian', 'Salvadoran', 'Samoan', 'San Marinese', 'Sao Tomean', 'Saudi Arabian', 'Senegalese', 'Serb or Croat', 'Seychellois', 'Sierra Leonean', 'Singaporean', 'Slovak', 'Slovene', 'Solomon Islander', 'Somalian', 'South African', 'South Korean', 'Spaniard', 'Sri Lankan', 'Stateless', 'Sudanese', 'Surinamer', 'Swazi', 'Swede', 'Swiss', 'Syrian', 'Taiwanese', 'Tajikistani', 'Tanzanian', 'Thai', 'Togolese', 'Tongan', 'Trinidadian, Tobagonian', 'Tunisian', 'Turk', 'Turkmen', 'Tuvaluan', 'Ugandan', 'Ukrainian', 'Unknown', 'Uruguayan', 'Uzbekistani', 'Venezuelan', 'Vietnamese', 'Vincentian', 'Virgin Islander', 'Yemenite', 'Zambian', 'Zimbabwean'))), dataset_ AS (SELECT SURNAME, BOOKING_NUMBER, OFFENDER_ID_DISPLAY, UNIT_4_SHORT_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DPa.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DPa.DO10077",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPa.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DPa.DO10a7c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP3",
      "name": "MIS Load Date",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP3.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP8",
      "name": "Nat - A-L",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.BOOKING_NUMBER, AT_OFFENDER_BOOKING_BAH.FIRST_NAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_OFFENDER_BOOKING.HO_REF, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, CASE WHEN DT_LIFEFLAG.life_sentence_flag = 'Y' THEN 'Life' WHEN DT_LIFEFLAG.life_sentence_flag IS NULL THEN CASE WHEN TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) IS NULL THEN NULL ELSE TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) || '  ' END || CASE WHEN TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) IS NULL THEN NULL ELSE TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) || '  ' END || CASE WHEN TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 7, 2)) IS NULL THEN NULL ELSE TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 7, 2)) || '  ' END ELSE '' END AS SENTENCE_LENGTH_FORMATTED_NO34 FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.DIM_DATE AT_DOB, (SELECT BODIMIS.FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK, BODIMIS.FACT_OFFENDER_SENTENCE.EFFECTIVE_SENTENCE_LENGTH FROM BODIMIS.FACT_OFFENDER_SENTENCE WHERE (BODIMIS.FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y')) DT_CURREFFSENLEN, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURREFFSENLEN.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A2022DF', 'A2559AM', 'A6906CE', 'A5350DG', 'A5485AC', 'A1501DG', 'A5927AK', 'A1297AW', 'A9531AJ', 'A5810AJ', 'A0201CE', 'A4666AV', 'A4679AA', 'A6406AX', 'A7437DL', 'A4980CH', 'A7071AY', 'A3948CR', 'A7667DQ', 'A7933CF', 'A1006AY', 'A4821CE', 'A7524CT', 'A5548AK', 'A1289AQ', 'A6503AM', 'A8668DT', 'A0455AG', 'A1723CK', 'A2008DT', 'A5723DR', 'A0033AR', 'A1869EA', 'A4549DT', 'A5226DT', 'A6179AM', 'A4850CX', 'A5429DX', 'A6448AV', 'A9326AQ', 'A9676AC', 'A4759AK', 'A8446AL', 'A3029AD', 'A0687AX', 'A0328DP', 'A3517AG', 'A7673CF', 'A2042DE', 'A3171AW', 'A8004DJ', 'A7836AT', 'A6068DZ', 'A0796AE', 'A3277DQ', 'A2574AG', 'A2131EA', 'A1373DY', 'A3638AD', 'A2437AV', 'A1042DX', 'A7691DY', 'A5871AD', 'A1985DX', 'A1525EA', 'A1659DA', 'A1004DZ', 'A4184AE', 'A5584CW', 'A0538AQ', 'A1592EA', 'A0074DQ', 'A1298AK', 'A3976AE', 'A2998CL', 'A1854AP', 'A9671CE', 'A1875DN', 'A2682CC', 'A8607AV', 'A0805AM', 'A3588CM', 'A9428AG', 'A2344EA', 'A6104AD', 'A4135AA', 'A2503DZ', 'A1929DA', 'A9379AQ', 'A5250DJ', 'A2297EA', 'A3900EC', 'A6371EA', 'A2127DT', 'A3319DV', 'A3013CA', 'A4751DQ', 'A1536DY', 'A4435AM', 'A7553CE', 'A7610AN', 'A6935DC', 'A1733DN', 'A5368CR', 'A5189DX', 'A5536EA', 'A4886CF', 'A9117ED', 'A7497AG', 'A1772CK', 'A6857EA', 'A5918DX', 'A3091CD', 'A6887DA', 'A1034DE', 'A7306AP', 'A6189EE', 'A2957DZ', 'A9332DY', 'A6306DX', 'A8623AJ', 'A3098CL', 'A5190AA', 'A5263DA', 'A5404AJ', 'A4074DM', 'A7966CC', 'A2524DT', 'A9512AQ', 'A5484AC', 'A2230DN', 'A4305CR', 'A4611DW', 'A6978DY', 'A3941EA', 'A7170AV', 'A1465DE', 'A0223CE', 'A8170EA', 'A1085CN', 'A2535DC', 'A0065EA', 'A9888AP', 'A6339DA', 'A1572DK', 'A3647CP', 'A6156DR', 'A5978DX', 'A0007EC', 'A2100DN', 'A0558ED', 'A7523DV', 'A6076DZ', 'A6067EA', 'A9222DD', 'A8952DY', 'A5907AK', 'A4801AQ', 'A5280CT', 'A5021DQ', 'A8735AH', 'A4613DQ', 'A6720DN', 'A8578CH', 'A7526DV', 'A0250DC', 'A5203CV', 'A4385AE', 'A8210CD', 'A0777DY', 'A6842DZ', 'A6299AR', 'A1233DA', 'A0508DT', 'A6902AG', 'A4795CW', 'A8891CL', 'A5813DL', 'A4064DZ', 'A7693AK', 'A4001CZ', 'A1501AV', 'A5431DX', 'A1421DE', 'A7416DN', 'A3976AQ', 'A4166CK', 'A2092EC', 'A2932EC', 'A9410CG', 'A8804AQ', 'A9726AQ', 'A0492ED', 'A1586DY', 'A1106DZ', 'A5786CF', 'A9896CX', 'A7221DJ', 'A1155DF', 'A2129CF', 'A0103AR', 'A7348CP', 'A7374AC', 'A6002DF', 'A9178DR', 'A8410DT', 'A6454AV', 'A4142CH', 'A9731DY', 'A1454DX', 'A2974EA', 'A3402AM', 'A7206DZ', 'A5231DW', 'A6791AD', 'A6539DX', 'A2072DD', 'A5670DM', 'A4326DQ', 'A4204AD', 'A9848AQ', 'A9395DR', 'A6289DL', 'A7990AG', 'A0729DW', 'A6845DF', 'A9594AQ', 'A7298DW', 'A9874AQ', 'A9197AK', 'A4702CP', 'A7519AJ', 'A6529DN', 'A3928DR', 'A7149AR', 'A4752DX', 'A1122CZ', 'A0564DG', 'A8149EA', 'A6853ED', 'A2883CY', 'A7933ED', 'A9945EA', 'A1787AD', 'A4639DV', 'A3330EA', 'A1413CN', 'A9236CD', 'A0505AR', 'A3703EE', 'A3706EE', 'A7081DR', 'A4531CE', 'A4829EA', 'A1821AW', 'A7077CE', 'A9751AE', 'A1896DL', 'A5103CR', 'A9619AK', 'A9965DE', 'A4980DN', 'A9793DL', 'A4680CL', 'A7640DN', 'A1559CK', 'A3371DZ', 'A1437DZ', 'A3357AW', 'A6001DZ', 'A4951AK', 'A5240DZ', 'A7722AH', 'A5262CK', 'A6916CV', 'A7079DM', 'A5770DV', 'A6077DV', 'A9388DT', 'A4421DV', 'A0594DA', 'A8255DH', 'A7512AL', 'A7539DE', 'A0232DA', 'A9547EA', 'A8934CD', 'A1933AY', 'A5615AQ', 'A4017CX', 'A1178CA', 'A5101CA', 'A6109AE', 'A9650AQ', 'A1035AX', 'A3319DZ', 'A7925DY', 'A0138EC', 'A7181ED', 'A4040ED', 'A8741DW', 'A1237EC', 'A2838CZ', 'A1960AX', 'A0483AN', 'A3270AT', 'A7031CQ', 'A8029CW', 'A5767DV', 'A8969CG', 'A6418DR', 'A9796DL', 'A9401CG', 'A5342AC', 'A2198AM', 'A4647EA', 'A7100DZ', 'A2296DZ', 'A5885DK', 'A1337DG', 'A1280AP', 'A5742DV', 'A4172CG', 'A1511AM', 'A7330DW', 'A6211EA', 'A6992ED', 'A6148EC', 'A0089DL', 'A0011CW', 'A3668AD', 'A1434DY', 'A4159AA', 'A5602DX', 'A2798DL', 'A3642DL', 'A1271DZ', 'A0764DJ', 'A6161AM', 'A5069DC', 'A0985CE', 'A1277AM', 'A4084DA', 'A4522DN', 'A2220EC', 'A6007EC', 'A6367DN', 'A2846AW', 'A4231AE', 'A8991AK', 'A6414DP', 'A1109DZ', 'A1746DF', 'A8002AR', 'A0802DN', 'A8507DH', 'A1575DJ', 'A3096DZ', 'A1576AL', 'A1935CE', 'A3741CT', 'A2992CF', 'A5061DH', 'A8253DX', 'A4976DP', 'A0737DM', 'A5803DN', 'A8741DY', 'A1733DY', 'A5768DV', 'A2651DQ', 'A2830ED', 'A8304DZ', 'A1943DJ', 'A2605DZ', 'A1074CG', 'A5030DP', 'A7423CN', 'A5940ED', 'A9774DZ', 'A5130DZ', 'A6429CP', 'A7172AN', 'A7726AN', 'A5849DV', 'A1997DJ', 'A4805DV', 'A3276ED', 'A8881DY', 'A6159DM', 'A1263DM', 'A5033DY', 'A9961DD', 'A8583ED', 'A5635CN', 'A4066EE', 'A2295DZ', 'A3621AQ', 'A2754DP', 'A6531AK', 'A4422DZ', 'A9799DL', 'A5548AL', 'A5033DG', 'A1864DW', 'A9400CK', 'A7715DY', 'A3283DL', 'A9607AQ', 'A6181ED', 'A4225CP', 'A5360DY', 'A3733EE', 'A6170ED', 'A0449EC', 'A6676AH', 'A0450AZ', 'A2058AL', 'A5010EC', 'A5689DV', 'A9640CH', 'A8030AQ', 'A9558DW', 'A2461CP', 'A6223DZ', 'A4382EE', 'A3554DK', 'A3423EA', 'A9243DY', 'A4537CA', 'A1846EC', 'A8918EA', 'A4965AJ', 'A4714AA', 'A5891DP', 'A6971EA', 'A7344DR', 'A4186DZ', 'A9187AV', 'A6548DX', 'A7315CD', 'A2459AY', 'A9313DP', 'A2487DP', 'A1629DX', 'A6163EE', 'A6850CM', 'A9631CX', 'A5302EA', 'A2562CD', 'A2983EA', 'A2076CQ', 'A9216DW', 'A8180AW', 'A3523AM', 'A3018DZ', 'A6429ED', 'A3014CX', 'A4308AD', 'A0855ED', 'A3834AL', 'A8554ED', 'A7330AT', 'A6216DG', 'A6354EC', 'A6482EC', 'A7667AV', 'A9743DG', 'A6798EA', 'A8287CE', 'A5819ED', 'A5387EC', 'A1384AK', 'A7013EE', 'A9969AQ', 'A8291DJ', 'A6291ED', 'A9368ED', 'A7716EC', 'A7715EC', 'A3787DZ', 'A7159DR', 'A3881EC', 'A4469EC', 'A3172DX', 'A5686DV', 'A5480AK', 'A3173DJ', 'A0137CQ', 'A3397DM', 'A7599AT', 'A0961DK', 'A7115DX', 'A1650DH', 'A6759DA', 'A1238CX', 'A3366EC', 'A7651CF', 'A3139AC', 'A8165EA', 'A1691EC', 'A5537ED', 'A5284AF', 'A7019ED', 'A6907EE', 'A9433AF', 'A9019EA', 'A0531EA', 'A7736DX', 'A6796AZ', 'A5760AA', 'A6340ED', 'A7299ED', 'A7300ED', 'A9632ED', 'A5857AN', 'A0269EC', 'A4500EE', 'A2128EA', 'A5056DY', 'A9241ED', 'A4379ED', 'A6589CV', 'A5371DD', 'A6954EE', 'A3666EC', 'A0873AD', 'A5415DX', 'A7026ED', 'A6947CW', 'A2313DG', 'A1423AK', 'A9653AQ', 'A2972AM', 'A3810DQ', 'A5715DQ', 'A7248EE', 'A2625ED', 'A6503EE', 'A9555DJ', 'A4155DX', 'A1381ED', 'A1484DC', 'A4038EA', 'A2983DG', 'A6152DL', 'A5095ED', 'A6359EE', 'A1356ED', 'A3941ED', 'A2582DV', 'A8385CK', 'A9122DX', 'A1934ED', 'A8643DX', 'A2895ED', 'A3343ED', 'A3896ED', 'A7584DF', 'A5148CN', 'A2797ED', 'A6486EE', 'A3944ED', 'A3943ED', 'A6254EE', 'A9673AQ', 'A6485EE', 'A5835ED', 'A3516ED', 'A4831CN', 'A6924ED', 'A2793ED', 'A0070DY', 'A0385DX', 'A6502EE', 'A6537EE', 'A4619ED', 'A1636DA', 'A2263CP', 'A6920ED', 'A7221EE', 'A7765CW', 'A6843CP', 'A3141ED', 'A3150ED', 'A3771AP', 'A2300EA', 'A1190ED', 'A7090AX', 'A1847ED', 'A2583AD', 'A6763CF', 'A2309CY', 'A8612AY', 'A4467EC', 'A7608AD', 'A4533DZ', 'A6959AX', 'A4366EE', 'A5517CK', 'A7874DG', 'A0046CM', 'A4304EA', 'A7951ED', 'A7969ED', 'A2174CT', 'A3185EE', 'A4379EE', 'A8342ED', 'A1429CV', 'A2054ED', 'A5002ED', 'A4328EE', 'A8343ED', 'A2774AM', 'A7616ED', 'A4426DZ', 'A6366ED', 'A3064CX', 'A7938ED', 'A7963ED', 'A7131EE', 'A6278DW', 'A5113DV', 'A1771EE', 'A0460DT', 'A4546EE', 'A5985AL', 'A4391AT', 'A8984EA', 'A1490CA', 'A2100EE', 'A7312EC', 'A0240AR', 'A4372EA', 'A6034AL', 'A4863EE', 'A8533ED', 'A6413DT', 'A3776EE', 'A4539EE', 'A7074AY', 'A2032EE', 'A6329DN', 'A4395AW', 'A7088DT', 'A6567DE', 'A3957EC', 'A4332DQ', 'A7061DK', 'A2643EE', 'A2145EC', 'A9888AQ', 'A9417ED', 'A9032EC', 'A0099AP', 'A3944EE', 'A5430EE', 'A1268AT', 'A5575EE', 'A8322CW', 'A9117CV', 'A2662EE', 'A3973EE', 'A0287EE', 'A4569AY', 'A4089EE', 'A2167CD', 'A5189ED', 'A5936EE', 'A3977AT', 'A6019EE', 'A8786CW', 'A7254ED', 'A4064AD', 'A0480EA', 'A2250EE', 'A5979EE', 'A3505EA', 'A8283ED', 'A5311EC', 'A6105AL', 'A3142CR', 'A8581ED', 'A2238EE', 'A2307EE', 'A2340EE', 'A1558AV', 'A9125CE', 'A5146AC', 'A4967DC', 'A1267EE', 'A0799AM', 'A4471EC', 'A5582EE', 'A9000AX', 'A2298EE', 'A1884EE', 'A8249AV', 'A8713ED', 'A4914EE', 'A1398EC', 'A9116ED', 'A4562DY', 'A4932EE', 'A5194CH', 'A9075CG', 'A5855EE', 'A9872AN', 'A2168AR', 'A7176AW', 'A9464ED', 'A5881AW', 'A2940EE', 'A8558DN', 'A3896EE', 'A3899EE', 'A8839AQ', 'A2826EE', 'A2948EE', 'A9739ED', 'A3571DL', 'A9853ED', 'A3546EE', 'A0231DD', 'A6984CQ', 'A9529CX')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, BOOKING_NUMBER, FIRST_NAME, DATE_OF_BIRTH, HO_REF, NATIONALITY_DESCRIPTION, UNIT_4_SHORT_DESCRIPTION, SENTENCE_LENGTH_FORMATTED_NO34 FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP8.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP8.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP8.DO10077",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "First Name",
            "legacyId": "DP8.DO10b04",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP8.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "HO_REF",
            "type": "string",
            "display": "Home Office Reference Number",
            "legacyId": "DP8.DO1096e",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "NATIONALITY_DESCRIPTION",
            "type": "string",
            "display": "Nationality Description",
            "legacyId": "DP8.DO100b5",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP8.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "SENTENCE_LENGTH_FORMATTED_NO34",
            "type": "string",
            "display": "Sentence Length Formatted - No Units",
            "legacyId": "DP8.DO146",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPb",
      "name": "Nat - M-Z",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.BOOKING_NUMBER, AT_OFFENDER_BOOKING_BAH.FIRST_NAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_OFFENDER_BOOKING.HO_REF, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, CASE WHEN DT_LIFEFLAG.life_sentence_flag = 'Y' THEN 'Life' WHEN DT_LIFEFLAG.life_sentence_flag IS NULL THEN CASE WHEN TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) IS NULL THEN NULL ELSE TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) || '  ' END || CASE WHEN TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) IS NULL THEN NULL ELSE TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) || '  ' END || CASE WHEN TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 7, 2)) IS NULL THEN NULL ELSE TO_NUMBER(SUBSTR(DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH, 7, 2)) || '  ' END ELSE '' END AS SENTENCE_LENGTH_FORMATTED_NO34 FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.DIM_DATE AT_DOB, (SELECT BODIMIS.FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK, BODIMIS.FACT_OFFENDER_SENTENCE.EFFECTIVE_SENTENCE_LENGTH FROM BODIMIS.FACT_OFFENDER_SENTENCE WHERE (BODIMIS.FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y')) DT_CURREFFSENLEN, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURREFFSENLEN.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A8036AG', 'A9582DN', 'A6899DL', 'A0164DM', 'A8062DZ', 'A6197DW', 'A5294DR', 'A4464DQ', 'A0044DZ', 'A7360ED', 'A5186DY', 'A9120DX', 'A2086AM', 'A6667DL', 'A2028AL', 'A5936ED', 'A8678DP', 'A5998CW', 'A5696DK', 'A5879DC', 'A3025EE', 'A6579CT', 'A8530AK', 'A2233DR', 'A7420EA', 'A5037DY', 'A3735EA', 'A6289CD', 'A2255DY', 'A1240CP', 'A7298AW', 'A6660DY', 'A0288DV', 'A4455DX', 'A9599EA', 'A1651DN', 'A0348EA', 'A4539DH', 'A9113DT', 'A8541DY', 'A3957CW', 'A8515DK', 'A3690DX', 'A3380DY', 'A6127DZ', 'A0299EC', 'A7885EA', 'A8069DX', 'A6229EE', 'A0750EE', 'A0999EC', 'A1967EC', 'A4751EA', 'A6748AL', 'A7945EC', 'A1328EC', 'A2153EE', 'A9015EC', 'A0735EA', 'A4765ED', 'A4183EC', 'A5588ED', 'A0819ED', 'A6517DZ', 'A3845ED', 'A0003DH', 'A6677EC', 'A3942ED', 'A3501ED', 'A6574DZ', 'A6769ED', 'A3939ED', 'A9600ED', 'A1452ED', 'A1603DV', 'A1182EE', 'A3463EE', 'A1770EE', 'A6127EE', 'A3123EE', 'A7141EE', 'A0931DH', 'A5676ED', 'A1501EE', 'A8864ED', 'A5803AW', 'A5652EE', 'A3970EE', 'A3048EE', 'A3979EE', 'A4457EE', 'A2359DY', 'A0264EE', 'A3536CJ', 'A4958EE', 'A1287DZ', 'A3901EE')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, BOOKING_NUMBER, FIRST_NAME, DATE_OF_BIRTH, HO_REF, NATIONALITY_DESCRIPTION, UNIT_4_SHORT_DESCRIPTION, SENTENCE_LENGTH_FORMATTED_NO34 FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPb.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DPb.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DPb.DO10077",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "First Name",
            "legacyId": "DPb.DO10b04",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DPb.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "HO_REF",
            "type": "string",
            "display": "Home Office Reference Number",
            "legacyId": "DPb.DO1096e",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "NATIONALITY_DESCRIPTION",
            "type": "string",
            "display": "Nationality Description",
            "legacyId": "DPb.DO100b5",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DPb.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "SENTENCE_LENGTH_FORMATTED_NO34",
            "type": "string",
            "display": "Sentence Length Formatted - No Units",
            "legacyId": "DPb.DO146",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "214316.RS",
      "name": "Sentenced Prisoners By Surname",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "214656.RS",
      "name": "Sentenced Prisoners By Location",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      },
      "dataset": "MISSING"
    }
  ],
  "errors": [
    {
      "type": "schema",
      "error": "instance.report[0] requires property \"dataset\"",
      "entityId": "FtPH6Vo_Vg0A12gAAHDrTV8AACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[1] requires property \"dataset\"",
      "entityId": "FtPH6Vo_Vg0A12gAAHDrTV8AACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report Variant 214316.RS does not have corresponding dataset undefined",
      "entityId": "214316.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report Variant 214656.RS does not have corresponding dataset undefined",
      "entityId": "214656.RS",
      "entityType": "variant"
    }
  ]
}