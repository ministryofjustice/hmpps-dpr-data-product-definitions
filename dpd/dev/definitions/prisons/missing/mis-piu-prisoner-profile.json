{
  "id": "olKnRO0ABTn7aqsAQAGD8K.FoJY",
  "name": "MIS PIU Prisoner Profile",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "POL0006 v00.00.01 LSRT0047"
    ]
  },
  "description": " This is a report/form for police intelligence purposes. It returns the personal information, court case, sentencing, movements, HDC and Address data for a prisoner's latest booking, regardless of whether open or closed.<br/>POL0006 â€“ v00.00.01 Last Modified: 05/11/13 ",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3376639/DP2",
      "name": "Header",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.MIDDLE_NAME_1, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.CRO_NUMBER, AT_OFFENDER_BOOKING.PNC_ID, AT_OFFENDER_ALIAS.FIRST_NAME AS ALIAS_GIVEN_NAME_1, AT_OFFENDER_ALIAS.MIDDLE_NAME_1 AS ALIAS_GIVEN_NAME_2, AT_OFFENDER_BOOKING.GENDER_DESCRIPTION, AT_OFFENDER_BOOKING.BIRTH_PLACE, AT_OFFENDER_BOOKING.BIRTH_COUNTRY, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'Asian/Asian British: Chinese' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_DESCRIPTION, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, AT_OFFENDER_EMPLOYMENT.OCCUPATION_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_CODE, 'Not Specified') AS RELIGION_CODE, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, CASE WHEN AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassified' ELSE AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL END AS CURRENT_SECURITY_CATEGORY, AT_OFFENDER_ALIAS.SURNAME AS ALIAS_SURNAME, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, AT_OFFENDER_BOOKING.BOOKING_NUMBER, AT_OFFENDER_ALIAS.GENDER, AT_OFFENDER_ALIAS.DISPLAY_NAME, CASE WHEN DT_FIRST_RECEPTION.DAY_DATE < '31/12/9000' THEN DT_FIRST_RECEPTION.DAY_DATE ELSE NULL END AS DATE_FIRST_RECEPTION FROM BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_ALIAS AT_OFFENDER_ALIAS, BODIMIS.DIM_OFFENDER_EMPLOYMENT AT_OFFENDER_EMPLOYMENT, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_CURRENT_SECURITY_CATEGORY, (SELECT * FROM (SELECT m.offender_booking_sk, d.day_date, m.movement_seq, m.movement_time, ROW_NUMBER() OVER (PARTITION BY m.offender_booking_sk ORDER BY m.movement_seq) AS row_seq_filter FROM bodimis.fact_movement_external m INNER JOIN bodimis.dim_date d ON m.date_sk = d.date_sk WHERE m.direction_code = 'IN') WHERE row_seq_filter = 1) DT_FIRST_RECEPTION WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_EMPLOYMENT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (DT_FIRST_RECEPTION.OFFENDER_BOOKING_SK = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK IS NULL OR AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_FLAG (+) = 'Y') AND (AT_CURRENT_SECURITY_CATEGORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, MIDDLE_NAME_1, DATE_OF_BIRTH, MAIN_LEGAL_STATUS_DESCRIPTION, CRO_NUMBER, PNC_ID, ALIAS_GIVEN_NAME_1, ALIAS_GIVEN_NAME_2, GENDER_DESCRIPTION, BIRTH_PLACE, BIRTH_COUNTRY, ETHNIC_DESCRIPTION, NATIONALITY_DESCRIPTION, OCCUPATION_DESCRIPTION, RELIGION_CODE, RELIGION_DESCRIPTION, CURRENT_SECURITY_CATEGORY, ALIAS_SURNAME, MAIN_LEGAL_STATUS_CODE, BOOKING_NUMBER, GENDER, DISPLAY_NAME, DATE_FIRST_RECEPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP2.DO7b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP2.DO80",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "MIDDLE_NAME_1",
            "type": "string",
            "display": "Offender Given Name 2",
            "legacyId": "DP2.DO81",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP2.DO85",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "MAIN_LEGAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Main Legal Status Description",
            "legacyId": "DP2.DOdf",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CRO_NUMBER",
            "type": "string",
            "display": "Criminal Records Office number",
            "legacyId": "DP2.DOda",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "PNC_ID",
            "type": "string",
            "display": "PNC ID",
            "legacyId": "DP2.DOdb",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ALIAS_GIVEN_NAME_1",
            "type": "string",
            "display": "Alias Given Name 1",
            "legacyId": "DP2.DO8b",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "ALIAS_GIVEN_NAME_2",
            "type": "string",
            "display": "Alias Given Name 2",
            "legacyId": "DP2.DO8c",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "GENDER_DESCRIPTION",
            "type": "string",
            "display": "Gender Description",
            "legacyId": "DP2.DOa9",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "BIRTH_PLACE",
            "type": "string",
            "display": "Birth Place",
            "legacyId": "DP2.DO86",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "BIRTH_COUNTRY",
            "type": "string",
            "display": "Birth Country",
            "legacyId": "DP2.DO88",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "ETHNIC_DESCRIPTION",
            "type": "string",
            "display": "Ethnic Description",
            "legacyId": "DP2.DO9d",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "NATIONALITY_DESCRIPTION",
            "type": "string",
            "display": "Nationality Description",
            "legacyId": "DP2.DOb5",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "OCCUPATION_DESCRIPTION",
            "type": "string",
            "display": "Occupation Description",
            "legacyId": "DP2.DOb7",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "RELIGION_CODE",
            "type": "string",
            "display": "Religion Code",
            "legacyId": "DP2.DOb2",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DP2.DOb3",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "CURRENT_SECURITY_CATEGORY",
            "type": "string",
            "display": "Current Security Category",
            "legacyId": "DP2.DOe1",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "ALIAS_SURNAME",
            "type": "string",
            "display": "Alias Surname",
            "legacyId": "DP2.DO89",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "MAIN_LEGAL_STATUS_CODE",
            "type": "string",
            "display": "Main Legal Status Code",
            "legacyId": "DP2.DOde",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP2.DO77",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "GENDER",
            "type": "string",
            "display": "Alias Gender",
            "legacyId": "DP2.DO70f",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "DISPLAY_NAME",
            "type": "string",
            "display": "Alias or Working Name?",
            "legacyId": "DP2.DO78f",
            "legacySqlClass": "column"
          },
          {
            "index": 24,
            "name": "DATE_FIRST_RECEPTION",
            "type": "date",
            "display": "Date First Reception",
            "legacyId": "DP2.DO106",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP4",
      "name": "Offences",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OFFENCE.OFFENCE_CODE_NK, AT_COURT_CASE.COURT_CASE_SK, CASE WHEN AT_FACT_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE TO_CHAR(AT_FACT_SENTENCE_TERMS.YEARS) END AS CASE_TERMS_YEARS, CASE WHEN AT_FACT_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y' THEN '' ELSE TO_CHAR(AT_FACT_SENTENCE_TERMS.MONTHS) END AS CASE_TERMS_MONTHS, CASE WHEN AT_FACT_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y' THEN '' ELSE TO_CHAR(AT_FACT_SENTENCE_TERMS.DAYS) END AS CASE_TERMS_DAYS, AT_DIM_OFFENCE.OFFENCE_NAME, AT_FACT_COURT_CHARGE.MOST_SERIOUS_FLAG, AT_MIN_SENTENCE_DATE.DAY_DATE, AT_FACT_COURT_CHARGE.OFFENDER_CHARGE_ID_NK, CASE WHEN AT_FACT_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y' THEN '' ELSE TO_CHAR(AT_FACT_SENTENCE_TERMS.WEEKS) END AS CASE_TERMS_WEEKS FROM BODIMIS.DIM_DATE AT_MIN_SENTENCE_DATE, BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.FACT_SENTENCE_CHARGE AT_FACT_SENTENCE_CHARGE, BODIMIS.FACT_CASE_SENTENCE_TERM AT_FACT_SENTENCE_TERMS, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_COURT_CASE AT_COURT_CASE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT * FROM (SELECT sentence_start_date_sk, offender_booking_sk, sentence_seq_nk, sentence_type_sk, court_case_sk, sentence_termination_date_sk, expiry_date_sk, ROW_NUMBER() OVER (PARTITION BY offender_booking_sk ORDER BY sentence_start_date_sk, sentence_seq_nk) AS row_seq_filter FROM bodimis.fact_case_sentence) WHERE row_seq_filter = 1) DT_FIRST_SENTENCE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_FACT_COURT_CHARGE.OFFENDER_CHARGE_ID_NK = AT_FACT_SENTENCE_CHARGE.OFFENDER_CHARGE_ID_NK (+)) AND (AT_FACT_SENTENCE_TERMS.OFFENDER_BOOKING_SK (+) = AT_FACT_SENTENCE_CHARGE.OFFENDER_BOOKING_SK AND AT_FACT_SENTENCE_TERMS.SENTENCE_SEQ_NK (+) = AT_FACT_SENTENCE_CHARGE.SENTENCE_SEQ_NK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (DT_FIRST_SENTENCE.SENTENCE_START_DATE_SK = AT_MIN_SENTENCE_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_FIRST_SENTENCE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active'))), dataset_ AS (SELECT COURT_CASE_NUMBER, OFFENCE_CODE_NK, COURT_CASE_SK, CASE_TERMS_YEARS, CASE_TERMS_MONTHS, CASE_TERMS_DAYS, OFFENCE_NAME, MOST_SERIOUS_FLAG, DAY_DATE, OFFENDER_CHARGE_ID_NK, CASE_TERMS_WEEKS FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "COURT_CASE_NUMBER",
            "type": "string",
            "display": "Court Case Number",
            "legacyId": "DP4.DO51",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENCE_CODE_NK",
            "type": "string",
            "display": "Offence Code",
            "legacyId": "DP4.DO4a",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "COURT_CASE_SK",
            "type": "double",
            "display": "Court Case Internal Key",
            "legacyId": "DP4.DO147",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CASE_TERMS_YEARS",
            "type": "string",
            "display": "Case Terms - Years",
            "legacyId": "DP4.DO1c6",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "CASE_TERMS_MONTHS",
            "type": "string",
            "display": "Case Terms - Months",
            "legacyId": "DP4.DO1c7",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "CASE_TERMS_DAYS",
            "type": "string",
            "display": "Case Terms - Days",
            "legacyId": "DP4.DO1c8",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DP4.DO4b",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "MOST_SERIOUS_FLAG",
            "type": "string",
            "display": "Main Offence Flag",
            "legacyId": "DP4.DO4f",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Minimum Sentence Date",
            "legacyId": "DP4.DO1db",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "OFFENDER_CHARGE_ID_NK",
            "type": "double",
            "display": "Offender Charge Id Nk",
            "legacyId": "DP4.DO1d9",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "CASE_TERMS_WEEKS",
            "type": "string",
            "display": "Case Terms - Weeks",
            "legacyId": "DP4.DO5e3",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP5",
      "name": "Sentence History",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT CASE WHEN AT_LTD_DATE.DAY_DATE < '31/12/9000' THEN AT_LTD_DATE.DAY_DATE END AS LTD_, 'Not Available' AS LTD_OVERRIDE, CASE WHEN AT_PRRD_DATE.DAY_DATE < '31/12/9000' THEN AT_PRRD_DATE.DAY_DATE END AS PRRD_, CASE WHEN AT_HDCAD_DATE.DAY_DATE < '31/12/9000' THEN AT_HDCAD_DATE.DAY_DATE END AS HDC_AD_, CASE WHEN AT_HDCED_DATE.DAY_DATE < '31/12/9000' THEN AT_HDCED_DATE.DAY_DATE END AS HDC_ELIGIBILITY_DATE_, CASE WHEN AT_MTD_DATE.DAY_DATE < '31/12/9000' THEN AT_MTD_DATE.DAY_DATE END AS MTD_HISTORICAL, CASE WHEN AT_APD_DATE.DAY_DATE < '31/12/9000' THEN AT_APD_DATE.DAY_DATE END AS APD_, CASE WHEN AT_LED_DATE.DAY_DATE < '31/12/9000' THEN AT_LED_DATE.DAY_DATE END AS LED_, CASE WHEN AT_ETD_DATE.DAY_DATE < '31/12/9000' THEN AT_ETD_DATE.DAY_DATE END AS ETD_, CASE WHEN AT_PED_DATE.DAY_DATE < '31/12/9000' THEN AT_PED_DATE.DAY_DATE END AS PED_, CASE WHEN AT_SED_DATE.DAY_DATE < '31/12/9000' THEN AT_SED_DATE.DAY_DATE END AS SED_, DT_CURRENT_KEY_DATES.SED, CASE WHEN AT_NPD_DATE.DAY_DATE < '31/12/9000' THEN AT_NPD_DATE.DAY_DATE END AS NPD_, CASE WHEN AT_ARD_DATE.DAY_DATE < '31/12/9000' THEN AT_ARD_DATE.DAY_DATE END AS ARD_, CASE WHEN AT_CRD_DATE.DAY_DATE < '31/12/9000' THEN AT_CRD_DATE.DAY_DATE END AS CRD_, AT_FACT_OFFENDER_SENTENCE.RECORD_DATETIME, AT_FACT_OFFENDER_SENTENCE.COMMENT_TEXT, AT_FACT_OFFENDER_SENTENCE.CALC_REASON_CODE, AT_FACT_OFFENDER_SENTENCE.CALC_REASON, CASE WHEN AT_TARIFF_DATE.DAY_DATE < '31/12/9000' THEN AT_TARIFF_DATE.DAY_DATE END AS TARIFF_DATE_, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE DT_CURREFFSENLEN.EFFECTIVE_SENTENCE_LENGTH END AS EFFECTIVE_SENTENCE_LENGTH, AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG FROM BODIMIS.DIM_DATE AT_LTD_DATE, BODIMIS.DIM_DATE AT_PRRD_DATE, BODIMIS.DIM_DATE AT_HDCAD_DATE, BODIMIS.DIM_DATE AT_HDCED_DATE, BODIMIS.DIM_DATE AT_MTD_DATE, BODIMIS.DIM_DATE AT_APD_DATE, BODIMIS.DIM_DATE AT_LED_DATE, BODIMIS.DIM_DATE AT_ETD_DATE, BODIMIS.DIM_DATE AT_PED_DATE, BODIMIS.DIM_DATE AT_SED_DATE, BODIMIS.DIM_DATE AT_NPD_DATE, BODIMIS.DIM_DATE AT_ARD_DATE, BODIMIS.DIM_DATE AT_CRD_DATE, BODIMIS.DIM_DATE AT_TARIFF_DATE, (SELECT AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK AS OFFENDER_BOOKING_SK, CASE WHEN AT_APD_DATE.DAY_DATE <> '31/12/9000' THEN AT_APD_DATE.DAY_DATE END AS CURR_APD_DATE, CASE WHEN AT_ARD_DATE.DAY_DATE <> '31/12/9000' THEN AT_ARD_DATE.DAY_DATE END AS CURR_ARD_DATE, CASE WHEN AT_CRD_DATE.DAY_DATE <> '31/12/9000' THEN AT_CRD_DATE.DAY_DATE END AS CURR_CRD_DATE, CASE WHEN AT_ETD_DATE.DAY_DATE <> '31/12/9000' THEN AT_ETD_DATE.DAY_DATE END AS CURR_ETD_DATE, CASE WHEN AT_HDCAD_DATE.DAY_DATE <> '31/12/9000' THEN AT_HDCAD_DATE.DAY_DATE END AS CURR_HDCAD_DATE, CASE WHEN AT_HDCED_DATE.DAY_DATE <> '31/12/9000' THEN AT_HDCED_DATE.DAY_DATE END AS CURR_HDCED_DATE, CASE WHEN AT_PED_DATE.DAY_DATE <> '31/12/9000' THEN AT_PED_DATE.DAY_DATE END AS CURR_PED_DATE, CASE WHEN AT_LED_DATE.DAY_DATE <> '31/12/9000' THEN AT_LED_DATE.DAY_DATE END AS CURR_LED_DATE, CASE WHEN AT_LTD_DATE.DAY_DATE <> '31/12/9000' THEN AT_LTD_DATE.DAY_DATE END AS CURR_LTD_DATE, CASE WHEN AT_MTD_DATE.DAY_DATE <> '31/12/9000' THEN AT_MTD_DATE.DAY_DATE END AS CURR_MTD_DATE, CASE WHEN AT_NPD_DATE.DAY_DATE <> '31/12/9000' THEN AT_NPD_DATE.DAY_DATE END AS CURR_NPD_DATE, CASE WHEN AT_PRRD_DATE.DAY_DATE <> '31/12/9000' THEN AT_PRRD_DATE.DAY_DATE END AS CURR_PRRD_DATE, CASE WHEN AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' THEN AT_RELEASE_DATE.DAY_DATE END AS CURR_RELEASE_DATE, CASE WHEN AT_SED_DATE.DAY_DATE <> '31/12/9000' THEN AT_SED_DATE.DAY_DATE END AS SED, MIN(CASE WHEN AT_SENT_START_DATE.DAY_DATE <> '31/12/9000' THEN AT_SENT_START_DATE.DAY_DATE END) AS SSD, CASE WHEN AT_TARIFF_DATE.DAY_DATE <> '31/12/9000' THEN AT_TARIFF_DATE.DAY_DATE END AS TARIFF, CASE WHEN AT_ROTL_DATE.DAY_DATE <> '31/12/9000' THEN AT_ROTL_DATE.DAY_DATE END AS CURR_ROTL_DATE, CASE WHEN AT_ERSED_DATE.DAY_DATE <> '31/12/9000' THEN AT_ERSED_DATE.DAY_DATE END AS CURR_ERSED_DATE, CASE WHEN AT_TERSED_DATE.DAY_DATE <> '31/12/9000' THEN AT_TERSED_DATE.DAY_DATE END AS CURR_TERSED_DATE, at_fact_offender_sentence.tused_date_sk AS tused_sk, NULLIF(td.day_date, TO_DATE('31/12/9000', 'DD/MM/YYYY')) AS tused FROM BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_ARD_DATE, BODIMIS.DIM_DATE AT_APD_DATE, BODIMIS.DIM_DATE AT_CRD_DATE, BODIMIS.DIM_DATE AT_ETD_DATE, BODIMIS.DIM_DATE AT_HDCAD_DATE, BODIMIS.DIM_DATE AT_HDCED_DATE, BODIMIS.DIM_DATE AT_PED_DATE, BODIMIS.DIM_DATE AT_LED_DATE, BODIMIS.DIM_DATE AT_LTD_DATE, BODIMIS.DIM_DATE AT_MTD_DATE, BODIMIS.DIM_DATE AT_NPD_DATE, BODIMIS.DIM_DATE AT_PRRD_DATE, BODIMIS.DIM_DATE AT_RELEASE_DATE, BODIMIS.DIM_DATE AT_SED_DATE, BODIMIS.DIM_DATE AT_SENT_START_DATE, BODIMIS.DIM_DATE AT_TARIFF_DATE, BODIMIS.DIM_DATE AT_ROTL_DATE, BODIMIS.DIM_DATE AT_ERSED_DATE, BODIMIS.DIM_DATE AT_TERSED_DATE, bodimis.dim_date td WHERE AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK = AT_FACT_SENTENCE.OFFENDER_BOOKING_SK (+) AND AT_FACT_OFFENDER_SENTENCE.ARD_DATE_SK = AT_ARD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.APD_DATE_SK = AT_APD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.CRD_DATE_SK = AT_CRD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.ETD_DATE_SK = AT_ETD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.HDCAD_DATE_SK = AT_HDCAD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.HDCED_DATE_SK = AT_HDCED_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.PED_DATE_SK = AT_PED_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.LED_DATE_SK = AT_LED_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.LTD_DATE_SK = AT_LTD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.MTD_DATE_SK = AT_MTD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.NPD_DATE_SK = AT_NPD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.PED_DATE_SK = AT_PED_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.PRRD_DATE_SK = AT_PRRD_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK = AT_RELEASE_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.SED_DATE_SK = AT_SED_DATE.DATE_SK (+) AND AT_FACT_SENTENCE.SENTENCE_START_DATE_SK = AT_SENT_START_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.TARIFF_DATE_SK = AT_TARIFF_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.ROTL_DATE_SK = AT_ROTL_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.ERSED_DATE_SK = AT_ERSED_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.TERSED_DATE_SK = AT_TERSED_DATE.DATE_SK (+) AND at_fact_offender_sentence.tused_date_sk = td.date_sk (+) AND AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y' GROUP BY AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK, CASE WHEN AT_APD_DATE.DAY_DATE <> '31/12/9000' THEN AT_APD_DATE.DAY_DATE END, CASE WHEN AT_ARD_DATE.DAY_DATE <> '31/12/9000' THEN AT_ARD_DATE.DAY_DATE END, CASE WHEN AT_CRD_DATE.DAY_DATE <> '31/12/9000' THEN AT_CRD_DATE.DAY_DATE END, CASE WHEN AT_ETD_DATE.DAY_DATE <> '31/12/9000' THEN AT_ETD_DATE.DAY_DATE END, CASE WHEN AT_HDCAD_DATE.DAY_DATE <> '31/12/9000' THEN AT_HDCAD_DATE.DAY_DATE END, CASE WHEN AT_HDCED_DATE.DAY_DATE <> '31/12/9000' THEN AT_HDCED_DATE.DAY_DATE END, CASE WHEN AT_PED_DATE.DAY_DATE <> '31/12/9000' THEN AT_PED_DATE.DAY_DATE END, CASE WHEN AT_LED_DATE.DAY_DATE <> '31/12/9000' THEN AT_LED_DATE.DAY_DATE END, CASE WHEN AT_LTD_DATE.DAY_DATE <> '31/12/9000' THEN AT_LTD_DATE.DAY_DATE END, CASE WHEN AT_MTD_DATE.DAY_DATE <> '31/12/9000' THEN AT_MTD_DATE.DAY_DATE END, CASE WHEN AT_NPD_DATE.DAY_DATE <> '31/12/9000' THEN AT_NPD_DATE.DAY_DATE END, CASE WHEN AT_PRRD_DATE.DAY_DATE <> '31/12/9000' THEN AT_PRRD_DATE.DAY_DATE END, CASE WHEN AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' THEN AT_RELEASE_DATE.DAY_DATE END, CASE WHEN at_sed_date.day_date <> '31/12/9000' THEN at_sed_date.day_date END, CASE WHEN AT_TARIFF_DATE.DAY_DATE <> '31/12/9000' THEN AT_TARIFF_DATE.DAY_DATE END, CASE WHEN AT_ROTL_DATE.DAY_DATE <> '31/12/9000' THEN AT_ROTL_DATE.DAY_DATE END, CASE WHEN AT_ERSED_DATE.DAY_DATE <> '31/12/9000' THEN AT_ERSED_DATE.DAY_DATE END, CASE WHEN AT_TERSED_DATE.DAY_DATE <> '31/12/9000' THEN AT_TERSED_DATE.DAY_DATE END, at_fact_offender_sentence.tused_date_sk, td.day_date) DT_CURRENT_KEY_DATES, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, (SELECT BODIMIS.FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK, BODIMIS.FACT_OFFENDER_SENTENCE.EFFECTIVE_SENTENCE_LENGTH FROM BODIMIS.FACT_OFFENDER_SENTENCE WHERE (BODIMIS.FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y')) DT_CURREFFSENLEN, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_FACT_OFFENDER_SENTENCE.APD_DATE_SK = AT_APD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.ETD_DATE_SK = AT_ETD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.MTD_DATE_SK = AT_MTD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.LTD_DATE_SK = AT_LTD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.ARD_DATE_SK = AT_ARD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.CRD_DATE_SK = AT_CRD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.PED_DATE_SK = AT_PED_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.NPD_DATE_SK = AT_NPD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.LED_DATE_SK = AT_LED_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.SED_DATE_SK = AT_SED_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.PRRD_DATE_SK = AT_PRRD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.HDCAD_DATE_SK = AT_HDCAD_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURRENT_KEY_DATES.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.HDCED_DATE_SK = AT_HDCED_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.TARIFF_DATE_SK = AT_TARIFF_DATE.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURREFFSENLEN.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT LTD_, LTD_OVERRIDE, PRRD_, HDC_AD_, HDC_ELIGIBILITY_DATE_, MTD_HISTORICAL, APD_, LED_, ETD_, PED_, SED_, SED, NPD_, ARD_, CRD_, RECORD_DATETIME, COMMENT_TEXT, CALC_REASON_CODE, CALC_REASON, TARIFF_DATE_, EFFECTIVE_SENTENCE_LENGTH, SENTENCE_CURRENT_FLAG FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "LTD_",
            "type": "date",
            "display": "LTD (Latest Transfer date) (Historical)",
            "legacyId": "DP5.DO308",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LTD_OVERRIDE",
            "type": "string",
            "display": "LTD Override",
            "legacyId": "DP5.DO99",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "PRRD_",
            "type": "date",
            "display": "PRRD (Post Recall Release Date) (Historic)",
            "legacyId": "DP5.DO89",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "HDC_AD_",
            "type": "date",
            "display": "HDC AD (Approved Date) (Historical)",
            "legacyId": "DP5.DO2f8",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "HDC_ELIGIBILITY_DATE_",
            "type": "date",
            "display": "HDC Eligibility Date (Historic)",
            "legacyId": "DP5.DO2f6",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "MTD_HISTORICAL",
            "type": "date",
            "display": "MTD (Mid Term Date) (Historical",
            "legacyId": "DP5.DO304",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "APD_",
            "type": "date",
            "display": "APD (Actual Parole Date) (Historical)",
            "legacyId": "DP5.DO2fe",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "LED_",
            "type": "date",
            "display": "LED (Licence Expiry Date ) (Historical)",
            "legacyId": "DP5.DO316",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ETD_",
            "type": "date",
            "display": "ETD (Earliest Transfer Date) (Historical)",
            "legacyId": "DP5.DO306",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "PED_",
            "type": "date",
            "display": "PED (Parole Eligibility Date) (Historical)",
            "legacyId": "DP5.DO2fc",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "SED_",
            "type": "date",
            "display": "SED (Sentence End Date) (Historical)",
            "legacyId": "DP5.DO302",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "SED",
            "type": "date",
            "display": "Sentence Completion Date",
            "legacyId": "DP5.DO6e",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "NPD_",
            "type": "date",
            "display": "NPD (Non Parole Date) (HIstorical)",
            "legacyId": "DP5.DO300",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "ARD_",
            "type": "date",
            "display": "ARD (Approved Release Date) (Historical)",
            "legacyId": "DP5.DO30d",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "CRD_",
            "type": "date",
            "display": "CRD (Conditional Release Date) (Historical)",
            "legacyId": "DP5.DO30a",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "RECORD_DATETIME",
            "type": "date",
            "display": "Sentence Last Update Date",
            "legacyId": "DP5.DO37c",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Sentence Last Update Comment",
            "legacyId": "DP5.DO37d",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "CALC_REASON_CODE",
            "type": "string",
            "display": "Sentence Last Update Reason Code",
            "legacyId": "DP5.DO383",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "CALC_REASON",
            "type": "string",
            "display": "Sentence Last Update Reason Description",
            "legacyId": "DP5.DO384",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "TARIFF_DATE_",
            "type": "date",
            "display": "Tariff Date (Historical)",
            "legacyId": "DP5.DO3b2",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "EFFECTIVE_SENTENCE_LENGTH",
            "type": "string",
            "display": "Effective Sentence Length",
            "legacyId": "DP5.DO2d0",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "SENTENCE_CURRENT_FLAG",
            "type": "string",
            "display": "Sentence Dates Current Flag",
            "legacyId": "DP5.DO2c9",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP6",
      "name": "Alerts",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_ALERT.ALERT_CODE_NK, CASE WHEN AT_ALERT.ALERT_ACTIVE_FLAG = 'Y' THEN (AT_ALERT.ALERT_CODE_NK || ' ' || AT_ALERT.ALERT_DESCRIPTION) END AS ALERT_FULL_DESCRIPTION, AT_OFFENDER_ALERT.ALERT_STATUS, CASE WHEN AT_ALERT_EXPIRY_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EXPIRY_DATE.DAY_DATE ELSE NULL END AS ALERT_EXPIRY_DATE, CASE WHEN AT_ALERT.ALERT_ACTIVE_FLAG = 'Y' THEN (AT_ALERT.ALERT_DESCRIPTION) END AS ALERT_DESCRIPTION_ONLY FROM BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EXPIRY_DATE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_EXPIRY_DATE_SK = AT_ALERT_EXPIRY_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT ALERT_CODE_NK, ALERT_FULL_DESCRIPTION, ALERT_STATUS, ALERT_EXPIRY_DATE, ALERT_DESCRIPTION_ONLY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP6.DO8e",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_FULL_DESCRIPTION",
            "type": "string",
            "display": "Alert Full Description",
            "legacyId": "DP6.DO91",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP6.DO94",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_EXPIRY_DATE",
            "type": "date",
            "display": "Alert Expiry Date",
            "legacyId": "DP6.DO96",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ALERT_DESCRIPTION_ONLY",
            "type": "string",
            "display": "Alert Description Only",
            "legacyId": "DP6.DO764",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP7",
      "name": "Addresses",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS CONTACT_NAME, DT_OFFENDER_CONTACT_ADDRESS.BIRTH_DATE, DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP, DT_OFFENDER_CONTACT_ADDRESS.FLAT, DT_OFFENDER_CONTACT_ADDRESS.PREMISE, DT_OFFENDER_CONTACT_ADDRESS.STREET, DT_OFFENDER_CONTACT_ADDRESS.LOCALITY, DT_OFFENDER_CONTACT_ADDRESS.CITY, DT_OFFENDER_CONTACT_ADDRESS.COUNTY, DT_OFFENDER_CONTACT_ADDRESS.COUNTRY, DT_OFFENDER_CONTACT_ADDRESS.POST_CODE, DT_OFFENDER_CONTACT_ADDRESS.TEL_NO, DT_OFFENDER_CONTACT_ADDRESS.EXT_NO, DT_OFFENDER_CONTACT_ADDRESS.OTHER_CONTACT_SK, DT_OFFENDER_CONTACT_ADDRESS.CON_ADDR_TYPE, DT_OFFENDER_CONTACT_ADDRESS.CONADDRTYPEDESC FROM (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */))), dataset_ AS (SELECT ACTIVE_FLAG, CONTACT_NAME, BIRTH_DATE, RELATIONSHIP, FLAT, PREMISE, STREET, LOCALITY, CITY, COUNTY, COUNTRY, POST_CODE, TEL_NO, EXT_NO, OTHER_CONTACT_SK, CON_ADDR_TYPE, CONADDRTYPEDESC FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "ACTIVE_FLAG",
            "type": "string",
            "display": "Contact Address Active Flag",
            "legacyId": "DP7.DO752",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "CONTACT_NAME",
            "type": "string",
            "display": "Contact Name",
            "legacyId": "DP7.DO747",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "BIRTH_DATE",
            "type": "date",
            "display": "Contact Birth Date",
            "legacyId": "DP7.DOade",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "RELATIONSHIP",
            "type": "string",
            "display": "Contact Relationship",
            "legacyId": "DP7.DO748",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "FLAT",
            "type": "string",
            "display": "Contact Address Flat",
            "legacyId": "DP7.DO749",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "PREMISE",
            "type": "string",
            "display": "Contact Address Premise",
            "legacyId": "DP7.DO74a",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "STREET",
            "type": "string",
            "display": "Contact Address Street",
            "legacyId": "DP7.DO74b",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "LOCALITY",
            "type": "string",
            "display": "Contact Address Locality",
            "legacyId": "DP7.DO74c",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "CITY",
            "type": "string",
            "display": "Contact Address City",
            "legacyId": "DP7.DO74d",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "COUNTY",
            "type": "string",
            "display": "Contact Address County",
            "legacyId": "DP7.DO74e",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "COUNTRY",
            "type": "string",
            "display": "Contact Address Country",
            "legacyId": "DP7.DO74f",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "POST_CODE",
            "type": "string",
            "display": "Contact Address Post Code",
            "legacyId": "DP7.DO750",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "TEL_NO",
            "type": "string",
            "display": "Contact Address Telephone Number",
            "legacyId": "DP7.DO753",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "EXT_NO",
            "type": "string",
            "display": "Contact Address Telephone Number Ext No",
            "legacyId": "DP7.DO754",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "OTHER_CONTACT_SK",
            "type": "double",
            "display": "Contact Address ID",
            "legacyId": "DP7.DO758",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "CON_ADDR_TYPE",
            "type": "string",
            "display": "Contact Address Type",
            "legacyId": "DP7.DO755",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "CONADDRTYPEDESC",
            "type": "string",
            "display": "Contact Address Type Description",
            "legacyId": "DP7.DO75a",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP8",
      "name": "Inmate Description",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT TO_CHAR(AT_OFFENDER_BOOKING.HEIGHT_IMPERIAL_FT) || ' Feet ' || TO_CHAR(AT_OFFENDER_BOOKING.HEIGHT_IMPERIAL_IN) || ' Inches' AS HEIGHT_IMPERIAL, TO_CHAR(TRUNC(AT_OFFENDER_BOOKING.HEIGHT_METRIC / 100, 2)) || ' Metres ' AS HEIGHT_METRIC, TO_CHAR(FLOOR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL / 14)) || ' Stone ' || '  ' || TO_CHAR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL - 14 * FLOOR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL / 14)) || ' Pounds ' AS WEIGHT_IMPERIAL, TO_CHAR(AT_OFFENDER_BOOKING.WEIGHT_METRIC) || ' Kilos ' AS WEIGHT_METRIC, AT_OFFENDER_BOOKING.HAIR_DESCRIPTION, AT_OFFENDER_BOOKING.LEFT_EYE_COLOUR_DESCRIPTION, AT_OFFENDER_BOOKING.RIGHT_EYE_COLOUR_DESCRIPTION, AT_OFFENDER_BOOKING.BUILD_DESCRIPTION, AT_OFFENDER_BOOKING.FACIAL_SHAPE_DESCRIPTION, AT_OFFENDER_PHYSICAL_MARK.BODY_PART_CODE, AT_OFFENDER_PHYSICAL_MARK.MARK_TYPE, AT_OFFENDER_PHYSICAL_MARK.SIDE_CODE, AT_OFFENDER_PHYSICAL_MARK.PART_ORIENTATION_CODE, AT_OFFENDER_BOOKING.FACIAL_HAIR_DESCRIPTION, AT_OFFENDER_PHYSICAL_MARK.COMMENT_TEXT, AT_OFFENDER_PHYSICAL_MARK.MARK, AT_OFFENDER_PHYSICAL_MARK.PART_ORIENTATION, AT_OFFENDER_PHYSICAL_MARK.SIDE, AT_OFFENDER_PHYSICAL_MARK.ID_MARK_SEQ, AT_OFFENDER_PHYSICAL_MARK.BODY_PART FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_PHYSICAL_MARK AT_OFFENDER_PHYSICAL_MARK WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_PHYSICAL_MARK.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT HEIGHT_IMPERIAL, HEIGHT_METRIC, WEIGHT_IMPERIAL, WEIGHT_METRIC, HAIR_DESCRIPTION, LEFT_EYE_COLOUR_DESCRIPTION, RIGHT_EYE_COLOUR_DESCRIPTION, BUILD_DESCRIPTION, FACIAL_SHAPE_DESCRIPTION, BODY_PART_CODE, MARK_TYPE, SIDE_CODE, PART_ORIENTATION_CODE, FACIAL_HAIR_DESCRIPTION, COMMENT_TEXT, MARK, PART_ORIENTATION, SIDE, ID_MARK_SEQ, BODY_PART FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "HEIGHT_IMPERIAL",
            "type": "string",
            "display": "Height Imperial",
            "legacyId": "DP8.DO9a",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "HEIGHT_METRIC",
            "type": "string",
            "display": "Height Metric",
            "legacyId": "DP8.DO99",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "WEIGHT_IMPERIAL",
            "type": "string",
            "display": "Weight Imperial",
            "legacyId": "DP8.DO9e",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "WEIGHT_METRIC",
            "type": "string",
            "display": "Weight Metric",
            "legacyId": "DP8.DO9f",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "HAIR_DESCRIPTION",
            "type": "string",
            "display": "Hair Colour",
            "legacyId": "DP8.DOaa",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "LEFT_EYE_COLOUR_DESCRIPTION",
            "type": "string",
            "display": "Left Eye Colour",
            "legacyId": "DP8.DOab",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "RIGHT_EYE_COLOUR_DESCRIPTION",
            "type": "string",
            "display": "Right Eye Colour",
            "legacyId": "DP8.DOac",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "BUILD_DESCRIPTION",
            "type": "string",
            "display": "Build",
            "legacyId": "DP8.DOa6",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "FACIAL_SHAPE_DESCRIPTION",
            "type": "string",
            "display": "Facial Shape",
            "legacyId": "DP8.DOa7",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "BODY_PART_CODE",
            "type": "string",
            "display": "Body Part Code",
            "legacyId": "DP8.DOa1",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "MARK_TYPE",
            "type": "string",
            "display": "Mark Type",
            "legacyId": "DP8.DOa2",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "SIDE_CODE",
            "type": "string",
            "display": "Side Code",
            "legacyId": "DP8.DOa3",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "PART_ORIENTATION_CODE",
            "type": "string",
            "display": "Part Orientation Code",
            "legacyId": "DP8.DOa4",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "FACIAL_HAIR_DESCRIPTION",
            "type": "string",
            "display": "Facial Hair",
            "legacyId": "DP8.DOa5",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Comment Text",
            "legacyId": "DP8.DO4ea",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "MARK",
            "type": "string",
            "display": "Mark Description",
            "legacyId": "DP8.DO6ca",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "PART_ORIENTATION",
            "type": "string",
            "display": "Part Orientation Description",
            "legacyId": "DP8.DO6b6",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "SIDE",
            "type": "string",
            "display": "Side Description",
            "legacyId": "DP8.DO6b7",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "ID_MARK_SEQ",
            "type": "double",
            "display": "Physical Characteristics ID",
            "legacyId": "DP8.DO6da",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "BODY_PART",
            "type": "string",
            "display": "Body Part Description",
            "legacyId": "DP8.DO6b8",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPa",
      "name": "Sentence Addresses",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_DIM_ADDRESSES.ADDRESS_TYPE, AT_DIM_ADDRESSES.ACTIVE_FLAG, AT_DIM_ADDRESSES.NO_FIXED_ADDRESS_FLAG, AT_DIM_ADDRESSES.FLAT, AT_DIM_ADDRESSES.PREMISE, AT_DIM_ADDRESSES.STREET, AT_DIM_ADDRESSES.LOCALITY, AT_DIM_ADDRESSES.CITY_DESC, AT_DIM_ADDRESSES.COUNTY_DESC, AT_DIM_ADDRESSES.COUNTRY_DESC, AT_DIM_ADDRESSES.POSTAL_CODE, AT_DIM_ADDRESSES.FLAT || ' ' || AT_DIM_ADDRESSES.PREMISE || ' ' || AT_DIM_ADDRESSES.STREET || ' ' || AT_DIM_ADDRESSES.LOCALITY || ' ' || AT_DIM_ADDRESSES.CITY_DESC || ' ' || AT_DIM_ADDRESSES.POSTAL_CODE || ' ' || AT_DIM_ADDRESSES.COUNTRY_DESC AS FULL_OFFENDER_ADDRESS, AT_DIM_ADDRESSES.HOME_TEL_NO, AT_DIM_ADDRESSES.HOME_EXT_NO, 'N/A' AS OFFENDER_ADDRESS_ID, AT_DIM_ADDRESSES.ADDR_TYPE_DESCRIPTION FROM BODIMIS.DIM_ADDRESSES AT_DIM_ADDRESSES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODISTAGING.REF_OFFENDERS AT_BODISTAG_REF_OFFENDERS WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_ID = AT_BODISTAG_REF_OFFENDERS.OFFENDER_ID (+)) AND (AT_BODISTAG_REF_OFFENDERS.OFFENDER_ID = AT_DIM_ADDRESSES.OFFENDER_ID_NK (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT ADDRESS_TYPE, ACTIVE_FLAG, NO_FIXED_ADDRESS_FLAG, FLAT, PREMISE, STREET, LOCALITY, CITY_DESC, COUNTY_DESC, COUNTRY_DESC, POSTAL_CODE, FULL_OFFENDER_ADDRESS, HOME_TEL_NO, HOME_EXT_NO, OFFENDER_ADDRESS_ID, ADDR_TYPE_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "ADDRESS_TYPE",
            "type": "string",
            "display": "Offender Address Type",
            "legacyId": "DPa.DO1072e",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ACTIVE_FLAG",
            "type": "string",
            "display": "Offender Address Active Flag",
            "legacyId": "DPa.DO1072d",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "NO_FIXED_ADDRESS_FLAG",
            "type": "string",
            "display": "Offender Address No Fixed Abode Flag",
            "legacyId": "DPa.DO1072c",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "FLAT",
            "type": "string",
            "display": "Offender Address 1",
            "legacyId": "DPa.DO1071d",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "PREMISE",
            "type": "string",
            "display": "Offender Address 2",
            "legacyId": "DPa.DO1071e",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "STREET",
            "type": "string",
            "display": "Offender Address 3",
            "legacyId": "DPa.DO1071f",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "LOCALITY",
            "type": "string",
            "display": "Offender Address 4",
            "legacyId": "DPa.DO10720",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "CITY_DESC",
            "type": "string",
            "display": "Offender Address 5",
            "legacyId": "DPa.DO10722",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "COUNTY_DESC",
            "type": "string",
            "display": "Offender Address 6",
            "legacyId": "DPa.DO10724",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "COUNTRY_DESC",
            "type": "string",
            "display": "Offender Address 7",
            "legacyId": "DPa.DO10726",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "POSTAL_CODE",
            "type": "string",
            "display": "Offender Address Post Code",
            "legacyId": "DPa.DO10727",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "FULL_OFFENDER_ADDRESS",
            "type": "string",
            "display": "Full Offender Address",
            "legacyId": "DPa.DO10756",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "HOME_TEL_NO",
            "type": "string",
            "display": "Offender Address Telephone Number",
            "legacyId": "DPa.DO1072a",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "HOME_EXT_NO",
            "type": "string",
            "display": "Offender Address Telephone Number Ext No",
            "legacyId": "DPa.DO1072b",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "OFFENDER_ADDRESS_ID",
            "type": "string",
            "display": "Offender Address ID",
            "legacyId": "DPa.DO10757",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "ADDR_TYPE_DESCRIPTION",
            "type": "string",
            "display": "Offender Address Type Description",
            "legacyId": "DPa.DO10759",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DPb",
      "name": "Movements",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_FACT_MOV_EXT.REASON, AT_FACT_MOV_EXT.TYPE, AT_DIM_DATE_EXT_MOV.DAY_DATE, AT_FACT_MOV_EXT.MOVEMENT_TIME, DT_EXT_MOVE_TO.TYPE_DESCRIPTION_TO, DT_EXT_MOVE_FROM.TYPE_DESCRIPTION_FROM FROM BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_TO, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_TO, 'Establishment' AS Location_Type_To FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_To FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_To FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_To FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_To FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_TO, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_FROM, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_FROM, 'Establishment' AS Location_Type_FROM FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_From FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_From FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_From FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_From FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_FROM, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_FACT_MOV_EXT.TO_LOCATION_SK = DT_EXT_MOVE_TO.SK_ID_TO (+) AND AT_FACT_MOV_EXT.TO_LOCATION_TYPE = DT_EXT_MOVE_TO.LOCATION_TYPE_TO (+)) AND (AT_FACT_MOV_EXT.FROM_LOCATION_SK = DT_EXT_MOVE_FROM.SK_ID_FROM (+) AND AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = DT_EXT_MOVE_FROM.LOCATION_TYPE_FROM (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT REASON, TYPE, DAY_DATE, MOVEMENT_TIME, TYPE_DESCRIPTION_TO, TYPE_DESCRIPTION_FROM FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "REASON",
            "type": "string",
            "display": "Movement Description (External)",
            "legacyId": "DPb.DO15b",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "TYPE",
            "type": "string",
            "display": "Movement Type (External)",
            "legacyId": "DPb.DO3ec",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DPb.DO15c",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Movement Date and Time (External)",
            "legacyId": "DPb.DO3eb",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "TYPE_DESCRIPTION_TO",
            "type": "string",
            "display": "Movement Description (To)",
            "legacyId": "DPb.DO6ff",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "TYPE_DESCRIPTION_FROM",
            "type": "string",
            "display": "Movement Description (From)",
            "legacyId": "DPb.DO700",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPf",
      "name": "Court Event Dates - Court Case Level",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT * AS NOMS_NUMBER FROM (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_COURT_CASE.COURT_CASE_SK, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION, MIN(DT_SPECIAL_COURT_EVENTS.first_sentenced_date), MIN(DT_SPECIAL_COURT_EVENTS.first_convicted_date), MIN(DT_SPECIAL_COURT_EVENTS.first_remand_date), MIN(DT_SPECIAL_COURT_EVENTS.first_committed_date), MIN(DT_SPECIAL_COURT_EVENTS.first_remand_court), MIN(DT_SPECIAL_COURT_EVENTS.first_convicted_court), MIN(DT_SPECIAL_COURT_EVENTS.first_sentenced_court), MIN(DT_SPECIAL_COURT_EVENTS.first_committed_court), MIN(DT_SPECIAL_COURT_EVENTS.second_remand_date), MIN(DT_SPECIAL_COURT_EVENTS.committed_to_court), MIN(DT_SPECIAL_COURT_EVENTS.first_appeal_court), MIN(DT_SPECIAL_COURT_EVENTS.first_appeal_date), MIN(DT_SPECIAL_COURT_EVENTS.first_bailed_court), MIN(DT_SPECIAL_COURT_EVENTS.first_appeal_result), MIN(DT_SPECIAL_COURT_EVENTS.first_bailed_date), MIN(DT_SPECIAL_COURT_EVENTS.first_sentenced_court), MIN(DT_SPECIAL_COURT_EVENTS.first_sentenced_date) FROM BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_REASON, (SELECT f.offender_booking_sk, f.court_case_sk, MIN(CASE WHEN f.outcome_key = 1 THEN f.event_date END) AS first_remand_date, MIN(CASE WHEN f.outcome_key = 1 THEN f.court_description END) AS first_remand_court, MIN(CASE WHEN f.outcome_key = 1 THEN f.outcome_reason_description END) AS first_remand_result, MIN(CASE WHEN f.outcome_key = 11 THEN f.event_date END) AS second_remand_date, MIN(CASE WHEN f.outcome_key = 11 THEN f.court_description END) AS second_remand_court, MIN(CASE WHEN f.outcome_key = 11 THEN f.outcome_reason_description END) AS second_remand_result, MIN(CASE WHEN f.outcome_key = 2 THEN f.event_date END) AS first_convicted_date, MIN(CASE WHEN f.outcome_key = 2 THEN f.court_description END) AS first_convicted_court, MIN(CASE WHEN f.outcome_key = 2 THEN f.outcome_reason_description END) AS first_convicted_result, MIN(CASE WHEN f.outcome_key = 3 THEN f.event_date END) AS first_sentenced_date, MIN(CASE WHEN f.outcome_key = 3 THEN f.court_description END) AS first_sentenced_court, MIN(CASE WHEN f.outcome_key = 3 THEN f.outcome_reason_description END) AS first_sentenced_result, MIN(CASE WHEN f.outcome_key = 4 THEN f.event_date END) AS first_committed_date, MIN(CASE WHEN f.outcome_key = 4 THEN f.court_description END) AS first_committed_court, MIN(CASE WHEN f.outcome_key = 4 THEN f.outcome_reason_description END) AS first_committed_result, MIN(CASE WHEN f.outcome_key = 4 THEN f.next_date END) AS committed_to_date, MIN(CASE WHEN f.outcome_key = 4 THEN f.next_court END) AS committed_to_court, MIN(CASE WHEN f.outcome_key = 4 THEN f.next_outcome END) AS committed_to_result, MIN(CASE WHEN f.outcome_key = 5 THEN f.event_date END) AS first_appeal_date, MIN(CASE WHEN f.outcome_key = 5 THEN f.court_description END) AS first_appeal_court, MIN(CASE WHEN f.outcome_key = 5 THEN f.outcome_reason_description END) AS first_appeal_result, MIN(CASE WHEN f.outcome_key = 6 THEN f.event_date END) AS first_bailed_date, MIN(CASE WHEN f.outcome_key = 6 THEN f.court_description END) AS first_bailed_court, MIN(CASE WHEN f.outcome_key = 6 THEN f.outcome_reason_description END) AS first_bailed_result FROM (SELECT row_seq, offender_booking_sk, court_case_sk, event_dt AS event_date, court_description, outcome_reason_description, next_date, next_court, next_outcome, CASE WHEN outcome_key = 1 AND row_seq = 2 THEN 11 ELSE outcome_key END AS outcome_key FROM (SELECT oc.*, fce.*, ROW_NUMBER() OVER (PARTITION BY fce.offender_booking_sk, oc.outcome_key, fce.court_case_sk ORDER BY fce.event_time, fce.court_event_nk) AS row_seq FROM (SELECT 1 AS outcome_key, 'Remand Outcome' AS outcome_type, outcome_code FROM ((SELECT '4011', '4012', '4013', '4014', '4015', '4016', '4017', '4020', '4021', '4506', '4529', '4530', '4531', '4532', '4533', '4534', '4535', '4536', '4537', '4538', '4539', '4541', '4542', '4543', '4548', '4549', '4550', '4551', '4552', '4558', '4559', '4560', '4561', '4562', '4563', '4564', '4565', '4587', '4588', '4589', '4504', '4511', '4512', '4513', '4514', '4515', '4516', '4519', '4520', '4521', '4522', '4523', '4524', '4540', '4578', '4579', '4580', '4581' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'4011'\", \"'4012'\", \"'4013'\", \"'4014'\", \"'4015'\", \"'4016'\", \"'4017'\", \"'4020'\", \"'4021'\", \"'4506'\", \"'4529'\", \"'4530'\", \"'4531'\", \"'4532'\", \"'4533'\", \"'4534'\", \"'4535'\", \"'4536'\", \"'4537'\", \"'4538'\", \"'4539'\", \"'4541'\", \"'4542'\", \"'4543'\", \"'4548'\", \"'4549'\", \"'4550'\", \"'4551'\", \"'4552'\", \"'4558'\", \"'4559'\", \"'4560'\", \"'4561'\", \"'4562'\", \"'4563'\", \"'4564'\", \"'4565'\", \"'4587'\", \"'4588'\", \"'4589'\", \"'4504'\", \"'4511'\", \"'4512'\", \"'4513'\", \"'4514'\", \"'4515'\", \"'4516'\", \"'4519'\", \"'4520'\", \"'4521'\", \"'4522'\", \"'4523'\", \"'4524'\", \"'4540'\", \"'4578'\", \"'4579'\", \"'4580'\", \"'4581'\"))) UNION ALL SELECT 2 AS outcome_key, 'Convicted Outcome' AS outcome_type, outcome_code FROM ((SELECT '1002', '1003', '1004', '1005', '1006', '1007', '1008', '1009', '1010', '1011', '1012', '1013', '1014', '1015', '1016', '1017', '1022', '1024', '1025', '1027', '1028', '1029', '1030', '1031', '1032', '1034', '1035', '1036', '1037', '1038', '1039', '1040', '1046', '1049', '1051', '1052', '1054', '1055', '1056', '1057', '1058', '1062', '1063', '1064', '1065', '1066', '1067', '1068', '1070', '1071', '1073', '1074', '1075', '1076', '1077', '1078', '1079', '1080', '1081', '1082', '1083', '1084', '1085', '1086', '1087', '1088', '1089', '1090', '1091', '1092', '1093', '1094', '1096', '1097', '1098', '1099', '1100', '1101', '1102', '1103', '1104', '1105', '1106', '1107', '1108', '1109', '1110', '1111', '1112', '1114', '1115', '1116', '1117', '1118', '1119', '1121', '1501', '1505', '1507', '1508', '1509', '1510', '1511', '1512', '1513', '1514', '2007', '2012', '2015', '2017', '2018', '2023', '2062', '2067', '2505', '3002', '3006', '3007', '3008', '3010', '3011', '3012', '3013', '3014', '3016', '3019', '3020', '3021', '3022', '3025', '3027', '3028', '3029', '3030', '3033', '3034', '3035', '3041', '3042', '3044', '3045', '3047', '3049', '3050', '3051', '3052', '3053', '3054', '3055', '3056', '3058', '3061', '3062', '3063', '3064', '3065', '3066', '3067', '3068', '3069', '3070', '3071', '3072', '3073', '3074', '3075', '3076', '3077', '3079', '3080', '3081', '3082', '3083', '3084', '3085', '3086', '3087', '3088', '3089', '3090', '3091', '3092', '3094', '3095', '3096', '3097', '3098', '3099', '3101', '3102', '3103', '3104', '3105', '3106', '3107', '3108', '3109', '3110', '3111', '3112', '3501', '3502', '3503', '3504', '3508', '3509', '3510', '3512', '4001', '4004', '4005', '4011', '4012', '4013', '4014', '4015', '4016', '4017', '4020', '4021', '4022', '4551', '4552', '4586', '4587', '4588', 'AC', 'FPR', 'G', '1001', '1026', '1043', '1044', '1047', '1050', '1059', '1060', '1061', '1069', '1072', '1503', '1506', '2021', '3001', '3003', '3004', '3005', '3009', '3015', '3017', '3031', '3032', '3036', '3037', '3038', '3039', '3040', '3043', '3046', '3048', '3057', '3059', '3060', '3078', '3093', '3513', '4019', '4511', '4512', '4519', '4520', '4521', '4525', '4527', '4578', '4579', '4580', '4581', '4591', '5001', '5002', '5003', '5004', '5005', '5006', '5008', '5009', '5010', '5012', '5013', '5014', '5015', '5016', '5017', '5018', '5019', '5020' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'1002'\", \"'1003'\", \"'1004'\", \"'1005'\", \"'1006'\", \"'1007'\", \"'1008'\", \"'1009'\", \"'1010'\", \"'1011'\", \"'1012'\", \"'1013'\", \"'1014'\", \"'1015'\", \"'1016'\", \"'1017'\", \"'1022'\", \"'1024'\", \"'1025'\", \"'1027'\", \"'1028'\", \"'1029'\", \"'1030'\", \"'1031'\", \"'1032'\", \"'1034'\", \"'1035'\", \"'1036'\", \"'1037'\", \"'1038'\", \"'1039'\", \"'1040'\", \"'1046'\", \"'1049'\", \"'1051'\", \"'1052'\", \"'1054'\", \"'1055'\", \"'1056'\", \"'1057'\", \"'1058'\", \"'1062'\", \"'1063'\", \"'1064'\", \"'1065'\", \"'1066'\", \"'1067'\", \"'1068'\", \"'1070'\", \"'1071'\", \"'1073'\", \"'1074'\", \"'1075'\", \"'1076'\", \"'1077'\", \"'1078'\", \"'1079'\", \"'1080'\", \"'1081'\", \"'1082'\", \"'1083'\", \"'1084'\", \"'1085'\", \"'1086'\", \"'1087'\", \"'1088'\", \"'1089'\", \"'1090'\", \"'1091'\", \"'1092'\", \"'1093'\", \"'1094'\", \"'1096'\", \"'1097'\", \"'1098'\", \"'1099'\", \"'1100'\", \"'1101'\", \"'1102'\", \"'1103'\", \"'1104'\", \"'1105'\", \"'1106'\", \"'1107'\", \"'1108'\", \"'1109'\", \"'1110'\", \"'1111'\", \"'1112'\", \"'1114'\", \"'1115'\", \"'1116'\", \"'1117'\", \"'1118'\", \"'1119'\", \"'1121'\", \"'1501'\", \"'1505'\", \"'1507'\", \"'1508'\", \"'1509'\", \"'1510'\", \"'1511'\", \"'1512'\", \"'1513'\", \"'1514'\", \"'2007'\", \"'2012'\", \"'2015'\", \"'2017'\", \"'2018'\", \"'2023'\", \"'2062'\", \"'2067'\", \"'2505'\", \"'3002'\", \"'3006'\", \"'3007'\", \"'3008'\", \"'3010'\", \"'3011'\", \"'3012'\", \"'3013'\", \"'3014'\", \"'3016'\", \"'3019'\", \"'3020'\", \"'3021'\", \"'3022'\", \"'3025'\", \"'3027'\", \"'3028'\", \"'3029'\", \"'3030'\", \"'3033'\", \"'3034'\", \"'3035'\", \"'3041'\", \"'3042'\", \"'3044'\", \"'3045'\", \"'3047'\", \"'3049'\", \"'3050'\", \"'3051'\", \"'3052'\", \"'3053'\", \"'3054'\", \"'3055'\", \"'3056'\", \"'3058'\", \"'3061'\", \"'3062'\", \"'3063'\", \"'3064'\", \"'3065'\", \"'3066'\", \"'3067'\", \"'3068'\", \"'3069'\", \"'3070'\", \"'3071'\", \"'3072'\", \"'3073'\", \"'3074'\", \"'3075'\", \"'3076'\", \"'3077'\", \"'3079'\", \"'3080'\", \"'3081'\", \"'3082'\", \"'3083'\", \"'3084'\", \"'3085'\", \"'3086'\", \"'3087'\", \"'3088'\", \"'3089'\", \"'3090'\", \"'3091'\", \"'3092'\", \"'3094'\", \"'3095'\", \"'3096'\", \"'3097'\", \"'3098'\", \"'3099'\", \"'3101'\", \"'3102'\", \"'3103'\", \"'3104'\", \"'3105'\", \"'3106'\", \"'3107'\", \"'3108'\", \"'3109'\", \"'3110'\", \"'3111'\", \"'3112'\", \"'3501'\", \"'3502'\", \"'3503'\", \"'3504'\", \"'3508'\", \"'3509'\", \"'3510'\", \"'3512'\", \"'4001'\", \"'4004'\", \"'4005'\", \"'4011'\", \"'4012'\", \"'4013'\", \"'4014'\", \"'4015'\", \"'4016'\", \"'4017'\", \"'4020'\", \"'4021'\", \"'4022'\", \"'4551'\", \"'4552'\", \"'4586'\", \"'4587'\", \"'4588'\", \"'AC'\", \"'FPR'\", \"'G'\", \"'1001'\", \"'1026'\", \"'1043'\", \"'1044'\", \"'1047'\", \"'1050'\", \"'1059'\", \"'1060'\", \"'1061'\", \"'1069'\", \"'1072'\", \"'1503'\", \"'1506'\", \"'2021'\", \"'3001'\", \"'3003'\", \"'3004'\", \"'3005'\", \"'3009'\", \"'3015'\", \"'3017'\", \"'3031'\", \"'3032'\", \"'3036'\", \"'3037'\", \"'3038'\", \"'3039'\", \"'3040'\", \"'3043'\", \"'3046'\", \"'3048'\", \"'3057'\", \"'3059'\", \"'3060'\", \"'3078'\", \"'3093'\", \"'3513'\", \"'4019'\", \"'4511'\", \"'4512'\", \"'4519'\", \"'4520'\", \"'4521'\", \"'4525'\", \"'4527'\", \"'4578'\", \"'4579'\", \"'4580'\", \"'4581'\", \"'4591'\", \"'5001'\", \"'5002'\", \"'5003'\", \"'5004'\", \"'5005'\", \"'5006'\", \"'5008'\", \"'5009'\", \"'5010'\", \"'5012'\", \"'5013'\", \"'5014'\", \"'5015'\", \"'5016'\", \"'5017'\", \"'5018'\", \"'5019'\", \"'5020'\"))) UNION ALL SELECT 3 AS outcome_key, 'Sentenced Outcome' AS outcome_type, outcome_code FROM ((SELECT '1002', '1003', '1022', '1024', '1073', '1081', '1105', '1106', '1107', '1110', '1111', '1112', '1114', '1121', '1509', '1510', '3006', '1001', '4503' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'1002'\", \"'1003'\", \"'1022'\", \"'1024'\", \"'1073'\", \"'1081'\", \"'1105'\", \"'1106'\", \"'1107'\", \"'1110'\", \"'1111'\", \"'1112'\", \"'1114'\", \"'1121'\", \"'1509'\", \"'1510'\", \"'3006'\", \"'1001'\", \"'4503'\"))) UNION ALL SELECT 4 AS outcome_key, 'Committed Outcome' AS outcome_type, outcome_code FROM ((SELECT '4001', '4014', '4015', '4016', '4017', '4020', '4021', '4558', '4559', '4560', '4561', '4562', '4563', '4564', '4565' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'4001'\", \"'4014'\", \"'4015'\", \"'4016'\", \"'4017'\", \"'4020'\", \"'4021'\", \"'4558'\", \"'4559'\", \"'4560'\", \"'4561'\", \"'4562'\", \"'4563'\", \"'4564'\", \"'4565'\"))) UNION ALL SELECT 5 AS outcome_key, 'Appeal Outcome' AS outcome_type, outcome_code FROM ((SELECT '1046', '3044', '3045', '4534', '3093', '3513' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'1046'\", \"'3044'\", \"'3045'\", \"'4534'\", \"'3093'\", \"'3513'\"))) UNION ALL SELECT 6 AS outcome_key, 'Bailed Outcome' AS outcome_type, outcome_code FROM ((SELECT '4011', '4013', '4014', '4015', '4017', '4529', '4530', '4533', '4552', '4558', '4559', '4561', '4587', '4589' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'4011'\", \"'4013'\", \"'4014'\", \"'4015'\", \"'4017'\", \"'4529'\", \"'4530'\", \"'4533'\", \"'4552'\", \"'4558'\", \"'4559'\", \"'4561'\", \"'4587'\", \"'4589'\")))) oc RIGHT OUTER JOIN (SELECT f.*, d.day_date AS event_dt, dc.court_description, dor.outcome_reason_description, LEAD(d.day_date) OVER (PARTITION BY f.offender_booking_sk, f.court_case_sk ORDER BY f.event_time, f.court_event_nk) AS next_date, LEAD(dc.court_description) OVER (PARTITION BY f.offender_booking_sk, f.court_case_sk ORDER BY f.event_time, f.court_event_nk) AS next_court, LEAD(dor.outcome_reason_description) OVER (PARTITION BY f.offender_booking_sk, f.court_case_sk ORDER BY f.event_time, f.court_event_nk) AS next_outcome FROM bodimis.fact_court_event f INNER JOIN bodimis.dim_date d ON f.event_date_sk = d.date_sk INNER JOIN bodimis.dim_court dc ON f.court_sk = dc.court_sk LEFT OUTER JOIN bodimis.dim_outcome_reason dor ON f.outcome = dor.outcome_reason_nk WHERE f.court_case_sk > 0) fce ON fce.outcome = oc.outcome_code) WHERE (row_seq = 1 OR (row_seq = 2 AND outcome_key = 1))) f GROUP BY f.offender_booking_sk, f.court_case_sk) DT_SPECIAL_COURT_EVENTS, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_COURT_CASE.OUTCOME_REASON_SK = AT_DIM_OUTCOME_REASON.OUTCOME_REASON_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = DT_SPECIAL_COURT_EVENTS.COURT_CASE_SK (+) AND AT_COURT_CASE.OFFENDER_BOOKING_SK = DT_SPECIAL_COURT_EVENTS.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active')) GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_COURT_CASE.COURT_CASE_SK, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION) _query0 FULL OUTER JOIN (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_COURT_CASE.COURT_CASE_SK, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION, MAX(CASE WHEN AT_EVENT_DATE.DAY_DATE < CURRENT_TIMESTAMP THEN AT_EVENT_DATE.DAY_DATE ELSE NULL END), MAX(CASE WHEN AT_EVENT_DATE.DAY_DATE >= CURRENT_TIMESTAMP THEN AT_EVENT_DATE.DAY_DATE ELSE NULL END) FROM BODIMIS.DIM_DATE AT_EVENT_DATE, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_REASON, BODIMIS.FACT_COURT_EVENT AT_FACT_COURT_EVENT, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_EVENT.EVENT_DATE_SK = AT_EVENT_DATE.DATE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_EVENT.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_COURT_CASE.OUTCOME_REASON_SK = AT_DIM_OUTCOME_REASON.OUTCOME_REASON_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active')) GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_COURT_CASE.COURT_CASE_SK, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION) _query1 ON _query0.OFFENDER_ID_DISPLAY = _query1.OFFENDER_ID_DISPLAY), dataset_ AS (SELECT NOMS_NUMBER FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "NOMS_NUMBER",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPf.DO10076",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP10",
      "name": "MIS Load",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP10.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375956/DP1f",
      "name": "Visit History",
      "description": "MIS Visits",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.FACT_OFFENDER_VISIT.OFFENDER_VISIT_ID, AT_VISIT_DATE.DAY_DATE, BODIMIS.FACT_OFFENDER_VISIT.VISIT_START_TIME, BODIMIS.FACT_OFFENDER_VISIT.VISIT_END_TIME, AT_VISIT_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION, AT_VISIT_TYPE.DESCRIPTION, AT_VISIT_STATUS.DESCRIPTION AS VISIT_STATUS_DESCRIPTION, AT_VISIT_OUTCOME.DESCRIPTION AS VISIT_OUTCOME_REASON_DESCRIP32, TRIM(CASE WHEN NOT AT_VISIT_OFFENDER_CONTACTS.title IS NULL THEN AT_VISIT_OFFENDER_CONTACTS.title || ' ' END || CASE WHEN NOT AT_VISIT_OFFENDER_CONTACTS.first_name IS NULL THEN AT_VISIT_OFFENDER_CONTACTS.first_name || ' ' END || CASE WHEN NOT AT_VISIT_OFFENDER_CONTACTS.middle_name IS NULL THEN AT_VISIT_OFFENDER_CONTACTS.middle_name || ' ' END || AT_VISIT_OFFENDER_CONTACTS.last_name) AS VISIT_VISITOR_NAME, AT_VISIT_OFFENDER_CONTACTS.TITLE, AT_VISIT_OFFENDER_CONTACTS.FIRST_NAME, AT_VISIT_OFFENDER_CONTACTS.MIDDLE_NAME, AT_VISIT_OFFENDER_CONTACTS.LAST_NAME, AT_VISIT_OFFENDER_CONTACTS.BIRTH_DATE, AT_VISIT_OFFENDER_CONTACTS.OFFENDER_ID_DISPLAY, BODIMIS.FACT_OFFENDER_VISIT.ATTENDED_FLAG, BODIMIS.FACT_OFFENDER_VISIT.GROUP_LEADER_FLAG, AT_VISIT_OFFENDER_CONTACTS.FLAT, AT_VISIT_OFFENDER_CONTACTS.PREMISE, AT_VISIT_OFFENDER_CONTACTS.STREET, AT_VISIT_OFFENDER_CONTACTS.CITY, AT_VISIT_OFFENDER_CONTACTS.COUNTY, AT_VISIT_OFFENDER_CONTACTS.COUNTRY, AT_VISIT_OFFENDER_CONTACTS.POST_CODE FROM BODIMIS.DIM_DATE AT_VISIT_DATE, BODIMIS.DIM_REFERENCE_CODES AT_VISIT_TYPE, BODIMIS.DIM_REFERENCE_CODES AT_VISIT_STATUS, BODIMIS.DIM_REFERENCE_CODES AT_VISIT_OUTCOME, BODIMIS.DIM_ESTABLISHMENT AT_VISIT_ESTABLISHMENT, BODIMIS.FACT_OFFENDER_VISIT, BODIMIS.DIM_OFFENDER_OTHER_CONTACTS AT_VISIT_OFFENDER_CONTACTS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.FACT_OFFENDER_VISIT.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_OFFENDER_VISIT.ESTABLISHMENT_SK = AT_VISIT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (BODIMIS.FACT_OFFENDER_VISIT.VISIT_DATE_SK = AT_VISIT_DATE.DATE_SK) AND (BODIMIS.FACT_OFFENDER_VISIT.OTHER_CONTACT_SK = AT_VISIT_OFFENDER_CONTACTS.OTHER_CONTACT_SK (+)) AND (AT_VISIT_TYPE.REFERENCE_CODE_SK = BODIMIS.FACT_OFFENDER_VISIT.VISIT_TYPE_SK) AND (AT_VISIT_STATUS.REFERENCE_CODE_SK = BODIMIS.FACT_OFFENDER_VISIT.VISIT_STATUS_SK) AND (AT_VISIT_OUTCOME.REFERENCE_CODE_SK = BODIMIS.FACT_OFFENDER_VISIT.OUTCOME_REASON_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #prompt('Enter NOMS Number','A',,Mono,Free,Not_Persistent,,User:0) */))), dataset_ AS (SELECT OFFENDER_VISIT_ID, DAY_DATE, VISIT_START_TIME, VISIT_END_TIME, ESTABLISHMENT_DESCRIPTION, DESCRIPTION, VISIT_STATUS_DESCRIPTION, VISIT_OUTCOME_REASON_DESCRIP32, VISIT_VISITOR_NAME, TITLE, FIRST_NAME, MIDDLE_NAME, LAST_NAME, BIRTH_DATE, OFFENDER_ID_DISPLAY, ATTENDED_FLAG, GROUP_LEADER_FLAG, FLAT, PREMISE, STREET, CITY, COUNTY, COUNTRY, POST_CODE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@prompt('Enter NOMS Number','A',,Mono,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_VISIT_ID",
            "type": "double",
            "display": "Visit ID",
            "legacyId": "DP1f.DO57c",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Visit Date",
            "legacyId": "DP1f.DO55d",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "VISIT_START_TIME",
            "type": "date",
            "display": "Visit Start Time",
            "legacyId": "DP1f.DO574",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "VISIT_END_TIME",
            "type": "date",
            "display": "Visit End Time",
            "legacyId": "DP1f.DO575",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Visit Establishment Name",
            "legacyId": "DP1f.DO55a",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Visit Type Description",
            "legacyId": "DP1f.DO561",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "VISIT_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Visit Status Description",
            "legacyId": "DP1f.DO563",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "VISIT_OUTCOME_REASON_DESCRIP32",
            "type": "string",
            "display": "Visit Outcome Reason Description",
            "legacyId": "DP1f.DO565",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "VISIT_VISITOR_NAME",
            "type": "string",
            "display": "Visit Visitor Name",
            "legacyId": "DP1f.DO568",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "TITLE",
            "type": "string",
            "display": "Visit Visitor Title",
            "legacyId": "DP1f.DO569",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Visit Visitor First Name",
            "legacyId": "DP1f.DO56a",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "MIDDLE_NAME",
            "type": "string",
            "display": "Visit Visitor Middle Name",
            "legacyId": "DP1f.DO56b",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "LAST_NAME",
            "type": "string",
            "display": "Visit Visitor Last Name",
            "legacyId": "DP1f.DO56c",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "BIRTH_DATE",
            "type": "date",
            "display": "Visit Visitor Birth Date",
            "legacyId": "DP1f.DO571",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "Visit Visitor NOMS Number",
            "legacyId": "DP1f.DO570",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "ATTENDED_FLAG",
            "type": "string",
            "display": "Visit Visitor Attended Flag",
            "legacyId": "DP1f.DO56f",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "GROUP_LEADER_FLAG",
            "type": "string",
            "display": "Visit Visitor Group Leader Flag",
            "legacyId": "DP1f.DO56d",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "FLAT",
            "type": "string",
            "display": "Flat",
            "legacyId": "DP1f.DO582",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "PREMISE",
            "type": "string",
            "display": "Premise",
            "legacyId": "DP1f.DO583",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "STREET",
            "type": "string",
            "display": "Street",
            "legacyId": "DP1f.DO584",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "CITY",
            "type": "string",
            "display": "City",
            "legacyId": "DP1f.DO58e",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "COUNTY",
            "type": "string",
            "display": "County",
            "legacyId": "DP1f.DO587",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "COUNTRY",
            "type": "string",
            "display": "Country",
            "legacyId": "DP1f.DO588",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "POST_CODE",
            "type": "string",
            "display": "Post Code",
            "legacyId": "DP1f.DO589",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375377/DP20",
      "name": "Adjudications",
      "description": "MIS Incidents",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DT_OFFENDER_ADJUDICATION.AGENCY_INCIDENT_ID_NK, DT_OFFENDER_ADJUDICATION.OIC_INCIDENT_ID, DT_OFFENDER_ADJUDICATION.OIC_HEARING_ID_NK, AT_ADJUDICATION_ESTAB.ESTABLISHMENT_CODE_NK, AT_ADJUDICATION_ESTAB.ESTABLISHMENT_DESCRIPTION, AT_DIM_OIC_OFFENCE_CHARGE.OIC_OFFENCE_CODE, AT_DIM_OIC_OFFENCE_CHARGE.DESCRIPTION, AT_DIM_DATE_CHARGE_LAID.DAY_DATE, DT_OFFENDER_ADJUDICATION.REPORT_DATE, AT_FACT_INCIDENT_CHARGE_RESULT.FINDING_CODE, AT_DIM_DATE_VERDICT.DAY_DATE AS VERDICT_DATE FROM BODIMIS.FACT_INCIDENT_CHARGE_RESULT AT_FACT_INCIDENT_CHARGE_RESULT, BODIMIS.DIM_ESTABLISHMENT AT_ADJUDICATION_ESTAB, BODIMIS.DIM_OIC_OFFENCE AT_DIM_OIC_OFFENCE_CHARGE, (SELECT a.oic_incident_id, c.offender_booking_sk, c.agency_incident_id_nk, c.charge_seq_nk, c.oic_offence_sk, a.oic_hearing_id_nk, a.party_seq_nk, a.establishment_sk, c.report_date, a.oic_hearing_type, a.notification_charge_date_sk FROM bodimis.fact_incident_charge c LEFT OUTER JOIN bodimis.fact_offender_adjudication a ON c.agency_incident_id_nk = a.agency_incident_id_nk AND c.offender_booking_sk = a.offender_booking_sk) DT_OFFENDER_ADJUDICATION, BODIMIS.DIM_DATE AT_DIM_DATE_CHARGE_LAID, BODIMIS.DIM_DATE AT_DIM_DATE_VERDICT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_DIM_DATE_CHARGE_LAID.DATE_SK (+) = DT_OFFENDER_ADJUDICATION.NOTIFICATION_CHARGE_DATE_SK) AND (AT_DIM_DATE_VERDICT.DATE_SK (+) = AT_FACT_INCIDENT_CHARGE_RESULT.DELIVERY_DATE_SK) AND (AT_DIM_OIC_OFFENCE_CHARGE.OIC_OFFENCE_SK = DT_OFFENDER_ADJUDICATION.OIC_OFFENCE_SK) AND (DT_OFFENDER_ADJUDICATION.OFFENDER_BOOKING_SK = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_ADJUDICATION_ESTAB.ESTABLISHMENT_SK (+) = DT_OFFENDER_ADJUDICATION.ESTABLISHMENT_SK) AND (DT_OFFENDER_ADJUDICATION.AGENCY_INCIDENT_ID_NK = AT_FACT_INCIDENT_CHARGE_RESULT.AGENCY_INCIDENT_ID (+) AND DT_OFFENDER_ADJUDICATION.OIC_HEARING_ID_NK = AT_FACT_INCIDENT_CHARGE_RESULT.OIC_HEARING_ID_NK (+) AND DT_OFFENDER_ADJUDICATION.OFFENDER_BOOKING_SK = AT_FACT_INCIDENT_CHARGE_RESULT.OFFENDER_BOOKING_SK (+) AND DT_OFFENDER_ADJUDICATION.CHARGE_SEQ_NK = AT_FACT_INCIDENT_CHARGE_RESULT.CHARGE_SEQ (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT AGENCY_INCIDENT_ID_NK, OIC_INCIDENT_ID, OIC_HEARING_ID_NK, ESTABLISHMENT_CODE_NK, ESTABLISHMENT_DESCRIPTION, OIC_OFFENCE_CODE, DESCRIPTION, DAY_DATE, REPORT_DATE, FINDING_CODE, VERDICT_DATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "AGENCY_INCIDENT_ID_NK",
            "type": "double",
            "display": "Agency Incident ID",
            "legacyId": "DP20.DO759",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OIC_INCIDENT_ID",
            "type": "double",
            "display": "OIC Incident ID",
            "legacyId": "DP20.DO75a",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OIC_HEARING_ID_NK",
            "type": "double",
            "display": "OIC Hearing ID",
            "legacyId": "DP20.DO758",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Adjudication Establishment Code",
            "legacyId": "DP20.DO6c1",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Adjudication Establishment Name",
            "legacyId": "DP20.DO6c2",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "OIC_OFFENCE_CODE",
            "type": "string",
            "display": "Charge Code",
            "legacyId": "DP20.DO282",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Charge Description",
            "legacyId": "DP20.DO26d",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Charge Laid Date",
            "legacyId": "DP20.DO280",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "REPORT_DATE",
            "type": "date",
            "display": "Incident Reported Date",
            "legacyId": "DP20.DO751",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "FINDING_CODE",
            "type": "string",
            "display": "Hearing Finding",
            "legacyId": "DP20.DO26e",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "VERDICT_DATE",
            "type": "date",
            "display": "Verdict Date",
            "legacyId": "DP20.DO281",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "206480.RS",
      "name": "Front Sheet",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      }
    },
    {
      "id": "207205.RS",
      "name": "Personal Details",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP5",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE SENTENCE_DATES_CURRENT_FLAG = 'Y')"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:ALERT_CODE_NK",
            "display": "Alert Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP6.DO8e"
          },
          {
            "name": "$ref:ALERT_DESCRIPTION_ONLY",
            "display": "Alert Description Only",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP6.DO764"
          },
          {
            "name": "$ref:ALERT_STATUS",
            "display": "Alert Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP6.DO94"
          },
          {
            "name": "$ref:ALERT_EXPIRY_DATE",
            "display": "Alert Expiry Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP6.DO96"
          }
        ]
      }
    },
    {
      "id": "205086.RS",
      "name": "Court Cases",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DPf",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-section",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOdf"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "147976.RS",
      "name": "Sentencing",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP5",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-section",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOdf"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "203603.RS",
      "name": "Addresses",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DPa",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOdf"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "208465.RS",
      "name": "Adjudications",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:AGENCY_INCIDENT_ID_NK",
            "display": "Agency Incident ID",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP20.DO759"
          },
          {
            "name": "$ref:REPORT_DATE",
            "display": "Incident Reported Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP20.DO751"
          },
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Adjudication Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP20.DO6c1"
          },
          {
            "name": "$ref:OIC_OFFENCE_CODE",
            "display": "Charge Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP20.DO282"
          },
          {
            "name": "$ref:DESCRIPTION",
            "display": "Charge Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP20.DO26d"
          },
          {
            "name": "$ref:FINDING_CODE",
            "display": "Hearing Finding",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP20.DO26e"
          },
          {
            "name": "$ref:VERDICT_DATE",
            "display": "Verdict Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP20.DO281"
          }
        ]
      }
    },
    {
      "id": "207453.RS",
      "name": "Movements",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DPb",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOdf"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "208103.RS",
      "name": "Visits",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375956/DP1f",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-section",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOdf"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "schema",
      "error": "instance.report[0] requires property \"dataset\"",
      "entityId": "olKnRO0ABTn7aqsAQAGD8K.FoJY",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report Variant 206480.RS does not have corresponding dataset undefined",
      "entityId": "206480.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field ALERT_CODE_NK does not have corresponding dataset schema field",
      "entityId": "207205.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field ALERT_DESCRIPTION_ONLY does not have corresponding dataset schema field",
      "entityId": "207205.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field ALERT_STATUS does not have corresponding dataset schema field",
      "entityId": "207205.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field ALERT_EXPIRY_DATE does not have corresponding dataset schema field",
      "entityId": "207205.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OFFENDER_ID_DISPLAY does not have corresponding dataset schema field",
      "entityId": "205086.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "205086.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "205086.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "205086.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "205086.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "205086.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OFFENDER_ID_DISPLAY does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OFFENDER_ID_DISPLAY does not have corresponding dataset schema field",
      "entityId": "203603.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "203603.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "203603.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "203603.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "203603.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "203603.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field AGENCY_INCIDENT_ID_NK does not have corresponding dataset schema field",
      "entityId": "208465.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field REPORT_DATE does not have corresponding dataset schema field",
      "entityId": "208465.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field ESTABLISHMENT_CODE_NK does not have corresponding dataset schema field",
      "entityId": "208465.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OIC_OFFENCE_CODE does not have corresponding dataset schema field",
      "entityId": "208465.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "208465.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field FINDING_CODE does not have corresponding dataset schema field",
      "entityId": "208465.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field VERDICT_DATE does not have corresponding dataset schema field",
      "entityId": "208465.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OFFENDER_ID_DISPLAY does not have corresponding dataset schema field",
      "entityId": "207453.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "207453.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "207453.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "207453.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "207453.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "207453.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "208103.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "208103.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "208103.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "208103.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "208103.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DPa",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DPf",
      "entityType": "dataset"
    }
  ]
}