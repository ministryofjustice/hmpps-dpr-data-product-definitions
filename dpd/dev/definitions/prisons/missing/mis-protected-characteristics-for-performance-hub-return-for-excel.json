{
  "id": "FtZ7yGBR0wAAANkAAHA7sF4LACJIAFe4",
  "name": "MIS Protected Characteristics for Performance Hub Return For Excel",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "PDD0116 - Protected Characteristics"
    ]
  },
  "description": "Provides a percentage breakdown of Age, Religion, Sexual Orientation, Disability and Ethnicity across an establishment chosen at runtime. The purpose and formatting of the report have been designed to be able to easily send statistics to the PPAS team for inclusion on the performance hub on a weekly basis. <br/>PDD0116 - v00.00.02 Last Modified 24/06/2021",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3376639/DPb",
      "name": "Characteristics",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.MARITAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.MATERNITY_STATUS_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.GENDER_CODE, AT_OFFENDER_BOOKING.GENDER_DESCRIPTION, CASE WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'Chinese' THEN 'Asian/Asian British: Chinese' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION = 'White : Irish Traveller/Gypsy' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.DESCRIPTION IS NULL THEN 'Code Missing' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_GROUP, AT_OFFENDER_BOOKING.SEXUAL_ORIENTATION_CODE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, MARITAL_STATUS_DESCRIPTION, MATERNITY_STATUS_DESCRIPTION, RELIGION_DESCRIPTION, SEX_ORIENTATION_DESCRIPTION, SURNAME, FIRST_NAME, ESTABLISHMENT_CODE_NK, ESTABLISHMENT_DESCRIPTION, OFFENDER_AGE, GENDER_CODE, GENDER_DESCRIPTION, ETHNIC_GROUP, SEXUAL_ORIENTATION_CODE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPb.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "MARITAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Marital Status Description",
            "legacyId": "DPb.DOaf",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "MATERNITY_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Maternity Status",
            "legacyId": "DPb.DOb0",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DPb.DOb3",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "SEX_ORIENTATION_DESCRIPTION",
            "type": "string",
            "display": "Sexual Orientation Description",
            "legacyId": "DPb.DO970",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DPb.DO7b",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DPb.DO80",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Associated Establishment Code",
            "legacyId": "DPb.DO7b2",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Associated Establishment Name",
            "legacyId": "DPb.DO7b1",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DPb.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "GENDER_CODE",
            "type": "string",
            "display": "Gender Code",
            "legacyId": "DPb.DOa8",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "GENDER_DESCRIPTION",
            "type": "string",
            "display": "Gender Description",
            "legacyId": "DPb.DOa9",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "ETHNIC_GROUP",
            "type": "string",
            "display": "Ethnic Group",
            "legacyId": "DPb.DO9c",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "SEXUAL_ORIENTATION_CODE",
            "type": "string",
            "display": "Sexual Orientation Code",
            "legacyId": "DPb.DO96f",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP9",
      "name": "MIS load",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP9.DO4dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DPd",
      "name": "Disability",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END AS DISABILITY_ACTIVE_FLAG, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE_DESCRIPTION, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE_DESCRIPTION, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS_DESCRIPTION FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_PERSONAL_CARE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_PERSONAL_CARE.OFFENDER_BOOKING_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END IN ('Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, DISABILITY_ACTIVE_FLAG, TYPE_DESCRIPTION, CODE_DESCRIPTION, STATUS_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPd.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DISABILITY_ACTIVE_FLAG",
            "type": "string",
            "display": "Disability Active Flag",
            "legacyId": "DPd.DOa9d",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "TYPE_DESCRIPTION",
            "type": "string",
            "display": "Care Type Description",
            "legacyId": "DPd.DO97b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CODE_DESCRIPTION",
            "type": "string",
            "display": "Care Code Description",
            "legacyId": "DPd.DO97d",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "STATUS_DESCRIPTION",
            "type": "string",
            "display": "Care Status Description",
            "legacyId": "DPd.DO97f",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP10",
      "name": "No Disability",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END AS DISABILITY_ACTIVE_FLAG, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE_DESCRIPTION, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE_DESCRIPTION, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS_DESCRIPTION FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_PERSONAL_CARE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_PERSONAL_CARE.OFFENDER_BOOKING_SK (+)) AND (NOT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A5485AC', 'A6949AR', 'A7842AG', 'A5260AK', 'A8838DY', 'A8854CD', 'A6344ED', 'A1602EK', 'A2865AL', 'A3642DL', 'A4244CC', 'A9373AA', 'A5307CP', 'A8698AK', 'A1997DJ', 'A3276ED', 'A9886DE', 'A7287AN', 'A4186DZ', 'A2378EC', 'A6448AV', 'A1384AK', 'A3173DJ', 'A6856EP', 'A7119CE', 'A6760AN', 'A7222AD', 'A4425EL', 'A3884CE', 'A4259AA', 'A2578AK', 'A4849CE', 'A5685AH', 'A6950AG', 'A0490DW', 'A7482AP', 'A1487CE', 'A5362AR', 'A6747AM', 'A4938EL', 'A2282EG', 'A6248AA', 'A8863DR', 'A2171AL', 'A0047EG', 'A3515AG', 'A4361AC', 'A5000DV', 'A3235AL', 'A2804CV', 'A0786EN', 'A1992AA', 'A6810EF', 'A2266DY', 'A7298DW', 'A5396DY', 'A0591EQ', 'A7958CF', 'A0560AX', 'A9524EM', 'A5813AY', 'A8519CA', 'A1579CV', 'A4299EP', 'A1854AM', 'A3321DY', 'A4186EC', 'A5534AN', 'A8265EA', 'A4666AQ', 'A5949EK', 'A5315AR', 'A2949AL', 'A3560DX', 'A6625EP', 'A7343DV', 'A9737EF', 'A8884CA', 'A1319AM', 'A6861DV', 'A3733AV', 'A1143AM', 'A2678ED', 'A5089AW', 'A4964AD', 'A8106CY', 'A8884AY', 'A1439CR', 'A2753EP', 'A1674EC', 'A7283AM', 'A7695EK', 'A0986EQ', 'A6591ED', 'A2155AQ', 'A3007AD') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'NR'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, DISABILITY_ACTIVE_FLAG, TYPE_DESCRIPTION, CODE_DESCRIPTION, STATUS_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP10.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DISABILITY_ACTIVE_FLAG",
            "type": "string",
            "display": "Disability Active Flag",
            "legacyId": "DP10.DOa9d",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "TYPE_DESCRIPTION",
            "type": "string",
            "display": "Care Type Description",
            "legacyId": "DP10.DO97b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CODE_DESCRIPTION",
            "type": "string",
            "display": "Care Code Description",
            "legacyId": "DP10.DO97d",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "STATUS_DESCRIPTION",
            "type": "string",
            "display": "Care Status Description",
            "legacyId": "DP10.DO97f",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP11",
      "name": "Disability Other",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END AS DISABILITY_ACTIVE_FLAG, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE_DESCRIPTION, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE_DESCRIPTION, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS_DESCRIPTION FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_PERSONAL_CARE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_PERSONAL_CARE.OFFENDER_BOOKING_SK (+)) AND (NOT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A5485AC', 'A6949AR', 'A7842AG', 'A5260AK', 'A8838DY', 'A8854CD', 'A6344ED', 'A1602EK', 'A2865AL', 'A3642DL', 'A4244CC', 'A9373AA', 'A5307CP', 'A8698AK', 'A1997DJ', 'A3276ED', 'A9886DE', 'A7287AN', 'A4186DZ', 'A2378EC', 'A6448AV', 'A1384AK', 'A3173DJ', 'A6856EP', 'A7119CE', 'A6760AN', 'A7222AD', 'A4425EL', 'A3884CE', 'A4259AA', 'A2578AK', 'A4849CE', 'A5685AH', 'A6950AG', 'A0490DW', 'A7482AP', 'A1487CE', 'A5362AR', 'A6747AM', 'A4938EL', 'A2282EG', 'A6248AA', 'A8863DR', 'A2171AL', 'A0047EG', 'A3515AG', 'A4361AC', 'A5000DV', 'A3235AL', 'A2804CV', 'A0786EN', 'A1992AA', 'A6810EF', 'A2266DY', 'A7298DW', 'A5396DY', 'A0591EQ', 'A7958CF', 'A0560AX', 'A9524EM', 'A5813AY', 'A8519CA', 'A1579CV', 'A4299EP', 'A1854AM', 'A3321DY', 'A4186EC', 'A5534AN', 'A8265EA', 'A4666AQ', 'A5949EK', 'A5315AR', 'A2949AL', 'A3560DX', 'A6625EP', 'A7343DV', 'A9737EF', 'A8884CA', 'A1319AM', 'A6861DV', 'A3733AV', 'A1143AM', 'A2678ED', 'A5089AW', 'A4964AD', 'A8106CY', 'A8884AY', 'A1439CR', 'A2753EP', 'A1674EC', 'A7283AM', 'A7695EK', 'A0986EQ', 'A6591ED', 'A2155AQ', 'A3007AD') AND NOT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A9654AR', 'A0164DM', 'A5282AC', 'A1476DX', 'A5555AP', 'A8139DD', 'A7128CF', 'A0125DM', 'A5186DY', 'A0837CY', 'A5998CW', 'A7097CW', 'A2300CT', 'A0687DR', 'A3380DR', 'A0215EL', 'A7443CA', 'A0093AW', 'A6391DZ', 'A3833EE', 'A8957EC', 'A0729DW', 'A0894CW', 'A2716AD', 'A7804EN', 'A0999AA', 'A3530CP', 'A7935AN', 'A7547AY', 'A9780EA', 'A7906DQ', 'A8319CD', 'A9318DV', 'A7361AC', 'A3668AD', 'A6759DW', 'A4181AD', 'A0092AR', 'A4514DP', 'A3233EL', 'A7534AV', 'A1836DH', 'A6313CV', 'A4893DF', 'A4360CF', 'A2605DZ', 'A6486EL', 'A4345AQ', 'A5116EK', 'A5950AW', 'A7201AN', 'A2885AE', 'A2775EE', 'A1929AJ', 'A8669DR', 'A6309CT', 'A8449DZ', 'A5238DR', 'A9969AQ', 'A0896DL', 'A9621DL', 'A8202EP', 'A2314EQ', 'A4686EN', 'A7042EP', 'A6858AV', 'A2599EC', 'A6461CM', 'A8525EN', 'A5615AQ', 'A1678EN', 'A0385EG', 'A1284EH', 'A3872AW', 'A4759DC', 'A1447CR', 'A2543AY', 'A0669DL', 'A9390EK', 'A6756CX', 'A0395EN', 'A2866EM', 'A4549EL', 'A6981DT', 'A6143DX', 'A0223EF', 'A9157CG', 'A8193DP', 'A4758EE', 'A5420EH', 'A6892CN', 'A2963EN', 'A6601EH', 'A0673EK', 'A7749EG', 'A4737EJ', 'A2335AM', 'A5014EN', 'A6191DC', 'A3017EK', 'A5423EH', 'A5919AA', 'A5095DQ', 'A2860AY', 'A1551EJ', 'A2163AY', 'A6182AP', 'A9463AK', 'A3127EG', 'A8627AC', 'A5642EJ', 'A1956DV', 'A7318ED', 'A3418EF', 'A8203EN', 'A6768AC', 'A0958DJ', 'A6821AD', 'A8198EN', 'A1877EN', 'A6366EK', 'A4637EM', 'A8150DA', 'A5615CR', 'A0274EM', 'A6478EF', 'A2144EK', 'A4690AQ', 'A5732AK', 'A6247CF', 'A5745EM', 'A9267EP', 'A0769CX', 'A1817EK', 'A5388DR', 'A8047DW', 'A9243EH', 'A6987EM', 'A8199EN', 'A3112EM', 'A8202EN', 'A8404EN', 'A0562DQ', 'A2561EF', 'A1179EN', 'A8201EN', 'A5235EL', 'A5408EM', 'A5041DA', 'A0775EN', 'A3377EL', 'A2349AM', 'A4106AV', 'A8813EK', 'A1391AK', 'A2175EN', 'A5283EM', 'A2534EF', 'A3481DP', 'A3910DZ', 'A0808EF', 'A4575CF', 'A3408CR', 'A7253CX', 'A7789EF', 'A6971DN', 'A3641EK', 'A7308CG', 'A6477DN', 'A2211EL', 'A1714EC', 'A3879CK', 'A2116EQ', 'A2897DK', 'A4552EL', 'A2796EN', 'A7040EJ', 'A6558EN', 'A3451EE', 'A2924AA', 'A9022EL', 'A1363DW', 'A6779AK', 'A9366EN', 'A9368EN', 'A3861AQ', 'A5165CE', 'A2516AT', 'A0776EN', 'A5924DY', 'A0263AP', 'A2998CE', 'A9587DY', 'A6625CF', 'A1691CN', 'A2306EL', 'A6179DD', 'A2713DJ', 'A3488EM', 'A2989CY', 'A9901EJ', 'A9086AQ', 'A4445CC', 'A5642CW', 'A1572AM', 'A7946CM', 'A5747CD', 'A1497CJ', 'A6581EP', 'A3026EP', 'A1531AD', 'A3959AA', 'A6210DM', 'A8304AG', 'A9064AE', 'A2162EN', 'A1751AD', 'A5567EP', 'A7779EG', 'A2040AA', 'A6103EK', 'A5966AH', 'A1230DD', 'A7784DH', 'A2900DE', 'A0512EP', 'A5480CA', 'A9606AQ', 'A2797CW', 'A8561AC', 'A6448EN', 'A0724DN', 'A7410CA', 'A2224AY', 'A7863AX', 'A0036EF', 'A6223DZ', 'A3013AD', 'A1619CY', 'A5364EM', 'A5574ED', 'A2181AD', 'A2445CH', 'A0013AV', 'A7027EN', 'A4425CP', 'A4591EP', 'A5004EN', 'A7149AC', 'A1346EJ', 'A5772DR', 'A7940CM', 'A5338DP', 'A2088AL', 'A5859AD', 'A5063DY', 'A5914DV', 'A2298AV', 'A1755EM', 'A0849AM', 'A9560AQ', 'A8184AX', 'A7377DY', 'A3225AL', 'A5940EF', 'A1647CY', 'A6042EP', 'A3658EA', 'A0519EA', 'A6414DC', 'A5494EK', 'A3512AM', 'A7047EP', 'A8357AQ', 'A1548EE', 'A8199EP', 'A8200EP', 'A4474EJ', 'A0765EP', 'A5377DQ', 'A2669CR', 'A4577EP', 'A7389DA', 'A6582EP', 'A5934DP', 'A4741DL', 'A5220DZ', 'A4094AG', 'A0393CG', 'A4803AL', 'A1349CG', 'A5237AY', 'A5373CA', 'A4462EQ', 'A4141EL', 'A2519EQ', 'A7497AG', 'A5194EL', 'A5111AY', 'A9374EN', 'A6345AP', 'A3738DJ', 'A0795DW', 'A3776EJ', 'A2598EN', 'A7389EA', 'A2096DP', 'A4336AM', 'A9821DG', 'A7689DX', 'A4419DJ', 'A5023AZ', 'A2834EC', 'A7782AM', 'A8482AX', 'A6640AL', 'A6327AY', 'A7741EJ', 'A4502AZ', 'A1852CH', 'A9640DC', 'A2850CE', 'A1015CC', 'A1357ED', 'A3948CX', 'A0650DG', 'A4233EA', 'A3788AY', 'A8491DM') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, DISABILITY_ACTIVE_FLAG, TYPE_DESCRIPTION, CODE_DESCRIPTION, STATUS_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP11.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DISABILITY_ACTIVE_FLAG",
            "type": "string",
            "display": "Disability Active Flag",
            "legacyId": "DP11.DOa9d",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "TYPE_DESCRIPTION",
            "type": "string",
            "display": "Care Type Description",
            "legacyId": "DP11.DO97b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CODE_DESCRIPTION",
            "type": "string",
            "display": "Care Code Description",
            "legacyId": "DP11.DO97d",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "STATUS_DESCRIPTION",
            "type": "string",
            "display": "Care Status Description",
            "legacyId": "DP11.DO97f",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "137134.RS",
      "name": "Stats",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      },
      "dataset": "MISSING"
    }
  ],
  "errors": [
    {
      "type": "schema",
      "error": "instance.report[0] requires property \"dataset\"",
      "entityId": "FtZ7yGBR0wAAANkAAHA7sF4LACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report Variant 137134.RS does not have corresponding dataset undefined",
      "entityId": "137134.RS",
      "entityType": "variant"
    }
  ]
}