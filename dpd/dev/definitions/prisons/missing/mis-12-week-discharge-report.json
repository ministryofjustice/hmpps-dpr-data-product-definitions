{
  "id": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
  "name": "MIS 12 Week Discharge Report",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "SEN0034 v00.00.02",
      "Release",
      "DV",
      "NFR",
      "Education"
    ]
  },
  "description": "The report displays those Prisoners in their final 12 weeks of custody, along with their Sentence Length, HDCED, HDCAD, Release date, NFR Marker, Domestic Violence Perpetrator and Current Education levels. Also displays those Prisoners who are scheduled for transfer prior to release.  The report is to enable establishments to engage and prepare those Prisoners for release.<br/><br/>SEN0034 - v00.00.02 Last Modified: 28/09/2018",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP2",
      "name": "Prisoners",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION, CASE WHEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END AS RELEASE_DATE_, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, FACT_CURR_KEY_DATES_SENT.CURR_HDCAD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH END AS EFFECTIVE_SENTENCE_LENGTH FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, (SELECT AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK AS OFFENDER_BOOKING_SK, CASE WHEN AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' THEN AT_RELEASE_DATE.DAY_DATE END AS CURR_RELEASE_DATE FROM BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE WHERE AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK = AT_RELEASE_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y' /* and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' */) DT_CURRENT_RELEASE_DATE, FACT_CURR_KEY_DATES_SENT, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND NOT CASE WHEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END IS NULL)), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, DATE_OF_BIRTH, UNIT_4_SHORT_DESCRIPTION, ESTABLISHMENT_DESCRIPTION, RELEASE_DATE_, MAIN_LEGAL_STATUS_CODE, CURR_HDCAD_DATE, CURR_HDCED_DATE, EFFECTIVE_SENTENCE_LENGTH, CASE WHEN V_COUNT_CA > 1 THEN 'MULTI ENTRIES - CHECK RECORD' ELSE V_CASE_ADMIN END AS V_CASE_ADMIN_DISPLAY, CASE WHEN V_SCHEDULED_TX_DATE IS NULL THEN '-' ELSE V_SCHEDULED_TX_DATE END AS V_SCHEDULED_TX_DATE_DISPLAY, CASE WHEN V_SCHEDULED_TX_DEST IS NULL THEN '-' ELSE V_SCHEDULED_TX_DEST END AS V_SCHEDULED_TX_DEST_DISPLAY, 'TBD' AS V_NFR, 'TBD' AS V_DV_PERP, EDUCATION_STUDY_AREA_DESC AS V_EDUCATION_STUDY_AREA, DESCRIPTION AS V_EDUCATION_LEVEL, COMMENT_TEXT AS V_EDUCATION_COMMENT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP2.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP2.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP2.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP2.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Associated Establishment Name",
            "legacyId": "DP2.DO107b1",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "RELEASE_DATE_",
            "type": "date",
            "display": "Release Date (Current)",
            "legacyId": "DP2.DO565",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "MAIN_LEGAL_STATUS_CODE",
            "type": "string",
            "display": "Main Legal Status Code",
            "legacyId": "DP2.DO100de",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "CURR_HDCAD_DATE",
            "type": "date",
            "display": "HDC AD (Approved Date)",
            "legacyId": "DP2.DO97",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "CURR_HDCED_DATE",
            "type": "date",
            "display": "HDC Eligibility Date",
            "legacyId": "DP2.DO70",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "EFFECTIVE_SENTENCE_LENGTH",
            "type": "string",
            "display": "Effective Sentence Length",
            "legacyId": "DP2.DO2d0",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "V_CASE_ADMIN_DISPLAY",
            "type": "string",
            "display": "V_CASE_ADMIN_DISPLAY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 12,
            "name": "V_SCHEDULED_TX_DATE_DISPLAY",
            "type": "string",
            "display": "V_SCHEDULED_TX_DATE_DISPLAY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 13,
            "name": "V_SCHEDULED_TX_DEST_DISPLAY",
            "type": "string",
            "display": "V_SCHEDULED_TX_DEST_DISPLAY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 14,
            "name": "V_NFR",
            "type": "string",
            "display": "V_NFR",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 15,
            "name": "V_DV_PERP",
            "type": "string",
            "display": "V_DV_PERP",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 16,
            "name": "V_EDUCATION_STUDY_AREA",
            "type": "string",
            "display": "V_EDUCATION_STUDY_AREA",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 17,
            "name": "V_EDUCATION_LEVEL",
            "type": "string",
            "display": "V_EDUCATION_LEVEL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 18,
            "name": "V_EDUCATION_COMMENT",
            "type": "string",
            "display": "V_EDUCATION_COMMENT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP4",
      "name": "Education",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_EDUCATION_LEVEL.CODE, AT_EDUCATION_LEVEL.DESCRIPTION, AT_EDUCATION_STUDY_AREA.DESCRIPTION AS EDUCATION_STUDY_AREA_DESC, BODIMIS.DIM_OFFENDER_EDUCATION.COMMENT_TEXT FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_REFERENCE_CODES AT_EDUCATION_LEVEL, BODIMIS.DIM_REFERENCE_CODES AT_EDUCATION_STUDY_AREA, BODIMIS.DIM_OFFENDER_EDUCATION, (SELECT AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK AS OFFENDER_BOOKING_SK, CASE WHEN AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' THEN AT_RELEASE_DATE.DAY_DATE END AS CURR_RELEASE_DATE FROM BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE WHERE AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK = AT_RELEASE_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y' /* and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' */) DT_CURRENT_RELEASE_DATE, FACT_CURR_KEY_DATES_SENT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_EDUCATION.OFFENDER_BOOKING_SK (+)) AND (BODIMIS.DIM_OFFENDER_EDUCATION.STUDY_AREA_SK = AT_EDUCATION_STUDY_AREA.REFERENCE_CODE_SK) AND (BODIMIS.DIM_OFFENDER_EDUCATION.EDUCATION_LEVEL_SK = AT_EDUCATION_LEVEL.REFERENCE_CODE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND NOT CASE WHEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END IS NULL)), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, CODE, DESCRIPTION, EDUCATION_STUDY_AREA_DESC, COMMENT_TEXT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP4.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "CODE",
            "type": "string",
            "display": "Education Level Code",
            "legacyId": "DP4.DO606",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Education Level Desc",
            "legacyId": "DP4.DO607",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "EDUCATION_STUDY_AREA_DESC",
            "type": "string",
            "display": "Education Study Area Desc",
            "legacyId": "DP4.DO605",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Education Comment Text",
            "legacyId": "DP4.DO60c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP5",
      "name": "Alerts",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, (SELECT AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK AS OFFENDER_BOOKING_SK, CASE WHEN AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' THEN AT_RELEASE_DATE.DAY_DATE END AS CURR_RELEASE_DATE FROM BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE WHERE AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK = AT_RELEASE_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y' /* and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' */) DT_CURRENT_RELEASE_DATE, FACT_CURR_KEY_DATES_SENT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_ALERT.ALERT_CODE_NK IN ('RDV', 'XNR') AND (AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND NOT CASE WHEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END IS NULL)), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP5.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP5.DO1008e",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP6",
      "name": "Transfers",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_SCHED_EXT_MOVE_TO.ESTABLISHMENT_CODE_NK, AT_OFF_SCH_DATE.DAY_DATE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ESTABLISHMENT AT_SCHED_EXT_MOVE_TO, BODIMIS.DIM_DATE AT_OFF_SCH_DATE, BODIMIS.FACT_OFFENDER_SCHEDULE AT_OFFENDER_SCHEDULE, (SELECT AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK AS OFFENDER_BOOKING_SK, CASE WHEN AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' THEN AT_RELEASE_DATE.DAY_DATE END AS CURR_RELEASE_DATE FROM BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE WHERE AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK = AT_RELEASE_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y' /* and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' */) DT_CURRENT_RELEASE_DATE, FACT_CURR_KEY_DATES_SENT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_SCHEDULE.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_SCHEDULE.DATE_SK = AT_OFF_SCH_DATE.DATE_SK) AND (AT_OFFENDER_SCHEDULE.TO_LOCATION_SK = AT_SCHED_EXT_MOVE_TO.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_SCHEDULE.OUTCOME = ('Scheduled (Approved)')) AND AT_OFFENDER_SCHEDULE.WAIT_LIST_APPROVED_FLAG = 'Y' AND AT_OFFENDER_SCHEDULE.DIRECTION_CODE = 'OUT' AND AT_OFFENDER_SCHEDULE.EVENT_TYPE = 'TRN' AND AT_OFFENDER_SCHEDULE.EVENT_STATUS IN ('SCH') AND AT_OFF_SCH_DATE.DAY_DATE > TRUNC(CURRENT_TIMESTAMP - 1) AND NOT CASE WHEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END IS NULL)), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ESTABLISHMENT_CODE_NK, DAY_DATE, CASE WHEN V_COUNT_CA > 1 THEN 'MULTI ENTRIES - CHECK RECORD' ELSE V_CASE_ADMIN END AS V_CASE_ADMIN_DISPLAY, CASE WHEN V_SCHEDULED_TX_DATE IS NULL THEN '-' ELSE V_SCHEDULED_TX_DATE END AS V_SCHEDULED_TX_DATE_DISPLAY, CASE WHEN V_SCHEDULED_TX_DEST IS NULL THEN '-' ELSE V_SCHEDULED_TX_DEST END AS V_SCHEDULED_TX_DEST_DISPLAY, 'TBD' AS V_NFR, 'TBD' AS V_DV_PERP FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP6.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Establishment Code  - Destination",
            "legacyId": "DP6.DO10921",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Schedule Date",
            "legacyId": "DP6.DO10924",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "V_CASE_ADMIN_DISPLAY",
            "type": "string",
            "display": "V_CASE_ADMIN_DISPLAY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 4,
            "name": "V_SCHEDULED_TX_DATE_DISPLAY",
            "type": "string",
            "display": "V_SCHEDULED_TX_DATE_DISPLAY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 5,
            "name": "V_SCHEDULED_TX_DEST_DISPLAY",
            "type": "string",
            "display": "V_SCHEDULED_TX_DEST_DISPLAY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 6,
            "name": "V_NFR",
            "type": "string",
            "display": "V_NFR",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 7,
            "name": "V_DV_PERP",
            "type": "string",
            "display": "V_DV_PERP",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP3",
      "name": "MIS Load Date",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP3.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP7",
      "name": "Contact",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS OTHER_CONTACT_NAME, CASE WHEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END AS RELEASE_DATE_, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, FACT_CURR_KEY_DATES_SENT.CURR_HDCAD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH END AS EFFECTIVE_SENTENCE_LENGTH FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS, (SELECT AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK AS OFFENDER_BOOKING_SK, CASE WHEN AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' THEN AT_RELEASE_DATE.DAY_DATE END AS CURR_RELEASE_DATE FROM BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE WHERE AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK = AT_RELEASE_DATE.DATE_SK (+) AND AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG = 'Y' /* and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' */) DT_CURRENT_RELEASE_DATE, FACT_CURR_KEY_DATES_SENT, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */)) AND DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP IN ('Case Administrator') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG (+) = 'Y') AND NOT CASE WHEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_ETD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) WHEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) < (FACT_CURR_KEY_DATES_SENT.CURR_LTD_DATE) THEN (FACT_CURR_KEY_DATES_SENT.CURR_MTD_DATE) ELSE DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE END IS NULL)), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, DATE_OF_BIRTH, UNIT_4_SHORT_DESCRIPTION, ESTABLISHMENT_CODE_NK, OTHER_CONTACT_NAME, RELEASE_DATE_, MAIN_LEGAL_STATUS_CODE, CURR_HDCAD_DATE, CURR_HDCED_DATE, EFFECTIVE_SENTENCE_LENGTH FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP7.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP7.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP7.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP7.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP7.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Associated Establishment Code",
            "legacyId": "DP7.DO107b2",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "OTHER_CONTACT_NAME",
            "type": "string",
            "display": "Other Contact Name",
            "legacyId": "DP7.DO10a1b",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "RELEASE_DATE_",
            "type": "date",
            "display": "Release Date (Current)",
            "legacyId": "DP7.DO565",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "MAIN_LEGAL_STATUS_CODE",
            "type": "string",
            "display": "Main Legal Status Code",
            "legacyId": "DP7.DO100de",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "CURR_HDCAD_DATE",
            "type": "date",
            "display": "HDC AD (Approved Date)",
            "legacyId": "DP7.DO97",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "CURR_HDCED_DATE",
            "type": "date",
            "display": "HDC Eligibility Date",
            "legacyId": "DP7.DO70",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "EFFECTIVE_SENTENCE_LENGTH",
            "type": "string",
            "display": "Effective Sentence Length",
            "legacyId": "DP7.DO2d0",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "144530.RS",
      "name": "By Release Date",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_12_WEEK_DISCHARGE_FILTER = 1)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_CASE_ADMIN_DISPLAY",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_count_CA] >1; \"MULTI ENTRIES - CHECK RECORD\"; [v_Case_Admin])"
          },
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10076"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10085"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10a7c"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO100de"
          },
          {
            "name": "$ref:EFFECTIVE_SENTENCE_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO2d0"
          },
          {
            "name": "$ref:CURR_HDCED_DATE",
            "display": "HDC Eligibility Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO70"
          },
          {
            "name": "$ref:CURR_HDCAD_DATE",
            "display": "HDC AD (Approved Date)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO97"
          },
          {
            "name": "$ref:RELEASE_DATE_",
            "display": "Release Date (Current)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO565"
          },
          {
            "name": "$ref:V_SCHEDULED_TX_DATE_DISPLAY",
            "display": "Scheduled Tx Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Scheduled_tx_date]);\"-\";[v_Scheduled_tx_date])"
          },
          {
            "name": "$ref:V_SCHEDULED_TX_DEST_DISPLAY",
            "display": "Tx Dest.",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Scheduled_tx_Dest]);\"-\";[v_Scheduled_tx_Dest])"
          },
          {
            "name": "$ref:V_NFR",
            "display": "NFR?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alert Code] = \"XNR\";\"Y\") In ([NOMS Number])"
          },
          {
            "name": "$ref:V_DV_PERP",
            "display": "DV Perp?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alert Code] = \"RDV\";\"Y\") In ([NOMS Number])"
          }
        ]
      }
    },
    {
      "id": "145075.RS",
      "name": "By Surname",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_12_WEEK_DISCHARGE_FILTER = 1)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_CASE_ADMIN_DISPLAY",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_count_CA] >1; \"MULTI ENTRIES - CHECK RECORD\"; [v_Case_Admin])"
          },
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10076"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10085"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10a7c"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO100de"
          },
          {
            "name": "$ref:EFFECTIVE_SENTENCE_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO2d0"
          },
          {
            "name": "$ref:CURR_HDCED_DATE",
            "display": "HDC Eligibility Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO70"
          },
          {
            "name": "$ref:CURR_HDCAD_DATE",
            "display": "HDC AD (Approved Date)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO97"
          },
          {
            "name": "$ref:RELEASE_DATE_",
            "display": "Release Date (Current)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO565"
          },
          {
            "name": "$ref:V_SCHEDULED_TX_DATE_DISPLAY",
            "display": "Scheduled Tx Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Scheduled_tx_date]);\"-\";[v_Scheduled_tx_date])"
          },
          {
            "name": "$ref:V_SCHEDULED_TX_DEST_DISPLAY",
            "display": "Tx Dest.",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Scheduled_tx_Dest]);\"-\";[v_Scheduled_tx_Dest])"
          },
          {
            "name": "$ref:V_NFR",
            "display": "NFR?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alert Code] = \"XNR\";\"Y\") In ([NOMS Number])"
          },
          {
            "name": "$ref:V_DV_PERP",
            "display": "DV Perp?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alert Code] = \"RDV\";\"Y\") In ([NOMS Number])"
          }
        ]
      }
    },
    {
      "id": "144975.RS",
      "name": "Education",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_12_WEEK_DISCHARGE_FILTER = 1)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_CASE_ADMIN_DISPLAY",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_count_CA] >1; \"MULTI ENTRIES - CHECK RECORD\"; [v_Case_Admin])"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10085"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10a7c"
          },
          {
            "name": "$ref:RELEASE_DATE_",
            "display": "Release Date (Current)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO565"
          },
          {
            "name": "$ref:V_EDUCATION_STUDY_AREA",
            "display": "Study Area",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Education Study Area Desc]"
          },
          {
            "name": "$ref:V_EDUCATION_LEVEL",
            "display": "Education Level",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Education Level Desc]"
          },
          {
            "name": "$ref:V_EDUCATION_COMMENT",
            "display": "Education Comment",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Education Comment Text]"
          }
        ]
      }
    },
    {
      "id": "144801.RS",
      "name": "Scheduled Tx Detail",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP6",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_12_WEEK_DISCHARGE_FILTER = 1)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_CASE_ADMIN_DISPLAY",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_count_CA] >1; \"MULTI ENTRIES - CHECK RECORD\"; [v_Case_Admin])"
          },
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP6.DO10076"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10085"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10a7c"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO100de"
          },
          {
            "name": "$ref:RELEASE_DATE_",
            "display": "Release Date (Current)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO565"
          },
          {
            "name": "$ref:V_SCHEDULED_TX_DATE_DISPLAY",
            "display": "Scheduled Tx Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Scheduled_tx_date]);\"-\";[v_Scheduled_tx_date])"
          },
          {
            "name": "$ref:V_SCHEDULED_TX_DEST_DISPLAY",
            "display": "Tx Dest.",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Scheduled_tx_Dest]);\"-\";[v_Scheduled_tx_Dest])"
          },
          {
            "name": "$ref:V_NFR",
            "display": "NFR?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alert Code] = \"XNR\";\"Y\") In ([NOMS Number])"
          },
          {
            "name": "$ref:V_DV_PERP",
            "display": "DV Perp?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alert Code] = \"RDV\";\"Y\") In ([NOMS Number])"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_NFR :: Error: =If([Alert Code] = \"XNR\";\"Y\") In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:31",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_DV_PERP :: Error: =If([Alert Code] = \"RDV\";\"Y\") In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:31",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_EDUCATION_STUDY_AREA :: ReferenceError: error is not defined",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_EDUCATION_LEVEL :: ReferenceError: error is not defined",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_EDUCATION_COMMENT :: ReferenceError: error is not defined",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_NFR :: Error: =If([Alert Code] = \"XNR\";\"Y\") In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:31",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DV_PERP :: Error: =If([Alert Code] = \"RDV\";\"Y\") In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:31",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_EDUCATION_STUDY_AREA :: ReferenceError: error is not defined",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_NFR :: Error: =If([Alert Code] = \"XNR\";\"Y\") In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:31",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_DV_PERP :: Error: =If([Alert Code] = \"RDV\";\"Y\") In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:31",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_NFR :: Error: =If([Alert Code] = \"XNR\";\"Y\") In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:31",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DV_PERP :: Error: =If([Alert Code] = \"RDV\";\"Y\") In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:31",
      "entityId": "klmwAA0AAb0NW3UA0GoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "144801.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field FIRST_NAME does not have corresponding dataset schema field",
      "entityId": "144801.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "144801.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field UNIT_4_SHORT_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "144801.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_CODE does not have corresponding dataset schema field",
      "entityId": "144801.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field RELEASE_DATE_ does not have corresponding dataset schema field",
      "entityId": "144801.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP2",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP4",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP5",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP6",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP7",
      "entityType": "dataset"
    }
  ]
}