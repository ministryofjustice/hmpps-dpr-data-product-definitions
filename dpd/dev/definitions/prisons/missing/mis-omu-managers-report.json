{
  "id": "klfROxsACKUyFQsA7FYAISgV_bQ",
  "name": "MIS OMU Managers Report",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "SEN0029 v7.0",
      "MAPPA"
    ]
  },
  "description": "Report consists of 12 tabs as follows<br/>All Prisoners in an establishment, PD1 Prisoners whose release date falls within the next 14 weeks, RCS  Prisoners whose release date falls within 7 weeks who have an active risk to children in custody alert (RCS), SOR Prisoners whose release date falls within 3 weeks who have an active sex offenderâ€™s register alert, PED  Prisoners who have a Parole Eligibility Date, LIFERS  Prisoners who have an indeterminate sentence, All HDC Eligible All Prisoners who have a HDCED, HDC Awaiting Checks  Prisoners who are eligible for HDC but have not had any checks carried out, MAPPA (All)  Prisoners who have  active MAPPA Alerts and whose release date falls within the next 6 months, ViSOR  Displays all Prisoners who have an active ViSOR Nominal Alert and Security Cat  Prisoners who have a Security Category Review date within the next 2 months.<br/>SEN0029 - v8.0 Last Updated:  22/08/2023",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP4",
      "name": "Prisoners",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT CASE WHEN AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassified' ELSE AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL END AS CURRENT_SECURITY_CATEGORY, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' WHEN SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '99' THEN 'Life' WHEN FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH = '00/00/00' THEN 'No sentence' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 6 THEN 'Less than 6 Months' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 12 THEN '6 Months to less than 1 Year' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) <> '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 2 THEN '1 Year to less than 2 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 3 THEN '2 Years to less than 3 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 4 THEN '3 Years to less than 4 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02', '03') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 10 THEN '4 Years to less than 10 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) >= 10 THEN '10 Years or more and Less than Life' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH IS NULL THEN 'No sentence' ELSE 'Not Categorised' END AS CURRENT_SENTENCE_LENGTH_BAND, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_FACT_COURT_CHARGE.MOST_SERIOUS_FLAG, AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.SURNAME, FACT_CURR_KEY_DATES_SENT.SSD, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, FACT_CURR_KEY_DATES_SENT.CURR_RELEASE_DATE, FACT_CURR_KEY_DATES_SENT.CURR_APD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_PED_DATE, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_DIM_OFFENCE.OFFENCE_NAME, FACT_CURR_KEY_DATES_SENT.CURR_ROTL_DATE, CASE WHEN AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassfied' ELSE AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_SEC_CAT_LEVEL END AS SECURITY_CATEGORY_CURRENT_LE31, AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_SEC_CAT_REVIEW_DATE, FACT_CURR_KEY_DATES_SENT.TARIFF, AT_OFFENDER_BOOKING.PNC_ID FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_CURRENT_SECURITY_CATEGORY, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, FACT_CURR_KEY_DATES_SENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_DIM_OFFENDER_ASSESSMENTS, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_FLAG (+) = 'Y') AND (AT_CURRENT_SECURITY_CATEGORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_DIM_OFFENDER_ASSESSMENTS.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))))), dataset_ AS (SELECT CURRENT_SECURITY_CATEGORY, CURRENT_SENTENCE_LENGTH_BAND, OFFENDER_ID_DISPLAY, DATE_OF_BIRTH, MOST_SERIOUS_FLAG, FIRST_NAME, SURNAME, SSD, MAIN_LEGAL_STATUS_CODE, CURR_RELEASE_DATE, CURR_APD_DATE, CURR_PED_DATE, UNIT_4_SHORT_DESCRIPTION, OFFENCE_NAME, CURR_ROTL_DATE, SECURITY_CATEGORY_CURRENT_LE31, CURRENT_SEC_CAT_REVIEW_DATE, TARIFF, PNC_ID, CASE WHEN CONTACTS.RELATIONSHIP = 'Case Administrator' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_CA, CASE WHEN CONTACTS.RELATIONSHIP = 'Prison Offender Manager' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_POM, CASE WHEN CONTACTS.RELATIONSHIP = 'Offender Supervisor' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_OS, CURRENT_SECURITY_CATEGORY AS V_SEC_CAT_CURRENT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "CURRENT_SECURITY_CATEGORY",
            "type": "string",
            "display": "Current Security Category",
            "legacyId": "DP4.DO100e1",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "CURRENT_SENTENCE_LENGTH_BAND",
            "type": "string",
            "display": "Current Sentence Length Band",
            "legacyId": "DP4.DO1ef",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP4.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP4.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "MOST_SERIOUS_FLAG",
            "type": "string",
            "display": "Main Offence Flag",
            "legacyId": "DP4.DO4f",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP4.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP4.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "SSD",
            "type": "date",
            "display": "Current Sentence Start Date",
            "legacyId": "DP4.DO32d",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "MAIN_LEGAL_STATUS_CODE",
            "type": "string",
            "display": "Main Legal Status Code",
            "legacyId": "DP4.DO100de",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "CURR_RELEASE_DATE",
            "type": "date",
            "display": "Current Release Date",
            "legacyId": "DP4.DO2e6",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "CURR_APD_DATE",
            "type": "date",
            "display": "APD (Actual Parole Date)",
            "legacyId": "DP4.DO88",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "CURR_PED_DATE",
            "type": "date",
            "display": "PED (Parole Eligibility Date)",
            "legacyId": "DP4.DO87",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP4.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DP4.DO4b",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "CURR_ROTL_DATE",
            "type": "date",
            "display": "ROTL (Release on Temp Licence)",
            "legacyId": "DP4.DO61b",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "SECURITY_CATEGORY_CURRENT_LE31",
            "type": "string",
            "display": "Security Category - Current Level",
            "legacyId": "DP4.DO10832",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "CURRENT_SEC_CAT_REVIEW_DATE",
            "type": "date",
            "display": "Security Category - Current Review Date",
            "legacyId": "DP4.DO10830",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "TARIFF",
            "type": "date",
            "display": "Tariff Date",
            "legacyId": "DP4.DO3b1",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "PNC_ID",
            "type": "string",
            "display": "PNC ID",
            "legacyId": "DP4.DO100db",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "V_OTHER_CONTACT_NAME_MGE_CA",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_CA",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 20,
            "name": "V_OTHER_CONTACT_NAME_MGE_POM",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_POM",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 21,
            "name": "V_OTHER_CONTACT_NAME_MGE_OS",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_OS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 22,
            "name": "V_SEC_CAT_CURRENT",
            "type": "string",
            "display": "V_SEC_CAT_CURRENT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3376639/DP25",
      "name": "Contacts",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS OTHER_CONTACT_NAME, DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP IN ('Offender Supervisor', 'Case Administrator', 'Prison Offender Manager') AND (DT_OFFENDER_CONTACT_ADDRESS.ROW_SEQ_FILTER (+) = 1) AND (DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG (+) = 'Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OTHER_CONTACT_NAME, RELATIONSHIP FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP25.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OTHER_CONTACT_NAME",
            "type": "string",
            "display": "Other Contact Name",
            "legacyId": "DP25.DOa1b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "RELATIONSHIP",
            "type": "string",
            "display": "Other Contact Relationship",
            "legacyId": "DP25.DOa1c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP26",
      "name": "MAPPA Alerts",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.SURNAME, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, FACT_CURR_KEY_DATES_SENT.CURR_RELEASE_DATE, AT_ALERT.ALERT_CODE_NK, AT_ALERT.ALERT_DESCRIPTION, AT_OFFENDER_ALERT.ALERT_STATUS, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE, AT_OFFENDER_ALERT.COMMENT_TEXT FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, FACT_CURR_KEY_DATES_SENT, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE') AND AT_ALERT.ALERT_CODE_NK IN ('P0', 'P1', 'P100', 'P101', 'P102', 'P103', 'P11', 'P2', 'P3', 'P22', 'P33', 'P55', 'P66', 'P44', 'P77', 'P88', 'P99', 'PA1', 'PC2', 'PC1', 'PC3', 'PL1', 'PL2', 'PL3'))), dataset_ AS (SELECT FIRST_NAME, SURNAME, UNIT_4_SHORT_DESCRIPTION, DATE_OF_BIRTH, OFFENDER_ID_DISPLAY, CURR_RELEASE_DATE, ALERT_CODE_NK, ALERT_DESCRIPTION, ALERT_STATUS, ALERT_EFFECTIVE_DATE, COMMENT_TEXT, CASE WHEN CONTACTS.RELATIONSHIP = 'Case Administrator' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_CA, CASE WHEN CONTACTS.RELATIONSHIP = 'Prison Offender Manager' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_POM, CASE WHEN CONTACTS.RELATIONSHIP = 'Offender Supervisor' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_OS FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP26.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP26.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP26.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP26.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP26.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "CURR_RELEASE_DATE",
            "type": "date",
            "display": "Current Release Date",
            "legacyId": "DP26.DO2e6",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP26.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DP26.DO10090",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP26.DO10094",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DP26.DO10095",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Alert Comment Text",
            "legacyId": "DP26.DO107ba",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "V_OTHER_CONTACT_NAME_MGE_CA",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_CA",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 12,
            "name": "V_OTHER_CONTACT_NAME_MGE_POM",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_POM",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 13,
            "name": "V_OTHER_CONTACT_NAME_MGE_OS",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_OS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP24",
      "name": "MIS Load",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP24.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP2b",
      "name": "HDC",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END AS HDC_DECISION_DATE, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC, AT_DIM_ELIGIBILITY_DATE.DAY_DATE, CASE WHEN AT_CURFEW_ASSESSMENT.PASSED_FLAG = 'Y' THEN 'YES' WHEN AT_CURFEW_ASSESSMENT.PASSED_FLAG = 'N' THEN 'NO' END AS HDC_PASSED_FLAG, AT_DIM_ARCR_DT.DAY_DATE AS HDC_ARD_CRD_DATE, CASE WHEN AT_DIM_ASSESSMENT_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_ASSESSMENT_DATE.DAY_DATE END AS HDC_CHECKS_DONE_DATE, FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE, CASE WHEN AT_CURFEW_ASSESSMENT.REVIEW_FLAG = 'Y' THEN 'YES' WHEN AT_CURFEW_ASSESSMENT.REVIEW_FLAG = 'N' THEN 'NO' END AS HDC_REVIEW_FLAG, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, FACT_CURR_KEY_DATES_SENT.SSD FROM BODIMIS.DIM_DATE AT_DIM_DECISION_DATE, BODIMIS.DIM_DATE AT_DIM_ELIGIBILITY_DATE, BODIMIS.DIM_DATE AT_DIM_ARCR_DT, BODIMIS.DIM_DATE AT_DIM_ASSESSMENT_DATE, BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, FACT_CURR_KEY_DATES_SENT, BODIMIS.DIM_DATE AT_DOB WHERE (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.ASSESSMENT_DATE_SK = AT_DIM_ASSESSMENT_DATE.DATE_SK (+)) AND (AT_CURFEW_ASSESSMENT.ELIGIBILITY_DATE_SK = AT_DIM_ELIGIBILITY_DATE.DATE_SK (+)) AND (AT_CURFEW_ASSESSMENT.DECISION_DATE_SK = AT_DIM_DECISION_DATE.DATE_SK) AND (AT_CURFEW_ASSESSMENT.ARD_CRD_DATE_SK = AT_DIM_ARCR_DT.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND NOT FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE IS NULL)), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, HDC_DECISION_DATE, HDC_ASSMENT_APP_STATUS_DESC, DAY_DATE, HDC_PASSED_FLAG, HDC_ARD_CRD_DATE, HDC_CHECKS_DONE_DATE, CURR_HDCED_DATE, HDC_REVIEW_FLAG, UNIT_4_SHORT_DESCRIPTION, DATE_OF_BIRTH, SSD, CASE WHEN CONTACTS_HDC.RELATIONSHIP = 'Case Administrator' THEN CONTACTS_HDC.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_CA_, CASE WHEN CONTACTS_HDC.RELATIONSHIP = 'Prison Offender Manager' THEN CONTACTS_HDC.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_POM_, CASE WHEN CONTACTS_HDC.RELATIONSHIP = 'Offender Supervisor' THEN CONTACTS_HDC.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_OS_, CASE WHEN DAY_DATE <> CURR_HDCED_DATE THEN CURR_HDCED_DATE ELSE DAY_DATE END AS V_ELIGIBILITY_DATE_MATCH, HDC.UNIT_4_SHORT_DESCRIPTION AS V_LOCATION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2b.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP2b.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP2b.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "HDC_DECISION_DATE",
            "type": "date",
            "display": "HDC Decision Date",
            "legacyId": "DP2b.DO3b0",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "HDC_ASSMENT_APP_STATUS_DESC",
            "type": "string",
            "display": "HDC Status",
            "legacyId": "DP2b.DO54",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "DAY_DATE",
            "type": "date",
            "display": "HDC Curfew Eligibility Date",
            "legacyId": "DP2b.DO549",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "HDC_PASSED_FLAG",
            "type": "string",
            "display": "HDC Passed Flag",
            "legacyId": "DP2b.DO3ad",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "HDC_ARD_CRD_DATE",
            "type": "date",
            "display": "HDC ARD CRD Date",
            "legacyId": "DP2b.DO5e2",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "HDC_CHECKS_DONE_DATE",
            "type": "date",
            "display": "HDC Checks Done Date",
            "legacyId": "DP2b.DO54a",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "CURR_HDCED_DATE",
            "type": "date",
            "display": "HDC Eligibility Date",
            "legacyId": "DP2b.DO70",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "HDC_REVIEW_FLAG",
            "type": "string",
            "display": "HDC Review Flag",
            "legacyId": "DP2b.DO3ae",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP2b.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP2b.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "SSD",
            "type": "date",
            "display": "Current Sentence Start Date",
            "legacyId": "DP2b.DO32d",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "V_OTHER_CONTACT_NAME_MGE_CA_",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_CA_",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 15,
            "name": "V_OTHER_CONTACT_NAME_MGE_POM_",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_POM_",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 16,
            "name": "V_OTHER_CONTACT_NAME_MGE_OS_",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_OS_",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 17,
            "name": "V_ELIGIBILITY_DATE_MATCH",
            "type": "string",
            "display": "V_ELIGIBILITY_DATE_MATCH",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 18,
            "name": "V_LOCATION",
            "type": "string",
            "display": "V_LOCATION",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3376639/DP2c",
      "name": "Contacts (HDC)",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS OTHER_CONTACT_NAME, DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP IN ('Offender Supervisor', 'Case Administrator', 'Prison Offender Manager') AND (DT_OFFENDER_CONTACT_ADDRESS.ROW_SEQ_FILTER (+) = 1) AND (DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG (+) = 'Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OTHER_CONTACT_NAME, RELATIONSHIP FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2c.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OTHER_CONTACT_NAME",
            "type": "string",
            "display": "Other Contact Name",
            "legacyId": "DP2c.DOa1b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "RELATIONSHIP",
            "type": "string",
            "display": "Other Contact Relationship",
            "legacyId": "DP2c.DOa1c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP2d",
      "name": "ISP's",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' OR CASE WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '1' THEN 'Y' ELSE 'N' END = 'Y' OR AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE IN ('ALP', 'ALP_LASPO', 'LR_ALP', 'LR_ALP_LASPO', 'CFLIFE', 'DFL', 'DLP', 'HMP', 'HMPL', 'LIFE', 'DPP', 'LR_DPP', 'LR_DLP', 'LR_LIFE', 'LR_MLP', 'IPP', 'LR_IPP', 'MLP', 'SEC53', 'SEC90', 'SEC90_03', 'SEC93', 'SEC93_03', 'SEC94', 'ALP_CODE18', 'ALP_CODE21', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'SEC275', 'SEC272')))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2d.DO10076",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP30",
      "name": "ViSOR Alert",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.PNC_ID, AT_OFFENDER_BOOKING.SURNAME, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, FACT_CURR_KEY_DATES_SENT.CURR_RELEASE_DATE, AT_ALERT.ALERT_CODE_NK, AT_ALERT.ALERT_DESCRIPTION, AT_OFFENDER_ALERT.ALERT_STATUS, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE, AT_OFFENDER_ALERT.COMMENT_TEXT FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, FACT_CURR_KEY_DATES_SENT, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE') AND AT_ALERT.ALERT_CODE_NK = 'PVN')), dataset_ AS (SELECT FIRST_NAME, PNC_ID, SURNAME, UNIT_4_SHORT_DESCRIPTION, DATE_OF_BIRTH, OFFENDER_ID_DISPLAY, CURR_RELEASE_DATE, ALERT_CODE_NK, ALERT_DESCRIPTION, ALERT_STATUS, ALERT_EFFECTIVE_DATE, COMMENT_TEXT, CASE WHEN CONTACTS.RELATIONSHIP = 'Case Administrator' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_CA, CASE WHEN CONTACTS.RELATIONSHIP = 'Prison Offender Manager' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_POM FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP30.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "PNC_ID",
            "type": "string",
            "display": "PNC ID",
            "legacyId": "DP30.DO100db",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP30.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP30.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP30.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP30.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CURR_RELEASE_DATE",
            "type": "date",
            "display": "Current Release Date",
            "legacyId": "DP30.DO2e6",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP30.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DP30.DO10090",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP30.DO10094",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DP30.DO10095",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Alert Comment Text",
            "legacyId": "DP30.DO107ba",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "V_OTHER_CONTACT_NAME_MGE_CA",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_CA",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 13,
            "name": "V_OTHER_CONTACT_NAME_MGE_POM",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_POM",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP31",
      "name": "RCS and SOR Alerts",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.PNC_ID, AT_OFFENDER_BOOKING.SURNAME, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, FACT_CURR_KEY_DATES_SENT.CURR_RELEASE_DATE, AT_ALERT.ALERT_CODE_NK, AT_ALERT.ALERT_DESCRIPTION, AT_OFFENDER_ALERT.ALERT_STATUS, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE, AT_OFFENDER_ALERT.COMMENT_TEXT FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, FACT_CURR_KEY_DATES_SENT, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE') AND AT_ALERT.ALERT_CODE_NK IN ('RCS', 'SOR', 'SR'))), dataset_ AS (SELECT FIRST_NAME, PNC_ID, SURNAME, UNIT_4_SHORT_DESCRIPTION, DATE_OF_BIRTH, OFFENDER_ID_DISPLAY, CURR_RELEASE_DATE, ALERT_CODE_NK, ALERT_DESCRIPTION, ALERT_STATUS, ALERT_EFFECTIVE_DATE, COMMENT_TEXT, CASE WHEN CONTACTS.RELATIONSHIP = 'Case Administrator' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_CA, CASE WHEN CONTACTS.RELATIONSHIP = 'Prison Offender Manager' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_POM, CASE WHEN CONTACTS.RELATIONSHIP = 'Offender Supervisor' THEN CONTACTS.OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_OS FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP31.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "PNC_ID",
            "type": "string",
            "display": "PNC ID",
            "legacyId": "DP31.DO100db",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP31.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP31.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP31.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP31.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CURR_RELEASE_DATE",
            "type": "date",
            "display": "Current Release Date",
            "legacyId": "DP31.DO2e6",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP31.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DP31.DO10090",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP31.DO10094",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DP31.DO10095",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Alert Comment Text",
            "legacyId": "DP31.DO107ba",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "V_OTHER_CONTACT_NAME_MGE_CA",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_CA",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 13,
            "name": "V_OTHER_CONTACT_NAME_MGE_POM",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_POM",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 14,
            "name": "V_OTHER_CONTACT_NAME_MGE_OS",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_OS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "214126.RS",
      "name": "All",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10085"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10a7c"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100de"
          },
          {
            "name": "$ref:CURRENT_SECURITY_CATEGORY",
            "display": "Current Security Category",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100e1"
          },
          {
            "name": "$ref:CURR_RELEASE_DATE",
            "display": "Current Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO2e6"
          }
        ]
      }
    },
    {
      "id": "212792.RS",
      "name": "PD1",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_PD1_DATE_FILTER = 1)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10085"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10a7c"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100de"
          },
          {
            "name": "$ref:CURR_RELEASE_DATE",
            "display": "Current Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO2e6"
          }
        ]
      }
    },
    {
      "id": "212882.RS",
      "name": "RCS",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP31",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_RCS_DATE_FILTER = 1 AND V_RCS_FILTER IN (1)))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:ALERT_EFFECTIVE_DATE",
            "display": "Alert Effective Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP31.DO10095"
          },
          {
            "name": "$ref:CURR_RELEASE_DATE",
            "display": "Current Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO2e6"
          }
        ]
      }
    },
    {
      "id": "212965.RS",
      "name": "SOR",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP31",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_SOR_DATE_FILTER = 1 AND V_SOR_FILTER IN (1)))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:ALERT_EFFECTIVE_DATE",
            "display": "Alert Effective Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP31.DO10095"
          }
        ]
      }
    },
    {
      "id": "213095.RS",
      "name": "PED",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_PED = 1)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10085"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10a7c"
          },
          {
            "name": "$ref:CURR_PED_DATE",
            "display": "PED (Parole Eligibility Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO87"
          },
          {
            "name": "$ref:CURR_RELEASE_DATE",
            "display": "Current Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO2e6"
          }
        ]
      }
    },
    {
      "id": "213204.RS",
      "name": "ISPs",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10085"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10a7c"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100de"
          },
          {
            "name": "$ref:TARIFF",
            "display": "Tariff Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO3b1"
          }
        ]
      }
    },
    {
      "id": "214643.RS",
      "name": "All HDC Eligible",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2b",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (HDC_STATUS <> 'Inactive/Merged                         ' AND HDC_REVIEW_FLAG <> 'YES' AND V_ELIGIBILITY_KEY_DATE <> 'No longer eligible'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA_",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts (HDC)].[Other Contact Name] Where ([Contacts (HDC)].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM_",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts (HDC)].[Other Contact Name]Where ([Contacts (HDC)].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS_",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts (HDC)].[Other Contact Name]Where ([Contacts (HDC)].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2b.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2b.DO10080"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2b.DO10a7c"
          },
          {
            "name": "$ref:V_ELIGIBILITY_DATE_MATCH",
            "display": "Eligibility Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Curfew Eligibility Date]<>[HDC Eligibility Date];[HDC Eligibility Date];[HDC Curfew Eligibility Date])"
          },
          {
            "name": "$ref:HDC_CHECKS_DONE_DATE",
            "display": "HDC Checks Done Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2b.DO54a"
          },
          {
            "name": "$ref:SSD",
            "display": "Current Sentence Start Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2b.DO32d"
          },
          {
            "name": "$ref:HDC_PASSED_FLAG",
            "display": "HDC Passed Flag",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2b.DO3ad"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2b.DO54"
          },
          {
            "name": "$ref:HDC_DECISION_DATE",
            "display": "HDC Decision Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2b.DO3b0"
          },
          {
            "name": "$ref:HDC_ARD_CRD_DATE",
            "display": "HDC ARD CRD Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2b.DO5e2"
          }
        ]
      }
    },
    {
      "id": "214937.RS",
      "name": "HDC Awaiting Checks",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2b",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (HDC_CHECKS_DONE_DATE IS NULL AND HDC_STATUS <> 'Inactive/Merged                         ' AND HDC_STATUS <> 'Rejected                                ' AND HDC_STATUS <> 'Approved' AND HDC_STATUS <> 'Offender Ineligible                     ' AND HDC_STATUS <> 'Opted Out (Offender)                    ' AND V_ELIGIBILITY_KEY_DATE <> 'No longer eligible'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA_",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts (HDC)].[Other Contact Name] Where ([Contacts (HDC)].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM_",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts (HDC)].[Other Contact Name]Where ([Contacts (HDC)].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS_",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts (HDC)].[Other Contact Name]Where ([Contacts (HDC)].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2b.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2b.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2b.DO10085"
          },
          {
            "name": "$ref:V_LOCATION",
            "display": "Cell",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[HDC].[Prisoner Location]"
          },
          {
            "name": "$ref:V_ELIGIBILITY_DATE_MATCH",
            "display": "Eligibility Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Curfew Eligibility Date]<>[HDC Eligibility Date];[HDC Eligibility Date];[HDC Curfew Eligibility Date])"
          },
          {
            "name": "$ref:HDC_ARD_CRD_DATE",
            "display": "HDC ARD CRD Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2b.DO5e2"
          }
        ]
      }
    },
    {
      "id": "213395.RS",
      "name": "MAPPA (All)",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP26",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (COUNT_NOMS_NO IN ('[NULL_VALUE]')))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:ALERT_DESCRIPTION",
            "display": "Alert Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP26.DO10090"
          }
        ]
      }
    },
    {
      "id": "215834.RS",
      "name": "MAPPA Cat 1",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP26",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_MAPPA_DATE_FILTER = 1 AND V_MAPPA_CAT1_ALERT_DESCRIPTION IN (1)))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:ALERT_DESCRIPTION",
            "display": "Alert Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP26.DO10090"
          }
        ]
      }
    },
    {
      "id": "215711.RS",
      "name": "MAPPA Cat 2",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP26",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_MAPPA_DATE_FILTER = 1 AND V_MAPPA_CAT2_ALERT_DESCRIPTION IN (1)))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:ALERT_DESCRIPTION",
            "display": "Alert Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP26.DO10090"
          }
        ]
      }
    },
    {
      "id": "215712.RS",
      "name": "MAPPA Cat 3",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_MAPPA_DATE_FILTER = 1 AND V_MAPPA_CAT3_ALERT_DESCRIPTION IN (1)))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP4.DO10080"
          },
          {
            "name": "$ref:ALERT_DESCRIPTION",
            "display": "Alert Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP26.DO10090"
          }
        ]
      }
    },
    {
      "id": "215700.RS",
      "name": "MAPPA Cat 4",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP26",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_MAPPA_DATE_FILTER = 1 AND V_MAPPA_CAT4_ALERT_DESCRIPTION = 1))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:ALERT_DESCRIPTION",
            "display": "Alert Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP26.DO10090"
          }
        ]
      }
    },
    {
      "id": "215344.RS",
      "name": "ViSOR",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP30",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:ALERT_EFFECTIVE_DATE",
            "display": "Alert Effective Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP30.DO10095"
          },
          {
            "name": "$ref:COMMENT_TEXT",
            "display": "Alert Comment Text",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP30.DO107ba"
          }
        ]
      }
    },
    {
      "id": "213642.RS",
      "name": "Security Cat Review",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_SEC_CAT_REVIEW_DATE_FILTER = 1)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_CA",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Case Administrator\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "Prison Offender Manager",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Contacts].[Other Contact Name] Where ([Contacts].[Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:V_SEC_CAT_CURRENT",
            "display": "Security Cat.",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Current Security Category]"
          },
          {
            "name": "$ref:CURRENT_SEC_CAT_REVIEW_DATE",
            "display": "Security Category - Current Review Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10830"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "schema",
      "error": "Report field ALERT_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "215712.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP4",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP26",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP2b",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP30",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP31",
      "entityType": "dataset"
    }
  ]
}