{
  "id": "klavLQoAC6LvBFoAPEoAISgV_bQ",
  "name": "MIS Adjudications by Establishment",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "ADJ0008  v00.00.03 Adjudications"
    ]
  },
  "description": "ADJ0008 - v00.00.04  Last modified: 16/03/2020 This report provides a list of all Adjudications for Prisoners in any establishment between the Incident Reported dates specified. This will list any adjudications even if the Prisoner has moved to another Prison. It will not list an adjudication that has not had a Hearing set up for it",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375377/DP2",
      "name": "Adjudications",
      "description": "MIS - Incidents",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, DT_OFFENDER_ADJUDICATION.AGENCY_INCIDENT_ID_NK, AT_DIM_OIC_OFFENCE_CHARGE.OIC_OFFENCE_CODE, AT_DIM_OIC_OFFENCE_CHARGE.DESCRIPTION, DT_OFFENDER_ADJUDICATION.REPORT_DATE, AT_INCIDENT_SANCTION.DESCRIPTION AS SANCTION_DESCRIPTION, BODIMIS.FACT_INCIDENT_SANCTION.STATUS, BODIMIS.FACT_INCIDENT_SANCTION.COMPENSATION_AMOUNT, BODIMIS.FACT_INCIDENT_SANCTION.SANCTION_DAYS, AT_INCIDENT_SANCTION.CODE, DT_OFFENDER_ADJUDICATION.OIC_HEARING_ID_NK, AT_ADJUDICATION_HEARING_TYPE.CODE AS HEARING_TYPE_CODE, AT_FACT_INCIDENT_CHARGE_RESULT.FINDING_CODE, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'Asian/Asian British: Chinese' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_DESCRIPTION, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'W3' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'A4' ELSE AT_DIM_ETHNICITY_CODES.CODE END AS ETHNIC_CODE, AT_ADJUDICATION_ESTAB.ESTABLISHMENT_CODE_NK, DT_OFFENDER_ADJUDICATION.OIC_INCIDENT_ID, COALESCE(AT_OFFENDER_BOOKING.RELIGION_CODE, 'Not Specified') AS RELIGION_CODE, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, AT_OFFENDER_BOOKING.SEXUAL_ORIENTATION_CODE, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END AS DISABILITY_ACTIVE_FLAG, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE_DESCRIPTION, BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE_DESCRIPTION, AT_DIM_DATE_VERDICT.DAY_DATE FROM BODIMIS.FACT_INCIDENT_CHARGE_RESULT AT_FACT_INCIDENT_CHARGE_RESULT, BODIMIS.DIM_REFERENCE_CODES AT_INCIDENT_SANCTION, BODIMIS.DIM_REFERENCE_CODES AT_ADJUDICATION_HEARING_TYPE, BODIMIS.DIM_ESTABLISHMENT AT_ADJUDICATION_ESTAB, BODIMIS.DIM_OIC_OFFENCE AT_DIM_OIC_OFFENCE_CHARGE, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT a.oic_incident_id, c.offender_booking_sk, c.agency_incident_id_nk, c.charge_seq_nk, c.oic_offence_sk, a.oic_hearing_id_nk, a.party_seq_nk, a.establishment_sk, c.report_date, a.oic_hearing_type, a.notification_charge_date_sk FROM bodimis.fact_incident_charge c LEFT OUTER JOIN bodimis.fact_offender_adjudication a ON c.agency_incident_id_nk = a.agency_incident_id_nk AND c.offender_booking_sk = a.offender_booking_sk) DT_OFFENDER_ADJUDICATION, BODIMIS.FACT_INCIDENT_SANCTION, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_PERSONAL_CARE, BODIMIS.DIM_DATE AT_DIM_DATE_VERDICT WHERE (AT_DIM_DATE_VERDICT.DATE_SK (+) = AT_FACT_INCIDENT_CHARGE_RESULT.DELIVERY_DATE_SK) AND (AT_DIM_OIC_OFFENCE_CHARGE.OIC_OFFENCE_SK = DT_OFFENDER_ADJUDICATION.OIC_OFFENCE_SK) AND (DT_OFFENDER_ADJUDICATION.OFFENDER_BOOKING_SK = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_ADJUDICATION_ESTAB.ESTABLISHMENT_SK (+) = DT_OFFENDER_ADJUDICATION.ESTABLISHMENT_SK) AND (DT_OFFENDER_ADJUDICATION.AGENCY_INCIDENT_ID_NK = AT_FACT_INCIDENT_CHARGE_RESULT.AGENCY_INCIDENT_ID (+) AND DT_OFFENDER_ADJUDICATION.OIC_HEARING_ID_NK = AT_FACT_INCIDENT_CHARGE_RESULT.OIC_HEARING_ID_NK (+) AND DT_OFFENDER_ADJUDICATION.OFFENDER_BOOKING_SK = AT_FACT_INCIDENT_CHARGE_RESULT.OFFENDER_BOOKING_SK (+) AND DT_OFFENDER_ADJUDICATION.CHARGE_SEQ_NK = AT_FACT_INCIDENT_CHARGE_RESULT.CHARGE_SEQ (+)) AND (AT_FACT_INCIDENT_CHARGE_RESULT.OIC_HEARING_ID_NK = BODIMIS.FACT_INCIDENT_SANCTION.OIC_HEARING_ID (+) AND AT_FACT_INCIDENT_CHARGE_RESULT.RESULT_SEQ_NK = BODIMIS.FACT_INCIDENT_SANCTION.RESULT_SEQ (+)) AND (AT_ADJUDICATION_HEARING_TYPE.CODE (+) = DT_OFFENDER_ADJUDICATION.OIC_HEARING_TYPE) AND (AT_ADJUDICATION_HEARING_TYPE.CODE_DOMAIN (+) = 'OIC_HEAR') AND (AT_INCIDENT_SANCTION.CODE (+) = BODIMIS.FACT_INCIDENT_SANCTION.OIC_SANCTION_CODE) AND (AT_INCIDENT_SANCTION.CODE_DOMAIN (+) = 'OIC_SANCT') AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_PERSONAL_CARE.OFFENDER_BOOKING_SK (+)) AND (AT_ADJUDICATION_ESTAB.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_) AND DT_OFFENDER_ADJUDICATION.REPORT_DATE BETWEEN TO_DATE('26-04-2021 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND TO_DATE('07-06-2021 00:00:00', 'DD-MM-YYYY HH24:MI:SS'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, AGENCY_INCIDENT_ID_NK, OIC_OFFENCE_CODE, DESCRIPTION, REPORT_DATE, SANCTION_DESCRIPTION, STATUS, COMPENSATION_AMOUNT, SANCTION_DAYS, CODE, OIC_HEARING_ID_NK, HEARING_TYPE_CODE, FINDING_CODE, ETHNIC_DESCRIPTION, ETHNIC_CODE, ESTABLISHMENT_CODE_NK, OIC_INCIDENT_ID, RELIGION_CODE, RELIGION_DESCRIPTION, SEXUAL_ORIENTATION_CODE, SEX_ORIENTATION_DESCRIPTION, OFFENDER_AGE, DISABILITY_ACTIVE_FLAG, CODE_DESCRIPTION, TYPE_DESCRIPTION, DAY_DATE, CASE WHEN HEARING_TYPE_CODE = 'INAD_ADULT' THEN 'Indep Adjud' ELSE CASE WHEN HEARING_TYPE_CODE = 'INAD_YOI' THEN 'Indep Adjud' ELSE CASE WHEN HEARING_TYPE_CODE = 'GOV_YOI' THEN 'Governor' ELSE CASE WHEN HEARING_TYPE_CODE = 'GOV_ADULT' THEN 'Governor' ELSE CASE WHEN HEARING_TYPE_CODE = 'GOV' THEN 'Governor' ELSE (HEARING_TYPE_CODE) END END END END END AS V_HEARING_TYPE, CASE WHEN FINDING_CODE = 'NOT_PROCEED' THEN 'NOT PROCEED' ELSE CASE WHEN FINDING_CODE = 'D' THEN 'DISMISSED' ELSE CASE WHEN FINDING_CODE = 'S' THEN 'SUSPENDED' ELSE FINDING_CODE END END END AS V_HEARING_FINDING, 'TBD' AS V_MAX_CONCAT_DISABILITY_CODE, ESTABLISHMENT_CODE_NK AS V_ESTABLISHMENT, V_TRIAL2 AS V_DIM_TRIAL_2 FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP2.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP2.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "AGENCY_INCIDENT_ID_NK",
            "type": "double",
            "display": "Agency Incident ID",
            "legacyId": "DP2.DO759",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "OIC_OFFENCE_CODE",
            "type": "string",
            "display": "Charge Code",
            "legacyId": "DP2.DO282",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Charge Description",
            "legacyId": "DP2.DO26d",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "REPORT_DATE",
            "type": "date",
            "display": "Incident Reported Date",
            "legacyId": "DP2.DO751",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "SANCTION_DESCRIPTION",
            "type": "string",
            "display": "Sanction Description",
            "legacyId": "DP2.DO764",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "STATUS",
            "type": "string",
            "display": "Sanction Status",
            "legacyId": "DP2.DO762",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "COMPENSATION_AMOUNT",
            "type": "double",
            "display": "Sanction Compensation Amount",
            "legacyId": "DP2.DO760",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "SANCTION_DAYS",
            "type": "double",
            "display": "Sanction Days",
            "legacyId": "DP2.DO761",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "CODE",
            "type": "string",
            "display": "Sanction Code",
            "legacyId": "DP2.DO763",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "OIC_HEARING_ID_NK",
            "type": "double",
            "display": "OIC Hearing ID",
            "legacyId": "DP2.DO758",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "HEARING_TYPE_CODE",
            "type": "string",
            "display": "Hearing Type Code",
            "legacyId": "DP2.DO75c",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "FINDING_CODE",
            "type": "string",
            "display": "Hearing Finding",
            "legacyId": "DP2.DO26e",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "ETHNIC_DESCRIPTION",
            "type": "string",
            "display": "Ethnic Description",
            "legacyId": "DP2.DO1009d",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DP2.DO1009b",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Adjudication Establishment Code",
            "legacyId": "DP2.DO6c1",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "OIC_INCIDENT_ID",
            "type": "double",
            "display": "OIC Incident ID",
            "legacyId": "DP2.DO75a",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "RELIGION_CODE",
            "type": "string",
            "display": "Religion Code",
            "legacyId": "DP2.DO100b2",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DP2.DO100b3",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "SEXUAL_ORIENTATION_CODE",
            "type": "string",
            "display": "Sexual Orientation Code",
            "legacyId": "DP2.DO1096f",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "SEX_ORIENTATION_DESCRIPTION",
            "type": "string",
            "display": "Sexual Orientation Description",
            "legacyId": "DP2.DO10970",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP2.DO10082",
            "legacySqlClass": "column"
          },
          {
            "index": 24,
            "name": "DISABILITY_ACTIVE_FLAG",
            "type": "string",
            "display": "Disability Active Flag",
            "legacyId": "DP2.DO10a9d",
            "legacySqlClass": "column"
          },
          {
            "index": 25,
            "name": "CODE_DESCRIPTION",
            "type": "string",
            "display": "Care Code Description",
            "legacyId": "DP2.DO1097d",
            "legacySqlClass": "column"
          },
          {
            "index": 26,
            "name": "TYPE_DESCRIPTION",
            "type": "string",
            "display": "Care Type Description",
            "legacyId": "DP2.DO1097b",
            "legacySqlClass": "column"
          },
          {
            "index": 27,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Verdict Date",
            "legacyId": "DP2.DO281",
            "legacySqlClass": "column"
          },
          {
            "index": 28,
            "name": "V_HEARING_TYPE",
            "type": "string",
            "display": "V_HEARING_TYPE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 29,
            "name": "V_HEARING_FINDING",
            "type": "string",
            "display": "V_HEARING_FINDING",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 30,
            "name": "V_MAX_CONCAT_DISABILITY_CODE",
            "type": "string",
            "display": "V_MAX_CONCAT_DISABILITY_CODE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 31,
            "name": "V_ESTABLISHMENT",
            "type": "string",
            "display": "V_ESTABLISHMENT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 32,
            "name": "V_DIM_TRIAL_2",
            "type": "string",
            "display": "V_DIM_TRIAL_2",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375377/DP4",
      "name": "MIS Load",
      "description": "MIS - Incidents",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP4.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP6",
      "name": "Current Establishment",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A1808DP', 'A0820CN', 'A5869EF', 'A5954EC', 'A3562DK', 'A5231DA', 'A8459AG', 'A6268DX', 'A6609CA', 'A6744CN', 'A8859EJ', 'A2069EE', 'A3373AR', 'A9304AR', 'A6295DX', 'A2997DT', 'A9959EJ', 'A5035DZ', 'A7894AK', 'A1188AF', 'A9853AV', 'A8054AX', 'A3599DD', 'A7788CH', 'A4259EM', 'A1283AV', 'A1633EG', 'A5403EG', 'A1467CA', 'A7562EK', 'A5406EP', 'A6000EC', 'A3685EL', 'A6470DJ', 'A5421CF', 'A0908AH', 'A9773EF', 'A8772DM', 'A2775DT', 'A5727DN', 'A8116AR', 'A8267CG', 'A7404EP', 'A4799DW', 'A8834CA', 'A4713DG', 'A6414DM', 'A5818AK', 'A5419CC', 'A3960AR', 'A8561CD', 'A1880EL', 'A1871DZ', 'A1159AH', 'A9931CJ', 'A3790CP', 'A5845AN', 'A9555EN', 'A9749CP', 'A5458CL', 'A5386EN', 'A1436DD', 'A3715DN', 'A8197CW', 'A9161DX', 'A7054DX', 'A0264AF', 'A0300ED', 'A0638AH', 'A7393DH', 'A0399AW', 'A2913EJ', 'A5281EJ', 'A5423EP', 'A0706EL', 'A3513AT', 'A1414EM', 'A2269DH', 'A7349AW', 'A2197AG', 'A1288AF', 'A4481ED', 'A1806EF', 'A6061DD', 'A8366CQ', 'A6017CT', 'A5760EC', 'A9936DH', 'A2758DK', 'A0674AF', 'A8694EC', 'A4846AF', 'A5290DL', 'A5047CF', 'A2773EN', 'A1189EQ', 'A9278EN', 'A3286EM', 'A2731EK', 'A6405EA', 'A8366DN', 'A7789CL', 'A1667AN', 'A5391DF', 'A6761DT', 'A5335AY', 'A4942CN', 'A2917DL', 'A0212DE', 'A8222AX', 'A8589DD', 'A1139AG', 'A0474CG', 'A6997AR', 'A3540AR', 'A1737CM', 'A5219DQ', 'A7164CV', 'A2566EJ', 'A3859DW', 'A3693AF', 'A4255CT', 'A0580CD', 'A1286AG', 'A1669DL', 'A5771AJ', 'A0549EM', 'A0421AY', 'A2904EQ', 'A5488DM', 'A4166DC', 'A4747AF', 'A8554AE', 'A3909CA', 'A6882CT', 'A8094AR', 'A8400CF', 'A9515EP', 'A1483DF', 'A4180EQ', 'A6832AF', 'A0531AT', 'A3310DA', 'A2999AF', 'A3620CZ', 'A8873AG', 'A6622CD', 'A8181AJ', 'A5533EF', 'A3826AL', 'A7693AE', 'A1463AF', 'A1528DP', 'A6676AK', 'A2448AV', 'A4699EA', 'A4171EP', 'A2715DZ', 'A0917AT', 'A8632AY', 'A5100CV', 'A1327DF', 'A1216AY', 'A9401DX', 'A7016DK', 'A5103CA', 'A1126AQ', 'A5289CM', 'A0453CP', 'A4574EN', 'A5227AR', 'A7374DN', 'A4862AN', 'A2497AR', 'A8623ED', 'A3120AR', 'A6501AF', 'A9002CR', 'A4687AP', 'A0697CQ', 'A8370CT', 'A9329AN', 'A8526AF', 'A2902AT', 'A4428AF', 'A3485AR', 'A5107DG', 'A0821CN', 'A0961CZ', 'A4340EP', 'A3614DX', 'A5532CZ', 'A2975AV', 'A6960EA', 'A7635EN', 'A9691EK', 'A7878CL', 'A6725AX', 'A9913EH', 'A7428EE', 'A8148AD', 'A8017CX', 'A6078DW', 'A5552CQ', 'A3302DP', 'A9640AX', 'A4109AX', 'A4645AP', 'A7853AD', 'A5591AD', 'A5262DQ', 'A2829AW', 'A7269EN', 'A8238AW', 'A4077AR', 'A3317AE', 'A2685AM', 'A4010CN', 'A9994DL', 'A5389DF', 'A8644AE', 'A3863CJ', 'A3260AK', 'A2861CN', 'A5125AA', 'A6147AG', 'A3840AR', 'A3083EE', 'A2977AF', 'A4828DG', 'A4075DP', 'A0626AN', 'A7874AR', 'A2121CM', 'A2081EP', 'A2314CG', 'A0099CX', 'A3102CA', 'A4467DD', 'A2481AY', 'A4271EA', 'A4990CL', 'A0775CG', 'A4561AP', 'A0447AW', 'A2490DG', 'A7188AV', 'A3724EC', 'A4003AR', 'A9639AJ', 'A2872DY', 'A6155CH', 'A4807ED', 'A0207DG', 'A5407EP', 'A1937DY', 'A0868EL', 'A9373DM', 'A8674CE', 'A1736DW', 'A9379CN', 'A4831CT', 'A8535EH', 'A4976CA', 'A8582EP', 'A2730CK', 'A4546AT', 'A6046AY', 'A2543CJ', 'A8385DL', 'A4857AD', 'A6537CE', 'A0727EG', 'A1061AG', 'A0096EJ', 'A7060EN', 'A3333AG', 'A0356CZ', 'A8030EM', 'A0102EQ', 'A4761ED', 'A7087AN', 'A4985CE', 'A2828DA', 'A5808EM', 'A4091DV', 'A3838DM')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ESTABLISHMENT_CODE_NK FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP6.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Associated Establishment Code",
            "legacyId": "DP6.DO7b2",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "116773.RS",
      "name": "Adjudications",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10076"
          },
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Adjudication Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO6c1"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1009b"
          },
          {
            "name": "$ref:REPORT_DATE",
            "display": "Incident Reported Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO751"
          },
          {
            "name": "$ref:OIC_OFFENCE_CODE",
            "display": "Charge Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO282"
          },
          {
            "name": "$ref:V_HEARING_TYPE",
            "display": "Hearing Type",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Hearing Type Code]= \"INAD_ADULT\"; \"Indep Adjud\"; If([Hearing Type Code]= \"INAD_YOI\"; \"Indep Adjud\"; If([Hearing Type Code] = \"GOV_YOI\"; \"Governor\"; If([Hearing Type Code] = \"GOV_ADULT\"; \"Governor\"; If([Hearing Type Code] = \"GOV\"; \"Governor\"; ([Hearing Type Code]))))))"
          },
          {
            "name": "$ref:V_HEARING_FINDING",
            "display": "Hearing Finding",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Hearing Finding] = \"NOT_PROCEED\"; \"NOT PROCEED\"; If([Hearing Finding] = \"D\"; \"DISMISSED\";If([Hearing Finding] = \"S\"; \"SUSPENDED\"; [Hearing Finding])))"
          },
          {
            "name": "$ref:CODE",
            "display": "Sanction Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO763"
          },
          {
            "name": "$ref:STATUS",
            "display": "Sanction Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO762"
          },
          {
            "name": "$ref:SANCTION_DAYS",
            "display": "Sanction Days",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO761"
          },
          {
            "name": "$ref:COMPENSATION_AMOUNT",
            "display": "Sanction Compensation Amount",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO760"
          },
          {
            "name": "$ref:OIC_INCIDENT_ID",
            "display": "OIC Incident ID",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO75a"
          }
        ]
      }
    },
    {
      "id": "117857.RS",
      "name": "Adjudications incl Prot Charcs ",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10076"
          },
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Adjudication Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO6c1"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:OFFENDER_AGE",
            "display": "Offender Age",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10082"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1009b"
          },
          {
            "name": "$ref:RELIGION_CODE",
            "display": "Religion Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO100b2"
          },
          {
            "name": "$ref:SEXUAL_ORIENTATION_CODE",
            "display": "Sexual Orientation Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1096f"
          },
          {
            "name": "$ref:V_MAX_CONCAT_DISABILITY_CODE",
            "display": "Disability",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_disability] Where ([v_Active_disability]= [v_max_disability]) In ([Adjudications].[NOMS Number])"
          },
          {
            "name": "$ref:REPORT_DATE",
            "display": "Incident Reported Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO751"
          },
          {
            "name": "$ref:OIC_OFFENCE_CODE",
            "display": "Charge Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO282"
          },
          {
            "name": "$ref:V_HEARING_TYPE",
            "display": "Hearing Type",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Hearing Type Code]= \"INAD_ADULT\"; \"Indep Adjud\"; If([Hearing Type Code]= \"INAD_YOI\"; \"Indep Adjud\"; If([Hearing Type Code] = \"GOV_YOI\"; \"Governor\"; If([Hearing Type Code] = \"GOV_ADULT\"; \"Governor\"; If([Hearing Type Code] = \"GOV\"; \"Governor\"; ([Hearing Type Code]))))))"
          },
          {
            "name": "$ref:V_HEARING_FINDING",
            "display": "Hearing Finding",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Hearing Finding] = \"NOT_PROCEED\"; \"NOT PROCEED\"; If([Hearing Finding] = \"D\"; \"DISMISSED\";If([Hearing Finding] = \"S\"; \"SUSPENDED\"; [Hearing Finding])))"
          },
          {
            "name": "$ref:CODE",
            "display": "Sanction Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO763"
          },
          {
            "name": "$ref:STATUS",
            "display": "Sanction Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO762"
          },
          {
            "name": "$ref:SANCTION_DAYS",
            "display": "Sanction Days",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO761"
          },
          {
            "name": "$ref:COMPENSATION_AMOUNT",
            "display": "Sanction Compensation Amount",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO760"
          },
          {
            "name": "$ref:OIC_INCIDENT_ID",
            "display": "OIC Incident ID",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO75a"
          }
        ]
      }
    },
    {
      "id": "117485.RS",
      "name": "Charge Descriptions",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OIC_OFFENCE_CODE",
            "display": "Charge Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO282"
          },
          {
            "name": "$ref:DESCRIPTION",
            "display": "Charge Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO26d"
          }
        ]
      }
    },
    {
      "id": "116968.RS",
      "name": "Sanction Descriptions",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:CODE",
            "display": "Sanction Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO763"
          },
          {
            "name": "$ref:SANCTION_DESCRIPTION",
            "display": "Sanction Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO764"
          }
        ]
      }
    },
    {
      "id": "117652.RS",
      "name": "Protected Chars Descriptions",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:SEXUAL_ORIENTATION_CODE",
            "display": "Sexual Orientation Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1096f"
          },
          {
            "name": "$ref:SEX_ORIENTATION_DESCRIPTION",
            "display": "Sexual Orientation Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10970"
          }
        ]
      }
    },
    {
      "id": "118061.RS",
      "name": "Adjudications Simple View",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_DIM_TRIAL_2 IS NOT NULL)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10076"
          },
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Adjudication Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO6c1"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1009b"
          },
          {
            "name": "$ref:REPORT_DATE",
            "display": "Incident Reported Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO751"
          },
          {
            "name": "$ref:OIC_INCIDENT_ID",
            "display": "OIC Incident ID",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO75a"
          },
          {
            "name": "$ref:V_ESTABLISHMENT",
            "display": "Current Est",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Associated Establishment Code]"
          },
          {
            "name": "$ref:V_DIM_TRIAL_2",
            "display": "Latest Hearing Outcome",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_trial2]"
          }
        ]
      }
    },
    {
      "id": "118320.RS",
      "name": "Adj Simple incl Prot Charcs",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_DIM_TRIAL_2 IS NOT NULL)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10076"
          },
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Adjudication Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO6c1"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:OFFENDER_AGE",
            "display": "Offender Age",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10082"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1009b"
          },
          {
            "name": "$ref:RELIGION_CODE",
            "display": "Religion Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO100b2"
          },
          {
            "name": "$ref:SEX_ORIENTATION_DESCRIPTION",
            "display": "Sexual Orientation Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10970"
          },
          {
            "name": "$ref:V_MAX_CONCAT_DISABILITY_CODE",
            "display": "Disability",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_disability] Where ([v_Active_disability]= [v_max_disability]) In ([Adjudications].[NOMS Number])"
          },
          {
            "name": "$ref:OIC_INCIDENT_ID",
            "display": "OIC Incident ID",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO75a"
          },
          {
            "name": "$ref:V_DIM_TRIAL_2",
            "display": "Latest Hearing Outcome",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_trial2]"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_DISABILITY_CODE :: Error: =[v_concat_disability] Where ([v_Active_disability]= [v_max_disability]) In ([Adjudications].[NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:74",
      "entityId": "klavLQoAC6LvBFoAPEoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_ESTABLISHMENT :: ReferenceError: error is not defined",
      "entityId": "klavLQoAC6LvBFoAPEoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_DISABILITY_CODE :: Error: =[v_concat_disability] Where ([v_Active_disability]= [v_max_disability]) In ([Adjudications].[NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:74",
      "entityId": "klavLQoAC6LvBFoAPEoAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375377/DP2",
      "entityType": "dataset"
    }
  ]
}