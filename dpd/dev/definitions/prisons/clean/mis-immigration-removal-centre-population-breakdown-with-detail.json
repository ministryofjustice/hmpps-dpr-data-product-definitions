{
  "id": "klnpsRkAAnhxGb4Az.8AFE.rcVQ",
  "name": "MIS Immigration Removal Centre Population Breakdown with Detail",
  "description": "This HM Inspectorate of Prisons report provides the population breakdown for an Immigration Removal Centre.<br/>IOP0014 v00.00.01 Last Modified: 20/10/2017",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "IOP0014 v00.00.05"
    ]
  },
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3376639/DP4",
      "name": "Detainees",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.IN_OUT, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, CASE WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) IS NULL THEN NULL WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 1 THEN 'Under 1 year' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 1 AND 6 THEN '1 to 6 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 7 AND 11 THEN '7 to 11 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 12 AND 16 THEN '12 to 16 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) > 16 AND (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 18 THEN '16 to 17 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 18 AND 21 THEN '18 to 21 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 22 AND 29 THEN '22 to 29 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 30 AND 39 THEN '30 to 39 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 40 AND 49 THEN '40 to 49 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 50 AND 59 THEN '50 to 59 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 60 AND 69 THEN '60 to 69 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) >= 70 THEN '70 or over' END AS AGE_BAND, AT_OFFENDER_BOOKING.GENDER_CODE, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) AS LENGTH_OF_STAY_IN_MONTHS, CASE WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 1 THEN 'Less than 1 month' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 1 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 3 THEN '1 month to 3 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 3 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 6 THEN '3 months to 6 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 6 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 12 THEN '6 months to 1 year' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 12 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 24 THEN '1 year to 2 years' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 24 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 48 THEN '2 years to 4 years' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 48 THEN '4 years or more' END AS LENGTH_OF_STAY, CASE WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 1 THEN 'Less than 1 week' WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 >= 1 AND TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 2 THEN '1 to 2 weeks' WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 >= 2 AND TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 4 THEN '2 to 4 weeks' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 1 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 2 THEN '1 to 2 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 2 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 4 THEN '2 to 4 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 4 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 6 THEN '4 to 6 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 6 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 8 THEN '6 to 8 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 8 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 10 THEN '8 to 10 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 10 THEN 'More than 10 months' END AS LENGTH_OF_STAY_BAND, DT_ADMISSION.MOVEMENT_TIME, CASE WHEN DT_ALL_LOCATIONS.LOCATION_TYPE = 'Establishment' AND DT_ALL_LOCATIONS.LOCATION_DESC LIKE '%Immigration%' THEN 'Another IRC' WHEN DT_ALL_LOCATIONS.LOCATION_TYPE = 'Establishment' THEN 'Prison' ELSE DT_ALL_LOCATIONS.LOCATION_TYPE END AS PREVIOUS_LOCATION_TYPE_ON_AD35, AT_CELL.UNIT_4_SHORT_DESCRIPTION, AT_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION, COUNT(DISTINCT (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY)) AS COUNT_OF_OFFENDERS, AT_OFFENDER_BOOKING.FIRST_NAME FROM (SELECT establishment_sk AS LOCATION_SK, establishment_description AS LOCATION_DESC, 'Establishment' AS LOCATION_TYPE FROM bodimis.dim_establishment UNION SELECT court_sk, court_description, 'Court' FROM bodimis.dim_court UNION SELECT probation_office_sk, prob_office_description, 'Probation Office' FROM bodimis.dim_probation_office UNION SELECT outside_location_sk, outside_location_description, 'Outside Location' FROM bodimis.dim_outside_location) DT_ALL_LOCATIONS, (SELECT ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk, fme.from_location_type, MAX(fme.MOVEMENT_SEQ) AS MOVEMENT_SEQ, MAX(d.day_date) AS MOVEMENT_TIME, TRUNC(ETL.LOAD_END_DATETIME) AS LOAD_DATE FROM BODIMIS.FACT_MOVEMENT_EXTERNAL fme, BODIMIS.DIM_OFFENDER_BOOKING ob, BODIMIS.DIM_ESTABLISHMENT est, BODIMIS.ETL_LOAD_LOG ETL, BODIMIS.DIM_DATE d WHERE ob.ESTABLISHMENT_SK = est.ESTABLISHMENT_SK AND d.date_sk = fme.date_sk AND fme.offender_booking_sk = ob.offender_booking_sk AND ob.active_status IN ('Active In', 'Active Out') AND ob.MIS_CURRENT_RECORD_IND = 'Y' AND ob.ACTIVE_FLAG = 'Y' AND ETL.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL) AND ob.ESTABLISHMENT_SK = fme.to_location_sk AND fme.movement_seq = (SELECT MAX(fme2.movement_seq) FROM BODIMIS.FACT_MOVEMENT_EXTERNAL fme2 WHERE fme.offender_booking_sk = fme2.offender_booking_sk AND fme2.direction_code = 'IN' AND fme2.TYPE = 'Admission' AND fme2.To_location_type = 'Establishment' AND fme2.reason_code <> 'R') GROUP BY ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk, fme.from_location_type, ETL.LOAD_END_DATETIME) DT_ADMISSION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_CELL AT_CELL WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_CELL.ESTABLISHMENT_SK = AT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_ESTABLISHMENT.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_ADMISSION.OFFENDER_BOOKING_SK (+)) AND (DT_ADMISSION.FROM_LOCATION_SK = DT_ALL_LOCATIONS.LOCATION_SK (+) AND DT_ADMISSION.FROM_LOCATION_TYPE = DT_ALL_LOCATIONS.LOCATION_TYPE (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_STATUS = 'O') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (AT_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND AT_OFFENDER_BOOKING.LIVING_UNIT_SK >= 1) GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.IN_OUT, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12), CASE WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) IS NULL THEN NULL WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 1 THEN 'Under 1 year' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 1 AND 6 THEN '1 to 6 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 7 AND 11 THEN '7 to 11 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 12 AND 16 THEN '12 to 16 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) > 16 AND (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 18 THEN '16 to 17 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 18 AND 21 THEN '18 to 21 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 22 AND 29 THEN '22 to 29 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 30 AND 39 THEN '30 to 39 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 40 AND 49 THEN '40 to 49 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 50 AND 59 THEN '50 to 59 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 60 AND 69 THEN '60 to 69 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) >= 70 THEN '70 or over' END, AT_OFFENDER_BOOKING.GENDER_CODE, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified'), MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME), CASE WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 1 THEN 'Less than 1 month' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 1 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 3 THEN '1 month to 3 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 3 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 6 THEN '3 months to 6 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 6 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 12 THEN '6 months to 1 year' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 12 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 24 THEN '1 year to 2 years' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 24 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 48 THEN '2 years to 4 years' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 48 THEN '4 years or more' END, CASE WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 1 THEN 'Less than 1 week' WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 >= 1 AND TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 2 THEN '1 to 2 weeks' WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 >= 2 AND TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 4 THEN '2 to 4 weeks' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 1 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 2 THEN '1 to 2 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 2 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 4 THEN '2 to 4 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 4 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 6 THEN '4 to 6 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 6 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 8 THEN '6 to 8 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 8 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 10 THEN '8 to 10 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 10 THEN 'More than 10 months' END, DT_ADMISSION.MOVEMENT_TIME, CASE WHEN DT_ALL_LOCATIONS.LOCATION_TYPE = 'Establishment' AND DT_ALL_LOCATIONS.LOCATION_DESC LIKE '%Immigration%' THEN 'Another IRC' WHEN DT_ALL_LOCATIONS.LOCATION_TYPE = 'Establishment' THEN 'Prison' ELSE DT_ALL_LOCATIONS.LOCATION_TYPE END, AT_CELL.UNIT_4_SHORT_DESCRIPTION, AT_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION, AT_OFFENDER_BOOKING.FIRST_NAME UNION SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.IN_OUT, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, CASE WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) IS NULL THEN NULL WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 1 THEN 'Under 1 year' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 1 AND 6 THEN '1 to 6 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 7 AND 11 THEN '7 to 11 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 12 AND 16 THEN '12 to 16 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) > 16 AND (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 18 THEN '16 to 17 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 18 AND 21 THEN '18 to 21 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 22 AND 29 THEN '22 to 29 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 30 AND 39 THEN '30 to 39 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 40 AND 49 THEN '40 to 49 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 50 AND 59 THEN '50 to 59 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 60 AND 69 THEN '60 to 69 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) >= 70 THEN '70 or over' END AS AGE_BAND, AT_OFFENDER_BOOKING.GENDER_CODE, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) AS LENGTH_OF_STAY_IN_MONTHS, CASE WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 1 THEN 'Less than 1 month' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 1 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 3 THEN '1 month to 3 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 3 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 6 THEN '3 months to 6 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 6 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 12 THEN '6 months to 1 year' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 12 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 24 THEN '1 year to 2 years' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 24 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 48 THEN '2 years to 4 years' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 48 THEN '4 years or more' END AS LENGTH_OF_STAY, CASE WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 1 THEN 'Less than 1 week' WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 >= 1 AND TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 2 THEN '1 to 2 weeks' WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 >= 2 AND TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 4 THEN '2 to 4 weeks' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 1 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 2 THEN '1 to 2 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 2 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 4 THEN '2 to 4 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 4 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 6 THEN '4 to 6 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 6 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 8 THEN '6 to 8 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 8 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 10 THEN '8 to 10 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 10 THEN 'More than 10 months' END AS LENGTH_OF_STAY_BAND, DT_ADMISSION.MOVEMENT_TIME, CASE WHEN DT_ALL_LOCATIONS.LOCATION_TYPE = 'Establishment' AND DT_ALL_LOCATIONS.LOCATION_DESC LIKE '%Immigration%' THEN 'Another IRC' WHEN DT_ALL_LOCATIONS.LOCATION_TYPE = 'Establishment' THEN 'Prison' ELSE DT_ALL_LOCATIONS.LOCATION_TYPE END AS PREVIOUS_LOCATION_TYPE_ON_AD35, '-', AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION, COUNT(DISTINCT (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY)) AS COUNT_OF_OFFENDERS, AT_OFFENDER_BOOKING.FIRST_NAME FROM (SELECT establishment_sk AS LOCATION_SK, establishment_description AS LOCATION_DESC, 'Establishment' AS LOCATION_TYPE FROM bodimis.dim_establishment UNION SELECT court_sk, court_description, 'Court' FROM bodimis.dim_court UNION SELECT probation_office_sk, prob_office_description, 'Probation Office' FROM bodimis.dim_probation_office UNION SELECT outside_location_sk, outside_location_description, 'Outside Location' FROM bodimis.dim_outside_location) DT_ALL_LOCATIONS, (SELECT ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk, fme.from_location_type, MAX(fme.MOVEMENT_SEQ) AS MOVEMENT_SEQ, MAX(d.day_date) AS MOVEMENT_TIME, TRUNC(ETL.LOAD_END_DATETIME) AS LOAD_DATE FROM BODIMIS.FACT_MOVEMENT_EXTERNAL fme, BODIMIS.DIM_OFFENDER_BOOKING ob, BODIMIS.DIM_ESTABLISHMENT est, BODIMIS.ETL_LOAD_LOG ETL, BODIMIS.DIM_DATE d WHERE ob.ESTABLISHMENT_SK = est.ESTABLISHMENT_SK AND d.date_sk = fme.date_sk AND fme.offender_booking_sk = ob.offender_booking_sk AND ob.active_status IN ('Active In', 'Active Out') AND ob.MIS_CURRENT_RECORD_IND = 'Y' AND ob.ACTIVE_FLAG = 'Y' AND ETL.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL) AND ob.ESTABLISHMENT_SK = fme.to_location_sk AND fme.movement_seq = (SELECT MAX(fme2.movement_seq) FROM BODIMIS.FACT_MOVEMENT_EXTERNAL fme2 WHERE fme.offender_booking_sk = fme2.offender_booking_sk AND fme2.direction_code = 'IN' AND fme2.TYPE = 'Admission' AND fme2.To_location_type = 'Establishment' AND fme2.reason_code <> 'R') GROUP BY ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk, fme.from_location_type, ETL.LOAD_END_DATETIME) DT_ADMISSION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_ADMISSION.OFFENDER_BOOKING_SK (+)) AND (DT_ADMISSION.FROM_LOCATION_SK = DT_ALL_LOCATIONS.LOCATION_SK (+) AND DT_ADMISSION.FROM_LOCATION_TYPE = DT_ALL_LOCATIONS.LOCATION_TYPE (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_STATUS = 'O') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND AT_OFFENDER_BOOKING.LIVING_UNIT_SK < 1) GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.IN_OUT, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12), CASE WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) IS NULL THEN NULL WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 1 THEN 'Under 1 year' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 1 AND 6 THEN '1 to 6 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 7 AND 11 THEN '7 to 11 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 12 AND 16 THEN '12 to 16 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) > 16 AND (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) < 18 THEN '16 to 17 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 18 AND 21 THEN '18 to 21 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 22 AND 29 THEN '22 to 29 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 30 AND 39 THEN '30 to 39 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 40 AND 49 THEN '40 to 49 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 50 AND 59 THEN '50 to 59 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) BETWEEN 60 AND 69 THEN '60 to 69 years' WHEN (FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12)) >= 70 THEN '70 or over' END, AT_OFFENDER_BOOKING.GENDER_CODE, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified'), MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME), CASE WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 1 THEN 'Less than 1 month' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 1 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 3 THEN '1 month to 3 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 3 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 6 THEN '3 months to 6 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 6 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 12 THEN '6 months to 1 year' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 12 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 24 THEN '1 year to 2 years' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 24 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) < 48 THEN '2 years to 4 years' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) >= 48 THEN '4 years or more' END, CASE WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 1 THEN 'Less than 1 week' WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 >= 1 AND TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 2 THEN '1 to 2 weeks' WHEN TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 >= 2 AND TRUNC((DT_ADMISSION.LOAD_DATE - DT_ADMISSION.MOVEMENT_TIME)) * 86400 / 60 / 60 / 24 / 7 < 4 THEN '2 to 4 weeks' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 1 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 2 THEN '1 to 2 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 2 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 4 THEN '2 to 4 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 4 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 6 THEN '4 to 6 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 6 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 8 THEN '6 to 8 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 8 AND MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) <= 10 THEN '8 to 10 months' WHEN MONTHS_BETWEEN(DT_ADMISSION.LOAD_DATE, DT_ADMISSION.MOVEMENT_TIME) > 10 THEN 'More than 10 months' END, DT_ADMISSION.MOVEMENT_TIME, CASE WHEN DT_ALL_LOCATIONS.LOCATION_TYPE = 'Establishment' AND DT_ALL_LOCATIONS.LOCATION_DESC LIKE '%Immigration%' THEN 'Another IRC' WHEN DT_ALL_LOCATIONS.LOCATION_TYPE = 'Establishment' THEN 'Prison' ELSE DT_ALL_LOCATIONS.LOCATION_TYPE END, '-', AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION, AT_OFFENDER_BOOKING.FIRST_NAME), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, IN_OUT, OFFENDER_AGE, AGE_BAND, GENDER_CODE, NATIONALITY_DESCRIPTION, RELIGION_DESCRIPTION, LENGTH_OF_STAY_IN_MONTHS, LENGTH_OF_STAY, LENGTH_OF_STAY_BAND, MOVEMENT_TIME, PREVIOUS_LOCATION_TYPE_ON_AD35, UNIT_4_SHORT_DESCRIPTION, ESTABLISHMENT_DESCRIPTION, COUNT_OF_OFFENDERS, FIRST_NAME FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP4.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP4.DO7b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "IN_OUT",
            "type": "string",
            "display": "In Out",
            "legacyId": "DP4.DO4d4",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP4.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "AGE_BAND",
            "type": "string",
            "display": "Age Band",
            "legacyId": "DP4.DO7fd",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "GENDER_CODE",
            "type": "string",
            "display": "Gender Code",
            "legacyId": "DP4.DOa8",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "NATIONALITY_DESCRIPTION",
            "type": "string",
            "display": "Nationality Description",
            "legacyId": "DP4.DOb5",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DP4.DOb3",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "LENGTH_OF_STAY_IN_MONTHS",
            "type": "double",
            "display": "Length of Stay in Months",
            "legacyId": "DP4.DO803",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "LENGTH_OF_STAY",
            "type": "string",
            "display": "Length of Stay",
            "legacyId": "DP4.DO7cf",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "LENGTH_OF_STAY_BAND",
            "type": "string",
            "display": "Length of Stay Band",
            "legacyId": "DP4.DO7fc",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Admission Date",
            "legacyId": "DP4.DO7ce",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "PREVIOUS_LOCATION_TYPE_ON_AD35",
            "type": "string",
            "display": "Previous Location Type on Admission",
            "legacyId": "DP4.DO806",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Unit Description 4 - Short",
            "legacyId": "DP4.DO4c2",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Establishment Name",
            "legacyId": "DP4.DO129",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "COUNT_OF_OFFENDERS",
            "type": "double",
            "display": "Count of Offenders",
            "legacyId": "DP4.DO655",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP4.DO80",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP26",
      "name": "IRC Nationalities",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT DT_DIM_NATIONALITY.NATIONALITY_DESC FROM (SELECT 'AB' AS NATIONALITY_CODE, 'Aruban' AS NATIONALITY_DESC FROM Dual UNION SELECT 'AFGA' AS NATIONALITY_CODE, 'Afghan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'AG' AS NATIONALITY_CODE, 'Anguillan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ALBA' AS NATIONALITY_CODE, 'Albanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ALGE' AS NATIONALITY_CODE, 'Algerian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'AMER' AS NATIONALITY_CODE, 'American' AS NATIONALITY_DESC FROM Dual UNION SELECT 'AN' AS NATIONALITY_CODE, 'Dutch Antillean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ANDO' AS NATIONALITY_CODE, 'Andorran' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ANGOL' AS NATIONALITY_CODE, 'Angolan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ANTIG' AS NATIONALITY_CODE, 'Antiguan, Barbudan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ARGEN' AS NATIONALITY_CODE, 'Argentine' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ARME' AS NATIONALITY_CODE, 'Armenian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ASM' AS NATIONALITY_CODE, 'American Samoan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'AUSI' AS NATIONALITY_CODE, 'Australian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'AUST' AS NATIONALITY_CODE, 'Austrian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'AZERB' AS NATIONALITY_CODE, 'Azerbaijani' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BAHA' AS NATIONALITY_CODE, 'Bahamian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BAHR' AS NATIONALITY_CODE, 'Bahraini' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BANGL' AS NATIONALITY_CODE, 'Bangladeshi' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BARB' AS NATIONALITY_CODE, 'Barbadian or Bajuns' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BELA' AS NATIONALITY_CODE, 'Belarusian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BELG' AS NATIONALITY_CODE, 'Belgian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BELI' AS NATIONALITY_CODE, 'Belizean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BENI' AS NATIONALITY_CODE, 'Beninese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BHUT' AS NATIONALITY_CODE, 'Bhutanese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BM' AS NATIONALITY_CODE, 'Bermudian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BOLI' AS NATIONALITY_CODE, 'Bolivian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BOSNI' AS NATIONALITY_CODE, 'Bosnian, Herzegovinian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BRAZ' AS NATIONALITY_CODE, 'Brazilian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BRIT' AS NATIONALITY_CODE, 'British' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BRUN' AS NATIONALITY_CODE, 'Bruneian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BULG' AS NATIONALITY_CODE, 'Bulgarian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BURM' AS NATIONALITY_CODE, 'Burmese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'BURU' AS NATIONALITY_CODE, 'Burundian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CAMB' AS NATIONALITY_CODE, 'Cambodian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CAMER' AS NATIONALITY_CODE, 'Cameroonian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CANA' AS NATIONALITY_CODE, 'Canadian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CAVER' AS NATIONALITY_CODE, 'Cape Verdian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CCK' AS NATIONALITY_CODE, 'Cocos Islander' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CF' AS NATIONALITY_CODE, 'Central African' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CHAD' AS NATIONALITY_CODE, 'Chadian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CHIL' AS NATIONALITY_CODE, 'Chilean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CHINA' AS NATIONALITY_CODE, 'Chinese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'COK' AS NATIONALITY_CODE, 'Cook Islander' AS NATIONALITY_DESC FROM Dual UNION SELECT 'COLO' AS NATIONALITY_CODE, 'Colombian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'COMO' AS NATIONALITY_CODE, 'Comoran' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CONG' AS NATIONALITY_CODE, 'Congolese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'COSRI' AS NATIONALITY_CODE, 'Costa Rican' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CROAT' AS NATIONALITY_CODE, 'Croat' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CT' AS NATIONALITY_CODE, 'I-Kiribati' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CUBA' AS NATIONALITY_CODE, 'Cuban' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CXR' AS NATIONALITY_CODE, 'Christmas Island' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CYPR' AS NATIONALITY_CODE, 'Cypriot' AS NATIONALITY_DESC FROM Dual UNION SELECT 'CZEC' AS NATIONALITY_CODE, 'Czech' AS NATIONALITY_DESC FROM Dual UNION SELECT 'DANE' AS NATIONALITY_CODE, 'Danish' AS NATIONALITY_DESC FROM Dual UNION SELECT 'DJIB' AS NATIONALITY_CODE, 'Djibouti' AS NATIONALITY_DESC FROM Dual UNION SELECT 'DOMI' AS NATIONALITY_CODE, 'Dominican' AS NATIONALITY_DESC FROM Dual UNION SELECT 'DUTCH' AS NATIONALITY_CODE, 'Dutch' AS NATIONALITY_DESC FROM Dual UNION SELECT 'EATIM' AS NATIONALITY_CODE, 'East Timorese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ECUA' AS NATIONALITY_CODE, 'Ecuadorian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'EGYP' AS NATIONALITY_CODE, 'Egyptian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'EMIR' AS NATIONALITY_CODE, 'Emirian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'EQUATO' AS NATIONALITY_CODE, 'Equatoguinean' AS NATIONALITY_DESC FROM Dual UNION SELECT (SELECT establishment_code FROM prompt_) AS NATIONALITY_CODE, 'Eritrean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ESTO' AS NATIONALITY_CODE, 'Estonian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ETHI' AS NATIONALITY_CODE, 'Ethiopian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'FG' AS NATIONALITY_CODE, 'French Guyanese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'FIJI' AS NATIONALITY_CODE, 'Fijian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'FILIP' AS NATIONALITY_CODE, 'Filipino' AS NATIONALITY_DESC FROM Dual UNION SELECT 'FINN' AS NATIONALITY_CODE, 'Finnish' AS NATIONALITY_DESC FROM Dual UNION SELECT 'FO' AS NATIONALITY_CODE, 'Faroese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'FREN' AS NATIONALITY_CODE, 'French' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GABO' AS NATIONALITY_CODE, 'Gabonese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GAMB' AS NATIONALITY_CODE, 'Gambian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GE' AS NATIONALITY_CODE, 'Georgian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GERM' AS NATIONALITY_CODE, 'German' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GHAN' AS NATIONALITY_CODE, 'Ghanaian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GI' AS NATIONALITY_CODE, 'Gibraltar' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GL' AS NATIONALITY_CODE, 'Greenlandic' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GLP' AS NATIONALITY_CODE, 'Guadeloupe' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GREE' AS NATIONALITY_CODE, 'Greek' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GREN' AS NATIONALITY_CODE, 'Grenadian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GU' AS NATIONALITY_CODE, 'Guamanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GUAT' AS NATIONALITY_CODE, 'Guatemalan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GUIN' AS NATIONALITY_CODE, 'Guinean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'GUYA' AS NATIONALITY_CODE, 'Guyanese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'HAIT' AS NATIONALITY_CODE, 'Haitian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'HOND' AS NATIONALITY_CODE, 'Honduran' AS NATIONALITY_DESC FROM Dual UNION SELECT 'HUNG' AS NATIONALITY_CODE, 'Hungarian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'HV' AS NATIONALITY_CODE, 'Burkinabe' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ICE' AS NATIONALITY_CODE, 'Icelandic' AS NATIONALITY_DESC FROM Dual UNION SELECT 'INDI' AS NATIONALITY_CODE, 'Indian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'INDO' AS NATIONALITY_CODE, 'Indonesian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'IRAN' AS NATIONALITY_CODE, 'Iranian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'IRAQ' AS NATIONALITY_CODE, 'Iraqi' AS NATIONALITY_DESC FROM Dual UNION SELECT 'IRISH' AS NATIONALITY_CODE, 'Irish' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ISRA' AS NATIONALITY_CODE, 'Israeli' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ITAL' AS NATIONALITY_CODE, 'Italian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'IVOR' AS NATIONALITY_CODE, 'Ivorian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'JAM' AS NATIONALITY_CODE, 'Jamaican' AS NATIONALITY_DESC FROM Dual UNION SELECT 'JAP' AS NATIONALITY_CODE, 'Japanese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'JORD' AS NATIONALITY_CODE, 'Jordanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'KAZA' AS NATIONALITY_CODE, 'Kazakhstani' AS NATIONALITY_DESC FROM Dual UNION SELECT 'KENY' AS NATIONALITY_CODE, 'Kenyan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'KN' AS NATIONALITY_CODE, 'Kyrgyzstani' AS NATIONALITY_DESC FROM Dual UNION SELECT 'KUWA' AS NATIONALITY_CODE, 'Kuwaiti' AS NATIONALITY_DESC FROM Dual UNION SELECT 'KY' AS NATIONALITY_CODE, 'Caymanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LA' AS NATIONALITY_CODE, 'Laotian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LATV' AS NATIONALITY_CODE, 'Latvian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LEBA' AS NATIONALITY_CODE, 'Lebanese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LIBE' AS NATIONALITY_CODE, 'Liberian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LIBY' AS NATIONALITY_CODE, 'Libyan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LIEC' AS NATIONALITY_CODE, 'Liechtensteiner' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LITHU' AS NATIONALITY_CODE, 'Lithuanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LS' AS NATIONALITY_CODE, 'Basotho' AS NATIONALITY_DESC FROM Dual UNION SELECT 'LUX' AS NATIONALITY_CODE, 'Luxembourger' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MACE' AS NATIONALITY_CODE, 'Macedonian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MALA' AS NATIONALITY_CODE, 'Malaysian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MALD' AS NATIONALITY_CODE, 'Maldivian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MALT' AS NATIONALITY_CODE, 'Maltese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MAR' AS NATIONALITY_CODE, 'Marshallese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MARI' AS NATIONALITY_CODE, 'Mauritanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MAUR' AS NATIONALITY_CODE, 'Mauritian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MEXI' AS NATIONALITY_CODE, 'Mexican' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MG' AS NATIONALITY_CODE, 'Malagasy' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MICR' AS NATIONALITY_CODE, 'Micronesian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ML' AS NATIONALITY_CODE, 'Malian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MLAW' AS NATIONALITY_CODE, 'Malawian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MO' AS NATIONALITY_CODE, 'Mahoran' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MOLD' AS NATIONALITY_CODE, 'Moldovan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MONA' AS NATIONALITY_CODE, 'Monacan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MONGO' AS NATIONALITY_CODE, 'Mongolian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MORO' AS NATIONALITY_CODE, 'Moroccan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MOTS' AS NATIONALITY_CODE, 'Motswana' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MOZA' AS NATIONALITY_CODE, 'Mozambican' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MS' AS NATIONALITY_CODE, 'Montserratian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'MTQ' AS NATIONALITY_CODE, 'Martiniquais' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NAMI' AS NATIONALITY_CODE, 'Namibian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NAUR' AS NATIONALITY_CODE, 'Nauruan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NCL' AS NATIONALITY_CODE, 'New Caledonian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NEPA' AS NATIONALITY_CODE, 'Nepalese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NFK' AS NATIONALITY_CODE, 'Norfolk Islander' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NICA' AS NATIONALITY_CODE, 'Nicaraguan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NIGER' AS NATIONALITY_CODE, 'Nigerien' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NIGERIA' AS NATIONALITY_CODE, 'Nigerian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NIU' AS NATIONALITY_CODE, 'Niuean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NKOR' AS NATIONALITY_CODE, 'North Korean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NORW' AS NATIONALITY_CODE, 'Norwegian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'NZEA' AS NATIONALITY_CODE, 'New Zealander' AS NATIONALITY_DESC FROM Dual UNION SELECT 'OMAN' AS NATIONALITY_CODE, 'Omani' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PAKN' AS NATIONALITY_CODE, 'Pakistani' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PALA' AS NATIONALITY_CODE, 'Palauan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PANA' AS NATIONALITY_CODE, 'Panamanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PARA' AS NATIONALITY_CODE, 'Paraguayan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PCN' AS NATIONALITY_CODE, 'Pitcairn Islander' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PERU' AS NATIONALITY_CODE, 'Peruvian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PNGU' AS NATIONALITY_CODE, 'Papua New Guinean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'POLE' AS NATIONALITY_CODE, 'Polish' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PORTU' AS NATIONALITY_CODE, 'Portuguese' AS NATIONALITY_DESC FROM Dual UNION SELECT (SELECT establishment_code FROM prompt_) AS NATIONALITY_CODE, 'Puerto Rican' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PSE' AS NATIONALITY_CODE, 'Palestinian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'PYF' AS NATIONALITY_CODE, 'French Polynesian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'QUAT' AS NATIONALITY_CODE, 'Qatari' AS NATIONALITY_DESC FROM Dual UNION SELECT 'REF' AS NATIONALITY_CODE, 'Refused' AS NATIONALITY_DESC FROM Dual UNION SELECT 'REU' AS NATIONALITY_CODE, 'Reunionese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ROMA' AS NATIONALITY_CODE, 'Romanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'RUSS' AS NATIONALITY_CODE, 'Russian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'RWAN' AS NATIONALITY_CODE, 'Rwandan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SAARA' AS NATIONALITY_CODE, 'Saudi Arabian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SALV' AS NATIONALITY_CODE, 'Salvadoran' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SAMO' AS NATIONALITY_CODE, 'Samoan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SANM' AS NATIONALITY_CODE, 'San Marinese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SECR' AS NATIONALITY_CODE, 'Serb or Croat' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SENE' AS NATIONALITY_CODE, 'Senegalese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SEYC' AS NATIONALITY_CODE, 'Seychellois' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SH' AS NATIONALITY_CODE, 'Saint Helenian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SILE' AS NATIONALITY_CODE, 'Sierra Leonean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SING' AS NATIONALITY_CODE, 'Singaporean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SKOR' AS NATIONALITY_CODE, 'South Korean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SLENE' AS NATIONALITY_CODE, 'Slovene' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SLOV' AS NATIONALITY_CODE, 'Slovak' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SOAFR' AS NATIONALITY_CODE, 'South African' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SOLO' AS NATIONALITY_CODE, 'Solomon Islander' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SOMA' AS NATIONALITY_CODE, 'Somalian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SPAN' AS NATIONALITY_CODE, 'Spaniard' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SRIL' AS NATIONALITY_CODE, 'Sri Lankan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'STATE' AS NATIONALITY_CODE, 'Stateless' AS NATIONALITY_DESC FROM Dual UNION SELECT 'STLU' AS NATIONALITY_CODE, 'Saint Lucian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'STP' AS NATIONALITY_CODE, 'Sao Tomean' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SUDAN' AS NATIONALITY_CODE, 'Sudanese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SURIN' AS NATIONALITY_CODE, 'Surinamer' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SW' AS NATIONALITY_CODE, 'Kittitian or Nevisian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SWAZI' AS NATIONALITY_CODE, 'Swazi' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SWEDE' AS NATIONALITY_CODE, 'Swede' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SWIS' AS NATIONALITY_CODE, 'Swiss' AS NATIONALITY_DESC FROM Dual UNION SELECT 'SYRI' AS NATIONALITY_CODE, 'Syrian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TA' AS NATIONALITY_CODE, 'Tajikistani' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TAIW' AS NATIONALITY_CODE, 'Taiwanese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TANZ' AS NATIONALITY_CODE, 'Tanzanian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'THAI' AS NATIONALITY_CODE, 'Thai' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TKL' AS NATIONALITY_CODE, 'Tokelauan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TNGA' AS NATIONALITY_CODE, 'Tongan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TOGO' AS NATIONALITY_CODE, 'Togolese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TRIN' AS NATIONALITY_CODE, 'Trinidadian, Tobagonian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TU' AS NATIONALITY_CODE, 'Turkmen' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TUNI' AS NATIONALITY_CODE, 'Tunisian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TURK' AS NATIONALITY_CODE, 'Turk' AS NATIONALITY_DESC FROM Dual UNION SELECT 'TV' AS NATIONALITY_CODE, 'Tuvaluan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'UGAN' AS NATIONALITY_CODE, 'Ugandan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'UKRA' AS NATIONALITY_CODE, 'Ukrainian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'UNKNOWN' AS NATIONALITY_CODE, 'Unknown' AS NATIONALITY_DESC FROM Dual UNION SELECT 'URUG' AS NATIONALITY_CODE, 'Uruguayan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'UZBE' AS NATIONALITY_CODE, 'Uzbekistani' AS NATIONALITY_DESC FROM Dual UNION SELECT 'VC' AS NATIONALITY_CODE, 'Vincentian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'VENE' AS NATIONALITY_CODE, 'Venezuelan' AS NATIONALITY_DESC FROM Dual UNION SELECT 'VG' AS NATIONALITY_CODE, 'Virgin Islander' AS NATIONALITY_DESC FROM Dual UNION SELECT 'VIET' AS NATIONALITY_CODE, 'Vietnamese' AS NATIONALITY_DESC FROM Dual UNION SELECT 'VY' AS NATIONALITY_CODE, 'Ni-Vanuata' AS NATIONALITY_DESC FROM Dual UNION SELECT 'WA' AS NATIONALITY_CODE, 'Sahrawi' AS NATIONALITY_DESC FROM Dual UNION SELECT 'YEMIN' AS NATIONALITY_CODE, 'Yemenite' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ZAM' AS NATIONALITY_CODE, 'Zambian' AS NATIONALITY_DESC FROM Dual UNION SELECT 'ZIM' AS NATIONALITY_CODE, 'Zimbabwean' AS NATIONALITY_DESC FROM Dual) DT_DIM_NATIONALITY), dataset_ AS (SELECT NATIONALITY_DESC FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "NATIONALITY_DESC",
            "type": "string",
            "display": "IOP IRC Nationality",
            "legacyId": "DP26.DO7fb",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP2c",
      "name": "IRC LoS",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT DT_IRC_LOS.IRC_LENGTH_OF_STAY FROM (SELECT 'Less than 1 week' AS IRC_LENGTH_OF_STAY FROM DUAL UNION SELECT '1 to 2 weeks' AS IRC_LENGTH_OF_STAY FROM DUAL UNION SELECT '2 to 4 weeks' AS IRC_LENGTH_OF_STAY FROM DUAL UNION SELECT '1 to 2 months' AS IRC_LENGTH_OF_STAY FROM DUAL UNION SELECT '2 to 4 months' AS IRC_LENGTH_OF_STAY FROM DUAL UNION SELECT '6 to 8 months' AS IRC_LENGTH_OF_STAY FROM DUAL UNION SELECT '8 to 10 months' AS IRC_LENGTH_OF_STAY FROM DUAL UNION SELECT 'More than 10 months' AS IRC_LENGTH_OF_STAY FROM DUAL) DT_IRC_LOS), dataset_ AS (SELECT IRC_LENGTH_OF_STAY FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "IRC_LENGTH_OF_STAY",
            "type": "string",
            "display": "IOP IRC Length Of Stay",
            "legacyId": "DP2c.DO7ff",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP37",
      "name": "MiS Load Date",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP37.DO4dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP39",
      "name": "IRC Ages",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT DT_IRC_AGE_BANDING.IRC_AGE_BAND FROM (SELECT 'Under 1 year' AS IRC_AGE_BAND FROM DUAL UNION SELECT '1 to 6 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '7 to 11 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '12 to 16 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '16 to 17 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '18 to 21 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '22 to 29 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '30 to 29 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '40 to 49 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '50 to 59 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '60 to 69 years' AS IRC_AGE_BAND FROM DUAL UNION SELECT '70 or over' AS IRC_AGE_BAND FROM DUAL) DT_IRC_AGE_BANDING), dataset_ AS (SELECT IRC_AGE_BAND FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "IRC_AGE_BAND",
            "type": "string",
            "display": "IOP IRC Age Band",
            "legacyId": "DP39.DO7f9",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP3b",
      "name": "IRC Religions",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_DIM_RELIGION.RELIGION_DESCRIPTION, AT_DIM_RELIGION.RELIGION_CODE FROM BODIMIS.DIM_RELIGION AT_DIM_RELIGION), dataset_ AS (SELECT RELIGION_DESCRIPTION, RELIGION_CODE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description New",
            "legacyId": "DP3b.DO4f3",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "RELIGION_CODE",
            "type": "string",
            "display": "Religion Code",
            "legacyId": "DP3b.DO7c2",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP3e",
      "name": "IRC Locations",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT DT_IRC_PREVIOUS_LOCATION.IRC_PREVIOUS_LOC FROM (SELECT 'Another IRC' AS IRC_PREVIOUS_LOC FROM DUAL UNION SELECT 'Court' AS IRC_PREVIOUS_LOC FROM DUAL UNION SELECT 'Probation Office' AS IRC_PREVIOUS_LOC FROM DUAL UNION SELECT 'Prison' AS IRC_PREVIOUS_LOC FROM DUAL UNION SELECT 'Outside Location' AS IRC_PREVIOUS_LOC FROM DUAL UNION SELECT 'Unknown Location' AS IRC_PREVIOUS_LOC FROM DUAL) DT_IRC_PREVIOUS_LOCATION), dataset_ AS (SELECT IRC_PREVIOUS_LOC FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "IRC_PREVIOUS_LOC",
            "type": "string",
            "display": "IOP IRC Previous Location",
            "legacyId": "DP3e.DO804",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "162212.RS",
      "name": "Summary",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_DESCRIPTION",
            "display": "Establishment Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO129"
          }
        ]
      }
    },
    {
      "id": "164017.RS",
      "name": "Core Detail",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_DESCRIPTION",
            "display": "Establishment Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO129"
          }
        ]
      }
    },
    {
      "id": "163795.RS",
      "name": "Detail",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_DESCRIPTION",
            "display": "Establishment Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO129"
          }
        ]
      }
    }
  ],
  "errors": []
}