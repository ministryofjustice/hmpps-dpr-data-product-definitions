{
  "id": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
  "name": "ORS National HDC DQ MI Report",
  "description": "<br/>HDC0007- v00.00.02 Last Updated 17/02/2021This report has been designed specifically for the Prison & Probation Analytical Services team. This report returns prisoners who have a HDCED between selected date range chosen at runtime. This report shows dates and information of each stage of referral during the HDC process.",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "HDC0007 v00.00.02"
    ]
  },
  "datasource": [
    {
      "id": "nomis",
      "name": "NOMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "nomis"
    }
  ],
  "dataset": [
    {
      "id": "3376286/DP3",
      "name": "Offenders",
      "description": "OR - Sentence",
      "datasource": "nomis",
      "query": "DP13_ AS (SELECT DISTINCT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_PEOPLE.FIRST_NAME, AT_PEOPLE.LAST_NAME AS CP_LAST_NAME FROM OMS_OWNER.OFFENDER_SENTENCES AT_OFFENDER_SENTENCES, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_SENT_CALCULATIONS AT_OFFENDER_SENT_CALCULATIONS, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS, OMS_OWNER.PERSONS AT_PEOPLE, OMS_OWNER.OFFENDER_CONTACT_PERSONS AT_CONTACTS WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID (+)) AND (AT_OFFENDER_SENTENCES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_CONTACTS.OFFENDER_BOOK_ID (+)) AND (AT_PEOPLE.PERSON_ID (+) = AT_CONTACTS.PERSON_ID) AND (COALESCE(AT_OFFENDER_SENT_CALCULATIONS.HDCED_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.HDCED_CALCULATED_DATE) >= (SELECT START_DATE FROM prompt_ /* = #prompt('HDCED Start Date:','D',,Mono,Free,Not_Persistent,,User:0) */) AND COALESCE(AT_OFFENDER_SENT_CALCULATIONS.HDCED_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.HDCED_CALCULATED_DATE) <= (SELECT END_DATE FROM prompt_ /* = #prompt('HDCED End Date:','D',,Mono,Free,Not_Persistent,,User:1) */) AND AT_OFFENDER_SENTENCES.SENTENCE_STATUS = 'A' AND AT_CONTACTS.RELATIONSHIP_TYPE IN ('CA') AND AT_CONTACTS.ACTIVE_FLAG IN ('Y') AND (AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Establishment\\Establishment Code',multi,free,,Not_Persistent,,User:3) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Establishment\\Establishment Code',multi,free,,Not_Persistent,,User:3) */)))), dataset_base_ AS (SELECT DISTINCT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER.LAST_NAME, AT_OFFENDER.FIRST_NAME, AT_OFFENDER_CURFEWS.APPROVAL_STATUS, AT_OFFENDER_CURFEWS.DECISION_DATE, AT_HDC_REQUEST_REFERRALS.REFERRAL_DATE, AT_HDC_REQUEST_REFERRALS.RECEIVED_DATE, AT_HDC_REQUEST_REFERRALS.REFERRAL_TO, AT_OFFENDER_CURFEWS.REVIEW_FLAG, DT_ADMISSION.ADMISSION_DATE, AT_OFFENDERS_LOCATIONS.DESCRIPTION, COALESCE(AT_OFFENDER_SENT_CALCULATIONS.HDCED_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.HDCED_CALCULATED_DATE) AS HDCED_DATE, CASE WHEN NOT AT_OFFENDER_RELEASE_DETAILS.RELEASE_DATE IS NULL THEN AT_OFFENDER_RELEASE_DETAILS.RELEASE_DATE WHEN AT_OFFENDER_RELEASE_DETAILS.RELEASE_DATE IS NULL THEN DT_LAST_RELEASE_DATE.LAST_REL_DATE ELSE NULL END AS CURRENT_RELEASE_DATE, AT_SENT_ORDERS.COURT_DATE, CURR_EFF_SENT_LEN.CURR_EFF_SENT_LEN, CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_OFFENDER_CURFEWS.ASSESSMENT_DATE, AT_OFFENDER_CURFEWS.PASSED_FLAG, COALESCE(AT_OFFENDER_SENT_CALCULATIONS.CRD_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.CRD_CALCULATED_DATE) AS CRD_DATE, COALESCE(AT_OFFENDER_SENT_CALCULATIONS.ARD_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.ARD_CALCULATED_DATE) AS ARD_DATE, DP13_.CP_LAST_NAME FROM OMS_OWNER.OFFENDER_SENTENCES AT_OFFENDER_SENTENCES, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_SENT_CALCULATIONS AT_OFFENDER_SENT_CALCULATIONS, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS, OMS_OWNER.IMPRISONMENT_STATUSES AT_IMPRISON_STATUSES, OMS_OWNER.OFFENDER_CURFEWS AT_OFFENDER_CURFEWS, OMS_OWNER.HDC_REQUEST_REFERRALS AT_HDC_REQUEST_REFERRALS, (SELECT DISTINCT m.OFFENDER_BOOK_ID, MAX(m.MOVEMENT_TIME) AS ADMISSION_DATE FROM OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS m, OMS_OWNER.offender_bookings h WHERE h.booking_status = 'O' AND h.active_flag = 'Y' AND m.direction_code = 'IN' AND m.Movement_reason_code <> 'R' AND m.Movement_type = 'ADM' AND m.to_agy_loc_id = h.agy_loc_id AND h.offender_book_id = m.offender_book_id GROUP BY m.OFFENDER_BOOK_ID) DT_ADMISSION, USER_ACCESSIBLE_CASELOADS, OMS_OWNER.OFFENDER_RELEASE_DETAILS AT_OFFENDER_RELEASE_DETAILS, (SELECT AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID, CASE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.HDCAD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.HDCAD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.APD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.APD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.PRRD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.PRRD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.ARD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.ARD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.ARD_CALCULATED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.ARD_CALCULATED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.CRD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.CRD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.CRD_CALCULATED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.CRD_CALCULATED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.NPD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.NPD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.NPD_CALCULATED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.NPD_CALCULATED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.MTD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.MTD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.MTD_CALCULATED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.MTD_CALCULATED_DATE ELSE NULL END AS Last_Rel_Date, EFFECTIVE_SENTENCE_LENGTH FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS AT_OFFENDER_SENT_CALCULATIONS WHERE AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) DT_LAST_RELEASE_DATE, OMS_OWNER.ORDERS AT_SENT_ORDERS, (SELECT OFF_BOOK.OFFENDER_BOOK_ID, CASE WHEN LIFE_FLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE SENT_CALC.EFFECTIVE_SENTENCE_LENGTH END AS CURR_EFF_SENT_LEN FROM (SELECT DISTINCT OFFENDER_SENTENCE_TERMS.OFFENDER_BOOK_ID, OFFENDER_SENTENCE_TERMS.LIFE_SENTENCE_FLAG FROM OFFENDER_SENTENCE_TERMS WHERE OFFENDER_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y') LIFE_FLAG, OMS_OWNER.OFFENDER_SENT_CALCULATIONS SENT_CALC, OMS_OWNER.OFFENDER_BOOKINGS OFF_BOOK WHERE (OFF_BOOK.OFFENDER_BOOK_ID = SENT_CALC.OFFENDER_BOOK_ID (+)) AND (LIFE_FLAG.OFFENDER_BOOK_ID (+) = SENT_CALC.OFFENDER_BOOK_ID) AND SENT_CALC.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE SENT_CALC.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) CURR_EFF_SENT_LEN, OMS_OWNER.OFFENDER_IMPRISON_STATUSES AT_OFFENDER_IMPRISON_STATUSES, DP13_ WHERE ((AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_OFFENDER_CURFEWS.OFFENDER_BOOK_ID) AND (AT_OFFENDER_CURFEWS.OFFENDER_BOOK_ID = AT_HDC_REQUEST_REFERRALS.OFFENDER_BOOK_ID AND AT_OFFENDER_CURFEWS.OFFENDER_CURFEW_ID = AT_HDC_REQUEST_REFERRALS.OFFENDER_CURFEW_ID) AND (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.OFFENDER_BOOK_ID = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_SENTENCES.OFFENDER_BOOK_ID = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS = 'Y' OR AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS IS NULL) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_OFFENDER_RELEASE_DETAILS.OFFENDER_BOOK_ID) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */))) AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = USER_ACCESSIBLE_CASELOADS.CASELOAD_ID) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = DT_LAST_RELEASE_DATE.OFFENDER_BOOK_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (CURR_EFF_SENT_LEN.OFFENDER_BOOK_ID = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = AT_OFFENDER_IMPRISON_STATUSES.IMPRISONMENT_STATUS) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = DT_ADMISSION.OFFENDER_BOOK_ID) AND (AT_SENT_ORDERS.ORDER_ID = AT_OFFENDER_SENTENCES.ORDER_ID) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */))) AND (AT_OFFENDER_SENTENCES.SENTENCE_CATEGORY <> 'LICENCE' AND NOT AT_OFFENDER_SENTENCES.SENTENCE_CALC_TYPE LIKE '%AGG%') AND (COALESCE(AT_OFFENDER_SENT_CALCULATIONS.HDCED_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.HDCED_CALCULATED_DATE) >= (SELECT START_DATE FROM prompt_ /* = #prompt('HDCED Start Date:','D',,Mono,Free,Not_Persistent,,User:0) */) AND COALESCE(AT_OFFENDER_SENT_CALCULATIONS.HDCED_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.HDCED_CALCULATED_DATE) <= (SELECT END_DATE FROM prompt_ /* = #prompt('HDCED End Date:','D',,Mono,Free,Not_Persistent,,User:1) */) AND AT_OFFENDER_SENTENCES.SENTENCE_STATUS = 'A' AND (AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Establishment\\Establishment Code',multi,free,,Not_Persistent,,User:3) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Establishment\\Establishment Code',multi,free,,Not_Persistent,,User:3) */)))) AND (DP13_.OFFENDER_ID_DISPLAY = AT_OFFENDER.OFFENDER_ID_DISPLAY)), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, LAST_NAME, FIRST_NAME, APPROVAL_STATUS, DECISION_DATE, REFERRAL_DATE, RECEIVED_DATE, REFERRAL_TO, REVIEW_FLAG, ADMISSION_DATE, DESCRIPTION, HDCED_DATE, CURRENT_RELEASE_DATE, COURT_DATE, CURR_EFF_SENT_LEN, LEGAL_STATUS_GROUPING, ASSESSMENT_DATE, PASSED_FLAG, CRD_DATE, ARD_DATE, (TO_DATE(ADMISSION_DATE, 'DD/MM/YYYY') - TO_DATE(TRUNC(SYSDATE), 'DD/MM/YYYY')) AS V_DAYS_IN_ESTAB, MAX(COURT_DATE) AS V_MAX_DATE_OF_SENTENCE, CASE WHEN V_CA_FIRST_NAME IS NULL THEN 'Multiple - Check NOMIS' ELSE V_CA_FIRST_NAME END AS V_CA_FIRST_NAME_MV_FIX, CP_LAST_NAME AS V_CA_LAST_NAME, CASE WHEN REFERRAL_TO = 'OFFENDER' THEN 'Y' END AS V_REFERRAL_OFF, 'TBD' AS V_MAX_OFF_REC_D_DATE, CASE WHEN REFERRAL_TO = 'PROP ADDRESS' THEN 'Y' END AS V_REFERRAL_PROP_ADDRESS, CASE WHEN REFERRAL_TO = 'PROP ADDRESS' THEN REFERRAL_DATE END AS V_REFERRAL_PROP_ADDRESS_REFE37, CASE WHEN REFERRAL_TO = 'PROP ADDRESS' THEN RECEIVED_DATE END AS V_REFERRAL_PROP_ADDRESS_REC_34, CASE WHEN REFERRAL_TO = 'OM' THEN 'Y' END AS V_REFERRAL_OM, 'TBD' AS V_MAX_OM_REC_D_DATE, CASE WHEN REFERRAL_TO = 'OM ADDRESS' THEN 'Y' END AS V_REFERRAL_OM_ADDRESS, 'TBD' AS V_MAX_OM_ADDRESS_REC_D_DATE, CASE WHEN REFERRAL_TO = 'GOVERNOR' THEN 'Y' END AS V_REFERRAL_GOVERNOR, 'TBD' AS V_MAX_GOV_REC_D_DATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code (All for all)','A','Establishment\\Establishment Code',multi,free,,Not_Persistent,,User:3)",
          "mandatory": "true",
          "referenceType": "establishment"
        },
        {
          "index": 1,
          "name": "start_date",
          "filterType": "date",
          "reportFieldType": "date",
          "display": "HDCED Start Date:",
          "description": "@prompt('HDCED Start Date:','D',,Mono,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        },
        {
          "index": 2,
          "name": "end_date",
          "filterType": "date",
          "reportFieldType": "date",
          "display": "HDCED End Date:",
          "description": "@prompt('HDCED End Date:','D',,Mono,Free,Not_Persistent,,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP3.DO10044",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LAST_NAME",
            "type": "string",
            "display": "Last Name",
            "legacyId": "DP3.DO10045",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "First Name",
            "legacyId": "DP3.DO10046",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "APPROVAL_STATUS",
            "type": "string",
            "display": "HDC Approval Status",
            "legacyId": "DP3.DO9b2",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "DECISION_DATE",
            "type": "date",
            "display": "HDC Decision Date",
            "legacyId": "DP3.DO9ae",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "REFERRAL_DATE",
            "type": "date",
            "display": "HDC Referral Date",
            "legacyId": "DP3.DO9b0",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "RECEIVED_DATE",
            "type": "date",
            "display": "HDC Referral Received Date",
            "legacyId": "DP3.DO9af",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "REFERRAL_TO",
            "type": "string",
            "display": "HDC Referral To",
            "legacyId": "DP3.DO9b1",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "REVIEW_FLAG",
            "type": "string",
            "display": "HDC Review Flag",
            "legacyId": "DP3.DO9b3",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "ADMISSION_DATE",
            "type": "date",
            "display": "Admission Date",
            "legacyId": "DP3.DO10c6a",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Establishment Name",
            "legacyId": "DP3.DO1033b",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "HDCED_DATE",
            "type": "date",
            "display": "HDCED Date",
            "legacyId": "DP3.DO10463",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "CURRENT_RELEASE_DATE",
            "type": "date",
            "display": "Current Release Date",
            "legacyId": "DP3.DO10b29",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "COURT_DATE",
            "type": "date",
            "display": "Sentence Date",
            "legacyId": "DP3.DO110e7",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "CURR_EFF_SENT_LEN",
            "type": "string",
            "display": "Current Effective Sentence Length",
            "legacyId": "DP3.DO10bf6",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP3.DO1108a",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "ASSESSMENT_DATE",
            "type": "date",
            "display": "HDC Checks Done Date",
            "legacyId": "DP3.DO9ad",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "PASSED_FLAG",
            "type": "string",
            "display": "HDC Passed Flag",
            "legacyId": "DP3.DO9b4",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "CRD_DATE",
            "type": "date",
            "display": "CRD Date",
            "legacyId": "DP3.DO1046f",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "ARD_DATE",
            "type": "date",
            "display": "ARD Date",
            "legacyId": "DP3.DO1082d",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "V_DAYS_IN_ESTAB",
            "type": "string",
            "display": "V_DAYS_IN_ESTAB",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 21,
            "name": "V_MAX_DATE_OF_SENTENCE",
            "type": "string",
            "display": "V_MAX_DATE_OF_SENTENCE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 22,
            "name": "V_CA_FIRST_NAME_MV_FIX",
            "type": "string",
            "display": "V_CA_FIRST_NAME_MV_FIX",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 23,
            "name": "V_CA_LAST_NAME",
            "type": "string",
            "display": "V_CA_LAST_NAME",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 24,
            "name": "V_REFERRAL_OFF",
            "type": "string",
            "display": "V_REFERRAL_OFF",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 25,
            "name": "V_MAX_OFF_REC_D_DATE",
            "type": "string",
            "display": "V_MAX_OFF_REC_D_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 26,
            "name": "V_REFERRAL_PROP_ADDRESS",
            "type": "string",
            "display": "V_REFERRAL_PROP_ADDRESS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 27,
            "name": "V_REFERRAL_PROP_ADDRESS_REFE37",
            "type": "string",
            "display": "V_REFERRAL_PROP_ADDRESS_REFE37",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 28,
            "name": "V_REFERRAL_PROP_ADDRESS_REC_34",
            "type": "string",
            "display": "V_REFERRAL_PROP_ADDRESS_REC_34",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 29,
            "name": "V_REFERRAL_OM",
            "type": "string",
            "display": "V_REFERRAL_OM",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 30,
            "name": "V_MAX_OM_REC_D_DATE",
            "type": "string",
            "display": "V_MAX_OM_REC_D_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 31,
            "name": "V_REFERRAL_OM_ADDRESS",
            "type": "string",
            "display": "V_REFERRAL_OM_ADDRESS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 32,
            "name": "V_MAX_OM_ADDRESS_REC_D_DATE",
            "type": "string",
            "display": "V_MAX_OM_ADDRESS_REC_D_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 33,
            "name": "V_REFERRAL_GOVERNOR",
            "type": "string",
            "display": "V_REFERRAL_GOVERNOR",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 34,
            "name": "V_MAX_GOV_REC_D_DATE",
            "type": "string",
            "display": "V_MAX_GOV_REC_D_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3376286/DP13",
      "name": "Case Admin",
      "description": "OR - Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_PEOPLE.FIRST_NAME, AT_PEOPLE.LAST_NAME FROM OMS_OWNER.OFFENDER_SENTENCES AT_OFFENDER_SENTENCES, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_SENT_CALCULATIONS AT_OFFENDER_SENT_CALCULATIONS, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS, OMS_OWNER.PERSONS AT_PEOPLE, OMS_OWNER.OFFENDER_CONTACT_PERSONS AT_CONTACTS WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID (+)) AND (AT_OFFENDER_SENTENCES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_CONTACTS.OFFENDER_BOOK_ID (+)) AND (AT_PEOPLE.PERSON_ID (+) = AT_CONTACTS.PERSON_ID) AND (COALESCE(AT_OFFENDER_SENT_CALCULATIONS.HDCED_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.HDCED_CALCULATED_DATE) >= (SELECT START_DATE FROM prompt_ /* = #prompt('HDCED Start Date:','D',,Mono,Free,Not_Persistent,,User:0) */) AND COALESCE(AT_OFFENDER_SENT_CALCULATIONS.HDCED_OVERRIDED_DATE, AT_OFFENDER_SENT_CALCULATIONS.HDCED_CALCULATED_DATE) <= (SELECT END_DATE FROM prompt_ /* = #prompt('HDCED End Date:','D',,Mono,Free,Not_Persistent,,User:1) */) AND AT_OFFENDER_SENTENCES.SENTENCE_STATUS = 'A' AND AT_CONTACTS.RELATIONSHIP_TYPE IN ('CA') AND AT_CONTACTS.ACTIVE_FLAG IN ('Y') AND (AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Establishment\\Establishment Code',multi,free,,Not_Persistent,,User:3) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Establishment\\Establishment Code',multi,free,,Not_Persistent,,User:3) */)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, FIRST_NAME, LAST_NAME FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code (All for all)','A','Establishment\\Establishment Code',multi,free,,Not_Persistent,,User:3)",
          "mandatory": "true",
          "referenceType": "establishment"
        },
        {
          "index": 1,
          "name": "start_date",
          "filterType": "date",
          "reportFieldType": "date",
          "display": "HDCED Start Date:",
          "description": "@prompt('HDCED Start Date:','D',,Mono,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        },
        {
          "index": 2,
          "name": "end_date",
          "filterType": "date",
          "reportFieldType": "date",
          "display": "HDCED End Date:",
          "description": "@prompt('HDCED End Date:','D',,Mono,Free,Not_Persistent,,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP13.DO10044",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "CP First Name",
            "legacyId": "DP13.DO10ed9",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "LAST_NAME",
            "type": "string",
            "display": "CP Last Name",
            "legacyId": "DP13.DO10ed8",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "80010.RS",
      "name": "All HDC Eligible",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376286/DP3",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (HDC_APPROVAL_STATUS <> 'INELIGIBLE' AND HDCED_DATE IS NOT NULL AND HDC_REVIEW_FLAG <> 'Y' AND HDC_APPROVAL_STATUS <> 'INACTIVE'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ADMISSION_DATE",
            "display": "Admission Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO10c6a"
          },
          {
            "name": "$ref:V_DAYS_IN_ESTAB",
            "display": "No. of days in Estab.",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=DaysBetween([Admission Date];CurrentDate())"
          },
          {
            "name": "$ref:DESCRIPTION",
            "display": "Establishment Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO1033b"
          },
          {
            "name": "$ref:LAST_NAME",
            "display": "Last Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO10045"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "First Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO10046"
          },
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO10044"
          },
          {
            "name": "$ref:CURR_EFF_SENT_LEN",
            "display": "Current Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO10bf6"
          },
          {
            "name": "$ref:V_MAX_DATE_OF_SENTENCE",
            "display": "Date of Sentence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([Sentence Date])"
          },
          {
            "name": "$ref:LEGAL_STATUS_GROUPING",
            "display": "Legal Status Grouping",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO1108a"
          },
          {
            "name": "$ref:HDCED_DATE",
            "display": "HDCED Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO10463"
          },
          {
            "name": "$ref:ASSESSMENT_DATE",
            "display": "HDC Checks Done Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO9ad"
          },
          {
            "name": "$ref:V_CA_FIRST_NAME_MV_FIX",
            "display": "CA First Name",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsError([v_CA_First_Name]);\"Multiple - Check NOMIS\"; [v_CA_First_Name])"
          },
          {
            "name": "$ref:V_CA_LAST_NAME",
            "display": "CA Last Name",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[CP Last Name]"
          },
          {
            "name": "$ref:PASSED_FLAG",
            "display": "HDC Passed Flag",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO9b4"
          },
          {
            "name": "$ref:V_REFERRAL_OFF",
            "display": "Referred to Offender?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Referral To] = \"OFFENDER\"; \"Y\")"
          },
          {
            "name": "$ref:V_MIN_OFF_REFERRAL_DATE",
            "display": "Offender Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_referral_OFF_referral_date]) In ([Offenders].[NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_OFF_REC_D_DATE",
            "display": "Received from Offender",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([v_referral_OFF_rec'd_date]) In ([Offenders].[NOMS Number])"
          },
          {
            "name": "$ref:V_REFERRAL_PROP_ADDRESS",
            "display": "Referred to Prisoner for Proposed address?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Referral To] = \"PROP ADDRESS\"; \"Y\")"
          },
          {
            "name": "$ref:V_REFERRAL_PROP_ADDRESS_REFE37",
            "display": "Proposed address Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Referral To] = \"PROP ADDRESS\"; [HDC Referral Date])"
          },
          {
            "name": "$ref:V_REFERRAL_PROP_ADDRESS_REC_34",
            "display": "Address received from Offender",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Referral To] = \"PROP ADDRESS\"; [HDC Referral Received Date])"
          },
          {
            "name": "$ref:V_REFERRAL_OM",
            "display": "Referral to OM?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Referral To] = \"OM\"; \"Y\")"
          },
          {
            "name": "$ref:V_MIN_OM_REFERRAL_DATE",
            "display": "OM Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_referral_OM_referral_date]) In ([Offenders].[NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_OM_REC_D_DATE",
            "display": "Received from OM",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([v_referral_OM_rec'd_date]) In ([Offenders].[NOMS Number])"
          },
          {
            "name": "$ref:V_REFERRAL_OM_ADDRESS",
            "display": "Referred OM Address",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Referral To] = \"OM ADDRESS\"; \"Y\")"
          },
          {
            "name": "$ref:V_MIN_OM_ADDRESS_REFERRAL_DATE",
            "display": "OM Address Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_referral_OM_Address_referral_date]) In ([Offenders].[NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_OM_ADDRESS_REC_D_DATE",
            "display": "OM Address Received Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([v_referral_OM_ADDRESS_rec'd_date]) In ([Offenders].[NOMS Number])"
          },
          {
            "name": "$ref:V_REFERRAL_GOVERNOR",
            "display": "Referred to Governor?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDC Referral To] = \"GOVERNOR\"; \"Y\")"
          },
          {
            "name": "$ref:V_MIN_GOV_REFERRAL_DATE",
            "display": "Governor Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_referral_GOVERNOR_referral_date]) In ([Offenders].[NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_GOV_REC_D_DATE",
            "display": "Received from Governor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([v_referral_GOVERNOR_rec'd_date]) In ([Offenders].[NOMS Number])"
          },
          {
            "name": "$ref:APPROVAL_STATUS",
            "display": "HDC Approval Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO9b2"
          },
          {
            "name": "$ref:DECISION_DATE",
            "display": "HDC Decision Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO9ae"
          },
          {
            "name": "$ref:ARD_DATE",
            "display": "ARD Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO1082d"
          },
          {
            "name": "$ref:CRD_DATE",
            "display": "CRD Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO1046f"
          },
          {
            "name": "$ref:CURRENT_RELEASE_DATE",
            "display": "Current Release Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP3.DO10b29"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_OFF_REC_D_DATE :: Error: =Max([v_referral_OFF_rec'd_date]) In ([Offenders].[NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_OM_REC_D_DATE :: Error: =Max([v_referral_OM_rec'd_date]) In ([Offenders].[NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_OM_ADDRESS_REC_D_DATE :: Error: =Max([v_referral_OM_ADDRESS_rec'd_date]) In ([Offenders].[NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_GOV_REC_D_DATE :: Error: =Max([v_referral_GOVERNOR_rec'd_date]) In ([Offenders].[NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MIN_OFF_REFERRAL_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 38.\n  MIN(V_REFERRAL_OFF_REFERRAL_DATE) IN \u001b[4m,\u001b[0mOFFENDERS.OFFENDER_ID_DISPLAY,",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_OFF_REC_D_DATE :: Error: =Max([v_referral_OFF_rec'd_date]) In ([Offenders].[NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MIN_OM_REFERRAL_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 37.\n  MIN(V_REFERRAL_OM_REFERRAL_DATE) IN \u001b[4m,\u001b[0mOFFENDERS.OFFENDER_ID_DISPLAY,",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_OM_REC_D_DATE :: Error: =Max([v_referral_OM_rec'd_date]) In ([Offenders].[NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MIN_OM_ADDRESS_REFERRAL_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 45.\n  MIN(V_REFERRAL_OM_ADDRESS_REFERRAL_DATE) IN \u001b[4m,\u001b[0mOFFENDERS.OFFENDER_ID_DISPLAY,",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_OM_ADDRESS_REC_D_DATE :: Error: =Max([v_referral_OM_ADDRESS_rec'd_date]) In ([Offenders].[NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MIN_GOV_REFERRAL_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 43.\n  MIN(V_REFERRAL_GOVERNOR_REFERRAL_DATE) IN \u001b[4m,\u001b[0mOFFENDERS.OFFENDER_ID_DISPLAY,",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_GOV_REC_D_DATE :: Error: =Max([v_referral_GOVERNOR_rec'd_date]) In ([Offenders].[NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FizjLGCjVgwAH30BAHB7QF9pACJIAAzC",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report field V_MIN_OFF_REFERRAL_DATE does not have corresponding dataset schema field",
      "entityId": "80010.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MIN_OM_REFERRAL_DATE does not have corresponding dataset schema field",
      "entityId": "80010.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MIN_OM_ADDRESS_REFERRAL_DATE does not have corresponding dataset schema field",
      "entityId": "80010.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MIN_GOV_REFERRAL_DATE does not have corresponding dataset schema field",
      "entityId": "80010.RS",
      "entityType": "variant"
    },
    {
      "type": "sqlQuery",
      "error": "Error: ORA-00904: \"V_CA_FIRST_NAME\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/",
      "entityId": "3376286/DP3",
      "entityType": "dataset"
    }
  ]
}