{
  "id": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
  "name": "MIS NSR860 DRAFT Data for Approved Premises TEST",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "MOV00 v00.00.01"
    ]
  },
  "description": "<br/>MOV00 v00.00.01 Last Modified: 31/01/2020",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP2",
      "name": "Discharges",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING_BAH.BOOKING_NUMBER, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH END AS EFFECTIVE_SENTENCE_LENGTH, AT_FACT_MOV_EXT.MOVEMENT_TIME, AT_FACT_MOV_EXT.REASON_CODE, AT_FACT_MOV_EXT.TYPE, AT_FACT_MOV_EXT.DIRECTION_CODE, DT_EXT_MOVE_TO.TYPE_DESCRIPTION_TO, DT_EXT_MOVE_FROM.TYPE_DESCRIPTION_FROM, AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_DESCRIPTION, AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION AS MOVEMENT_LOCATION_FROM_DESCR35, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_DESCRIPTION, CASE WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA') THEN 'Recall' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '0' THEN 'Dead' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '1' THEN 'Indeterminate Sentence' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('2', '3') THEN 'Sentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('9', '10') OR AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'CIV_RMD' THEN 'Civil Prisoner' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('8', '11') THEN 'Immigration Detainee' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('12', '13', '14') THEN 'Remand' WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_FACT_MOV_EXT.REASON, AT_DIM_DATE_EXT_MOV.DAY_DATE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, FACT_CURR_KEY_DATES_SENT, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_TO, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_TO, 'Establishment' AS Location_Type_To FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_To FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_To FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_To FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_To FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_TO, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_FROM, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_FROM, 'Establishment' AS Location_Type_FROM FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_From FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_From FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_From FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_From FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_FROM, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_TO, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (CASE WHEN AT_FACT_MOV_EXT.TO_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.TO_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_SK (+)) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_FACT_MOV_EXT.TO_LOCATION_SK = DT_EXT_MOVE_TO.SK_ID_TO (+) AND AT_FACT_MOV_EXT.TO_LOCATION_TYPE = DT_EXT_MOVE_TO.LOCATION_TYPE_TO (+)) AND (AT_FACT_MOV_EXT.FROM_LOCATION_SK = DT_EXT_MOVE_FROM.SK_ID_FROM (+) AND AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = DT_EXT_MOVE_FROM.LOCATION_TYPE_FROM (+)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OUTSIDE', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('08-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, BOOKING_NUMBER, EFFECTIVE_SENTENCE_LENGTH, MOVEMENT_TIME, REASON_CODE, TYPE, DIRECTION_CODE, TYPE_DESCRIPTION_TO, TYPE_DESCRIPTION_FROM, ESTABLISHMENT_DESCRIPTION, MOVEMENT_LOCATION_FROM_DESCR35, MAIN_LEGAL_STATUS_DESCRIPTION, LEGAL_STATUS_GROUPING, REASON, DAY_DATE, 'TBD' AS V_MAX_CONCAT_MAIN_OFFENCE, RISK_LEVEL_ AS V_ROSH, 'TBD' AS V_MAX_CONCAT_MAPPA_CAT, 'TBD' AS V_MAX_CONCAT_MAPPA_LEVEL, CASE WHEN MAPPA_ALERTS.ALERT_CODE_NK = 'PVN' THEN MAPPA_ALERTS.ALERT_DESCRIPTION END AS V_VISOR_NOMINAL, DISCHARGES.DAY_DATE AS V_RELEASE_DATE, 'TBD' AS V_RECEPTION_AFTER_RELEASE_DI34, V_REHAB_PROVIDER AS V_REHAB_PROVIDER_DISPLAY FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP2.DO10b05",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "EFFECTIVE_SENTENCE_LENGTH",
            "type": "string",
            "display": "Effective Sentence Length",
            "legacyId": "DP2.DO2d0",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Movement Date and Time (External)",
            "legacyId": "DP2.DO103eb",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "REASON_CODE",
            "type": "string",
            "display": "Movement Reason Code (External)",
            "legacyId": "DP2.DO103fc",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "TYPE",
            "type": "string",
            "display": "Movement Type (External)",
            "legacyId": "DP2.DO103ec",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "DIRECTION_CODE",
            "type": "string",
            "display": "Movement Direction Code (External)",
            "legacyId": "DP2.DO103fd",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "TYPE_DESCRIPTION_TO",
            "type": "string",
            "display": "Movement Description (To)",
            "legacyId": "DP2.DO106ff",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "TYPE_DESCRIPTION_FROM",
            "type": "string",
            "display": "Movement Description (From)",
            "legacyId": "DP2.DO10700",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Movement Location To Description (External)",
            "legacyId": "DP2.DO1015e",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "MOVEMENT_LOCATION_FROM_DESCR35",
            "type": "string",
            "display": "Movement Location From Description (External)",
            "legacyId": "DP2.DO1015d",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "MAIN_LEGAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Main Legal Status Description",
            "legacyId": "DP2.DO100df",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP2.DO107cb",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "REASON",
            "type": "string",
            "display": "Movement Description (External)",
            "legacyId": "DP2.DO1015b",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DP2.DO1015c",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "V_MAX_CONCAT_MAIN_OFFENCE",
            "type": "string",
            "display": "V_MAX_CONCAT_MAIN_OFFENCE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 16,
            "name": "V_ROSH",
            "type": "string",
            "display": "V_ROSH",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 17,
            "name": "V_MAX_CONCAT_MAPPA_CAT",
            "type": "string",
            "display": "V_MAX_CONCAT_MAPPA_CAT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 18,
            "name": "V_MAX_CONCAT_MAPPA_LEVEL",
            "type": "string",
            "display": "V_MAX_CONCAT_MAPPA_LEVEL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 19,
            "name": "V_VISOR_NOMINAL",
            "type": "string",
            "display": "V_VISOR_NOMINAL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 20,
            "name": "V_RELEASE_DATE",
            "type": "string",
            "display": "V_RELEASE_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 21,
            "name": "V_RECEPTION_AFTER_RELEASE_DI34",
            "type": "string",
            "display": "V_RECEPTION_AFTER_RELEASE_DI34",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 22,
            "name": "V_REHAB_PROVIDER_DISPLAY",
            "type": "string",
            "display": "V_REHAB_PROVIDER_DISPLAY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP9",
      "name": "Receptions after release",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING_BAH.BOOKING_NUMBER, AT_DIM_DATE_EXT_MOV.DAY_DATE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_TO, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.TO_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.TO_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_SK (+)) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND (AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'North West /West Midlands /Wales', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Admission' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'IN' AND NOT AT_FACT_MOV_EXT.REASON_CODE IN ('NOTR', 'TRN', 'INT', 'M'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, BOOKING_NUMBER, DAY_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP9.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP9.DO10b05",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DP9.DO1015c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP8",
      "name": "MAPPA Alerts",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE, AT_ALERT.ALERT_DESCRIPTION FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('08-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE' AND CASE WHEN AT_ALERT.ALERT_ACTIVE_FLAG = 'Y' THEN AT_ALERT.ALERT_TYPE_NK END = 'P')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK, ALERT_EFFECTIVE_DATE, ALERT_DESCRIPTION FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP8.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code and Description",
            "legacyId": "DP8.DO1092b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DP8.DO10095",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DP8.DO10090",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPa",
      "name": "Main Offence",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_OFFENCE.OFFENCE_NAME FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('08-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND AT_FACT_COURT_CHARGE.MOST_SERIOUS_FLAG = 'Y')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OFFENCE_NAME FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPa.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DPa.DO4b",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPb",
      "name": "OASys Risk Alerts",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE, AT_ALERT.ALERT_DESCRIPTION FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('08-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE' AND AT_ALERT.ALERT_CODE_NK IN ('ROH', 'ROM', 'ROV'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK, ALERT_EFFECTIVE_DATE, ALERT_DESCRIPTION FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPb.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code and Description",
            "legacyId": "DPb.DO1092b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DPb.DO10095",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DPb.DO10090",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DPc",
      "name": "Provider",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK > 0 THEN BODIMIS.DIM_REHAB_PROVIDER.CODE_NK END AS REHAB_PROVIDER_CODE, CASE WHEN BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK > 0 THEN BODIMIS.DIM_REHAB_PROVIDER.DESCRIPTION END AS REHAB_PROVIDER_DESCRIPTION, AT_OFFENDER_BOOKING.BOOKING_NUMBER FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_REHAB_PROVIDER, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.FACT_OFFENDER_REHAB WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER('DPRWS') AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.FACT_OFFENDER_REHAB.OFFENDER_BOOKING_SK (+)) AND (BODIMIS.FACT_OFFENDER_REHAB.REHAB_PROVIDER_SK = BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK (+)) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('08-04-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND (BODIMIS.FACT_OFFENDER_REHAB.PROVIDER_ACTIVE_FLAG = 'Y' OR BODIMIS.FACT_OFFENDER_REHAB.PROVIDER_ACTIVE_FLAG IS NULL) AND (BODIMIS.FACT_OFFENDER_REHAB.DECISION_ACTIVE_FLAG = 'Y' OR BODIMIS.FACT_OFFENDER_REHAB.DECISION_ACTIVE_FLAG IS NULL))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, REHAB_PROVIDER_CODE, REHAB_PROVIDER_DESCRIPTION, BOOKING_NUMBER FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPc.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "REHAB_PROVIDER_CODE",
            "type": "string",
            "display": "Rehab Provider Code",
            "legacyId": "DPc.DOb37",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "REHAB_PROVIDER_DESCRIPTION",
            "type": "string",
            "display": "Rehab Provider Description",
            "legacyId": "DPc.DOb38",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DPc.DO77",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375896/DPd",
      "name": "OASys",
      "description": "Ad-hoc Reports",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT OFFENDER.OFFENDER_ID_DISPLAY, SUBSTR(ASSESSMENT.CALC_HIGHEST_RISK, 4) AS RISK_LEVEL_, ASSESSMENT.DATE_COMPLETED FROM OFFENDER, ASSESSMENT WHERE (OFFENDER.OFFENDER_ID = ASSESSMENT.OFFENDER_ID (+)) AND (SUBSTR(OFFENDER.OFFENDER_ID_DISPLAY, 1, 10) = TAGMIS_CASELOAD_SECURITY('DPRWS', OFFENDER.OFFENDER_ID_DISPLAY)) AND ASSESSMENT.ASSESSMENT_ID IN (SELECT LAST_VALUE(ASSESSMENT.assessment_id) OVER (PARTITION BY ASSESSMENT.offender_id ORDER BY ASSESSMENT.date_completed rows BETWEEN CURRENT ROW AND UNBOUNDED following) AS last_ass_for_offender FROM ASSESSMENT, OFFENDER WHERE (OFFENDER.OFFENDER_ID = ASSESSMENT.OFFENDER_ID (+)) AND (ASSESSMENT.single_date_completed = 'Y' AND completed_assessment <> 'Abandoned' AND NOT OFFENDER.Offender_id IS NULL) AND (SUBSTR(OFFENDER.OFFENDER_ID_DISPLAY, 1, 10) = TAGMIS_CASELOAD_SECURITY('DPRWS', OFFENDER.OFFENDER_ID_DISPLAY)) AND (COALESCE(ASSESSMENT.COMPLETED_ASSESSMENT, 'Not Specified') = 'True' AND OFFENDER.HISTORIC_OFFENDER_CALC = 'Current'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, RISK_LEVEL_, DATE_COMPLETED FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPd.DO264",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "RISK_LEVEL_",
            "type": "string",
            "display": "Risk Level (10 6)",
            "legacyId": "DPd.DOf2f",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DATE_COMPLETED",
            "type": "date",
            "display": "Date Completed",
            "legacyId": "DPd.DO5e5",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP3",
      "name": "Load End Date",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP3.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "137598.RS",
      "name": "Discharges by Date",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10b05"
          },
          {
            "name": "$ref:LEGAL_STATUS_GROUPING",
            "display": "Legal Status Grouping",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO107cb"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO100df"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAIN_OFFENCE",
            "display": "Main Offence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_main_offence] Where ([v_Main_Offence]= [v_max_main_offence]) In ([NOMS Number])"
          },
          {
            "name": "$ref:EFFECTIVE_SENTENCE_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO2d0"
          },
          {
            "name": "$ref:V_ROSH",
            "display": "RoH (from OASys assessment)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Risk Level (10 6)]"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAPPA_CAT",
            "display": "MAPPA Cat.",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_MAPPA_Cat] Where ([v_MAPPA_Category]= [v_max_MAPPA_Cat]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAPPA_LEVEL",
            "display": "MAPPA Level",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_MAPPA_Level] Where ([v_MAPPA_Level]= [v_max_MAPPA_Level]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_VISOR_NOMINAL",
            "display": "ViSOR Nominal",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[MAPPA Alerts].[Alert Description] Where ([MAPPA Alerts].[Alert Code and Description] = \"PVN\")"
          },
          {
            "name": "$ref:TYPE_DESCRIPTION_FROM",
            "display": "Movement Description (From)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10700"
          },
          {
            "name": "$ref:REASON_CODE",
            "display": "Movement Reason Code (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO103fc"
          },
          {
            "name": "$ref:REASON",
            "display": "Movement Description (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1015b"
          },
          {
            "name": "$ref:V_RELEASE_DATE",
            "display": "Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Discharges].[Movement Date Only (External)]"
          },
          {
            "name": "$ref:V_RECEPTION_AFTER_RELEASE_DI34",
            "display": "Admission after release?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number])"
          },
          {
            "name": "$ref:V_REHAB_PROVIDER_DISPLAY",
            "display": "Rehab Provider",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_Rehab_Provider]"
          }
        ]
      }
    },
    {
      "id": "140753.RS",
      "name": "Discharges by Establishment",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10b05"
          },
          {
            "name": "$ref:LEGAL_STATUS_GROUPING",
            "display": "Legal Status Grouping",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO107cb"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO100df"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAIN_OFFENCE",
            "display": "Main Offence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_main_offence] Where ([v_Main_Offence]= [v_max_main_offence]) In ([NOMS Number])"
          },
          {
            "name": "$ref:EFFECTIVE_SENTENCE_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO2d0"
          },
          {
            "name": "$ref:V_ROSH",
            "display": "RoH (from OASys assessment)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Risk Level (10 6)]"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAPPA_CAT",
            "display": "MAPPA Cat.",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_MAPPA_Cat] Where ([v_MAPPA_Category]= [v_max_MAPPA_Cat]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAPPA_LEVEL",
            "display": "MAPPA Level",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_MAPPA_Level] Where ([v_MAPPA_Level]= [v_max_MAPPA_Level]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_VISOR_NOMINAL",
            "display": "ViSOR Nominal",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[MAPPA Alerts].[Alert Description] Where ([MAPPA Alerts].[Alert Code and Description] = \"PVN\")"
          },
          {
            "name": "$ref:TYPE_DESCRIPTION_FROM",
            "display": "Movement Description (From)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10700"
          },
          {
            "name": "$ref:REASON_CODE",
            "display": "Movement Reason Code (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO103fc"
          },
          {
            "name": "$ref:REASON",
            "display": "Movement Description (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1015b"
          },
          {
            "name": "$ref:MOVEMENT_TIME",
            "display": "Movement Date and Time (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO103eb"
          },
          {
            "name": "$ref:V_RECEPTION_AFTER_RELEASE_DI34",
            "display": "Admission after release?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number])"
          },
          {
            "name": "$ref:V_REHAB_PROVIDER_DISPLAY",
            "display": "Rehab Provider",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_Rehab_Provider]"
          }
        ]
      }
    },
    {
      "id": "140820.RS",
      "name": "Discharges by NOMS Number",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10b05"
          },
          {
            "name": "$ref:LEGAL_STATUS_GROUPING",
            "display": "Legal Status Grouping",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO107cb"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO100df"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAIN_OFFENCE",
            "display": "Main Offence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_main_offence] Where ([v_Main_Offence]= [v_max_main_offence]) In ([NOMS Number])"
          },
          {
            "name": "$ref:EFFECTIVE_SENTENCE_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO2d0"
          },
          {
            "name": "$ref:V_ROSH",
            "display": "RoH (from OASys assessment)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Risk Level (10 6)]"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAPPA_CAT",
            "display": "MAPPA Cat.",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_MAPPA_Cat] Where ([v_MAPPA_Category]= [v_max_MAPPA_Cat]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MAPPA_LEVEL",
            "display": "MAPPA Level",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_MAPPA_Level] Where ([v_MAPPA_Level]= [v_max_MAPPA_Level]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_VISOR_NOMINAL",
            "display": "ViSOR Nominal",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[MAPPA Alerts].[Alert Description] Where ([MAPPA Alerts].[Alert Code and Description] = \"PVN\")"
          },
          {
            "name": "$ref:TYPE_DESCRIPTION_FROM",
            "display": "Movement Description (From)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10700"
          },
          {
            "name": "$ref:REASON_CODE",
            "display": "Movement Reason Code (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO103fc"
          },
          {
            "name": "$ref:REASON",
            "display": "Movement Description (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1015b"
          },
          {
            "name": "$ref:MOVEMENT_TIME",
            "display": "Movement Date and Time (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO103eb"
          },
          {
            "name": "$ref:V_RECEPTION_AFTER_RELEASE_DI34",
            "display": "Admission after release?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number])"
          },
          {
            "name": "$ref:V_REHAB_PROVIDER_DISPLAY",
            "display": "Rehab Provider",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_Rehab_Provider]"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_MAIN_OFFENCE :: Error: =[v_concat_main_offence] Where ([v_Main_Offence]= [v_max_main_offence]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:73",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_MAPPA_CAT :: Error: =[v_concat_MAPPA_Cat] Where ([v_MAPPA_Category]= [v_max_MAPPA_Cat]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:69",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_MAPPA_LEVEL :: Error: =[v_concat_MAPPA_Level] Where ([v_MAPPA_Level]= [v_max_MAPPA_Level]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:70",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_RECEPTION_AFTER_RELEASE_DI34 :: Error: =If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_MAIN_OFFENCE :: Error: =[v_concat_main_offence] Where ([v_Main_Offence]= [v_max_main_offence]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:73",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_ROSH :: ReferenceError: error is not defined",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_MAPPA_CAT :: Error: =[v_concat_MAPPA_Cat] Where ([v_MAPPA_Category]= [v_max_MAPPA_Cat]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:69",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_MAPPA_LEVEL :: Error: =[v_concat_MAPPA_Level] Where ([v_MAPPA_Level]= [v_max_MAPPA_Level]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:70",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RECEPTION_AFTER_RELEASE_DI34 :: Error: =If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FhsQj14mZQUAGpAAAHDrLV8VACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP2",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375896/DPd",
      "entityType": "dataset"
    }
  ]
}