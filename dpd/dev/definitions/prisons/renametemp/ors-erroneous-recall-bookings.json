{
  "id": "kld1AGgADDlUF.4A3v8AISgXYiw",
  "name": "ORS Erroneous Recall Bookings ",
  "description": "This report returns a list of prisoners who are currently on erroneous book numbers e.g. those incorrectly received on a new book number but have been recalled for an early period of custody.<br/>DQ0018 - v1.4 Last Modified: 18/01/2018         ",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "DQ0018",
      "recall",
      "erroneous",
      "Booking"
    ]
  },
  "datasource": [
    {
      "id": "nomis",
      "name": "NOMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "nomis"
    }
  ],
  "dataset": [
    {
      "id": "3376286/DP8",
      "name": "Main Data",
      "description": "OR - Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER.FIRST_NAME, AT_OFFENDER.LAST_NAME, AT_SENT_ORDERS.COURT_DATE, AT_OFFENDER_SENTENCES.SENTENCE_STATUS, AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS, AT_OFFENDER_BOOKING.IN_OUT_STATUS, AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID, CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_OFFENDER_BOOKING.BOOKING_STATUS, AT_OFFENDER_BOOKING.BOOKING_BEGIN_DATE, AT_OFFENDER_BOOKING.BOOKING_NO, AT_OFFENDER_SENTENCES.SENTENCE_CATEGORY FROM OMS_OWNER.OFFENDER_SENTENCES AT_OFFENDER_SENTENCES, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.IMPRISONMENT_STATUSES AT_IMPRISON_STATUSES, OMS_OWNER.ORDERS AT_SENT_ORDERS, OMS_OWNER.OFFENDER_IMPRISON_STATUSES AT_OFFENDER_IMPRISON_STATUSES WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_SENTENCES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS = 'Y' OR AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS IS NULL) AND (AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS (+) = AT_OFFENDER_IMPRISON_STATUSES.IMPRISONMENT_STATUS) AND (AT_SENT_ORDERS.ORDER_ID = AT_OFFENDER_SENTENCES.ORDER_ID) AND (AT_OFFENDER_SENTENCES.SENTENCE_CATEGORY <> 'LICENCE' AND NOT AT_OFFENDER_SENTENCES.SENTENCE_CALC_TYPE LIKE '%AGG%') AND (AT_OFFENDER.OFFENDER_ID_DISPLAY IN ('A0023ET', 'A0035EL', 'A0067EQ', 'A0067ER', 'A0095EJ', 'A0097DT', 'A0099ET', 'A0122EP', 'A0123EP', 'A0150DQ', 'A0156AD', 'A0170AD', 'A0185DY', 'A0186AE', 'A0205DT', 'A0217DG', 'A0250AC', 'A0292ER', 'A0304DF', 'A0318ER', 'A0336CT', 'A0357EE', 'A0363AK', 'A0363EP', 'A0376ET', 'A0419AJ', 'A0447ET', 'A0457ER', 'A0494ET', 'A0521AE', 'A0530ET', 'A0588ER', 'A0590ET', 'A0611AZ', 'A0645ET', 'A0662AK', 'A0671AZ', 'A0684ER', 'A0704EQ', 'A0711CH', 'A0712EE', 'A0730CZ', 'A0744AG', 'A0781CQ', 'A0791AC', 'A0860ER', 'A0984EA', 'A0993DH', 'A1035AC', 'A1068ER', 'A1071CL', 'A1100EQ', 'A1124AZ', 'A1156ER', 'A1163AX', 'A1196AN', 'A1204EP', 'A1217EE', 'A1267CL', 'A1277CV', 'A1296AF', 'A1417DJ', 'A1431EQ', 'A1441CY', 'A1466AW', 'A1467AW', 'A1515CL', 'A1516EC', 'A1586DD', 'A1604EM', 'A1630ER', 'A1640EP', 'A1652AE', 'A1658AE', 'A1760DJ', 'A1792AX', 'A1795AW', 'A1867EC', 'A1932AF', 'A1936AV', 'A2015DW', 'A2025AT', 'A2028DT', 'A2045EQ', 'A2050CC', 'A2061EJ', 'A2074ER', 'A2104EG', 'A2281EH', 'A2290EQ', 'A2303AC', 'A2318EM', 'A2329AL', 'A2341AC', 'A2347DQ', 'A2392EP', 'A2448EK', 'A2556EP', 'A2594AE', 'A2688EQ', 'A2736DK', 'A2763EE', 'A2774EF', 'A2792DP', 'A2850ER', 'A2866ED', 'A2949AV', 'A2963EM', 'A2976EA', 'A2989DJ', 'A3004EQ', 'A3090CR', 'A3145ED', 'A3195EQ', 'A3277AP', 'A3310CJ', 'A3353DP', 'A3364DX', 'A3449AD', 'A3587CT', 'A3619EE', 'A3675AQ', 'A3684AC', 'A3687ER', 'A3688AJ', 'A3715CQ', 'A3731DD', 'A3741AE', 'A3818AY', 'A3824CY', 'A3830AH', 'A3918AP', 'A3933AC', 'A3937ER', 'A3942CZ', 'A3967AL', 'A4107AJ', 'A4183EN', 'A4189ER', 'A4229CP', 'A4235AZ', 'A4236DX', 'A4238DW', 'A4242CH', 'A4342AY', 'A4410DM', 'A4457ER', 'A4472AD', 'A4482CG', 'A4522AR', 'A4547EC', 'A4582AC', 'A4590AL', 'A4592DN', 'A4680EM', 'A4681EG', 'A4699EQ', 'A4767DD', 'A4835CP', 'A4851CZ', 'A4903AC', 'A4918EQ', 'A5053ER', 'A5086AV', 'A5195CN', 'A5202AF', 'A5211DL', 'A5233CX', 'A5299EF', 'A5305ER', 'A5323EF', 'A5334DE', 'A5375AF', 'A5412DE', 'A5440CW', 'A5456ER', 'A5462CR', 'A5593CJ', 'A5641CG', 'A5720DW', 'A5734CV', 'A5736ER', 'A5768EQ', 'A5778DE', 'A5812EQ', 'A5953AP', 'A5960EP', 'A5997EQ', 'A6009EQ', 'A6019AZ', 'A6081AP', 'A6086ER', 'A6109EP', 'A6121DW', 'A6162AW', 'A6176ER', 'A6267DE', 'A6311DQ', 'A6332EP', 'A6366EQ', 'A6371ER', 'A6381AD', 'A6381EC', 'A6383AM', 'A6399EN', 'A6403AC', 'A6452EH', 'A6454DG', 'A6469AH', 'A6496AA', 'A6536AC', 'A6579AA', 'A6587AA', 'A6598AA', 'A6603CH', 'A6605EE', 'A6696ER', 'A6728CN', 'A6730AX', 'A6743EQ', 'A6759CP', 'A6801AK', 'A6826AA', 'A6843AA', 'A6868AR', 'A6871EQ', 'A6897DQ', 'A6921AA', 'A6933ER', 'A6947AK', 'A6954AK', 'A6993DZ', 'A7032EQ', 'A7034AY', 'A7144EQ', 'A7148EP', 'A7167DC', 'A7224ER', 'A7256EG', 'A7257CE', 'A7261EP', 'A7265AQ', 'A7290DC', 'A7298EA', 'A7298ER', 'A7326ER', 'A7331AA', 'A7335ER', 'A7370AA', 'A7371AE', 'A7428DA', 'A7460AD', 'A7489DE', 'A7534DV', 'A7591AA', 'A7601AW', 'A7604AH', 'A7624DQ', 'A7672DT', 'A7716EQ', 'A7718CX', 'A7754AA', 'A7772ER', 'A7847CZ', 'A7851CG', 'A7873AA', 'A7924AA', 'A7955EL', 'A7963AV', 'A7966ED', 'A8056DJ', 'A8061ER', 'A8129ER', 'A8154AD', 'A8203EP', 'A8210EF', 'A8242CW', 'A8250DR', 'A8259AA', 'A8261DC', 'A8278EQ', 'A8285EQ', 'A8287DJ', 'A8307DH', 'A8318AD', 'A8318DT', 'A8338ER', 'A8357AA', 'A8387AD', 'A8398AA', 'A8504AV', 'A8510CG', 'A8528ER', 'A8532ER', 'A8548DJ', 'A8564DR', 'A8579ER', 'A8677AA', 'A8721ER', 'A8722DG', 'A8760AA', 'A8806DD', 'A8826AA', 'A8879ER', 'A8880CM', 'A8882CV', 'A9012AA', 'A9029AV', 'A9030AT', 'A9033ER', 'A9041AA', 'A9080ER', 'A9138AA', 'A9146AG', 'A9200EP', 'A9246AJ', 'A9268ER', 'A9282ER', 'A9310ER', 'A9315ER', 'A9332DH', 'A9332ER', 'A9354ER', 'A9366DN', 'A9379EC', 'A9386ER', 'A9429AA', 'A9432ER', 'A9433AA', 'A9436EQ', 'A9437AV', 'A9441AL', 'A9466EP', 'A9508CG', 'A9567EQ', 'A9577ER', 'A9617EQ', 'A9640ER', 'A9662CT', 'A9673ER', 'A9722AZ', 'A9726DK', 'A9735DE', 'A9771AF', 'A9774EP', 'A9792CE', 'A9818AA', 'A9838AW', 'A9849CP', 'A9860DY', 'A9889EA', 'A9922ER', 'A9923ER', 'A9924ER', 'A9929ER', 'A9934DJ', 'A9973ER', 'A9974ER') OR AT_OFFENDER.OFFENDER_ID_DISPLAY IN ('A0015CV', 'A0017ET', 'A0022CF', 'A0031ET', 'A0035CX', 'A0036EQ', 'A0036ET', 'A0038ET', 'A0067CM', 'A0095ET', 'A0118EP', 'A0121EP', 'A0129ET', 'A0154ET', 'A0230AC', 'A0246ER', 'A0274DE', 'A0321CT', 'A0338AF', 'A0377ET', 'A0387EP', 'A0451ER', 'A0454AH', 'A0500CK', 'A0519DJ', 'A0589AC', 'A0612ET', 'A0666ET', 'A0667AF', 'A0686CY', 'A0734CF', 'A0749DQ', 'A0755CZ', 'A0801CD', 'A0828ER', 'A0832DG', 'A0884ER', 'A0933DR', 'A0990AL', 'A1014AL', 'A1024AC', 'A1089AC', 'A1150DD', 'A1212AC', 'A1228AC', 'A1230EL', 'A1269EK', 'A1332CG', 'A1382DK', 'A1416ER', 'A1429EG', 'A1463AT', 'A1537AK', 'A1538AG', 'A1543AL', 'A1577DY', 'A1753CQ', 'A1763ER', 'A1789CQ', 'A1812ER', 'A1935CZ', 'A1985CC', 'A1994DP', 'A2020EG', 'A2052ER', 'A2071ER', 'A2082EP', 'A2134ER', 'A2139DW', 'A2194EA', 'A2205CQ', 'A2211DH', 'A2279DQ', 'A2335ER', 'A2343EP', 'A2429CY', 'A2478ER', 'A2506EQ', 'A2520EQ', 'A2590DA', 'A2597ER', 'A2608EQ', 'A2612EQ', 'A2638EP', 'A2654EQ', 'A2671DF', 'A2696DR', 'A2721DA', 'A2779AG', 'A2791CF', 'A2848EP', 'A2856ER', 'A2874CF', 'A2937AV', 'A3018DZ', 'A3047CN', 'A3097AG', 'A3129AG', 'A3146CG', 'A3166CJ', 'A3215EK', 'A3237AC', 'A3244EK', 'A3367ER', 'A3427CM', 'A3430AY', 'A3431ER', 'A3530CJ', 'A3571DF', 'A3616EN', 'A3669AE', 'A3691ER', 'A3692CP', 'A3703EQ', 'A3706EQ', 'A3753AC', 'A3759AV', 'A3814CZ', 'A3822DK', 'A3879ER', 'A3916ER', 'A3919CN', 'A3956EJ', 'A3957EP', 'A4028EP', 'A4232ER', 'A4263DC', 'A4302EQ', 'A4361DW', 'A4387EP', 'A4403CL', 'A4426EQ', 'A4464EQ', 'A4489CW', 'A4511AM', 'A4513AH', 'A4555AA', 'A4556CH', 'A4569EQ', 'A4572EQ', 'A4595DR', 'A4633CE', 'A4646ED', 'A4650AC', 'A4656CA', 'A4664EQ', 'A4725EC', 'A4783EP', 'A4784ER', 'A4837ER', 'A4840CH', 'A4876ER', 'A4895EN', 'A5032EQ', 'A5059CK', 'A5136EE', 'A5181ED', 'A5183EQ', 'A5212EQ', 'A5219DT', 'A5286ER', 'A5304EN', 'A5308ER', 'A5325ER', 'A5334CN', 'A5400DC', 'A5450EQ', 'A5461CE', 'A5494EQ', 'A5506ER', 'A5509AN', 'A5569ER', 'A5584DK', 'A5609EQ', 'A5690ED', 'A5726CY', 'A5807AW', 'A5912AC', 'A5936ER', 'A5948CH', 'A5973ER', 'A5979ER', 'A5994ER', 'A6007ER', 'A6086CE', 'A6091DY', 'A6103CG', 'A6127ER', 'A6187EQ', 'A6197AE', 'A6205EQ', 'A6238EM', 'A6251EF', 'A6285DF', 'A6321DY', 'A6378EQ', 'A6383AC', 'A6406AY', 'A6453ER', 'A6563AA', 'A6565AA', 'A6573AA', 'A6580AA', 'A6585DZ', 'A6623AZ', 'A6630AK', 'A6643AC', 'A6663DV', 'A6694ER', 'A6756EP', 'A6759CK', 'A6759ER', 'A6760ER', 'A6816AA', 'A6843ER', 'A6861AC', 'A6862CV', 'A6878EQ', 'A6898DR', 'A6926AC', 'A6932ER', 'A6936CP', 'A6973CW', 'A6997AG', 'A7012AG', 'A7027ER', 'A7029AA', 'A7036ER', 'A7048EN', 'A7050EQ', 'A7101ER', 'A7103ER', 'A7123AE', 'A7150AA', 'A7182AL', 'A7211ER', 'A7259AV', 'A7286DT', 'A7355CZ', 'A7378CX', 'A7389ER', 'A7409AA', 'A7412EL', 'A7423EQ', 'A7457EN', 'A7477AA', 'A7524ER', 'A7533EP', 'A7613AA', 'A7642ER', 'A7646DV', 'A7652CG', 'A7661ER', 'A7690ER', 'A7719CV', 'A7754EL', 'A7800AD', 'A7800CG', 'A7801CW', 'A7802EP', 'A7809AA', 'A7812ER', 'A7836DT', 'A7838EG', 'A7869ER', 'A7880EQ', 'A7885AD', 'A7937AH', 'A7949EQ', 'A7986DG', 'A8059ER', 'A8063ER', 'A8109EH', 'A8124EK', 'A8132ER', 'A8136ER', 'A8141EP', 'A8214EG', 'A8244AA', 'A8295AF', 'A8337EJ', 'A8357EG', 'A8360DZ', 'A8361EG', 'A8394EQ', 'A8396EQ', 'A8397AJ', 'A8412AF', 'A8459EQ', 'A8473AF', 'A8558DY', 'A8568AD', 'A8584AA', 'A8630ER', 'A8653DJ', 'A8657AE', 'A8680ER', 'A8699AA', 'A8754CA', 'A8754EQ', 'A8781EP', 'A8797DN', 'A8809AF', 'A8822EQ', 'A8853EL', 'A8934CG', 'A8939EP', 'A9015DW', 'A9067CZ', 'A9091DT', 'A9093EQ', 'A9100DE', 'A9130ER', 'A9133CX', 'A9191ER', 'A9219DP', 'A9236CZ', 'A9258EQ', 'A9283ER', 'A9316ER', 'A9341ER', 'A9354AZ', 'A9356ER', 'A9410ER', 'A9449AA', 'A9516EP', 'A9528AL', 'A9529AC', 'A9563EQ', 'A9570ER', 'A9585DE', 'A9618EQ', 'A9644ER', 'A9658EQ', 'A9689EP', 'A9691EQ', 'A9699AV', 'A9700EP', 'A9713DE', 'A9780EP', 'A9787EQ', 'A9791DY', 'A9794ER', 'A9803EC', 'A9815EQ', 'A9835DD', 'A9838EM', 'A9847AZ', 'A9849AL', 'A9863ER', 'A9916EQ', 'A9918EQ', 'A9931AX', 'A9933CP', 'A9954CG', 'A9986DF', 'A9995AC') OR AT_OFFENDER.OFFENDER_ID_DISPLAY IN ('A0031ER', 'A0047EQ', 'A0117ER', 'A0136DT', 'A0140EH', 'A0152EQ', 'A0174ET', 'A0185EQ', 'A0186ET', 'A0235DY', 'A0311CA', 'A0360DA', 'A0389CG', 'A0400ET', 'A0441ER', 'A0447DD', 'A0449ER', 'A0456AR', 'A0457EQ', 'A0477ET', 'A0497ET', 'A0503AC', 'A0522CD', 'A0571AC', 'A0628ET', 'A0639AC', 'A0666AF', 'A0685EF', 'A0710CQ', 'A0711ET', 'A0773DN', 'A0775CT', 'A0802DF', 'A0819EQ', 'A0826CW', 'A0946DT', 'A1005EA', 'A1008AC', 'A1025AA', 'A1087CN', 'A1104AC', 'A1130ER', 'A1185AG', 'A1269ER', 'A1274ER', 'A1331AL', 'A1438EP', 'A1459AE', 'A1482CK', 'A1615EQ', 'A1670DE', 'A1696CY', 'A1714DD', 'A1802ER', 'A1878ER', 'A1926EQ', 'A1981CF', 'A2034EQ', 'A2046AE', 'A2156EH', 'A2157ER', 'A2235DY', 'A2241EA', 'A2324ER', 'A2337CG', 'A2362EC', 'A2363AC', 'A2499AR', 'A2514ER', 'A2520AA', 'A2560AG', 'A2578AX', 'A2622DY', 'A2636EE', 'A2681DX', 'A2700DG', 'A2760CX', 'A2764EQ', 'A2790EQ', 'A2797EN', 'A2820EQ', 'A2845AM', 'A2868EK', 'A3068ER', 'A3070ER', 'A3073AE', 'A3078DC', 'A3166ER', 'A3202AC', 'A3281CR', 'A3428AK', 'A3496DN', 'A3512AF', 'A3524DA', 'A3530AH', 'A3555CF', 'A3571DM', 'A3640AY', 'A3767ER', 'A3843AP', 'A3870EQ', 'A3880AC', 'A3930DR', 'A3962AC', 'A4026CF', 'A4164CK', 'A4168DY', 'A4251CX', 'A4311EQ', 'A4324AP', 'A4327EQ', 'A4372ER', 'A4443EQ', 'A4511EN', 'A4533AR', 'A4552EC', 'A4555EK', 'A4704AP', 'A4814ER', 'A4820CK', 'A4835ER', 'A4922EQ', 'A4931AN', 'A4999AT', 'A5018ER', 'A5019AC', 'A5072DG', 'A5091EQ', 'A5141AE', 'A5153ER', 'A5177AR', 'A5178DF', 'A5193DP', 'A5196ER', 'A5320DX', 'A5342EM', 'A5358ER', 'A5365EQ', 'A5454ER', 'A5597EK', 'A5633EQ', 'A5663CH', 'A5701EQ', 'A5796DD', 'A5846ER', 'A5867EF', 'A5896EQ', 'A5931CX', 'A5954CL', 'A5973AF', 'A5984ER', 'A5986AW', 'A5996DQ', 'A6020ER', 'A6028AC', 'A6081ER', 'A6088ER', 'A6107AC', 'A6112DX', 'A6151DD', 'A6160DK', 'A6178AX', 'A6199CV', 'A6204AF', 'A6208AV', 'A6292CL', 'A6299CM', 'A6320ER', 'A6367AE', 'A6372AD', 'A6455ER', 'A6532AD', 'A6568EQ', 'A6794ER', 'A6826CH', 'A6850EH', 'A6867EA', 'A6951CA', 'A6957DG', 'A7035EJ', 'A7045ER', 'A7051ER', 'A7114DJ', 'A7190CE', 'A7195AA', 'A7208CQ', 'A7217DL', 'A7280AA', 'A7321EQ', 'A7338ER', 'A7353EM', 'A7444EH', 'A7482AA', 'A7502AC', 'A7513AA', 'A7552EP', 'A7570ER', 'A7600CE', 'A7698DF', 'A7716AK', 'A7854EP', 'A7913ER', 'A7974EP', 'A8113EN', 'A8128ER', 'A8140AE', 'A8166EQ', 'A8195AA', 'A8263CK', 'A8280EQ', 'A8296EP', 'A8351EA', 'A8357ER', 'A8383AA', 'A8384AH', 'A8400EQ', 'A8409ER', 'A8449EG', 'A8486AA', 'A8486CV', 'A8494ER', 'A8518EP', 'A8528AE', 'A8544DD', 'A8617EA', 'A8633ER', 'A8673DV', 'A8683ER', 'A8730CC', 'A8755CA', 'A8769EP', 'A8777AA', 'A8794EQ', 'A8812EL', 'A8814EQ', 'A8884ER', 'A8886CG', 'A8888ER', 'A8922DA', 'A8924CT', 'A8950ER', 'A8959EA', 'A8973EN', 'A8993EN', 'A9006EQ', 'A9032ER', 'A9044EL', 'A9135AA', 'A9148AE', 'A9177EJ', 'A9223AJ', 'A9253AW', 'A9254AZ', 'A9312ER', 'A9428ER', 'A9431EQ', 'A9470ER', 'A9478EQ', 'A9488ER', 'A9497EQ', 'A9499EQ', 'A9500EQ', 'A9502EQ', 'A9503ER', 'A9518CF', 'A9546EP', 'A9556ER', 'A9605ER', 'A9609ER', 'A9613EQ', 'A9642CM', 'A9648AT', 'A9670ER', 'A9724DG', 'A9802AJ', 'A9855CP', 'A9865ER', 'A9890AC', 'A9891EP', 'A9908EN', 'A9985DT', 'A9993EP') OR AT_OFFENDER.OFFENDER_ID_DISPLAY IN ('A0363ET', 'A0585CW', 'A0693AP', 'A0741ER', 'A0776DQ', 'A0921AC', 'A1096AC', 'A1108AJ', 'A1124EH', 'A1184AC', 'A1480AC', 'A2163ER', 'A2529EQ', 'A2581AZ', 'A2645ER', 'A2723CR', 'A2924EP', 'A3133AC', 'A3325ER', 'A3649EF', 'A3867DD', 'A3867DJ', 'A4101ER', 'A4129DC', 'A4363CL', 'A4823AL', 'A5171AC', 'A5320ER', 'A5368ER', 'A5525CG', 'A5641EQ', 'A5745EP', 'A5957EQ', 'A5986AT', 'A6199EQ', 'A6240EQ', 'A6435AK', 'A6490AA', 'A6576DG', 'A6578AA', 'A6593EN', 'A6767EN', 'A6768AA', 'A6993ER', 'A7106ER', 'A7108ER', 'A7117DQ', 'A7164EC', 'A7184EP', 'A7375CX', 'A7380AA', 'A7400ER', 'A7404AA', 'A7410AA', 'A7425EQ', 'A7438DQ', 'A7511CQ', 'A7528DQ', 'A7559EN', 'A7590EQ', 'A7654DL', 'A7693AF', 'A7715AA', 'A7947EQ', 'A7955EQ', 'A7971EP', 'A7977EP', 'A8062ER', 'A8283EQ', 'A8525AA', 'A8609AF', 'A8632ER', 'A8750EQ', 'A8793DV', 'A8889EP', 'A8921EP', 'A8994AE', 'A9035ER', 'A9133EG', 'A9199ER', 'A9295CA', 'A9335AA', 'A9336AA', 'A9536AD', 'A9735CR', 'A9744AA', 'A9826EP', 'A9846EQ', 'A9866ER'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, FIRST_NAME, LAST_NAME, COURT_DATE, SENTENCE_STATUS, IMPRISONMENT_STATUS, IN_OUT_STATUS, OFFENDER_BOOK_ID, LEGAL_STATUS_GROUPING, BOOKING_STATUS, BOOKING_BEGIN_DATE, BOOKING_NO, SENTENCE_CATEGORY, 'TBD' AS V_OPEN_BOOKING_NUMBER, CASE WHEN (TO_DATE(COURT_DATE, 'DD/MM/YYYY') - TO_DATE(BOOKING_BEGIN_DATE, 'DD/MM/YYYY')) < 14 THEN 'Yes' ELSE 'No' END AS V_GRACE_PERIOD, 'TBD' AS V_CASE_ADMINISTRATOR FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP8.DO10044",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Given Name 1",
            "legacyId": "DP8.DO11066",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "LAST_NAME",
            "type": "string",
            "display": "Last Name",
            "legacyId": "DP8.DO10045",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "COURT_DATE",
            "type": "date",
            "display": "Sentence Date",
            "legacyId": "DP8.DO110e7",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "SENTENCE_STATUS",
            "type": "string",
            "display": "Sentence Status",
            "legacyId": "DP8.DO10a11",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "IMPRISONMENT_STATUS",
            "type": "string",
            "display": "Main Legal Status",
            "legacyId": "DP8.DO103c7",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "IN_OUT_STATUS",
            "type": "string",
            "display": "In Out Status",
            "legacyId": "DP8.DO10cde",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "OFFENDER_BOOK_ID",
            "type": "double",
            "display": "Offender Book Id",
            "legacyId": "DP8.DO106e7",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP8.DO1108a",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "BOOKING_STATUS",
            "type": "string",
            "display": "Booking Status",
            "legacyId": "DP8.DO10885",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "BOOKING_BEGIN_DATE",
            "type": "date",
            "display": "Booking Begin Date",
            "legacyId": "DP8.DO10b97",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "BOOKING_NO",
            "type": "string",
            "display": "Booking No",
            "legacyId": "DP8.DO10c23",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "SENTENCE_CATEGORY",
            "type": "string",
            "display": "Sentence Category",
            "legacyId": "DP8.DO10e5c",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "V_OPEN_BOOKING_NUMBER",
            "type": "string",
            "display": "V_OPEN_BOOKING_NUMBER",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 14,
            "name": "V_GRACE_PERIOD",
            "type": "string",
            "display": "V_GRACE_PERIOD",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 15,
            "name": "V_CASE_ADMINISTRATOR",
            "type": "string",
            "display": "V_CASE_ADMINISTRATOR",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3376286/DPe",
      "name": "A-G",
      "description": "OR - Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY FROM OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_OFFENDER.LAST_NAME BETWEEN 'A' AND 'H' AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = (SELECT establishment_code FROM prompt_)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPe.DO10044",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376286/DP10",
      "name": "H-M",
      "description": "OR - Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY FROM OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_OFFENDER.LAST_NAME BETWEEN 'H' AND 'N' AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = (SELECT establishment_code FROM prompt_)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP10.DO10044",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376286/DP11",
      "name": "N-T",
      "description": "OR - Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY FROM OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_OFFENDER.LAST_NAME BETWEEN 'N' AND 'U' AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = (SELECT establishment_code FROM prompt_)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP11.DO10044",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376286/DPf",
      "name": "U-Z",
      "description": "OR - Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY FROM OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_OFFENDER.LAST_NAME BETWEEN 'U' AND 'ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ' AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = (SELECT establishment_code FROM prompt_)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPf.DO10044",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376286/DP12",
      "name": "Case Admin",
      "description": "OR - Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_PEOPLE.FIRST_NAME, AT_PEOPLE.LAST_NAME FROM OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.PERSONS AT_PEOPLE, OMS_OWNER.OFFENDER_CONTACT_PERSONS AT_CONTACTS WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_CONTACTS.OFFENDER_BOOK_ID (+)) AND (AT_PEOPLE.PERSON_ID (+) = AT_CONTACTS.PERSON_ID) AND ((AT_OFFENDER.OFFENDER_ID_DISPLAY IN ('A0023ET', 'A0035EL', 'A0067EQ', 'A0067ER', 'A0095EJ', 'A0097DT', 'A0099ET', 'A0122EP', 'A0123EP', 'A0150DQ', 'A0156AD', 'A0170AD', 'A0185DY', 'A0186AE', 'A0205DT', 'A0217DG', 'A0250AC', 'A0292ER', 'A0304DF', 'A0318ER', 'A0336CT', 'A0357EE', 'A0363AK', 'A0363EP', 'A0376ET', 'A0419AJ', 'A0447ET', 'A0457ER', 'A0494ET', 'A0521AE', 'A0530ET', 'A0588ER', 'A0590ET', 'A0611AZ', 'A0645ET', 'A0662AK', 'A0671AZ', 'A0684ER', 'A0704EQ', 'A0711CH', 'A0712EE', 'A0730CZ', 'A0744AG', 'A0781CQ', 'A0791AC', 'A0860ER', 'A0984EA', 'A0993DH', 'A1035AC', 'A1068ER', 'A1071CL', 'A1100EQ', 'A1124AZ', 'A1156ER', 'A1163AX', 'A1196AN', 'A1204EP', 'A1217EE', 'A1267CL', 'A1277CV', 'A1296AF', 'A1417DJ', 'A1431EQ', 'A1441CY', 'A1466AW', 'A1467AW', 'A1515CL', 'A1516EC', 'A1586DD', 'A1604EM', 'A1630ER', 'A1640EP', 'A1652AE', 'A1658AE', 'A1760DJ', 'A1792AX', 'A1795AW', 'A1867EC', 'A1932AF', 'A1936AV', 'A2015DW', 'A2025AT', 'A2028DT', 'A2045EQ', 'A2050CC', 'A2061EJ', 'A2074ER', 'A2104EG', 'A2281EH', 'A2290EQ', 'A2303AC', 'A2318EM', 'A2329AL', 'A2341AC', 'A2347DQ', 'A2392EP', 'A2448EK', 'A2556EP', 'A2594AE', 'A2688EQ', 'A2736DK', 'A2763EE', 'A2774EF', 'A2792DP', 'A2850ER', 'A2866ED', 'A2949AV', 'A2963EM', 'A2976EA', 'A2989DJ', 'A3004EQ', 'A3090CR', 'A3145ED', 'A3195EQ', 'A3277AP', 'A3310CJ', 'A3353DP', 'A3364DX', 'A3449AD', 'A3587CT', 'A3619EE', 'A3675AQ', 'A3684AC', 'A3687ER', 'A3688AJ', 'A3715CQ', 'A3731DD', 'A3741AE', 'A3818AY', 'A3824CY', 'A3830AH', 'A3918AP', 'A3933AC', 'A3937ER', 'A3942CZ', 'A3967AL', 'A4107AJ', 'A4183EN', 'A4189ER', 'A4229CP', 'A4235AZ', 'A4236DX', 'A4238DW', 'A4242CH', 'A4342AY', 'A4410DM', 'A4457ER', 'A4472AD', 'A4482CG', 'A4522AR', 'A4547EC', 'A4582AC', 'A4590AL', 'A4592DN', 'A4680EM', 'A4681EG', 'A4699EQ', 'A4767DD', 'A4835CP', 'A4851CZ', 'A4903AC', 'A4918EQ', 'A5053ER', 'A5086AV', 'A5195CN', 'A5202AF', 'A5211DL', 'A5233CX', 'A5299EF', 'A5305ER', 'A5323EF', 'A5334DE', 'A5375AF', 'A5412DE', 'A5440CW', 'A5456ER', 'A5462CR', 'A5593CJ', 'A5641CG', 'A5720DW', 'A5734CV', 'A5736ER', 'A5768EQ', 'A5778DE', 'A5812EQ', 'A5953AP', 'A5960EP', 'A5997EQ', 'A6009EQ', 'A6019AZ', 'A6081AP', 'A6086ER', 'A6109EP', 'A6121DW', 'A6162AW', 'A6176ER', 'A6267DE', 'A6311DQ', 'A6332EP', 'A6366EQ', 'A6371ER', 'A6381AD', 'A6381EC', 'A6383AM', 'A6399EN', 'A6403AC', 'A6452EH', 'A6454DG', 'A6469AH', 'A6496AA', 'A6536AC', 'A6579AA', 'A6587AA', 'A6598AA', 'A6603CH', 'A6605EE', 'A6696ER', 'A6728CN', 'A6730AX', 'A6743EQ', 'A6759CP', 'A6801AK', 'A6826AA', 'A6843AA', 'A6868AR', 'A6871EQ', 'A6897DQ', 'A6921AA', 'A6933ER', 'A6947AK', 'A6954AK', 'A6993DZ', 'A7032EQ', 'A7034AY', 'A7144EQ', 'A7148EP', 'A7167DC', 'A7224ER', 'A7256EG', 'A7257CE', 'A7261EP', 'A7265AQ', 'A7290DC', 'A7298EA', 'A7298ER', 'A7326ER', 'A7331AA', 'A7335ER', 'A7370AA', 'A7371AE', 'A7428DA', 'A7460AD', 'A7489DE', 'A7534DV', 'A7591AA', 'A7601AW', 'A7604AH', 'A7624DQ', 'A7672DT', 'A7716EQ', 'A7718CX', 'A7754AA', 'A7772ER', 'A7847CZ', 'A7851CG', 'A7873AA', 'A7924AA', 'A7955EL', 'A7963AV', 'A7966ED', 'A8056DJ', 'A8061ER', 'A8129ER', 'A8154AD', 'A8203EP', 'A8210EF', 'A8242CW', 'A8250DR', 'A8259AA', 'A8261DC', 'A8278EQ', 'A8285EQ', 'A8287DJ', 'A8307DH', 'A8318AD', 'A8318DT', 'A8338ER', 'A8357AA', 'A8387AD', 'A8398AA', 'A8504AV', 'A8510CG', 'A8528ER', 'A8532ER', 'A8548DJ', 'A8564DR', 'A8579ER', 'A8677AA', 'A8721ER', 'A8722DG', 'A8760AA', 'A8806DD', 'A8826AA', 'A8879ER', 'A8880CM', 'A8882CV', 'A9012AA', 'A9029AV', 'A9030AT', 'A9033ER', 'A9041AA', 'A9080ER', 'A9138AA', 'A9146AG', 'A9200EP', 'A9246AJ', 'A9268ER', 'A9282ER', 'A9310ER', 'A9315ER', 'A9332DH', 'A9332ER', 'A9354ER', 'A9366DN', 'A9379EC', 'A9386ER', 'A9429AA', 'A9432ER', 'A9433AA', 'A9436EQ', 'A9437AV', 'A9441AL', 'A9466EP', 'A9508CG', 'A9567EQ', 'A9577ER', 'A9617EQ', 'A9640ER', 'A9662CT', 'A9673ER', 'A9722AZ', 'A9726DK', 'A9735DE', 'A9771AF', 'A9774EP', 'A9792CE', 'A9818AA', 'A9838AW', 'A9849CP', 'A9860DY', 'A9889EA', 'A9922ER', 'A9923ER', 'A9924ER', 'A9929ER', 'A9934DJ', 'A9973ER', 'A9974ER') OR AT_OFFENDER.OFFENDER_ID_DISPLAY IN ('A0015CV', 'A0017ET', 'A0022CF', 'A0031ET', 'A0035CX', 'A0036EQ', 'A0036ET', 'A0038ET', 'A0067CM', 'A0095ET', 'A0118EP', 'A0121EP', 'A0129ET', 'A0154ET', 'A0230AC', 'A0246ER', 'A0274DE', 'A0321CT', 'A0338AF', 'A0377ET', 'A0387EP', 'A0451ER', 'A0454AH', 'A0500CK', 'A0519DJ', 'A0589AC', 'A0612ET', 'A0666ET', 'A0667AF', 'A0686CY', 'A0734CF', 'A0749DQ', 'A0755CZ', 'A0801CD', 'A0828ER', 'A0832DG', 'A0884ER', 'A0933DR', 'A0990AL', 'A1014AL', 'A1024AC', 'A1089AC', 'A1150DD', 'A1212AC', 'A1228AC', 'A1230EL', 'A1269EK', 'A1332CG', 'A1382DK', 'A1416ER', 'A1429EG', 'A1463AT', 'A1537AK', 'A1538AG', 'A1543AL', 'A1577DY', 'A1753CQ', 'A1763ER', 'A1789CQ', 'A1812ER', 'A1935CZ', 'A1985CC', 'A1994DP', 'A2020EG', 'A2052ER', 'A2071ER', 'A2082EP', 'A2134ER', 'A2139DW', 'A2194EA', 'A2205CQ', 'A2211DH', 'A2279DQ', 'A2335ER', 'A2343EP', 'A2429CY', 'A2478ER', 'A2506EQ', 'A2520EQ', 'A2590DA', 'A2597ER', 'A2608EQ', 'A2612EQ', 'A2638EP', 'A2654EQ', 'A2671DF', 'A2696DR', 'A2721DA', 'A2779AG', 'A2791CF', 'A2848EP', 'A2856ER', 'A2874CF', 'A2937AV', 'A3018DZ', 'A3047CN', 'A3097AG', 'A3129AG', 'A3146CG', 'A3166CJ', 'A3215EK', 'A3237AC', 'A3244EK', 'A3367ER', 'A3427CM', 'A3430AY', 'A3431ER', 'A3530CJ', 'A3571DF', 'A3616EN', 'A3669AE', 'A3691ER', 'A3692CP', 'A3703EQ', 'A3706EQ', 'A3753AC', 'A3759AV', 'A3814CZ', 'A3822DK', 'A3879ER', 'A3916ER', 'A3919CN', 'A3956EJ', 'A3957EP', 'A4028EP', 'A4232ER', 'A4263DC', 'A4302EQ', 'A4361DW', 'A4387EP', 'A4403CL', 'A4426EQ', 'A4464EQ', 'A4489CW', 'A4511AM', 'A4513AH', 'A4555AA', 'A4556CH', 'A4569EQ', 'A4572EQ', 'A4595DR', 'A4633CE', 'A4646ED', 'A4650AC', 'A4656CA', 'A4664EQ', 'A4725EC', 'A4783EP', 'A4784ER', 'A4837ER', 'A4840CH', 'A4876ER', 'A4895EN', 'A5032EQ', 'A5059CK', 'A5136EE', 'A5181ED', 'A5183EQ', 'A5212EQ', 'A5219DT', 'A5286ER', 'A5304EN', 'A5308ER', 'A5325ER', 'A5334CN', 'A5400DC', 'A5450EQ', 'A5461CE', 'A5494EQ', 'A5506ER', 'A5509AN', 'A5569ER', 'A5584DK', 'A5609EQ', 'A5690ED', 'A5726CY', 'A5807AW', 'A5912AC', 'A5936ER', 'A5948CH', 'A5973ER', 'A5979ER', 'A5994ER', 'A6007ER', 'A6086CE', 'A6091DY', 'A6103CG', 'A6127ER', 'A6187EQ', 'A6197AE', 'A6205EQ', 'A6238EM', 'A6251EF', 'A6285DF', 'A6321DY', 'A6378EQ', 'A6383AC', 'A6406AY', 'A6453ER', 'A6563AA', 'A6565AA', 'A6573AA', 'A6580AA', 'A6585DZ', 'A6623AZ', 'A6630AK', 'A6643AC', 'A6663DV', 'A6694ER', 'A6756EP', 'A6759CK', 'A6759ER', 'A6760ER', 'A6816AA', 'A6843ER', 'A6861AC', 'A6862CV', 'A6878EQ', 'A6898DR', 'A6926AC', 'A6932ER', 'A6936CP', 'A6973CW', 'A6997AG', 'A7012AG', 'A7027ER', 'A7029AA', 'A7036ER', 'A7048EN', 'A7050EQ', 'A7101ER', 'A7103ER', 'A7123AE', 'A7150AA', 'A7182AL', 'A7211ER', 'A7259AV', 'A7286DT', 'A7355CZ', 'A7378CX', 'A7389ER', 'A7409AA', 'A7412EL', 'A7423EQ', 'A7457EN', 'A7477AA', 'A7524ER', 'A7533EP', 'A7613AA', 'A7642ER', 'A7646DV', 'A7652CG', 'A7661ER', 'A7690ER', 'A7719CV', 'A7754EL', 'A7800AD', 'A7800CG', 'A7801CW', 'A7802EP', 'A7809AA', 'A7812ER', 'A7836DT', 'A7838EG', 'A7869ER', 'A7880EQ', 'A7885AD', 'A7937AH', 'A7949EQ', 'A7986DG', 'A8059ER', 'A8063ER', 'A8109EH', 'A8124EK', 'A8132ER', 'A8136ER', 'A8141EP', 'A8214EG', 'A8244AA', 'A8295AF', 'A8337EJ', 'A8357EG', 'A8360DZ', 'A8361EG', 'A8394EQ', 'A8396EQ', 'A8397AJ', 'A8412AF', 'A8459EQ', 'A8473AF', 'A8558DY', 'A8568AD', 'A8584AA', 'A8630ER', 'A8653DJ', 'A8657AE', 'A8680ER', 'A8699AA', 'A8754CA', 'A8754EQ', 'A8781EP', 'A8797DN', 'A8809AF', 'A8822EQ', 'A8853EL', 'A8934CG', 'A8939EP', 'A9015DW', 'A9067CZ', 'A9091DT', 'A9093EQ', 'A9100DE', 'A9130ER', 'A9133CX', 'A9191ER', 'A9219DP', 'A9236CZ', 'A9258EQ', 'A9283ER', 'A9316ER', 'A9341ER', 'A9354AZ', 'A9356ER', 'A9410ER', 'A9449AA', 'A9516EP', 'A9528AL', 'A9529AC', 'A9563EQ', 'A9570ER', 'A9585DE', 'A9618EQ', 'A9644ER', 'A9658EQ', 'A9689EP', 'A9691EQ', 'A9699AV', 'A9700EP', 'A9713DE', 'A9780EP', 'A9787EQ', 'A9791DY', 'A9794ER', 'A9803EC', 'A9815EQ', 'A9835DD', 'A9838EM', 'A9847AZ', 'A9849AL', 'A9863ER', 'A9916EQ', 'A9918EQ', 'A9931AX', 'A9933CP', 'A9954CG', 'A9986DF', 'A9995AC') OR AT_OFFENDER.OFFENDER_ID_DISPLAY IN ('A0031ER', 'A0047EQ', 'A0117ER', 'A0136DT', 'A0140EH', 'A0152EQ', 'A0174ET', 'A0185EQ', 'A0186ET', 'A0235DY', 'A0311CA', 'A0360DA', 'A0389CG', 'A0400ET', 'A0441ER', 'A0447DD', 'A0449ER', 'A0456AR', 'A0457EQ', 'A0477ET', 'A0497ET', 'A0503AC', 'A0522CD', 'A0571AC', 'A0628ET', 'A0639AC', 'A0666AF', 'A0685EF', 'A0710CQ', 'A0711ET', 'A0773DN', 'A0775CT', 'A0802DF', 'A0819EQ', 'A0826CW', 'A0946DT', 'A1005EA', 'A1008AC', 'A1025AA', 'A1087CN', 'A1104AC', 'A1130ER', 'A1185AG', 'A1269ER', 'A1274ER', 'A1331AL', 'A1438EP', 'A1459AE', 'A1482CK', 'A1615EQ', 'A1670DE', 'A1696CY', 'A1714DD', 'A1802ER', 'A1878ER', 'A1926EQ', 'A1981CF', 'A2034EQ', 'A2046AE', 'A2156EH', 'A2157ER', 'A2235DY', 'A2241EA', 'A2324ER', 'A2337CG', 'A2362EC', 'A2363AC', 'A2499AR', 'A2514ER', 'A2520AA', 'A2560AG', 'A2578AX', 'A2622DY', 'A2636EE', 'A2681DX', 'A2700DG', 'A2760CX', 'A2764EQ', 'A2790EQ', 'A2797EN', 'A2820EQ', 'A2845AM', 'A2868EK', 'A3068ER', 'A3070ER', 'A3073AE', 'A3078DC', 'A3166ER', 'A3202AC', 'A3281CR', 'A3428AK', 'A3496DN', 'A3512AF', 'A3524DA', 'A3530AH', 'A3555CF', 'A3571DM', 'A3640AY', 'A3767ER', 'A3843AP', 'A3870EQ', 'A3880AC', 'A3930DR', 'A3962AC', 'A4026CF', 'A4164CK', 'A4168DY', 'A4251CX', 'A4311EQ', 'A4324AP', 'A4327EQ', 'A4372ER', 'A4443EQ', 'A4511EN', 'A4533AR', 'A4552EC', 'A4555EK', 'A4704AP', 'A4814ER', 'A4820CK', 'A4835ER', 'A4922EQ', 'A4931AN', 'A4999AT', 'A5018ER', 'A5019AC', 'A5072DG', 'A5091EQ', 'A5141AE', 'A5153ER', 'A5177AR', 'A5178DF', 'A5193DP', 'A5196ER', 'A5320DX', 'A5342EM', 'A5358ER', 'A5365EQ', 'A5454ER', 'A5597EK', 'A5633EQ', 'A5663CH', 'A5701EQ', 'A5796DD', 'A5846ER', 'A5867EF', 'A5896EQ', 'A5931CX', 'A5954CL', 'A5973AF', 'A5984ER', 'A5986AW', 'A5996DQ', 'A6020ER', 'A6028AC', 'A6081ER', 'A6088ER', 'A6107AC', 'A6112DX', 'A6151DD', 'A6160DK', 'A6178AX', 'A6199CV', 'A6204AF', 'A6208AV', 'A6292CL', 'A6299CM', 'A6320ER', 'A6367AE', 'A6372AD', 'A6455ER', 'A6532AD', 'A6568EQ', 'A6794ER', 'A6826CH', 'A6850EH', 'A6867EA', 'A6951CA', 'A6957DG', 'A7035EJ', 'A7045ER', 'A7051ER', 'A7114DJ', 'A7190CE', 'A7195AA', 'A7208CQ', 'A7217DL', 'A7280AA', 'A7321EQ', 'A7338ER', 'A7353EM', 'A7444EH', 'A7482AA', 'A7502AC', 'A7513AA', 'A7552EP', 'A7570ER', 'A7600CE', 'A7698DF', 'A7716AK', 'A7854EP', 'A7913ER', 'A7974EP', 'A8113EN', 'A8128ER', 'A8140AE', 'A8166EQ', 'A8195AA', 'A8263CK', 'A8280EQ', 'A8296EP', 'A8351EA', 'A8357ER', 'A8383AA', 'A8384AH', 'A8400EQ', 'A8409ER', 'A8449EG', 'A8486AA', 'A8486CV', 'A8494ER', 'A8518EP', 'A8528AE', 'A8544DD', 'A8617EA', 'A8633ER', 'A8673DV', 'A8683ER', 'A8730CC', 'A8755CA', 'A8769EP', 'A8777AA', 'A8794EQ', 'A8812EL', 'A8814EQ', 'A8884ER', 'A8886CG', 'A8888ER', 'A8922DA', 'A8924CT', 'A8950ER', 'A8959EA', 'A8973EN', 'A8993EN', 'A9006EQ', 'A9032ER', 'A9044EL', 'A9135AA', 'A9148AE', 'A9177EJ', 'A9223AJ', 'A9253AW', 'A9254AZ', 'A9312ER', 'A9428ER', 'A9431EQ', 'A9470ER', 'A9478EQ', 'A9488ER', 'A9497EQ', 'A9499EQ', 'A9500EQ', 'A9502EQ', 'A9503ER', 'A9518CF', 'A9546EP', 'A9556ER', 'A9605ER', 'A9609ER', 'A9613EQ', 'A9642CM', 'A9648AT', 'A9670ER', 'A9724DG', 'A9802AJ', 'A9855CP', 'A9865ER', 'A9890AC', 'A9891EP', 'A9908EN', 'A9985DT', 'A9993EP') OR AT_OFFENDER.OFFENDER_ID_DISPLAY IN ('A0363ET', 'A0585CW', 'A0693AP', 'A0741ER', 'A0776DQ', 'A0921AC', 'A1096AC', 'A1108AJ', 'A1124EH', 'A1184AC', 'A1480AC', 'A2163ER', 'A2529EQ', 'A2581AZ', 'A2645ER', 'A2723CR', 'A2924EP', 'A3133AC', 'A3325ER', 'A3649EF', 'A3867DD', 'A3867DJ', 'A4101ER', 'A4129DC', 'A4363CL', 'A4823AL', 'A5171AC', 'A5320ER', 'A5368ER', 'A5525CG', 'A5641EQ', 'A5745EP', 'A5957EQ', 'A5986AT', 'A6199EQ', 'A6240EQ', 'A6435AK', 'A6490AA', 'A6576DG', 'A6578AA', 'A6593EN', 'A6767EN', 'A6768AA', 'A6993ER', 'A7106ER', 'A7108ER', 'A7117DQ', 'A7164EC', 'A7184EP', 'A7375CX', 'A7380AA', 'A7400ER', 'A7404AA', 'A7410AA', 'A7425EQ', 'A7438DQ', 'A7511CQ', 'A7528DQ', 'A7559EN', 'A7590EQ', 'A7654DL', 'A7693AF', 'A7715AA', 'A7947EQ', 'A7955EQ', 'A7971EP', 'A7977EP', 'A8062ER', 'A8283EQ', 'A8525AA', 'A8609AF', 'A8632ER', 'A8750EQ', 'A8793DV', 'A8889EP', 'A8921EP', 'A8994AE', 'A9035ER', 'A9133EG', 'A9199ER', 'A9295CA', 'A9335AA', 'A9336AA', 'A9536AD', 'A9735CR', 'A9744AA', 'A9826EP', 'A9846EQ', 'A9866ER')) AND AT_CONTACTS.RELATIONSHIP_TYPE = 'CA' AND AT_CONTACTS.ACTIVE_FLAG IN ('Y') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, FIRST_NAME, LAST_NAME FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP12.DO10044",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "CP First Name",
            "legacyId": "DP12.DO10ed9",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "LAST_NAME",
            "type": "string",
            "display": "CP Last Name",
            "legacyId": "DP12.DO10ed8",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "160929.RS",
      "name": "Erroneous Bookings",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376286/DP8",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_REL_DATES = 1 AND V_REL_BOOKING = 1 AND V_REL_NUMBER_OF_BOOKINGS IN (1) AND V_OPEN_BOOKING = 1 AND V_SENT_BOOK_DATE <> 1 AND V_SENT_BOOK_DATE <> 1))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP8.DO10044"
          },
          {
            "name": "$ref:LAST_NAME",
            "display": "Last Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP8.DO10045"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP8.DO11066"
          },
          {
            "name": "$ref:V_OPEN_BOOKING_NUMBER",
            "display": "Current Book Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([Booking No]) Where([Booking Status] = \"O\") In ([Main Data].[NOMS Number])"
          },
          {
            "name": "$ref:BOOKING_BEGIN_DATE",
            "display": "Booking Begin Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP8.DO10b97"
          },
          {
            "name": "$ref:COURT_DATE",
            "display": "Sentence Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP8.DO110e7"
          },
          {
            "name": "$ref:V_GRACE_PERIOD",
            "display": "Within Grace Period?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If (DaysBetween([Sentence Date];[Booking Begin Date]) < 14;\"Yes\";\"No\")"
          },
          {
            "name": "$ref:V_CASE_ADMINISTRATOR",
            "display": "Case Administrator",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_count_case_admin] >1;\"Muliple Active - Check Record\";([CP Last Name]+\", \"+[CP First Name]) In ([Main Data].[NOMS Number]))"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_OPEN_BOOKING_NUMBER :: Error: =Max([Booking No]) Where([Booking Status] = \"O\") In ([Main Data].[NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:50",
      "entityId": "kld1AGgADDlUF.4A3v8AISgXYiw",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_CASE_ADMINISTRATOR :: Error: =If([v_count_case_admin] >1;\"Muliple Active - Check Record\";([CP Last Name]+\", \"+[CP First Name]) In ([Main Data].[NOMS Number])) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "kld1AGgADDlUF.4A3v8AISgXYiw",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OPEN_BOOKING_NUMBER :: Error: =Max([Booking No]) Where([Booking Status] = \"O\") In ([Main Data].[NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:50",
      "entityId": "kld1AGgADDlUF.4A3v8AISgXYiw",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_CASE_ADMINISTRATOR :: Error: =If([v_count_case_admin] >1;\"Muliple Active - Check Record\";([CP Last Name]+\", \"+[CP First Name]) In ([Main Data].[NOMS Number])) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "kld1AGgADDlUF.4A3v8AISgXYiw",
      "entityType": "dpd"
    }
  ]
}