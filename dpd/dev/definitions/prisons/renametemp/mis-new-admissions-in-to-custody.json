{
  "id": "klmAP5gAAgY7BokA22gAISgV_bQ",
  "name": "MIS New Admissions in to Custody",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "MOV0045 v00.00.03"
    ]
  },
  "description": "Retrieves a list of Prisoners who were admitted to Prison on their first Admission from court and also those admitted in to their current establishment via transfer. The report also retrieves current active alerts for ACCT and Custodial Violence Management as well as expired Open ACCT Alerts. Report also has a tab for scheduled transfers.  <br/>MOV0045 v00.00.03 Last Modified: 21/05/2019",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP2",
      "name": "Court Admissions",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE='MERGE' Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE='W8' then 'W3' WHEN AT_DIM_ETHNICITY_CODES.CODE='O1' then 'A4' ELSE AT_DIM_ETHNICITY_CODES.CODE END , CASE WHEN AT_DIM_ETHNICITY_CODES.CODE='MERGE' Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL Then 'Code Missing' when AT_DIM_ETHNICITY_CODES.CODE='W8' then 'White: Gypsy or Irish Traveller' when AT_DIM_ETHNICITY_CODES.CODE='O1' then 'Asian/Asian British: Chinese' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION end, NVL(AT_OFFENDER_BOOKING.RELIGION_CODE,'Not Specified'), NVL(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION,'Not Specified'), AT_FACT_MOV_EXT.MOVEMENT_TIME, AT_FACT_MOV_EXT.REASON_CODE, AT_FACT_MOV_EXT.TYPE, Case When DT_LIFEFLAG.LIFE_SENTENCE_FLAG='Y' then 'Life' Else FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH End, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, DT_EXT_MOVE_FROM.TYPE_DESCRIPTION_FROM, AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_CODE_NK, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_FACT_MOV_EXT.REASON, DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE, AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_CSRA_LEVEL, AT_OFFENDER_BOOKING.PNC_ID FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, (  SELECT distinct BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE ( BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK=dss.sentence_status_sk) AND dss.sentence_status='Active' AND ( BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK=BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK ) AND ( BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK=BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK ) AND ( BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK=BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK ) and BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG='Y' ) DT_LIFEFLAG, FACT_CURR_KEY_DATES_SENT, ( SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK as SK_ID_FROM, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION as TYPE_DESCRIPTION_FROM, 'Establishment' as Location_Type_FROM FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' as Location_Type_From FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT ALL BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' as Location_Type_From FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' as Location_Type_From FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' as Location_Type_From FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN flat IS NOT NULL THEN flat || '  ' END || CASE WHEN premise IS NOT NULL THEN premise || '  ' END || CASE WHEN street IS NOT NULL THEN street || '  ' END || CASE WHEN locality IS NOT NULL THEN locality || '  ' END || CASE WHEN city_desc IS NOT NULL THEN city_desc || '  ' END || CASE WHEN county_desc IS NOT NULL THEN county_desc || '  ' END || CASE WHEN postal_code IS NOT NULL THEN postal_code || '  ' END || CASE WHEN country_desc IS NOT NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses ) DT_EXT_MOVE_FROM, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_TO, (   Select AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK as OFFENDER_BOOKING_SK, case when AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE From --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE where --AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK=AT_FACT_SENTENCE.OFFENDER_BOOKING_SK(+) AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK=AT_RELEASE_DATE.DATE_SK(+) and AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG='Y' --and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' ) DT_CURRENT_RELEASE_DATE, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_DIM_OFFENDER_ASSESSMENTS, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV WHERE ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_LIFEFLAG.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.BIRTH_DATE_SK=AT_DOB.DATE_SK ) AND ( AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK ) AND ( AT_DIM_DATE_EXT_MOV.DATE_SK=AT_FACT_MOV_EXT.DATE_SK ) AND ( case when AT_FACT_MOV_EXT.TO_LOCATION_TYPE = 'Establishment' then AT_FACT_MOV_EXT.TO_LOCATION_SK end = AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_SK(+) ) AND ( AT_DIM_ETHNICITY_CODES.CODE(+)=AT_OFFENDER_BOOKING.ETHNICITY_CODE ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /*= #Variable('BOUSER') */ )) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_FACT_MOV_EXT.FROM_LOCATION_SK=DT_EXT_MOVE_FROM.SK_ID_FROM(+) and AT_FACT_MOV_EXT.FROM_LOCATION_TYPE=DT_EXT_MOVE_FROM.LOCATION_TYPE_FROM(+) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=AT_DIM_OFFENDER_ASSESSMENTS.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.LIVING_UNIT_SK=AT_DIM_LOCATION.UNIT_4_SK(+) ) AND ( ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK =(SELECT ESTABLISHMENT_CODE FROM prompt_ /*= #Prompt('Establishment Code','A','Associated Establishment\\Associated Establishment Code',mono,free,Not_Persistent,User:69) */ ) ) AND ( AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y' ) AND AT_DIM_DATE_EXT_MOV.DAY_DATE BETWEEN (SELECT UNKNOWN_PARAMETER FROM prompt_ /*= #prompt('Enter Movement Date Only (External)(Start):','D',,Mono,Free,Not_Persistent,,User:0) */ ) AND (SELECT UNKNOWN_PARAMETER FROM prompt_ /*= #prompt('Enter Movement Date Only (External)(End):','D',,Mono,Free,Not_Persistent,,User:1) */ ) AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'IN' AND AT_FACT_MOV_EXT.FROM_LOCATION_TYPE NOT IN ( 'Establishment','Home Leave Address' ) AND AT_FACT_MOV_EXT.TYPE = 'Admission' )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code','A','Associated Establishment\\Associated Establishment Code',mono,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        },
        {
          "index": 1,
          "name": "unknown_parameter",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter Movement Date Only (External)(Start):",
          "description": "@prompt('Enter Movement Date Only (External)(Start):','D',,Mono,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3375368/DP9",
      "name": "Alerts",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK, AT_ALERT.ALERT_ACTIVE_FLAG, AT_OFFENDER_ALERT.ALERT_STATUS, CASE WHEN AT_ALERT_EXPIRY_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EXPIRY_DATE.DAY_DATE ELSE NULL END AS ALERT_EXPIRY_DATE, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EXPIRY_DATE, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_OFFENDER_ALERT.ALERT_EXPIRY_DATE_SK = AT_ALERT_EXPIRY_DATE.DATE_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code','A','Associated Establishment\\Associated Establishment Code',mono,free,Not_Persistent,User:69) */)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND AT_DIM_DATE_EXT_MOV.DAY_DATE BETWEEN (SELECT UNKNOWN_PARAMETER FROM prompt_ /* = #prompt('Enter Movement Date Only (External)(Start):','D',,Mono,Free,Not_Persistent,,User:0) */) AND (SELECT UNKNOWN_PARAMETER FROM prompt_ /* = #prompt('Enter Movement Date Only (External)(End):','D',,Mono,Free,Not_Persistent,,User:1) */) AND AT_ALERT.ALERT_CODE_NK IN ('HA', 'HA1', 'HA2', 'OCVM') AND AT_FACT_MOV_EXT.TYPE IN ('Admission', 'Court', 'Transfers'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK, ALERT_ACTIVE_FLAG, ALERT_STATUS, ALERT_EXPIRY_DATE, ALERT_EFFECTIVE_DATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code','A','Associated Establishment\\Associated Establishment Code',mono,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        },
        {
          "index": 1,
          "name": "unknown_parameter",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter Movement Date Only (External)(Start):",
          "description": "@prompt('Enter Movement Date Only (External)(Start):','D',,Mono,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP9.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP9.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_ACTIVE_FLAG",
            "type": "string",
            "display": "Alert Active Flag",
            "legacyId": "DP9.DO1069b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP9.DO10094",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ALERT_EXPIRY_DATE",
            "type": "date",
            "display": "Alert Expiry Date",
            "legacyId": "DP9.DO10096",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DP9.DO10095",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPa",
      "name": "Scheduled Tx",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_SCHED_EXT_MOVE_TO.ESTABLISHMENT_DESCRIPTION, AT_OFF_SCH_DATE.DAY_DATE, AT_OFFENDER_SCHEDULE.EVENT_SUB_TYPE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ESTABLISHMENT AT_SCHED_EXT_MOVE_TO, BODIMIS.DIM_DATE AT_OFF_SCH_DATE, BODIMIS.FACT_OFFENDER_SCHEDULE AT_OFFENDER_SCHEDULE WHERE (AT_OFFENDER_SCHEDULE.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_SCHEDULE.DATE_SK = AT_OFF_SCH_DATE.DATE_SK) AND (AT_OFFENDER_SCHEDULE.TO_LOCATION_SK = AT_SCHED_EXT_MOVE_TO.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code','A','Associated Establishment\\Associated Establishment Code',mono,free,Not_Persistent,User:69) */)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_SCHEDULE.OUTCOME = ('Scheduled (Approved)')) AND AT_OFFENDER_SCHEDULE.EVENT_TYPE = 'TRN' AND AT_OFF_SCH_DATE.DAY_DATE >= TRUNC(CURRENT_TIMESTAMP))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, ESTABLISHMENT_DESCRIPTION, DAY_DATE, EVENT_SUB_TYPE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code','A','Associated Establishment\\Associated Establishment Code',mono,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPa.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DPa.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Establishment Name - Destination",
            "legacyId": "DPa.DO104ec",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Schedule Date",
            "legacyId": "DPa.DO10924",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "EVENT_SUB_TYPE",
            "type": "string",
            "display": "Event Sub Type",
            "legacyId": "DPa.DO108ef",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPc",
      "name": "Current Admission or Transfer in",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE='MERGE' Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE='W8' then 'W3' WHEN AT_DIM_ETHNICITY_CODES.CODE='O1' then 'A4' ELSE AT_DIM_ETHNICITY_CODES.CODE END , CASE WHEN AT_DIM_ETHNICITY_CODES.CODE='MERGE' Then 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL Then 'Code Missing' when AT_DIM_ETHNICITY_CODES.CODE='W8' then 'White: Gypsy or Irish Traveller' when AT_DIM_ETHNICITY_CODES.CODE='O1' then 'Asian/Asian British: Chinese' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION end, NVL(AT_OFFENDER_BOOKING.RELIGION_CODE,'Not Specified'), NVL(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION,'Not Specified'), AT_FACT_MOV_EXT.MOVEMENT_TIME, AT_FACT_MOV_EXT.REASON_CODE, AT_FACT_MOV_EXT.TYPE, Case When DT_LIFEFLAG.LIFE_SENTENCE_FLAG='Y' then 'Life' Else FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH End, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, DT_EXT_MOVE_FROM.TYPE_DESCRIPTION_FROM, AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_CODE_NK, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_FACT_MOV_EXT.REASON, DT_CURRENT_RELEASE_DATE.CURR_RELEASE_DATE, AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_CSRA_LEVEL, DT_ADMISSION.MOVEMENT_TIME FROM ( Select ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk , fme.from_location_type, max(fme.MOVEMENT_SEQ ) as MOVEMENT_SEQ, max(d.day_date) as MOVEMENT_TIME, trunc(ETL.LOAD_END_DATETIME) as LOAD_DATE From BODIMIS.FACT_MOVEMENT_EXTERNAL fme, BODIMIS.DIM_OFFENDER_BOOKING ob, BODIMIS.DIM_ESTABLISHMENT est, BODIMIS.ETL_LOAD_LOG ETL, BODIMIS.DIM_DATE d Where ob.ESTABLISHMENT_SK=est.ESTABLISHMENT_SK and d.date_sk=fme.date_sk and fme.offender_booking_sk=ob.offender_booking_sk and ob.active_status IN('Active In','Active Out') And ob.MIS_CURRENT_RECORD_IND = 'Y' and ob.ACTIVE_FLAG = 'Y' and ETL.LOAD_ID=(select max(LOAD_ID) from BODIMIS.ETL_LOAD_LOG WHERE LOAD_END_DATETIME IS NOT NULL) And ob.ESTABLISHMENT_SK=fme.to_location_sk and fme.movement_seq= (select max(fme2.movement_seq ) from BODIMIS.FACT_MOVEMENT_EXTERNAL fme2 where fme.offender_booking_sk=fme2.offender_booking_sk and fme2.direction_code='IN' And fme2.TYPE='Admission' And fme2.To_location_type='Establishment' and fme2.reason_code <> 'R') GROUP BY ob.offender_id_display, fme.offender_booking_sk,est.establishment_code_nk,fme.to_location_sk,fme.from_location_sk,fme.from_location_type,ETL.LOAD_END_DATETIME ) DT_ADMISSION, BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, (  SELECT distinct BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE ( BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK=dss.sentence_status_sk) AND dss.sentence_status='Active' AND ( BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK=BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK ) AND ( BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK=BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK ) AND ( BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK=BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK ) and BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG='Y' ) DT_LIFEFLAG, FACT_CURR_KEY_DATES_SENT, ( SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK as SK_ID_FROM, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION as TYPE_DESCRIPTION_FROM, 'Establishment' as Location_Type_FROM FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' as Location_Type_From FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT ALL BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' as Location_Type_From FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' as Location_Type_From FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' as Location_Type_From FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN flat IS NOT NULL THEN flat || '  ' END || CASE WHEN premise IS NOT NULL THEN premise || '  ' END || CASE WHEN street IS NOT NULL THEN street || '  ' END || CASE WHEN locality IS NOT NULL THEN locality || '  ' END || CASE WHEN city_desc IS NOT NULL THEN city_desc || '  ' END || CASE WHEN county_desc IS NOT NULL THEN county_desc || '  ' END || CASE WHEN postal_code IS NOT NULL THEN postal_code || '  ' END || CASE WHEN country_desc IS NOT NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses ) DT_EXT_MOVE_FROM, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_TO, (   Select AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK as OFFENDER_BOOKING_SK, case when AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE From --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, BODIMIS.DIM_DATE AT_RELEASE_DATE where --AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK=AT_FACT_SENTENCE.OFFENDER_BOOKING_SK(+) AT_FACT_OFFENDER_SENTENCE.RELEASE_CALCULATED_DATE_SK=AT_RELEASE_DATE.DATE_SK(+) and AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG='Y' --and AT_RELEASE_DATE.DAY_DATE !='31/12/9000' ) DT_CURRENT_RELEASE_DATE, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_DIM_OFFENDER_ASSESSMENTS, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV WHERE ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_CURRENT_RELEASE_DATE.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_LIFEFLAG.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.BIRTH_DATE_SK=AT_DOB.DATE_SK ) AND ( AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK ) AND ( AT_DIM_DATE_EXT_MOV.DATE_SK=AT_FACT_MOV_EXT.DATE_SK ) AND ( case when AT_FACT_MOV_EXT.TO_LOCATION_TYPE = 'Establishment' then AT_FACT_MOV_EXT.TO_LOCATION_SK end = AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_SK(+) ) AND ( AT_DIM_ETHNICITY_CODES.CODE(+)=AT_OFFENDER_BOOKING.ETHNICITY_CODE ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /*= #Variable('BOUSER') */ )) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_FACT_MOV_EXT.FROM_LOCATION_SK=DT_EXT_MOVE_FROM.SK_ID_FROM(+) and AT_FACT_MOV_EXT.FROM_LOCATION_TYPE=DT_EXT_MOVE_FROM.LOCATION_TYPE_FROM(+) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=DT_ADMISSION.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK=AT_DIM_OFFENDER_ASSESSMENTS.OFFENDER_BOOKING_SK(+) ) AND ( AT_OFFENDER_BOOKING.LIVING_UNIT_SK=AT_DIM_LOCATION.UNIT_4_SK(+) ) AND ( ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK =(SELECT ESTABLISHMENT_CODE FROM prompt_ /*= #Prompt('Establishment Code','A','Associated Establishment\\Associated Establishment Code',mono,free,Not_Persistent,User:69) */ ) ) AND ( AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y' ) AND AT_DIM_DATE_EXT_MOV.DAY_DATE BETWEEN (SELECT UNKNOWN_PARAMETER FROM prompt_ /*= #prompt('Enter Movement Date Only (External)(Start):','D',,Mono,Free,Not_Persistent,,User:0) */ ) AND (SELECT UNKNOWN_PARAMETER FROM prompt_ /*= #prompt('Enter Movement Date Only (External)(End):','D',,Mono,Free,Not_Persistent,,User:1) */ ) AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'IN' AND AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_CODE_NK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK AND AT_FACT_MOV_EXT.TYPE IN ( 'Admission','Transfers' ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code','A','Associated Establishment\\Associated Establishment Code',mono,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        },
        {
          "index": 1,
          "name": "unknown_parameter",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter Movement Date Only (External)(Start):",
          "description": "@prompt('Enter Movement Date Only (External)(Start):','D',,Mono,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3375368/DP3",
      "name": "Load End Date",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP3.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "137598.RS",
      "name": "Admissions from Court",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP2_DO10076",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO1007B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10080",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10085",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_PNC",
            "display": "PNC",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[PNC ID]"
          },
          {
            "name": "$ref:DP2_DO10A7C",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO1009B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO2D0",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO100DE",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO100B2",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO103FC",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10700",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10400",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO103EB",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_CSRA",
            "display": "CSRA",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Court Admissions].[CSRA - Current Level] = \"Standard\"; \"Stand\";[Court Admissions].[CSRA - Current Level])"
          },
          {
            "name": "$ref:V_HA_ALERT_EFFECTIVE_DATE",
            "display": "Open ACCT Eff. date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Alert Effective Date]) Where ([v_HA_ACCT_Alert] = \"Y\")"
          },
          {
            "name": "$ref:V_HA_ACCT_ALERT",
            "display": "Open ACCT?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Alert_HA] = \"HA\" And [Alert Status] = \"ACTIVE\"; \"Y\")"
          },
          {
            "name": "$ref:V_HA1_ACCT_POST_CLOSURE",
            "display": "ACCT Post Close? ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Post_Closure_HA1]= \"HA1\"; \"Y\")"
          },
          {
            "name": "$ref:V_HA2_ACCT_CLOSED_AND_EXPIRED",
            "display": "Closed or Exp. ACCT?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Closed_HA2] = \"HA2\";\"Y\"; If([v_HA_ACCT_Alert_Expired] = \"Y\"; \"Y\"))"
          },
          {
            "name": "$ref:V_OCVM",
            "display": "Cust Viol Man?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_OCVM_Alert]= \"OCVM\"; \"Y\")"
          },
          {
            "name": "$ref:DP2_DO565",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "137660.RS",
      "name": "Admissions by Surname",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP2_DO10076",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO1007B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10080",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10085",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_PNC",
            "display": "PNC",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[PNC ID]"
          },
          {
            "name": "$ref:DP2_DO10A7C",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO1009B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO2D0",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO100DE",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO100B2",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO103FC",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10700",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10400",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO103EB",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_CSRA",
            "display": "CSRA",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Court Admissions].[CSRA - Current Level] = \"Standard\"; \"Stand\";[Court Admissions].[CSRA - Current Level])"
          },
          {
            "name": "$ref:V_HA_ALERT_EFFECTIVE_DATE",
            "display": "Open ACCT Eff. date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Alert Effective Date]) Where ([v_HA_ACCT_Alert] = \"Y\")"
          },
          {
            "name": "$ref:V_HA_ACCT_ALERT",
            "display": "Open ACCT?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Alert_HA] = \"HA\" And [Alert Status] = \"ACTIVE\"; \"Y\")"
          },
          {
            "name": "$ref:V_HA1_ACCT_POST_CLOSURE",
            "display": "ACCT Post Close? ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Post_Closure_HA1]= \"HA1\"; \"Y\")"
          },
          {
            "name": "$ref:V_HA2_ACCT_CLOSED_AND_EXPIRED",
            "display": "Closed or Exp. ACCT?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Closed_HA2] = \"HA2\";\"Y\"; If([v_HA_ACCT_Alert_Expired] = \"Y\"; \"Y\"))"
          },
          {
            "name": "$ref:V_OCVM",
            "display": "Cust Viol Man?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_OCVM_Alert]= \"OCVM\"; \"Y\")"
          },
          {
            "name": "$ref:DP2_DO565",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "141878.RS",
      "name": "Admissions with PNC",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP2_DO100DB",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10076",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO1007B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10080",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10085",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10A7C",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO1009B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO2D0",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO100DE",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO100B2",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO103FC",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10700",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO10400",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO103EB",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_CSRA",
            "display": "CSRA",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Court Admissions].[CSRA - Current Level] = \"Standard\"; \"Stand\";[Court Admissions].[CSRA - Current Level])"
          },
          {
            "name": "$ref:V_HA_ALERT_EFFECTIVE_DATE",
            "display": "Open ACCT Eff. date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Alert Effective Date]) Where ([v_HA_ACCT_Alert] = \"Y\")"
          },
          {
            "name": "$ref:V_HA_ACCT_ALERT",
            "display": "Open ACCT?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Alert_HA] = \"HA\" And [Alert Status] = \"ACTIVE\"; \"Y\")"
          },
          {
            "name": "$ref:V_HA1_ACCT_POST_CLOSURE",
            "display": "ACCT Post Close? ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Post_Closure_HA1]= \"HA1\"; \"Y\")"
          },
          {
            "name": "$ref:V_HA2_ACCT_CLOSED_AND_EXPIRED",
            "display": "Closed or Exp. ACCT?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Closed_HA2] = \"HA2\";\"Y\"; If([v_HA_ACCT_Alert_Expired] = \"Y\"; \"Y\"))"
          },
          {
            "name": "$ref:V_OCVM",
            "display": "Cust Viol Man?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_OCVM_Alert]= \"OCVM\"; \"Y\")"
          },
          {
            "name": "$ref:DP2_DO565",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "140203.RS",
      "name": "Scheduled Transfers",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DPa",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DPa.DO10076"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DPa.DO1007b"
          },
          {
            "name": "$ref:DAY_DATE",
            "display": "Schedule Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO10924"
          },
          {
            "name": "$ref:ESTABLISHMENT_DESCRIPTION",
            "display": "Establishment Name - Destination",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO104ec"
          }
        ]
      }
    },
    {
      "id": "140462.RS",
      "name": "Adm or Txs in to current Est.",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DPc",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_MAX_MOVE_CODE IS NOT NULL)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DPC_DO10076",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DPC_DO1007B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DPC_DO10080",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DPC_DO10085",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_PNC",
            "display": "PNC",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[PNC ID]"
          },
          {
            "name": "$ref:DPC_DO10A7C",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DPC_DO1009B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DPC_DO2D0",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DPC_DO100DE",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DPC_DO100B2",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_MAX_MOVE_CODE",
            "display": "Move Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "= [Current Admission or Transfer in].[Movement Reason Code (External)]Where ([Current Admission or Transfer in].[Movement Date and Time (External)] = [v_Max_Move]) In ([Current Admission or Transfer in].[NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_MOVE_FROM",
            "display": "From",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Current Admission or Transfer in].[Movement Description (From)] Where ([Current Admission or Transfer in].[Movement Date and Time (External)] = [v_Max_Move]) In ([Current Admission or Transfer in].[NOMS Number])"
          },
          {
            "name": "$ref:DPC_DO10400",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_ADMISSION_DATE",
            "display": "Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Admission Date]"
          },
          {
            "name": "$ref:V_CSRA_CURRENT_ADMISSION",
            "display": "CSRA",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Current Admission or Transfer in].[CSRA - Current Level]= \"Standard\"; \"Stand\";[Current Admission or Transfer in].[CSRA - Current Level])"
          },
          {
            "name": "$ref:V_ALERT_EFFECTIVE_DATE_CURRE40",
            "display": "Open ACCT Eff. date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Alert Effective Date]) Where ([v_HA_ACCT_Alert_current_Admission] = \"Y\")"
          },
          {
            "name": "$ref:V_HA_ACCT_ALERT_CURRENT_ADMI33",
            "display": "Open ACCT?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Alert_HA_current_admission] = \"HA\" And [Alert Status] = \"ACTIVE\"; \"Y\")"
          },
          {
            "name": "$ref:V_HA1_ACCT_POST_CLOSURE_CURR41",
            "display": "ACCT Post Close? ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Post_Closure_HA1]= \"HA1\"; \"Y\")"
          },
          {
            "name": "$ref:V_ACCT_CLOSED_AND_EXPIRED_CU43",
            "display": "Closed or Exp. Open ACCT?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_ACCT_Closed_HA2_current_admission] = \"HA2\";\"Y\"; If([v_HA_ACCT_Alert_Expired_current_admission] = \"Y\"; \"Y\"))"
          },
          {
            "name": "$ref:V_OCVM_CURRENT_ADMISSION",
            "display": "Cust Viol Man?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_OCVM_Alert_current_admission]= \"OCVM\"; \"Y\")"
          },
          {
            "name": "$ref:DPC_DO565",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "140894.RS",
      "name": "Alerts created at current Estab",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DPc",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE V_MAX_MOVE_CODE IS NOT NULL)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DPC_DO1007B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DPC_DO10080",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_PNC",
            "display": "PNC",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[PNC ID]"
          },
          {
            "name": "$ref:V_MAX_MOVE_CODE",
            "display": "Move Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "= [Current Admission or Transfer in].[Movement Reason Code (External)]Where ([Current Admission or Transfer in].[Movement Date and Time (External)] = [v_Max_Move]) In ([Current Admission or Transfer in].[NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_MOVE_FROM",
            "display": "From",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Current Admission or Transfer in].[Movement Description (From)] Where ([Current Admission or Transfer in].[Movement Date and Time (External)] = [v_Max_Move]) In ([Current Admission or Transfer in].[NOMS Number])"
          },
          {
            "name": "$ref:DPC_DO10400",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_ADMISSION_DATE",
            "display": "Adm. Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Admission Date]"
          },
          {
            "name": "$ref:V_HA_ALERT_EFFECTIVE_DATE_CR46",
            "display": "ACCT Open Effec. Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alert Effective Date] Where ([Alert Code] = \"HA\")"
          },
          {
            "name": "$ref:V_HA_ALERT_EXPIRY_DATE_CREAT43",
            "display": "ACCT Open Expiry Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alert Expiry Date] Where ([Alert Code] = \"HA\")"
          },
          {
            "name": "$ref:V_HA1_ALERT_EFFECTIVE_DATE_C47",
            "display": "ACCT Post Closure Effec. Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alert Effective Date] Where ([Alert Code] = \"HA1\")"
          },
          {
            "name": "$ref:V_HA1_ALERT_EXPIRY_DATE_CREA44",
            "display": "ACCT Post Closure Expiry Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alert Expiry Date] Where ([Alert Code] = \"HA1\")"
          },
          {
            "name": "$ref:V_HA2_ALERT_EFFECTIVE_DATE_C47",
            "display": "ACCT Closed Eff. Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alert Effective Date] Where ([Alert Code] = \"HA2\")"
          },
          {
            "name": "$ref:V_HA2_ALERT_EXPIRY_DATE_CREA44",
            "display": "ACCT Closed Expiry Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alert Expiry Date] Where ([Alert Code] = \"HA2\")"
          },
          {
            "name": "$ref:V_OCVM_ALERT_EFFECTIVE_DATE_48",
            "display": "Cust Viol Man Eff. Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alert Effective Date] Where ([Alert Code] = \"OCVM\")"
          },
          {
            "name": "$ref:V_OCVM_ALERT_EXPIRY_DATE_CRE45",
            "display": "Cust Viol Man Expiry Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Alert Expiry Date] Where ([Alert Code] = \"OCVM\")"
          },
          {
            "name": "$ref:DPC_DO565",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "139125.RS",
      "name": "Codes and Descriptions",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:DP2_DO100B2",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP2_DO100B3",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expected table name but got None. Line 1, Col: 4178.\n  hen AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE \u001b[4mFrom\u001b[0m --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENT]",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA_ALERT_EFFECTIVE_DATE :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA_ACCT_ALERT :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expected table name but got None. Line 1, Col: 5434.\n  hen AT_RELEASE_DATE.DAY_DATE <> '31/12/9000' Then AT_RELEASE_DATE.DAY_DATE end as CURR_RELEASE_DATE \u001b[4mFrom\u001b[0m --BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENT]",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_PNC :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_MOVE_CODE :: Error: = [Current Admission or Transfer in].[Movement Reason Code (External)]Where ([Current Admission or Transfer in].[Movement Date and Time (External)] = [v_Max_Move]) In ([Current Admission or Transfer in].[NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:165",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_MOVE_FROM :: Error: =[Current Admission or Transfer in].[Movement Description (From)] Where ([Current Admission or Transfer in].[Movement Date and Time (External)] = [v_Max_Move]) In ([Current Admission or Transfer in].[NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:161",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_ALERT_EFFECTIVE_DATE_CURRE40 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA_ACCT_ALERT_CURRENT_ADMI33 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA_ALERT_EFFECTIVE_DATE_CR46 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA_ALERT_EXPIRY_DATE_CREAT43 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA1_ALERT_EFFECTIVE_DATE_C47 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA1_ALERT_EXPIRY_DATE_CREA44 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA2_ALERT_EFFECTIVE_DATE_C47 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HA2_ALERT_EXPIRY_DATE_CREA44 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OCVM_ALERT_EFFECTIVE_DATE_48 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OCVM_ALERT_EXPIRY_DATE_CRE45 :: ReferenceError: error is not defined",
      "entityId": "klmAP5gAAgY7BokA22gAISgV_bQ",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Dataset does not have any schema fields (comments -- in query)",
      "entityId": "3375368/DP2",
      "entityType": "dataset"
    },
    {
      "type": "schema",
      "error": "Dataset does not have any schema fields (comments -- in query)",
      "entityId": "3375368/DPc",
      "entityType": "dataset"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10076 does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO1007B does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10080 does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10085 does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_PNC does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10A7C does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO1009B does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO2D0 does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100DE does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100B2 does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO103FC does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10700 does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10400 does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO103EB does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_CSRA does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ALERT_EFFECTIVE_DATE does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ACCT_ALERT does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA1_ACCT_POST_CLOSURE does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA2_ACCT_CLOSED_AND_EXPIRED does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_OCVM does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO565 does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10076 does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO1007B does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10080 does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10085 does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_PNC does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10A7C does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO1009B does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO2D0 does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100DE does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100B2 does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO103FC does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10700 does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10400 does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO103EB does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_CSRA does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ALERT_EFFECTIVE_DATE does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ACCT_ALERT does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA1_ACCT_POST_CLOSURE does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA2_ACCT_CLOSED_AND_EXPIRED does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_OCVM does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO565 does not have corresponding dataset schema field",
      "entityId": "137660.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100DB does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10076 does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO1007B does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10080 does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10085 does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10A7C does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO1009B does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO2D0 does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100DE does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100B2 does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO103FC does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10700 does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO10400 does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO103EB does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_CSRA does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ALERT_EFFECTIVE_DATE does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ACCT_ALERT does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA1_ACCT_POST_CLOSURE does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA2_ACCT_CLOSED_AND_EXPIRED does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_OCVM does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO565 does not have corresponding dataset schema field",
      "entityId": "141878.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO10076 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO1007B does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO10080 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO10085 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_PNC does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO10A7C does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO1009B does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO2D0 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO100DE does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO100B2 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MAX_MOVE_CODE does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MAX_MOVE_FROM does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO10400 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_ADMISSION_DATE does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_CSRA_CURRENT_ADMISSION does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_ALERT_EFFECTIVE_DATE_CURRE40 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ACCT_ALERT_CURRENT_ADMI33 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA1_ACCT_POST_CLOSURE_CURR41 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_ACCT_CLOSED_AND_EXPIRED_CU43 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_OCVM_CURRENT_ADMISSION does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO565 does not have corresponding dataset schema field",
      "entityId": "140462.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO1007B does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO10080 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_PNC does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MAX_MOVE_CODE does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MAX_MOVE_FROM does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO10400 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_ADMISSION_DATE does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ALERT_EFFECTIVE_DATE_CR46 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA_ALERT_EXPIRY_DATE_CREAT43 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA1_ALERT_EFFECTIVE_DATE_C47 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA1_ALERT_EXPIRY_DATE_CREA44 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA2_ALERT_EFFECTIVE_DATE_C47 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_HA2_ALERT_EXPIRY_DATE_CREA44 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_OCVM_ALERT_EFFECTIVE_DATE_48 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_OCVM_ALERT_EXPIRY_DATE_CRE45 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DPC_DO565 does not have corresponding dataset schema field",
      "entityId": "140894.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100B2 does not have corresponding dataset schema field",
      "entityId": "139125.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP2_DO100B3 does not have corresponding dataset schema field",
      "entityId": "139125.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "unable to generate test sql",
      "entityId": "3375368/DP2",
      "entityType": "dataset"
    }
  ]
}