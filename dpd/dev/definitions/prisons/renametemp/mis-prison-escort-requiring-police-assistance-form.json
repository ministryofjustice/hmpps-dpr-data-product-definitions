{
  "id": "FsxZbl2YjAAAC0wBAHArPF4QACJIAFJ8",
  "name": "MIS Prison Escort Requiring Police Assistance form",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "MOV0070 v00.00.01"
    ]
  },
  "description": "Returns a Prisoners main details and can be used when a Prisoner is required to be escorted by the Police.  The report can be printed out and a Storm reference number entered manually once the Police have been notified.<br/>MOV0070 - v00.00.01 Last Modified: 03/09/19",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3376639/DPe",
      "name": "Prisoner Details",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_CELL.UNIT_4_SHORT_DESCRIPTION, AT_OFFENDER_BOOKING.PNC_ID, AT_OFFENDER_BOOKING.CRO_NUMBER, AT_OFFENDER_ALIAS.SURNAME AS ALIAS_SURNAME, AT_OFFENDER_ALIAS.FIRST_NAME AS ALIAS_GIVEN_NAME_1, AT_OFFENDER_ALIAS.MIDDLE_NAME_1, AT_OFFENDER_ALIAS.MIDDLE_NAME_2, AT_OFFENDER_ALIAS.DATE_OF_BIRTH, TO_CHAR(TRUNC(AT_OFFENDER_BOOKING.HEIGHT_METRIC / 100, 2)) || ' Metres ' AS HEIGHT_METRIC, TO_CHAR(AT_OFFENDER_BOOKING.HEIGHT_IMPERIAL_FT) || ' Feet ' || TO_CHAR(AT_OFFENDER_BOOKING.HEIGHT_IMPERIAL_IN) || ' Inches' AS HEIGHT_IMPERIAL, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'Asian/Asian British: Chinese' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_DESCRIPTION, TO_CHAR(FLOOR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL / 14)) || ' Stone ' || '  ' || TO_CHAR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL - 14 * FLOOR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL / 14)) || ' Pounds ' AS WEIGHT_IMPERIAL, TO_CHAR(AT_OFFENDER_BOOKING.WEIGHT_METRIC) || ' Kilos ' AS WEIGHT_METRIC, AT_OFFENDER_PHYSICAL_MARK.BODY_PART_CODE, AT_OFFENDER_PHYSICAL_MARK.BODY_PART, AT_OFFENDER_BOOKING.BUILD_DESCRIPTION, AT_OFFENDER_PHYSICAL_MARK.COMMENT_TEXT, AT_OFFENDER_BOOKING.FACIAL_HAIR_DESCRIPTION, AT_OFFENDER_BOOKING.FACIAL_SHAPE_DESCRIPTION, AT_OFFENDER_BOOKING.GENDER_CODE, AT_OFFENDER_BOOKING.GENDER_DESCRIPTION, AT_OFFENDER_BOOKING.HAIR_DESCRIPTION, AT_OFFENDER_PHYSICAL_MARK.MARK_TYPE, AT_OFFENDER_PHYSICAL_MARK.MARK, AT_OFFENDER_PHYSICAL_MARK.PART_ORIENTATION_CODE, AT_OFFENDER_PHYSICAL_MARK.PART_ORIENTATION, AT_OFFENDER_PHYSICAL_MARK.ID_MARK_SEQ, AT_OFFENDER_PHYSICAL_MARK.SIDE_CODE, AT_OFFENDER_PHYSICAL_MARK.SIDE, AT_OFFENDER_BOOKING.LEFT_EYE_COLOUR_DESCRIPTION, AT_OFFENDER_BOOKING.RIGHT_EYE_COLOUR_DESCRIPTION FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_CELL AT_CELL, BODIMIS.DIM_OFFENDER_ALIAS AT_OFFENDER_ALIAS, BODIMIS.DIM_OFFENDER_PHYSICAL_MARK AT_OFFENDER_PHYSICAL_MARK WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_PHYSICAL_MARK.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK IS NULL OR AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #prompt('Enter NOMS Number:','A',,Mono,Free,Not_Persistent,,User:0) */) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT SAC.CASELOAD_ID FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC WHERE SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)))))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, DATE_OF_BIRTH, UNIT_4_SHORT_DESCRIPTION, PNC_ID, CRO_NUMBER, ALIAS_SURNAME, ALIAS_GIVEN_NAME_1, MIDDLE_NAME_1, MIDDLE_NAME_2, DATE_OF_BIRTH, HEIGHT_METRIC, HEIGHT_IMPERIAL, ETHNIC_DESCRIPTION, WEIGHT_IMPERIAL, WEIGHT_METRIC, BODY_PART_CODE, BODY_PART, BUILD_DESCRIPTION, COMMENT_TEXT, FACIAL_HAIR_DESCRIPTION, FACIAL_SHAPE_DESCRIPTION, GENDER_CODE, GENDER_DESCRIPTION, HAIR_DESCRIPTION, MARK_TYPE, MARK, PART_ORIENTATION_CODE, PART_ORIENTATION, ID_MARK_SEQ, SIDE_CODE, SIDE, LEFT_EYE_COLOUR_DESCRIPTION, RIGHT_EYE_COLOUR_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number:",
          "description": "@prompt('Enter NOMS Number:','A',,Mono,Free,Not_Persistent,,User:0)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPe.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DPe.DO7b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DPe.DO80",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DPe.DO85",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Unit Description 4 - Short",
            "legacyId": "DPe.DO4c2",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "PNC_ID",
            "type": "string",
            "display": "PNC ID",
            "legacyId": "DPe.DOdb",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CRO_NUMBER",
            "type": "string",
            "display": "Criminal Records Office number",
            "legacyId": "DPe.DOda",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ALIAS_SURNAME",
            "type": "string",
            "display": "Alias Surname",
            "legacyId": "DPe.DO89",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ALIAS_GIVEN_NAME_1",
            "type": "string",
            "display": "Alias Given Name 1",
            "legacyId": "DPe.DO8b",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "MIDDLE_NAME_1",
            "type": "string",
            "display": "Alias Given Name 2",
            "legacyId": "DPe.DO8c",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "MIDDLE_NAME_2",
            "type": "string",
            "display": "Alias Given Name 3",
            "legacyId": "DPe.DOb6b",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Alias Date of Birth",
            "legacyId": "DPe.DO8d",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "HEIGHT_METRIC",
            "type": "string",
            "display": "Height Metric",
            "legacyId": "DPe.DO99",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "HEIGHT_IMPERIAL",
            "type": "string",
            "display": "Height Imperial",
            "legacyId": "DPe.DO9a",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "ETHNIC_DESCRIPTION",
            "type": "string",
            "display": "Ethnic Description",
            "legacyId": "DPe.DO9d",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "WEIGHT_IMPERIAL",
            "type": "string",
            "display": "Weight Imperial",
            "legacyId": "DPe.DO9e",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "WEIGHT_METRIC",
            "type": "string",
            "display": "Weight Metric",
            "legacyId": "DPe.DO9f",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "BODY_PART_CODE",
            "type": "string",
            "display": "Body Part Code",
            "legacyId": "DPe.DOa1",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "BODY_PART",
            "type": "string",
            "display": "Body Part Description",
            "legacyId": "DPe.DO6b8",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "BUILD_DESCRIPTION",
            "type": "string",
            "display": "Build",
            "legacyId": "DPe.DOa6",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Comment Text",
            "legacyId": "DPe.DO4ea",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "FACIAL_HAIR_DESCRIPTION",
            "type": "string",
            "display": "Facial Hair",
            "legacyId": "DPe.DOa5",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "FACIAL_SHAPE_DESCRIPTION",
            "type": "string",
            "display": "Facial Shape",
            "legacyId": "DPe.DOa7",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "GENDER_CODE",
            "type": "string",
            "display": "Gender Code",
            "legacyId": "DPe.DOa8",
            "legacySqlClass": "column"
          },
          {
            "index": 24,
            "name": "GENDER_DESCRIPTION",
            "type": "string",
            "display": "Gender Description",
            "legacyId": "DPe.DOa9",
            "legacySqlClass": "column"
          },
          {
            "index": 25,
            "name": "HAIR_DESCRIPTION",
            "type": "string",
            "display": "Hair Colour",
            "legacyId": "DPe.DOaa",
            "legacySqlClass": "column"
          },
          {
            "index": 26,
            "name": "MARK_TYPE",
            "type": "string",
            "display": "Mark Type",
            "legacyId": "DPe.DOa2",
            "legacySqlClass": "column"
          },
          {
            "index": 27,
            "name": "MARK",
            "type": "string",
            "display": "Mark Description",
            "legacyId": "DPe.DO6ca",
            "legacySqlClass": "column"
          },
          {
            "index": 28,
            "name": "PART_ORIENTATION_CODE",
            "type": "string",
            "display": "Part Orientation Code",
            "legacyId": "DPe.DOa4",
            "legacySqlClass": "column"
          },
          {
            "index": 29,
            "name": "PART_ORIENTATION",
            "type": "string",
            "display": "Part Orientation Description",
            "legacyId": "DPe.DO6b6",
            "legacySqlClass": "column"
          },
          {
            "index": 30,
            "name": "ID_MARK_SEQ",
            "type": "double",
            "display": "Physical Characteristics ID",
            "legacyId": "DPe.DO6da",
            "legacySqlClass": "column"
          },
          {
            "index": 31,
            "name": "SIDE_CODE",
            "type": "string",
            "display": "Side Code",
            "legacyId": "DPe.DOa3",
            "legacySqlClass": "column"
          },
          {
            "index": 32,
            "name": "SIDE",
            "type": "string",
            "display": "Side Description",
            "legacyId": "DPe.DO6b7",
            "legacySqlClass": "column"
          },
          {
            "index": 33,
            "name": "LEFT_EYE_COLOUR_DESCRIPTION",
            "type": "string",
            "display": "Left Eye Colour",
            "legacyId": "DPe.DOab",
            "legacySqlClass": "column"
          },
          {
            "index": 34,
            "name": "RIGHT_EYE_COLOUR_DESCRIPTION",
            "type": "string",
            "display": "Right Eye Colour",
            "legacyId": "DPe.DOac",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP10",
      "name": "NOK Details",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS OTHER_CONTACT_NAME, DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP, DT_OFFENDER_CONTACT_ADDRESS.FLAT || ' ' || DT_OFFENDER_CONTACT_ADDRESS.PREMISE AS OTHER_CONTACT_HOUSE_INFORMAT31, DT_OFFENDER_CONTACT_ADDRESS.STREET, DT_OFFENDER_CONTACT_ADDRESS.locality || (CASE WHEN DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.city WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.city IS NULL THEN NULL WHEN DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.city IS NULL THEN NULL WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL THEN ', ' || DT_OFFENDER_CONTACT_ADDRESS.city ELSE ', ' || DT_OFFENDER_CONTACT_ADDRESS.city END) || (CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.county IS NULL AND NOT DT_OFFENDER_CONTACT_ADDRESS.city IS NULL THEN ', ' || DT_OFFENDER_CONTACT_ADDRESS.county WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.county IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.city IS NULL AND NOT DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL THEN ', ' || DT_OFFENDER_CONTACT_ADDRESS.county WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.county IS NULL AND NOT DT_OFFENDER_CONTACT_ADDRESS.city IS NULL THEN ', ' || DT_OFFENDER_CONTACT_ADDRESS.county WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.county IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.city IS NULL AND DT_OFFENDER_CONTACT_ADDRESS.locality IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.county ELSE NULL END) AS OTHER_CONTACT_AREA, DT_OFFENDER_CONTACT_ADDRESS.POST_CODE, DT_OFFENDER_CONTACT_ADDRESS.TEL_NO, DT_OFFENDER_CONTACT_ADDRESS.EMERGENCY_CONTACT_FLAG FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = 'A2311EG' AND DT_OFFENDER_CONTACT_ADDRESS.NEXT_OF_KIN_FLAG = 'Y' AND (DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG (+) = 'Y') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT SAC.CASELOAD_ID FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC WHERE SAC.USERNAME = (SELECT username FROM context_))))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OTHER_CONTACT_NAME, RELATIONSHIP, OTHER_CONTACT_HOUSE_INFORMAT31, STREET, OTHER_CONTACT_AREA, POST_CODE, TEL_NO, EMERGENCY_CONTACT_FLAG FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP10.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OTHER_CONTACT_NAME",
            "type": "string",
            "display": "Other Contact Name",
            "legacyId": "DP10.DOa1b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "RELATIONSHIP",
            "type": "string",
            "display": "Other Contact Relationship",
            "legacyId": "DP10.DOa1c",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "OTHER_CONTACT_HOUSE_INFORMAT31",
            "type": "string",
            "display": "Other Contact House Information",
            "legacyId": "DP10.DOa1d",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "STREET",
            "type": "string",
            "display": "Other Contact Street",
            "legacyId": "DP10.DOa1e",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "OTHER_CONTACT_AREA",
            "type": "string",
            "display": "Other Contact Area",
            "legacyId": "DP10.DOa1f",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "POST_CODE",
            "type": "string",
            "display": "Other Contact Post Code",
            "legacyId": "DP10.DOa20",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "TEL_NO",
            "type": "string",
            "display": "Other Contact Tel No",
            "legacyId": "DP10.DOa21",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "EMERGENCY_CONTACT_FLAG",
            "type": "string",
            "display": "Other Contact Emergency Contact Flag",
            "legacyId": "DP10.DOb60",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP11",
      "name": "Active Alerts",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_ALERT.COMMENT_TEXT, AT_ALERT.ALERT_CODE_NK, AT_ALERT.ALERT_DESCRIPTION, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = 'A2311EG' AND (AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT SAC.CASELOAD_ID FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC WHERE SAC.USERNAME = (SELECT username FROM context_))))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, COMMENT_TEXT, ALERT_CODE_NK, ALERT_DESCRIPTION, ALERT_EFFECTIVE_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP11.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Alert Comment Text",
            "legacyId": "DP11.DO7ba",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP11.DO8e",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DP11.DO90",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DP11.DO95",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP12",
      "name": "Address",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, DT_OFFENDER_ADDRESSES.PRIMARY_FLAG, DT_OFFENDER_ADDRESSES.NO_FIXED_ADDRESS_FLAG, DT_OFFENDER_ADDRESSES.FLAT || ' '|| DT_OFFENDER_ADDRESSES.PREMISE || ' '|| DT_OFFENDER_ADDRESSES.STREET || ' '|| DT_OFFENDER_ADDRESSES.LOCALITY || ' '|| DT_OFFENDER_ADDRESSES.CITY_DESC || ' '|| DT_OFFENDER_ADDRESSES.POSTAL_CODE || ' '|| DT_OFFENDER_ADDRESSES.COUNTRY_DESC FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, ( select ROW_NUMBER() OVER (PARTITION BY ss.OWNER_ID ORDER BY PRIMARY_FLAG desc, ss.address_active_flag desc, ss.USAGE_ACTIVE_FLAG desc, ss.usages_dttm DESC nulls last) row_seq_filter, ss.* from ( select * from ( select AT_DIM_ADDRESSES.OWNER_ID, AT_DIM_ADDRESS_USAGES.ADDRESS_ID_NK, AT_DIM_ADDRESS_USAGES.ADDRESS_USAGE, AT_DIM_ADDRESS_USAGES.ADDR_USAGE_DESCRIPTION, AT_DIM_ADDRESS_USAGES.ACTIVE_FLAG as USAGE_ACTIVE_FLAG, AT_DIM_ADDRESSES.flat, AT_DIM_ADDRESSES.premise, AT_DIM_ADDRESSES.Street, AT_DIM_ADDRESSES.locality, AT_DIM_ADDRESSES.city_code, AT_DIM_ADDRESSES.city_desc, AT_DIM_ADDRESSES.county_code, AT_DIM_ADDRESSES.county_desc, AT_DIM_ADDRESSES.postal_code, AT_DIM_ADDRESSES.COUNTRY_CODE, AT_DIM_ADDRESSES.country_desc, AT_DIM_ADDRESSES.HOME_TEL_NO, AT_DIM_ADDRESSES.HOME_EXT_NO, AT_DIM_ADDRESSES.NO_FIXED_ADDRESS_FLAG, AT_DIM_ADDRESSES.establishment_sk, AT_DIM_ADDRESSES.PRIMARY_FLAG, AT_DIM_ADDRESSES.active_flag as address_active_flag, AT_DIM_ADDRESS_USAGES.CREATE_DATETIME, AT_DIM_ADDRESS_USAGES.MODIFY_DATETIME, COALESCE(AT_DIM_ADDRESS_USAGES.modify_datetime, AT_DIM_ADDRESS_USAGES.create_datetime) as usages_dttm from BODIMIS.DIM_ADDRESS_USAGES AT_DIM_ADDRESS_USAGES inner join BODIMIS.dim_addresses AT_DIM_ADDRESSES on AT_DIM_ADDRESS_USAGES.address_id_nk = AT_DIM_ADDRESSES.address_id_nk and AT_DIM_ADDRESSES.owner_class='OFF'  ) Addr_usages --where Addr_usages.usages_dttm is not null ) ss ) DT_OFFENDER_ADDRESSES, BODISTAGING.REF_OFFENDERS AT_BODISTAG_REF_OFFENDERS WHERE ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.ESTABLISHMENT_SK=AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK ) AND ( AT_ESTABLISHMENT_TAP.ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.OFFENDER_ID=AT_BODISTAG_REF_OFFENDERS.OFFENDER_ID(+) ) AND ( AT_BODISTAG_REF_OFFENDERS.ROOT_OFFENDER_ID=DT_OFFENDER_ADDRESSES.OWNER_ID(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = 'A2311EG' AND ( DT_OFFENDER_ADDRESSES.ADDRESS_ACTIVE_FLAG='Y' ) AND ( AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y' ) AND ( AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT SAC.CASELOAD_ID FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC WHERE SAC.USERNAME = (SELECT username from context_) ) ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3376639/DPb",
      "name": "MIS Load",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DPb.DO4dd",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "136881.RS",
      "name": "Prison Escort Police Assist.",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DPe",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:DP12_DO95C",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO951",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP12_DO945",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expecting ). Line 1, Col: 1864.\n  ESS_USAGES.address_id_nk = AT_DIM_ADDRESSES.address_id_nk and AT_DIM_ADDRESSES.owner_class='OFF'  ) \u001b[4mAddr_usages\u001b[0m --where Addr_usages.usages_dttm is not null ) ss ) DT_OFFENDER_ADDRESSES, BODISTAGING.REF_OFFENDERS]",
      "entityId": "FsxZbl2YjAAAC0wBAHArPF4QACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Dataset does not have any schema fields (comments -- in query)",
      "entityId": "3376639/DP12",
      "entityType": "dataset"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO95C does not have corresponding dataset schema field",
      "entityId": "136881.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO951 does not have corresponding dataset schema field",
      "entityId": "136881.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP12_DO945 does not have corresponding dataset schema field",
      "entityId": "136881.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3376639/DPe",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "unable to generate test sql",
      "entityId": "3376639/DP12",
      "entityType": "dataset"
    }
  ]
}