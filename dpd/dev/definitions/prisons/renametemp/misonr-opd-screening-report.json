{
  "id": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
  "name": "MISONR OPD Screening Report",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "OAS0032 v1.0"
    ]
  },
  "description": "Shows prisoners who may be eligible for the OPD pathway.<br/>Latest update: Added POM & OS.<br/>OAS0032 - v1.1  Last Modified: 11/12/2020",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP4",
      "name": "Prisoners",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.SURNAME, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, CASE WHEN AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassified' ELSE AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL END AS CURRENT_SECURITY_CATEGORY, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' WHEN SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '99' THEN 'Life' WHEN FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH = '00/00/00' THEN 'No sentence' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 6 THEN 'Less than 6 Months' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) = '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 4, 2)) < 12 THEN '6 Months to less than 1 Year' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) <> '00' AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 2 THEN '1 Year to less than 2 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 3 THEN '2 Years to less than 3 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 4 THEN '3 Years to less than 4 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND NOT SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2) IN ('00', '01', '02', '03') AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) < 10 THEN '4 Years to less than 10 Years' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND TO_NUMBER(SUBSTR(FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH, 1, 2)) >= 10 THEN '10 Years or more and Less than Life' WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG IS NULL AND FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH IS NULL THEN 'No sentence' ELSE 'Not Categorised' END AS CURRENT_SENTENCE_LENGTH_BAND, AT_OFFENDER_BOOKING.PNC_ID, AT_FACT_COURT_CHARGE.MOST_SERIOUS_FLAG, FACT_CURR_KEY_DATES_SENT.SSD, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, DT_ADMISSION.MOVEMENT_TIME, FACT_CURR_KEY_DATES_SENT.CURR_RELEASE_DATE, FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE, FACT_CURR_KEY_DATES_SENT.CURR_APD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_PED_DATE, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.IEP_BAND, '** Incentive Level Missing **') AS IEP_BAND, AT_DIM_OFFENCE.OFFENCE_NAME, FACT_CURR_KEY_DATES_SENT.CURR_ROTL_DATE, CASE WHEN AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassfied' ELSE AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_SEC_CAT_LEVEL END AS SECURITY_CATEGORY_CURRENT_LE31, AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_SEC_CAT_REVIEW_DATE, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'Asian/Asian British: Chinese' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_DESCRIPTION, FACT_CURR_KEY_DATES_SENT.CURR_HDCAD_DATE, AT_DIM_SENTENCE_TYPE.SENTENCE_CODE_NK, AT_DIM_OFFENCE.OFFENCE_CODE_NK, CASE WHEN AT_DIM_OFFENCE.OFFENCE_SK > 0 THEN (AT_DIM_OFFENCE.OFFENCE_CODE_NK) ELSE '-' END AS OFFENCE_CJIT_CODE, FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_PRRD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_LED_DATE, FACT_CURR_KEY_DATES_SENT.SED, FACT_CURR_KEY_DATES_SENT.CURR_NPD_DATE, FACT_CURR_KEY_DATES_SENT.TARIFF, CASE WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDSU18') THEN 'Recall' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '0' THEN 'Dead' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '1' THEN 'Indeterminate Sentence' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('2', '3') THEN 'Sentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('9', '10') OR AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'CIV_RMD' THEN 'Civil Prisoner' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('8', '11') THEN 'Immigration Detainee' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('12', '13', '14') THEN 'Remand' WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, (SELECT ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk, fme.from_location_type, MAX(fme.MOVEMENT_SEQ) AS MOVEMENT_SEQ, MAX(d.day_date) AS MOVEMENT_TIME, TRUNC(ETL.LOAD_END_DATETIME) AS LOAD_DATE FROM BODIMIS.FACT_MOVEMENT_EXTERNAL fme, BODIMIS.DIM_OFFENDER_BOOKING ob, BODIMIS.DIM_ESTABLISHMENT est, BODIMIS.ETL_LOAD_LOG ETL, BODIMIS.DIM_DATE d WHERE ob.ESTABLISHMENT_SK = est.ESTABLISHMENT_SK AND d.date_sk = fme.date_sk AND fme.offender_booking_sk = ob.offender_booking_sk AND ob.active_status IN ('Active In', 'Active Out') AND ob.MIS_CURRENT_RECORD_IND = 'Y' AND ob.ACTIVE_FLAG = 'Y' AND ETL.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL) AND ob.ESTABLISHMENT_SK = fme.to_location_sk AND fme.movement_seq = (SELECT MAX(fme2.movement_seq) FROM BODIMIS.FACT_MOVEMENT_EXTERNAL fme2 WHERE fme.offender_booking_sk = fme2.offender_booking_sk AND fme2.direction_code = 'IN' AND fme2.TYPE = 'Admission' AND fme2.To_location_type = 'Establishment' AND fme2.reason_code <> 'R') GROUP BY ob.offender_id_display, fme.offender_booking_sk, est.establishment_code_nk, fme.to_location_sk, fme.from_location_sk, fme.from_location_type, ETL.LOAD_END_DATETIME) DT_ADMISSION, BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_SENTENCE_TYPE AT_DIM_SENTENCE_TYPE, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_CURRENT_SECURITY_CATEGORY, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, FACT_CURR_KEY_DATES_SENT, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_DIM_OFFENDER_ASSESSMENTS, BODIMIS.DIM_COURT_CASE AT_COURT_CASE, BODIMIS.DIM_CELL AT_CELL WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_CELL.ESTABLISHMENT_SK = AT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_SENTENCE.COURT_CASE_SK (+)) AND (AT_ESTABLISHMENT.ACTIVE_FLAG = 'Y') AND (AT_FACT_SENTENCE.SENTENCE_TYPE_SK = AT_DIM_SENTENCE_TYPE.SENTENCE_TYPE_SK (+)) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_ADMISSION.OFFENDER_BOOKING_SK (+)) AND (AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_FLAG (+) = 'Y') AND (AT_CURRENT_SECURITY_CATEGORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_DIM_OFFENDER_ASSESSMENTS.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND NOT CASE WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDSU18') THEN 'Recall' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '0' THEN 'Dead' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '1' THEN 'Indeterminate Sentence' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('2', '3') THEN 'Sentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('9', '10') OR AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'CIV_RMD' THEN 'Civil Prisoner' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('8', '11') THEN 'Immigration Detainee' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('12', '13', '14') THEN 'Remand' WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END IN ('Remand'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, FIRST_NAME, SURNAME, DATE_OF_BIRTH, OFFENDER_AGE, CURRENT_SECURITY_CATEGORY, CURRENT_SENTENCE_LENGTH_BAND, PNC_ID, MOST_SERIOUS_FLAG, SSD, MAIN_LEGAL_STATUS_CODE, MOVEMENT_TIME, CURR_RELEASE_DATE, CURR_HDCED_DATE, CURR_APD_DATE, CURR_PED_DATE, UNIT_4_SHORT_DESCRIPTION, IEP_BAND, OFFENCE_NAME, CURR_ROTL_DATE, SECURITY_CATEGORY_CURRENT_LE31, CURRENT_SEC_CAT_REVIEW_DATE, NATIONALITY_DESCRIPTION, ETHNIC_DESCRIPTION, CURR_HDCAD_DATE, SENTENCE_CODE_NK, OFFENCE_CODE_NK, OFFENCE_CJIT_CODE, CURR_CRD_DATE, CURR_PRRD_DATE, CURR_LED_DATE, SED, CURR_NPD_DATE, TARIFF, LEGAL_STATUS_GROUPING, ESTABLISHMENT_DESCRIPTION, CRAMS_NUMBER AS V_CRN, 'TBD' AS V_MAX_CONCAT_MOST_CODE, CASE WHEN MOST_SERIOUS_FLAG = 'Y' THEN OFFENCE_NAME END AS V_MAIN_OFFENCE, CASE WHEN RELATIONSHIP = 'Prison Offender Manager' THEN OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_POM, CASE WHEN RELATIONSHIP = 'Offender Supervisor' THEN OTHER_CONTACT_NAME END AS V_OTHER_CONTACT_NAME_MGE_OS, 'TBD' AS V_MAX_CONCAT_ALERT_CODE, PRISONER_ALERTS_INC_INACTIVE.ALERT_DESCRIPTION AS V_ACCT_ALERT, COUNT(V_ACCT_ALERT) AS V_COUNT_ACCTS, S1Q27B_NO_GENERAL_OFFENDING_24 AS V_OGRS3_2YR, CASE WHEN V_RISK_LEVEL_MGE = 'Not calculated' THEN 'Low' ELSE V_RISK_LEVEL_MGE END AS V_RISK_LEVEL, V_U18_CONVICTIONS || V_OASYS_Q22B || V_OASYS_Q22C || V_OASYS_Q26 || V_OASYS_Q55 || V_OASYS_Q74 || V_OASYS_Q75 || V_OASYS_Q107 || V_OASYS_Q112 || V_OASYS_Q113 AS V_PERSONALITY_SCORE_TOTAL, TO_NUMBER(V_CHALLENGING_BEHAVIOUR_INDICATOR_SCORE) || TO_NUMBER(V_CHILDHOOD_INDICATOR_SCORE) || TO_NUMBER(V_MENTAL_HEALTH_INDICATOR_SCORE) || TO_NUMBER(V_SUICIDE_OR_SELF_HARM_INDICATOR_SCORE) AS V_INDICATOR_SCORE_TOTAL, CASE WHEN V_RISK_LEVEL = 'High' AND V_PERSONALITY_SCORE_TOTAL > 6 THEN 'Yes' ELSE CASE WHEN V_RISK_LEVEL = 'Very High' AND V_PERSONALITY_SCORE_TOTAL > 6 THEN 'Yes' ELSE CASE WHEN V_RISK_LEVEL = 'High' AND V_INDICATOR_SCORE_TOTAL > 1 THEN 'Yes' ELSE CASE WHEN V_RISK_LEVEL = 'Very High' AND V_INDICATOR_SCORE_TOTAL > 1 THEN 'Yes' ELSE 'No' END END END END AS V_OPD_ELIGIBLE_, S6Q3_CHILDHOOD_EXPERIENCE AS V_EXPERIENCE_OF_CHILDHOOD, CHILDHOOD_BEHAVIOURAL_PROBLE31 AS V_CHILDHOOD_BEHAVIOURAL_PROB32, CASE WHEN V_CHILDHOOD_BEHAVIOURAL_PROBLEMS = 'Yes' OR V_EXPERIENCE_OF_CHILDHOOD > 0 THEN '1' ELSE '0' END AS V_CHILDHOOD_INDICATOR_SCORE, S10Q6_PSYCHIATRIC_PROBLEMS AS V_CURRENT_PSYCHIATRIC_PROBLEMS, PSYCHIATRIC_TREATMENT_ AS V_PSYCHIATRIC_TREATMENT, CASE WHEN V_CURRENT_PSYCHIATRIC_PROBLEMS > 0 OR V_PSYCHIATRIC_TREATMENT = 'Yes' THEN '1' ELSE '0' END AS V_MENTAL_HEALTH_INDICATOR_SC31, ASSAULTED_THREATENED_STAFF AS V_ASSAULTED_STAFF, CONTROL_ISSUES_DISRUPTIVE_BE35 AS V_CONTROL_ISSUES_DISRUPTIVE_37, CASE WHEN V_ASSAULTED_STAFF = 'Yes' OR V_CONTROL_ISSUES_DISRUPTIVE_BEHAVIOUR = 'Yes' THEN '1' ELSE '0' END AS V_CHALLENGING_BEHAVIOUR_INDI39, S10Q5_SELF_HARM AS V_SELF_HARM_ATTEMPTED_SUICID59, RISK_OF_SUICIDE AS V_RISK_OF_SUICIDE, RISK_OF_SELF_HARM AS V_RISK_OF_SELF_HARM, 'TBD' AS V_SUICIDE_OR_SELF_HARM_INDIC38, MOVEMENT_TIME AS V_ADMISSION_DATE_MGE, DATE_COMPLETED AS V_DATE_COMPLETED_MGE, CASE WHEN S1Q5_NUMBER >= 1 THEN 1 ELSE 0 END AS V_U18_CONVICTIONS, CASE WHEN VIOLENCE_OR_THREAT_OF_VIOLEN31 = 'Yes' THEN 1 ELSE 0 END AS V_OASYS_Q2_2B, CASE WHEN EXCESSIVE_OR_SADISTIC_VIOLEN31 = 'Yes' THEN 1 ELSE 0 END AS V_OASYS_Q2_2C, CASE WHEN OFFENDER_RECOGNISES_IMPACT_ = 'No' THEN 1 ELSE 0 END AS V_OASYS_Q2_6, CASE WHEN S5Q5_OVER_RELIANCE >= 1 THEN 1 ELSE 0 END AS V_OASYS_Q5_5, CASE WHEN S7Q4_MANIPULATIVE_LIFESTYLE >= 1 THEN 1 ELSE 0 END AS V_OASYS_Q7_4, CASE WHEN S7Q5_RECKLESS_BEHAVIOUR >= 1 THEN 1 ELSE 0 END AS V_OASYS_Q7_5, CASE WHEN CHILDHOOD_BEHAVIOURAL_PROBLE31 = 'Yes' THEN 1 ELSE 0 END AS V_OASYS_Q10_7, CASE WHEN S11Q2_IMPULSIVITY >= 1 THEN 1 ELSE 0 END AS V_OASYS_Q11_2, CASE WHEN S11Q3_AGGRESSIVE >= 1 THEN 1 ELSE 0 END AS V_OASYS_Q11_3 FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP4.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP4.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP4.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP4.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP4.DO10082",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "CURRENT_SECURITY_CATEGORY",
            "type": "string",
            "display": "Current Security Category",
            "legacyId": "DP4.DO100e1",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CURRENT_SENTENCE_LENGTH_BAND",
            "type": "string",
            "display": "Current Sentence Length Band",
            "legacyId": "DP4.DO1ef",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "PNC_ID",
            "type": "string",
            "display": "PNC ID",
            "legacyId": "DP4.DO100db",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "MOST_SERIOUS_FLAG",
            "type": "string",
            "display": "Main Offence Flag",
            "legacyId": "DP4.DO4f",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "SSD",
            "type": "date",
            "display": "Current Sentence Start Date",
            "legacyId": "DP4.DO32d",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "MAIN_LEGAL_STATUS_CODE",
            "type": "string",
            "display": "Main Legal Status Code",
            "legacyId": "DP4.DO100de",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Admission Date",
            "legacyId": "DP4.DO107ce",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "CURR_RELEASE_DATE",
            "type": "date",
            "display": "Current Release Date",
            "legacyId": "DP4.DO2e6",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "CURR_HDCED_DATE",
            "type": "date",
            "display": "HDC Eligibility Date",
            "legacyId": "DP4.DO70",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "CURR_APD_DATE",
            "type": "date",
            "display": "APD (Actual Parole Date)",
            "legacyId": "DP4.DO88",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "CURR_PED_DATE",
            "type": "date",
            "display": "PED (Parole Eligibility Date)",
            "legacyId": "DP4.DO87",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP4.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "IEP_BAND",
            "type": "string",
            "display": "IEP Band",
            "legacyId": "DP4.DO100e4",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DP4.DO4b",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "CURR_ROTL_DATE",
            "type": "date",
            "display": "ROTL (Release on Temp Licence)",
            "legacyId": "DP4.DO61b",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "SECURITY_CATEGORY_CURRENT_LE31",
            "type": "string",
            "display": "Security Category - Current Level",
            "legacyId": "DP4.DO10832",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "CURRENT_SEC_CAT_REVIEW_DATE",
            "type": "date",
            "display": "Security Category - Current Review Date",
            "legacyId": "DP4.DO10830",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "NATIONALITY_DESCRIPTION",
            "type": "string",
            "display": "Nationality Description",
            "legacyId": "DP4.DO100b5",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "ETHNIC_DESCRIPTION",
            "type": "string",
            "display": "Ethnic Description",
            "legacyId": "DP4.DO1009d",
            "legacySqlClass": "column"
          },
          {
            "index": 24,
            "name": "CURR_HDCAD_DATE",
            "type": "date",
            "display": "HDC AD (Approved Date)",
            "legacyId": "DP4.DO97",
            "legacySqlClass": "column"
          },
          {
            "index": 25,
            "name": "SENTENCE_CODE_NK",
            "type": "string",
            "display": "Sentence Type",
            "legacyId": "DP4.DO3e",
            "legacySqlClass": "column"
          },
          {
            "index": 26,
            "name": "OFFENCE_CODE_NK",
            "type": "string",
            "display": "Offence Code",
            "legacyId": "DP4.DO4a",
            "legacySqlClass": "column"
          },
          {
            "index": 27,
            "name": "OFFENCE_CJIT_CODE",
            "type": "string",
            "display": "Offence CJIT Code",
            "legacyId": "DP4.DO49",
            "legacySqlClass": "column"
          },
          {
            "index": 28,
            "name": "CURR_CRD_DATE",
            "type": "date",
            "display": "CRD (Conditional Release Date)",
            "legacyId": "DP4.DO48",
            "legacySqlClass": "column"
          },
          {
            "index": 29,
            "name": "CURR_PRRD_DATE",
            "type": "date",
            "display": "PRRD (Post Recall Release Date)",
            "legacyId": "DP4.DO2f4",
            "legacySqlClass": "column"
          },
          {
            "index": 30,
            "name": "CURR_LED_DATE",
            "type": "date",
            "display": "LED (Licence Expiry Date )",
            "legacyId": "DP4.DO6a",
            "legacySqlClass": "column"
          },
          {
            "index": 31,
            "name": "SED",
            "type": "date",
            "display": "SED (Sentence End Date)",
            "legacyId": "DP4.DO46",
            "legacySqlClass": "column"
          },
          {
            "index": 32,
            "name": "CURR_NPD_DATE",
            "type": "date",
            "display": "NPD (Non Parole Date)",
            "legacyId": "DP4.DO8e",
            "legacySqlClass": "column"
          },
          {
            "index": 33,
            "name": "TARIFF",
            "type": "date",
            "display": "Tariff Date",
            "legacyId": "DP4.DO3b1",
            "legacySqlClass": "column"
          },
          {
            "index": 34,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP4.DO107cb",
            "legacySqlClass": "column"
          },
          {
            "index": 35,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Establishment Name",
            "legacyId": "DP4.DO10129",
            "legacySqlClass": "column"
          },
          {
            "index": 36,
            "name": "V_CRN",
            "type": "string",
            "display": "V_CRN",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 37,
            "name": "V_MAX_CONCAT_MOST_CODE",
            "type": "string",
            "display": "V_MAX_CONCAT_MOST_CODE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 38,
            "name": "V_MAIN_OFFENCE",
            "type": "string",
            "display": "V_MAIN_OFFENCE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 39,
            "name": "V_OTHER_CONTACT_NAME_MGE_POM",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_POM",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 40,
            "name": "V_OTHER_CONTACT_NAME_MGE_OS",
            "type": "string",
            "display": "V_OTHER_CONTACT_NAME_MGE_OS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 41,
            "name": "V_MAX_CONCAT_ALERT_CODE",
            "type": "string",
            "display": "V_MAX_CONCAT_ALERT_CODE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 42,
            "name": "V_ACCT_ALERT",
            "type": "string",
            "display": "V_ACCT_ALERT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 43,
            "name": "V_COUNT_ACCTS",
            "type": "string",
            "display": "V_COUNT_ACCTS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 44,
            "name": "V_OGRS3_2YR",
            "type": "string",
            "display": "V_OGRS3_2YR",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 45,
            "name": "V_RISK_LEVEL",
            "type": "string",
            "display": "V_RISK_LEVEL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 46,
            "name": "V_PERSONALITY_SCORE_TOTAL",
            "type": "string",
            "display": "V_PERSONALITY_SCORE_TOTAL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 47,
            "name": "V_INDICATOR_SCORE_TOTAL",
            "type": "string",
            "display": "V_INDICATOR_SCORE_TOTAL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 48,
            "name": "V_OPD_ELIGIBLE_",
            "type": "string",
            "display": "V_OPD_ELIGIBLE_",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 49,
            "name": "V_EXPERIENCE_OF_CHILDHOOD",
            "type": "string",
            "display": "V_EXPERIENCE_OF_CHILDHOOD",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 50,
            "name": "V_CHILDHOOD_BEHAVIOURAL_PROB32",
            "type": "string",
            "display": "V_CHILDHOOD_BEHAVIOURAL_PROB32",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 51,
            "name": "V_CHILDHOOD_INDICATOR_SCORE",
            "type": "string",
            "display": "V_CHILDHOOD_INDICATOR_SCORE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 52,
            "name": "V_CURRENT_PSYCHIATRIC_PROBLEMS",
            "type": "string",
            "display": "V_CURRENT_PSYCHIATRIC_PROBLEMS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 53,
            "name": "V_PSYCHIATRIC_TREATMENT",
            "type": "string",
            "display": "V_PSYCHIATRIC_TREATMENT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 54,
            "name": "V_MENTAL_HEALTH_INDICATOR_SC31",
            "type": "string",
            "display": "V_MENTAL_HEALTH_INDICATOR_SC31",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 55,
            "name": "V_ASSAULTED_STAFF",
            "type": "string",
            "display": "V_ASSAULTED_STAFF",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 56,
            "name": "V_CONTROL_ISSUES_DISRUPTIVE_37",
            "type": "string",
            "display": "V_CONTROL_ISSUES_DISRUPTIVE_37",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 57,
            "name": "V_CHALLENGING_BEHAVIOUR_INDI39",
            "type": "string",
            "display": "V_CHALLENGING_BEHAVIOUR_INDI39",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 58,
            "name": "V_SELF_HARM_ATTEMPTED_SUICID59",
            "type": "string",
            "display": "V_SELF_HARM_ATTEMPTED_SUICID59",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 59,
            "name": "V_RISK_OF_SUICIDE",
            "type": "string",
            "display": "V_RISK_OF_SUICIDE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 60,
            "name": "V_RISK_OF_SELF_HARM",
            "type": "string",
            "display": "V_RISK_OF_SELF_HARM",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 61,
            "name": "V_SUICIDE_OR_SELF_HARM_INDIC38",
            "type": "string",
            "display": "V_SUICIDE_OR_SELF_HARM_INDIC38",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 62,
            "name": "V_ADMISSION_DATE_MGE",
            "type": "string",
            "display": "V_ADMISSION_DATE_MGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 63,
            "name": "V_DATE_COMPLETED_MGE",
            "type": "string",
            "display": "V_DATE_COMPLETED_MGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 64,
            "name": "V_U18_CONVICTIONS",
            "type": "string",
            "display": "V_U18_CONVICTIONS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 65,
            "name": "V_OASYS_Q2_2B",
            "type": "string",
            "display": "V_OASYS_Q2_2B",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 66,
            "name": "V_OASYS_Q2_2C",
            "type": "string",
            "display": "V_OASYS_Q2_2C",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 67,
            "name": "V_OASYS_Q2_6",
            "type": "string",
            "display": "V_OASYS_Q2_6",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 68,
            "name": "V_OASYS_Q5_5",
            "type": "string",
            "display": "V_OASYS_Q5_5",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 69,
            "name": "V_OASYS_Q7_4",
            "type": "string",
            "display": "V_OASYS_Q7_4",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 70,
            "name": "V_OASYS_Q7_5",
            "type": "string",
            "display": "V_OASYS_Q7_5",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 71,
            "name": "V_OASYS_Q10_7",
            "type": "string",
            "display": "V_OASYS_Q10_7",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 72,
            "name": "V_OASYS_Q11_2",
            "type": "string",
            "display": "V_OASYS_Q11_2",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 73,
            "name": "V_OASYS_Q11_3",
            "type": "string",
            "display": "V_OASYS_Q11_3",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375896/DP22",
      "name": "OASys",
      "description": "ONR - Ad-hoc Reports",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT OFFENDER.OFFENDER_ID_DISPLAY, ASSESSMENT.DATE_COMPLETED, COUNT(DISTINCT OFFENDER.OFFENDER_ID) AS COUNT_OF_OFFENDERS, REP_OFFENDER_HISTORY.CONTROLLING_OWNER, SUBSTR(ASSESSMENT.CALC_HIGHEST_RISK, 4) AS RISK_LEVEL_, REP_OFFENDER_HISTORY.OFFENDER_MANAGER, ASSESSMENT.CALC_PURPOSE_OF_ASSMNT_GROUPS, COALESCE(PURPOSE_OF_ASSESSMENT.DESCRIPTION, 'Not Specified') AS PURPOSE_OF_ASSESSMENT, ASSESSMENT_SECTION1.S1Q27A_NO_GENERAL_OFFENDING_12, ASSESSMENT_SECTION1.S1Q27B_NO_GENERAL_OFFENDING_24, ASSESSMENT_SUMMARY.OGP_YEAR_1, ASSESSMENT_SUMMARY.OGP_YEAR_2, ASSESSMENT_SUMMARY.OVP_YEAR_1, ASSESSMENT_SUMMARY.OVP_YEAR_2, ASSESSMENT_SECTION1.S1Q5_NUMBER, CASE WHEN ASSESSMENT_SECTION2.S2Q2B_VIOLENCE_THREAT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2B_VIOLENCE_THREAT = '1' THEN 'Yes' END AS VIOLENCE_OR_THREAT_OF_VIOLEN31, CASE WHEN ASSESSMENT_SECTION2.S2Q2C_EXCESSIVE_VIOLENCE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2C_EXCESSIVE_VIOLENCE = '1' THEN 'Yes' END AS EXCESSIVE_OR_SADISTIC_VIOLEN31, ASSESSMENT_SECTION5.S5Q5_OVER_RELIANCE, ASSESSMENT_SECTION7.S7Q4_MANIPULATIVE_LIFESTYLE, ASSESSMENT_SECTION7.S7Q5_RECKLESS_BEHAVIOUR, CASE WHEN ASSESSMENT_SECTION10.S10Q7_CHILDHOOD_PROBLEMS = '0' THEN 'No' WHEN ASSESSMENT_SECTION10.S10Q7_CHILDHOOD_PROBLEMS = '1' THEN 'Yes' END AS CHILDHOOD_BEHAVIOURAL_PROBLE31, ASSESSMENT_SECTION11.S11Q2_IMPULSIVITY, ASSESSMENT_SECTION11.S11Q3_AGGRESSIVE, CASE WHEN ASSESSMENT_SECTION2.S2Q6_OFFENDER_RECOGNISE_IMPACT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q6_OFFENDER_RECOGNISE_IMPACT = '1' THEN 'Yes' END AS OFFENDER_RECOGNISES_IMPACT_, OFFENDER.CRAMS_NUMBER, REP_OFFENDER_HISTORY.PHYSICAL_LOCATION, ASSESSMENT_SECTION6.S6Q3_CHILDHOOD_EXPERIENCE, ASSESSMENT_SECTION10.S10Q6_PSYCHIATRIC_PROBLEMS, ASSESSMENT_SECTION10.S10Q5_SELF_HARM, CASE WHEN ASSESSMENT_SECTION10.S10Q7_PSYCHIATRIC_TREATMENT = '0' THEN 'No' WHEN ASSESSMENT_SECTION10.S10Q7_PSYCHIATRIC_TREATMENT = '1' THEN 'Yes' END AS PSYCHIATRIC_TREATMENT_, CASE WHEN ASSESSMENT_ROH_SCREENING.R1Q3_ASSAULTED_STAFF_CURR = 'C' THEN 'Yes' END AS ASSAULTED_THREATENED_STAFF, CASE WHEN ASSESSMENT_ROH_SCREENING.R3Q1_SUICIDE_RISK = '0' THEN 'No' WHEN ASSESSMENT_ROH_SCREENING.R3Q1_SUICIDE_RISK = '1' THEN 'Yes' WHEN ASSESSMENT_ROH_SCREENING.R3Q1_SUICIDE_RISK = '2' THEN 'Don’t Know' END AS RISK_OF_SUICIDE, CASE WHEN ASSESSMENT_ROH_SCREENING.R3Q2_SELF_HARM_RISK = '0' THEN 'No' WHEN ASSESSMENT_ROH_SCREENING.R3Q2_SELF_HARM_RISK = '1' THEN 'Yes' WHEN ASSESSMENT_ROH_SCREENING.R3Q2_SELF_HARM_RISK = '2' THEN 'Don’t Know' END AS RISK_OF_SELF_HARM, CASE WHEN ASSESSMENT_ROH_SCREENING.R4Q2_DISRUPTIVE_BEHAVIOUR = '0' THEN 'No' WHEN ASSESSMENT_ROH_SCREENING.R4Q2_DISRUPTIVE_BEHAVIOUR = '1' THEN 'Yes' WHEN ASSESSMENT_ROH_SCREENING.R4Q2_DISRUPTIVE_BEHAVIOUR = '2' THEN 'Don’t Know' END AS CONTROL_ISSUES_DISRUPTIVE_BE35 FROM OFFENDER, ASSESSMENT, REP_OFFENDER_HISTORY, PURPOSE_OF_ASSESSMENT, ASSESSMENT_SECTION1, ASSESSMENT_SUMMARY, ASSESSMENT_SECTION2, ASSESSMENT_SECTION5, ASSESSMENT_SECTION7, ASSESSMENT_SECTION10, ASSESSMENT_SECTION11, ASSESSMENT_SECTION6, ASSESSMENT_ROH_SCREENING WHERE (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SUMMARY.ASSESSMENT_ID) AND (PURPOSE_OF_ASSESSMENT.PURPOSE_OF_ASSESSMENT_CODE (+) = ASSESSMENT.PURPOSE_OF_ASSESSMENT_CODE) AND (ASSESSMENT_ROH_SCREENING.ASSESSMENT_ID = ASSESSMENT.ASSESSMENT_ID) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SECTION1.ASSESSMENT_ID) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SECTION2.ASSESSMENT_ID) AND (ASSESSMENT_SECTION5.ASSESSMENT_ID = ASSESSMENT.ASSESSMENT_ID) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SECTION6.ASSESSMENT_ID) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SECTION7.ASSESSMENT_ID) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SECTION10.ASSESSMENT_ID) AND (ASSESSMENT.ASSESSMENT_ID = ASSESSMENT_SECTION11.ASSESSMENT_ID) AND (OFFENDER.OFFENDER_ID = ASSESSMENT.OFFENDER_ID (+)) AND (OFFENDER.OFFENDER_ID = REP_OFFENDER_HISTORY.OFFENDER_ID (+)) AND (SUBSTR(OFFENDER.OFFENDER_ID_DISPLAY, 1, 10) = TAGMIS_CASELOAD_SECURITY('VQL10O', OFFENDER.OFFENDER_ID_DISPLAY)) AND (ASSESSMENT.ASSESSMENT_ID IN (SELECT LAST_VALUE(ASSESSMENT.assessment_id) OVER (PARTITION BY ASSESSMENT.offender_id ORDER BY ASSESSMENT.date_completed rows BETWEEN CURRENT ROW AND UNBOUNDED following) AS last_ass_for_offender FROM ASSESSMENT, OFFENDER, REP_OFFENDER_HISTORY WHERE (OFFENDER.OFFENDER_ID = ASSESSMENT.OFFENDER_ID (+)) AND (OFFENDER.OFFENDER_ID = REP_OFFENDER_HISTORY.OFFENDER_ID (+)) AND (ASSESSMENT.single_date_completed = 'Y' AND completed_assessment <> 'Abandoned' AND NOT OFFENDER.Offender_id IS NULL) AND (SUBSTR(OFFENDER.OFFENDER_ID_DISPLAY, 1, 10) = TAGMIS_CASELOAD_SECURITY('VQL10O', OFFENDER.OFFENDER_ID_DISPLAY)) AND (COALESCE(ASSESSMENT.COMPLETED_ASSESSMENT, 'Not Specified') = 'True' AND OFFENDER.HISTORIC_OFFENDER_CALC = 'Current' AND (REP_OFFENDER_HISTORY.LATEST_OWNERSHIP_RANK = 1) AND REP_OFFENDER_HISTORY.PHYSICAL_LOCATION = 'Bedford (HMP)' AND SUBSTR(ASSESSMENT.CALC_HIGHEST_RISK, 4) IN ('Very High', 'High'))) AND (REP_OFFENDER_HISTORY.LATEST_OWNERSHIP_RANK = 1)) GROUP BY OFFENDER.OFFENDER_ID_DISPLAY, ASSESSMENT.DATE_COMPLETED, REP_OFFENDER_HISTORY.CONTROLLING_OWNER, SUBSTR(ASSESSMENT.CALC_HIGHEST_RISK, 4), REP_OFFENDER_HISTORY.OFFENDER_MANAGER, ASSESSMENT.CALC_PURPOSE_OF_ASSMNT_GROUPS, COALESCE(PURPOSE_OF_ASSESSMENT.DESCRIPTION, 'Not Specified'), ASSESSMENT_SECTION1.S1Q27A_NO_GENERAL_OFFENDING_12, ASSESSMENT_SECTION1.S1Q27B_NO_GENERAL_OFFENDING_24, ASSESSMENT_SUMMARY.OGP_YEAR_1, ASSESSMENT_SUMMARY.OGP_YEAR_2, ASSESSMENT_SUMMARY.OVP_YEAR_1, ASSESSMENT_SUMMARY.OVP_YEAR_2, ASSESSMENT_SECTION1.S1Q5_NUMBER, CASE WHEN ASSESSMENT_SECTION2.S2Q2B_VIOLENCE_THREAT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2B_VIOLENCE_THREAT = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_SECTION2.S2Q2C_EXCESSIVE_VIOLENCE = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q2C_EXCESSIVE_VIOLENCE = '1' THEN 'Yes' END, ASSESSMENT_SECTION5.S5Q5_OVER_RELIANCE, ASSESSMENT_SECTION7.S7Q4_MANIPULATIVE_LIFESTYLE, ASSESSMENT_SECTION7.S7Q5_RECKLESS_BEHAVIOUR, CASE WHEN ASSESSMENT_SECTION10.S10Q7_CHILDHOOD_PROBLEMS = '0' THEN 'No' WHEN ASSESSMENT_SECTION10.S10Q7_CHILDHOOD_PROBLEMS = '1' THEN 'Yes' END, ASSESSMENT_SECTION11.S11Q2_IMPULSIVITY, ASSESSMENT_SECTION11.S11Q3_AGGRESSIVE, CASE WHEN ASSESSMENT_SECTION2.S2Q6_OFFENDER_RECOGNISE_IMPACT = '0' THEN 'No' WHEN ASSESSMENT_SECTION2.S2Q6_OFFENDER_RECOGNISE_IMPACT = '1' THEN 'Yes' END, OFFENDER.CRAMS_NUMBER, REP_OFFENDER_HISTORY.PHYSICAL_LOCATION, ASSESSMENT_SECTION6.S6Q3_CHILDHOOD_EXPERIENCE, ASSESSMENT_SECTION10.S10Q6_PSYCHIATRIC_PROBLEMS, ASSESSMENT_SECTION10.S10Q5_SELF_HARM, CASE WHEN ASSESSMENT_SECTION10.S10Q7_PSYCHIATRIC_TREATMENT = '0' THEN 'No' WHEN ASSESSMENT_SECTION10.S10Q7_PSYCHIATRIC_TREATMENT = '1' THEN 'Yes' END, CASE WHEN ASSESSMENT_ROH_SCREENING.R1Q3_ASSAULTED_STAFF_CURR = 'C' THEN 'Yes' END, CASE WHEN ASSESSMENT_ROH_SCREENING.R3Q1_SUICIDE_RISK = '0' THEN 'No' WHEN ASSESSMENT_ROH_SCREENING.R3Q1_SUICIDE_RISK = '1' THEN 'Yes' WHEN ASSESSMENT_ROH_SCREENING.R3Q1_SUICIDE_RISK = '2' THEN 'Don’t Know' END, CASE WHEN ASSESSMENT_ROH_SCREENING.R3Q2_SELF_HARM_RISK = '0' THEN 'No' WHEN ASSESSMENT_ROH_SCREENING.R3Q2_SELF_HARM_RISK = '1' THEN 'Yes' WHEN ASSESSMENT_ROH_SCREENING.R3Q2_SELF_HARM_RISK = '2' THEN 'Don’t Know' END, CASE WHEN ASSESSMENT_ROH_SCREENING.R4Q2_DISRUPTIVE_BEHAVIOUR = '0' THEN 'No' WHEN ASSESSMENT_ROH_SCREENING.R4Q2_DISRUPTIVE_BEHAVIOUR = '1' THEN 'Yes' WHEN ASSESSMENT_ROH_SCREENING.R4Q2_DISRUPTIVE_BEHAVIOUR = '2' THEN 'Don’t Know' END), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, DATE_COMPLETED, COUNT_OF_OFFENDERS, CONTROLLING_OWNER, RISK_LEVEL_, OFFENDER_MANAGER, CALC_PURPOSE_OF_ASSMNT_GROUPS, PURPOSE_OF_ASSESSMENT, S1Q27A_NO_GENERAL_OFFENDING_12, S1Q27B_NO_GENERAL_OFFENDING_24, OGP_YEAR_1, OGP_YEAR_2, OVP_YEAR_1, OVP_YEAR_2, S1Q5_NUMBER, VIOLENCE_OR_THREAT_OF_VIOLEN31, EXCESSIVE_OR_SADISTIC_VIOLEN31, S5Q5_OVER_RELIANCE, S7Q4_MANIPULATIVE_LIFESTYLE, S7Q5_RECKLESS_BEHAVIOUR, CHILDHOOD_BEHAVIOURAL_PROBLE31, S11Q2_IMPULSIVITY, S11Q3_AGGRESSIVE, OFFENDER_RECOGNISES_IMPACT_, CRAMS_NUMBER, PHYSICAL_LOCATION, S6Q3_CHILDHOOD_EXPERIENCE, S10Q6_PSYCHIATRIC_PROBLEMS, S10Q5_SELF_HARM, PSYCHIATRIC_TREATMENT_, ASSAULTED_THREATENED_STAFF, RISK_OF_SUICIDE, RISK_OF_SELF_HARM, CONTROL_ISSUES_DISRUPTIVE_BE35 FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP22.DO264",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DATE_COMPLETED",
            "type": "date",
            "display": "Date Completed",
            "legacyId": "DP22.DO5e5",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "COUNT_OF_OFFENDERS",
            "type": "double",
            "display": "Count of Offenders",
            "legacyId": "DP22.DOcbd",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CONTROLLING_OWNER",
            "type": "string",
            "display": "Controlling Owner",
            "legacyId": "DP22.DO114b",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "RISK_LEVEL_",
            "type": "string",
            "display": "Risk Level (10 6)",
            "legacyId": "DP22.DOf2f",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "OFFENDER_MANAGER",
            "type": "string",
            "display": "Offender Manager",
            "legacyId": "DP22.DO114a",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CALC_PURPOSE_OF_ASSMNT_GROUPS",
            "type": "string",
            "display": "Purpose Of Assessment Groups",
            "legacyId": "DP22.DO1006",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "PURPOSE_OF_ASSESSMENT",
            "type": "string",
            "display": "Purpose Of Assessment",
            "legacyId": "DP22.DOa0d",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "S1Q27A_NO_GENERAL_OFFENDING_12",
            "type": "double",
            "display": "OGRS 3 Score - 1 year (27)",
            "legacyId": "DP22.DO107b",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "S1Q27B_NO_GENERAL_OFFENDING_24",
            "type": "double",
            "display": "OGRS 3 Score - 2 year (27)",
            "legacyId": "DP22.DO107c",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "OGP_YEAR_1",
            "type": "double",
            "display": "OGP 1 Year Score",
            "legacyId": "DP22.DO109e",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "OGP_YEAR_2",
            "type": "double",
            "display": "OGP 2 Year Score",
            "legacyId": "DP22.DO109f",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "OVP_YEAR_1",
            "type": "double",
            "display": "OVP 1 Year Score",
            "legacyId": "DP22.DO10a1",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "OVP_YEAR_2",
            "type": "double",
            "display": "OVP 2 Year Score",
            "legacyId": "DP22.DO10a2",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "S1Q5_NUMBER",
            "type": "double",
            "display": "Number of Court Appearances U18 (5)",
            "legacyId": "DP22.DO737",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "VIOLENCE_OR_THREAT_OF_VIOLEN31",
            "type": "string",
            "display": "Violence or Threat of Violence (b)",
            "legacyId": "DP22.DOac3",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "EXCESSIVE_OR_SADISTIC_VIOLEN31",
            "type": "string",
            "display": "Excessive or Sadistic Violence (c)",
            "legacyId": "DP22.DOac4",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "S5Q5_OVER_RELIANCE",
            "type": "double",
            "display": "Over Reliance on Others for Financial Support (5)",
            "legacyId": "DP22.DOb34",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "S7Q4_MANIPULATIVE_LIFESTYLE",
            "type": "double",
            "display": "Manipulative/Predatory Lifestyle (4)",
            "legacyId": "DP22.DOb59",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "S7Q5_RECKLESS_BEHAVIOUR",
            "type": "double",
            "display": "Recklessness and Risk-taking Behaviour (5)",
            "legacyId": "DP22.DOb5b",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "CHILDHOOD_BEHAVIOURAL_PROBLE31",
            "type": "string",
            "display": "Childhood Behavioural Problems (7)",
            "legacyId": "DP22.DObdb",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "S11Q2_IMPULSIVITY",
            "type": "double",
            "display": "Impulsivity (2)",
            "legacyId": "DP22.DObea",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "S11Q3_AGGRESSIVE",
            "type": "double",
            "display": "Aggressive / Controlling Behaviour (3)",
            "legacyId": "DP22.DObec",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "OFFENDER_RECOGNISES_IMPACT_",
            "type": "string",
            "display": "Offender Recognises Impact (6)",
            "legacyId": "DP22.DOad1",
            "legacySqlClass": "column"
          },
          {
            "index": 24,
            "name": "CRAMS_NUMBER",
            "type": "string",
            "display": "Case Index Number",
            "legacyId": "DP22.DOa93",
            "legacySqlClass": "column"
          },
          {
            "index": 25,
            "name": "PHYSICAL_LOCATION",
            "type": "string",
            "display": "Physical Location",
            "legacyId": "DP22.DO114c",
            "legacySqlClass": "column"
          },
          {
            "index": 26,
            "name": "S6Q3_CHILDHOOD_EXPERIENCE",
            "type": "double",
            "display": "Experience of Childhood (3)",
            "legacyId": "DP22.DOb42",
            "legacySqlClass": "column"
          },
          {
            "index": 27,
            "name": "S10Q6_PSYCHIATRIC_PROBLEMS",
            "type": "double",
            "display": "Psychiatric Problems (6)",
            "legacyId": "DP22.DObd9",
            "legacySqlClass": "column"
          },
          {
            "index": 28,
            "name": "S10Q5_SELF_HARM",
            "type": "double",
            "display": "Self Harm / Attempted Suicide / Suicidal Thoughts (5)",
            "legacyId": "DP22.DObd7",
            "legacySqlClass": "column"
          },
          {
            "index": 29,
            "name": "PSYCHIATRIC_TREATMENT_",
            "type": "string",
            "display": "Psychiatric Treatment (7)",
            "legacyId": "DP22.DObdd",
            "legacySqlClass": "column"
          },
          {
            "index": 30,
            "name": "ASSAULTED_THREATENED_STAFF",
            "type": "string",
            "display": "Assaulted / Threatened Staff",
            "legacyId": "DP22.DO6f9",
            "legacySqlClass": "column"
          },
          {
            "index": 31,
            "name": "RISK_OF_SUICIDE",
            "type": "string",
            "display": "Risk of Suicide",
            "legacyId": "DP22.DO720",
            "legacySqlClass": "column"
          },
          {
            "index": 32,
            "name": "RISK_OF_SELF_HARM",
            "type": "string",
            "display": "Risk of Self-harm",
            "legacyId": "DP22.DO721",
            "legacySqlClass": "column"
          },
          {
            "index": 33,
            "name": "CONTROL_ISSUES_DISRUPTIVE_BE35",
            "type": "string",
            "display": "Control Issues / Disruptive Behaviour",
            "legacyId": "DP22.DO725",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP25",
      "name": "Demog",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS OTHER_CONTACT_NAME, DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS, BODIMIS.DIM_CELL AT_CELL WHERE (AT_CELL.ESTABLISHMENT_SK = AT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_ESTABLISHMENT.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP IN ('Offender Supervisor', 'Prison Offender Manager') AND (DT_OFFENDER_CONTACT_ADDRESS.ROW_SEQ_FILTER (+) = 1) AND (DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG (+) = 'Y') AND (AT_OFFENDER_BOOKING.BOOKING_SEQ = 1))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OTHER_CONTACT_NAME, RELATIONSHIP FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP25.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OTHER_CONTACT_NAME",
            "type": "string",
            "display": "Other Contact Name",
            "legacyId": "DP25.DOa1b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "RELATIONSHIP",
            "type": "string",
            "display": "Other Contact Relationship",
            "legacyId": "DP25.DOa1c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP26",
      "name": "Prisoner Alerts",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK, AT_ALERT.ALERT_DESCRIPTION, AT_OFFENDER_ALERT.ALERT_STATUS FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_CELL AT_CELL WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_CELL.ESTABLISHMENT_SK = AT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_ESTABLISHMENT.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE') AND AT_ALERT.ALERT_CODE_NK IN ('PC1', 'PC2', 'PC3', 'PL1', 'PL2', 'PL3', 'P0', 'P1', 'P2', 'P3', 'PVN', 'XNR', 'XGANG', 'RDV', 'OHCO', 'CPC', 'CPRC', 'OPPO', 'SOR', 'RCS', 'SC', 'XCC', 'XSO', 'SR', 'XCH', 'OHA', 'OCYP', 'LFC21', 'LFC25', 'LPQAA', 'LCE'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK, ALERT_DESCRIPTION, ALERT_STATUS FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP26.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP26.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DP26.DO10090",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP26.DO10094",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP24",
      "name": "MIS Load",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP24.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP2b",
      "name": "Rehab",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK > 0 THEN BODIMIS.DIM_REHAB_PROVIDER.CODE_NK END AS REHAB_PROVIDER_CODE, CASE WHEN BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK > 0 THEN BODIMIS.DIM_REHAB_PROVIDER.DESCRIPTION END AS REHAB_PROVIDER_DESCRIPTION FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_REHAB_PROVIDER, BODIMIS.FACT_OFFENDER_REHAB WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.FACT_OFFENDER_REHAB.OFFENDER_BOOKING_SK (+)) AND (BODIMIS.FACT_OFFENDER_REHAB.REHAB_PROVIDER_SK = BODIMIS.DIM_REHAB_PROVIDER.REHAB_PROVIDER_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (BODIMIS.FACT_OFFENDER_REHAB.PROVIDER_ACTIVE_FLAG = 'Y' OR BODIMIS.FACT_OFFENDER_REHAB.PROVIDER_ACTIVE_FLAG IS NULL) AND (BODIMIS.FACT_OFFENDER_REHAB.DECISION_ACTIVE_FLAG = 'Y' OR BODIMIS.FACT_OFFENDER_REHAB.DECISION_ACTIVE_FLAG IS NULL))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, REHAB_PROVIDER_CODE, REHAB_PROVIDER_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2b.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "REHAB_PROVIDER_CODE",
            "type": "string",
            "display": "Rehab Provider Code",
            "legacyId": "DP2b.DO10b37",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "REHAB_PROVIDER_DESCRIPTION",
            "type": "string",
            "display": "Rehab Provider Description",
            "legacyId": "DP2b.DO10b38",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP2c",
      "name": "Imm and Ext",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_FACT_COURT_EVENT.OUTCOME FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.FACT_COURT_EVENT AT_FACT_COURT_EVENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_EVENT.COURT_CASE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_FACT_COURT_EVENT.OUTCOME IN ('5500', '4022') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OUTCOME FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2c.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OUTCOME",
            "type": "string",
            "display": "Court Event Outcome Code",
            "legacyId": "DP2c.DO25a",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP2e",
      "name": "Prisoner Alerts inc Inactive",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK, AT_ALERT.ALERT_DESCRIPTION, AT_OFFENDER_ALERT.ALERT_STATUS, AT_ALERT.ALERT_ACTIVE_FLAG, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE, BODIMIS.DIM_CELL AT_CELL WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_CELL.ESTABLISHMENT_SK = AT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_ESTABLISHMENT.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND AT_ALERT.ALERT_CODE_NK IN ('HA'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK, ALERT_DESCRIPTION, ALERT_STATUS, ALERT_ACTIVE_FLAG, ALERT_EFFECTIVE_DATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2e.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP2e.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_DESCRIPTION",
            "type": "string",
            "display": "Alert Description",
            "legacyId": "DP2e.DO10090",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP2e.DO10094",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ALERT_ACTIVE_FLAG",
            "type": "string",
            "display": "Alert Active Flag",
            "legacyId": "DP2e.DO1069b",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DP2e.DO10095",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375377/DP2f",
      "name": "Adjudications",
      "description": "MIS - Incidents",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, COUNT(DISTINCT TRIM(DT_OFFENDER_ADJUDICATION.OIC_HEARING_ID_NK || ' ' || DT_OFFENDER_ADJUDICATION.PARTY_SEQ_NK)) AS COUNT_OF_ADJUDICATIONS, DT_OFFENDER_ADJUDICATION.OIC_INCIDENT_ID, DT_OFFENDER_ADJUDICATION.AGENCY_INCIDENT_ID_NK, DT_OFFENDER_ADJUDICATION.REPORT_DATE FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT a.oic_incident_id, c.offender_booking_sk, c.agency_incident_id_nk, c.charge_seq_nk, c.oic_offence_sk, a.oic_hearing_id_nk, a.party_seq_nk, a.establishment_sk, c.report_date, a.oic_hearing_type, a.notification_charge_date_sk FROM bodimis.fact_incident_charge c LEFT OUTER JOIN bodimis.fact_offender_adjudication a ON c.agency_incident_id_nk = a.agency_incident_id_nk AND c.offender_booking_sk = a.offender_booking_sk) DT_OFFENDER_ADJUDICATION, BODIMIS.DIM_CELL AT_CELL WHERE (DT_OFFENDER_ADJUDICATION.OFFENDER_BOOKING_SK = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_CELL.ESTABLISHMENT_SK = AT_ESTABLISHMENT.ESTABLISHMENT_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_ESTABLISHMENT.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_ESTABLISHMENT.ESTABLISHMENT_CODE_NK = (SELECT establishment_code FROM prompt_)) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y')) GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, DT_OFFENDER_ADJUDICATION.OIC_INCIDENT_ID, DT_OFFENDER_ADJUDICATION.AGENCY_INCIDENT_ID_NK, DT_OFFENDER_ADJUDICATION.REPORT_DATE), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, COUNT_OF_ADJUDICATIONS, OIC_INCIDENT_ID, AGENCY_INCIDENT_ID_NK, REPORT_DATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2f.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "COUNT_OF_ADJUDICATIONS",
            "type": "double",
            "display": "Count of Adjudications",
            "legacyId": "DP2f.DOdf",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OIC_INCIDENT_ID",
            "type": "double",
            "display": "OIC Incident ID",
            "legacyId": "DP2f.DO75a",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "AGENCY_INCIDENT_ID_NK",
            "type": "double",
            "display": "Agency Incident ID",
            "legacyId": "DP2f.DO759",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "REPORT_DATE",
            "type": "date",
            "display": "Incident Reported Date",
            "legacyId": "DP2f.DO751",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "210866.RS",
      "name": "Offender Information",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_DESCRIPTION",
            "display": "Establishment Name",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10129"
          },
          {
            "name": "$ref:V_CRN",
            "display": "CRN",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Case Index Number]"
          },
          {
            "name": "$ref:PNC_ID",
            "display": "PNC ID",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100db"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10085"
          },
          {
            "name": "$ref:ETHNIC_DESCRIPTION",
            "display": "Ethnic Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO1009d"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100de"
          },
          {
            "name": "$ref:V_MAX_CONCAT_MOST_CODE",
            "display": "Main Offence Sentence Type",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_Concat_MOST] Where ([v_MOST]= [v_Max_MOST]) In ([NOMIS Number])"
          },
          {
            "name": "$ref:V_MAIN_OFFENCE",
            "display": "Main Offence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offence Name]Where ([Main Offence Flag]=\"Y\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_POM",
            "display": "POM (Prison Offender Manager)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Other Contact Name] Where ([Other Contact Relationship]=\"Prison Offender Manager\")"
          },
          {
            "name": "$ref:V_OTHER_CONTACT_NAME_MGE_OS",
            "display": "Offender Supervisor",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Other Contact Name] Where ([Other Contact Relationship]=\"Offender Supervisor\")"
          },
          {
            "name": "$ref:SSD",
            "display": "Current Sentence Start Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO32d"
          },
          {
            "name": "$ref:CURRENT_SENTENCE_LENGTH_BAND",
            "display": "Current Sentence Length Band",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO1ef"
          },
          {
            "name": "$ref:MOVEMENT_TIME",
            "display": "Admission Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO107ce"
          },
          {
            "name": "$ref:V_MAX_CONCAT_ALERT_CODE",
            "display": "MAPPA Alerts",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_alert] Where ([v_Alert_code]= [v_Max_Alert_Code]) In ([NOMIS Number])"
          },
          {
            "name": "$ref:CURR_CRD_DATE",
            "display": "CRD (Conditional Release Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO48"
          },
          {
            "name": "$ref:CURR_RELEASE_DATE",
            "display": "Current Release Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO2e6"
          },
          {
            "name": "$ref:CURR_LED_DATE",
            "display": "LED (Licence Expiry Date )",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO6a"
          },
          {
            "name": "$ref:SED",
            "display": "SED (Sentence End Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO46"
          },
          {
            "name": "$ref:CURR_PED_DATE",
            "display": "PED (Parole Eligibility Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO87"
          },
          {
            "name": "$ref:CURR_NPD_DATE",
            "display": "NPD (Non Parole Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO8e"
          },
          {
            "name": "$ref:TARIFF",
            "display": "Tariff Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO3b1"
          },
          {
            "name": "$ref:V_ACCT_ALERT",
            "display": "ACCT Alerts",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Prisoner Alerts inc Inactive].[Alert Description]"
          },
          {
            "name": "$ref:V_COUNT_ACCTS",
            "display": "No of ACCTs",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Count([v_ACCT_Alert])"
          },
          {
            "name": "$ref:V_OGRS3_2YR",
            "display": "OGRS 3 2yr Score",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[OGRS 3 Score - 2 year (27)]"
          },
          {
            "name": "$ref:V_RISK_LEVEL",
            "display": "Risk (RoSH)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If [v_risk_level_mge] = \"Not calculated\" Then \"Low\" Else [v_risk_level_mge]"
          },
          {
            "name": "$ref:V_PERSONALITY_SCORE_TOTAL",
            "display": "OASys PD Screen Score",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_U18_convictions]+[v_OASys_Q2.2b]+[v_OASys_Q2.2c]+[v_OASys_Q2.6]+[v_OASys_Q5.5]+[v_OASys_Q7.4]+[v_OASys_Q7.5]+[v_OASys_Q10.7]+[v_OASys_Q11.2]+[v_OASys_Q11.3]"
          },
          {
            "name": "$ref:V_INDICATOR_SCORE_TOTAL",
            "display": "Indicator Scores Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=ToNumber([v_Challenging_Behaviour_Indicator_Score])+ToNumber([v_Childhood Indicator_Score])+ToNumber([v_Mental_Health_Indicator_Score])+ToNumber([v_Suicide_or_Self-harm_Indicator_Score])"
          },
          {
            "name": "$ref:V_OPD_ELIGIBLE_",
            "display": "OPD Eligible?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If((([v_Risk Level] = \"High\") And ([v_Personality_Score_Total] > 6));\"Yes\";\n(If((([v_Risk Level] = \"Very High\") And ([v_Personality_Score_Total] > 6));\"Yes\";\n(If((([v_Risk Level] = \"High\") And ([v_Indicator_Score_Total] > 1));\"Yes\";\n(If((([v_Risk Level] = \"Very High\") And ([v_Indicator_Score_Total] > 1));\"Yes\";\"No\")))))))"
          },
          {
            "name": "$ref:V_EXPERIENCE_OF_CHILDHOOD",
            "display": "Q6.3 Experience of Childhood",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Experience of Childhood (3)]"
          },
          {
            "name": "$ref:V_CHILDHOOD_BEHAVIOURAL_PROB32",
            "display": "Q10.7 Childhood Beahvioural Problems",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Childhood Behavioural Problems (7)]"
          },
          {
            "name": "$ref:V_CHILDHOOD_INDICATOR_SCORE",
            "display": "Childhood Indicator Score",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If((([v_Childhood Behavioural Problems] = \"Yes\") Or ([v_Experience of Childhood] > 0));\"1\";\"0\")"
          },
          {
            "name": "$ref:V_CURRENT_PSYCHIATRIC_PROBLEMS",
            "display": "Q10.6 Current Psychiatric Problems",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Psychiatric Problems (6)]"
          },
          {
            "name": "$ref:V_PSYCHIATRIC_TREATMENT",
            "display": "Q10.7 History of psychiatric treatment (optional) ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Psychiatric Treatment (7)]"
          },
          {
            "name": "$ref:V_MENTAL_HEALTH_INDICATOR_SC31",
            "display": "Mental Health Indicator Score",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If((([v_Current Psychiatric Problems] >0) Or ([v_Psychiatric Treatment] = \"Yes\"));\"1\";\"0\")"
          },
          {
            "name": "$ref:V_ASSAULTED_STAFF",
            "display": "R1.3 Assaulted / threatened staff",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Assaulted / Threatened Staff]"
          },
          {
            "name": "$ref:V_CONTROL_ISSUES_DISRUPTIVE_37",
            "display": "R4.2 Control issues - disruptive behaviour",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Control Issues / Disruptive Behaviour]"
          },
          {
            "name": "$ref:V_CHALLENGING_BEHAVIOUR_INDI39",
            "display": "Challenging Behaviour Indicator Score",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If((([v_Assaulted Staff] = \"Yes\") Or ([v_Control Issues Disruptive Behaviour] = \"Yes\"));\"1\";\"0\")"
          },
          {
            "name": "$ref:V_SELF_HARM_ATTEMPTED_SUICID59",
            "display": "Q10.5 Self-harm, attempted suicide, suicidal thoughts or feelings",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Self Harm / Attempted Suicide / Suicidal Thoughts (5)]"
          },
          {
            "name": "$ref:V_RISK_OF_SUICIDE",
            "display": "R3.1 Risk of suicide",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Risk of Suicide]"
          },
          {
            "name": "$ref:V_RISK_OF_SELF_HARM",
            "display": "R3.2 Risk of self-harm",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Risk of Self-harm]"
          },
          {
            "name": "$ref:V_SUICIDE_OR_SELF_HARM_INDIC38",
            "display": "Suicide or Self-harm Indicator Score",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If((([v_Self Harm Attempted Suicide Suicidal Thoughts or Feelings] > 0) Or ([v_Risk of Self Harm] = \"Yes\") Or ([v_Risk of Suicide] = \"Yes\"));\"1\";\"0\")"
          },
          {
            "name": "$ref:V_RISK_LEVEL",
            "display": "Risk (RoSH)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If [v_risk_level_mge] = \"Not calculated\" Then \"Low\" Else [v_risk_level_mge]"
          },
          {
            "name": "$ref:V_PERSONALITY_SCORE_TOTAL",
            "display": "OASys PD Screen Score",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_U18_convictions]+[v_OASys_Q2.2b]+[v_OASys_Q2.2c]+[v_OASys_Q2.6]+[v_OASys_Q5.5]+[v_OASys_Q7.4]+[v_OASys_Q7.5]+[v_OASys_Q10.7]+[v_OASys_Q11.2]+[v_OASys_Q11.3]"
          },
          {
            "name": "$ref:V_INDICATOR_SCORE_TOTAL",
            "display": "Indicator Scores Total",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=ToNumber([v_Challenging_Behaviour_Indicator_Score])+ToNumber([v_Childhood Indicator_Score])+ToNumber([v_Mental_Health_Indicator_Score])+ToNumber([v_Suicide_or_Self-harm_Indicator_Score])"
          },
          {
            "name": "$ref:V_OPD_ELIGIBLE_",
            "display": "OPD Eligible?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If((([v_Risk Level] = \"High\") And ([v_Personality_Score_Total] > 6));\"Yes\";\n(If((([v_Risk Level] = \"Very High\") And ([v_Personality_Score_Total] > 6));\"Yes\";\n(If((([v_Risk Level] = \"High\") And ([v_Indicator_Score_Total] > 1));\"Yes\";\n(If((([v_Risk Level] = \"Very High\") And ([v_Indicator_Score_Total] > 1));\"Yes\";\"No\")))))))"
          }
        ]
      }
    },
    {
      "id": "212948.RS",
      "name": "OASys PD Screen",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP4",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_RISK_LEVEL IN ('High','Very High') AND V_PERSONALITY_SCORE_TOTAL >= 0))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:V_CRN",
            "display": "CRN",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Case Index Number]"
          },
          {
            "name": "$ref:PNC_ID",
            "display": "PNC ID",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO100db"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10080"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP4.DO10085"
          },
          {
            "name": "$ref:V_MAIN_OFFENCE",
            "display": "Main Offence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offence Name]Where ([Main Offence Flag]=\"Y\")"
          },
          {
            "name": "$ref:V_ADMISSION_DATE_MGE",
            "display": "Admission Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Admission Date]"
          },
          {
            "name": "$ref:V_DATE_COMPLETED_MGE",
            "display": "OASys Assessment Completed Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Date Completed]"
          },
          {
            "name": "$ref:V_RISK_LEVEL",
            "display": "Risk (RoSH)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If [v_risk_level_mge] = \"Not calculated\" Then \"Low\" Else [v_risk_level_mge]"
          },
          {
            "name": "$ref:V_U18_CONVICTIONS",
            "display": "Q1.5 Number of court appearances at which convicted, or received a conditional or absolute discharge aged under 18 years",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Number of Court Appearances U18 (5)] >=1;1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q2_2B",
            "display": "Q2.2b Did the offence involve any of the following: Violence or Threat of Violence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Violence or Threat of Violence (b)] = \"Yes\";1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q2_2C",
            "display": "Q2.2c Did the offence involve any of the following: Excessive or Sadistic Violence",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Excessive or Sadistic Violence (c)] = \"Yes\";1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q2_6",
            "display": "Q2.6 Does the offender recognise the impact and consequences of offending on victim, community -wider society?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Offender Recognises Impact (6)] =\"No\";1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q5_5",
            "display": "Q5.5 Over-reliance on family / friends / others for financial support (optional)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Over Reliance on Others for Financial Support (5)] >=1;1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q7_4",
            "display": "Q7.4 Manipulative / predatory lifestyle (optional) \n",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Manipulative/Predatory Lifestyle (4)] >=1;1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q7_5",
            "display": "Q7.5 Recklessness and risk-taking behaviour",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Recklessness and Risk-taking Behaviour (5)] >=1;1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q10_7",
            "display": "Q10.7 Evidence of childhood behavioural problems (optional) ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Childhood Behavioural Problems (7)] =\"Yes\";1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q11_2",
            "display": "Q11.2 Impulsivity",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Impulsivity (2)] >=1;1;0)"
          },
          {
            "name": "$ref:V_OASYS_Q11_3",
            "display": "Q11.3 Aggressive / controlling behaviour (optional)",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Aggressive / Controlling Behaviour (3)] >=1;1;0)"
          },
          {
            "name": "$ref:V_PERSONALITY_SCORE_TOTAL",
            "display": "Personality Score",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_U18_convictions]+[v_OASys_Q2.2b]+[v_OASys_Q2.2c]+[v_OASys_Q2.6]+[v_OASys_Q5.5]+[v_OASys_Q7.4]+[v_OASys_Q7.5]+[v_OASys_Q10.7]+[v_OASys_Q11.2]+[v_OASys_Q11.3]"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_CRN :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_MOST_CODE :: Error: =[v_Concat_MOST] Where ([v_MOST]= [v_Max_MOST]) In ([NOMIS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:49",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_OTHER_CONTACT_NAME_MGE_POM :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_OTHER_CONTACT_NAME_MGE_OS :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_ALERT_CODE :: Error: =[v_concat_alert] Where ([v_Alert_code]= [v_Max_Alert_Code]) In ([NOMIS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:62",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_RISK_OF_SUICIDE :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_RISK_OF_SELF_HARM :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_SUICIDE_OR_SELF_HARM_INDIC38 :: Error: =If((([v_Self Harm Attempted Suicide Suicidal Thoughts or Feelings] > 0) Or ([v_Risk of Self Harm] = \"Yes\") Or ([v_Risk of Suicide] = \"Yes\"));\"1\";\"0\") ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_DATE_COMPLETED_MGE :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_MOST_CODE :: Error: =[v_Concat_MOST] Where ([v_MOST]= [v_Max_MOST]) In ([NOMIS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:49",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OTHER_CONTACT_NAME_MGE_POM :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OTHER_CONTACT_NAME_MGE_OS :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_ALERT_CODE :: Error: =[v_concat_alert] Where ([v_Alert_code]= [v_Max_Alert_Code]) In ([NOMIS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:62",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_CHILDHOOD_BEHAVIOURAL_PROB32 :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_PSYCHIATRIC_TREATMENT :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_ASSAULTED_STAFF :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_CONTROL_ISSUES_DISRUPTIVE_37 :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RISK_OF_SUICIDE :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RISK_OF_SELF_HARM :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_SUICIDE_OR_SELF_HARM_INDIC38 :: Error: =If((([v_Self Harm Attempted Suicide Suicidal Thoughts or Feelings] > 0) Or ([v_Risk of Self Harm] = \"Yes\") Or ([v_Risk of Suicide] = \"Yes\"));\"1\";\"0\") ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DATE_COMPLETED_MGE :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OASYS_Q2_2B :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OASYS_Q2_2C :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OASYS_Q2_6 :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_OASYS_Q10_7 :: ReferenceError: error is not defined",
      "entityId": "Flmk01_KTQ4AAJoAAHAbOF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP4",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375896/DP22",
      "entityType": "dataset"
    }
  ]
}