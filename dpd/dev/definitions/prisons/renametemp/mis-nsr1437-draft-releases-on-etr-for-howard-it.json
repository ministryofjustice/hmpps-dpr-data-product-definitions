{
  "id": "FnPKM18E5gsAvUsBAHD7cl8WACJIAFJ8",
  "name": "MIS NSR1437 DRAFT Releases on ETR for Howard IT",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "MOV00 v00.00.01"
    ]
  },
  "description": "<br/>MOV00 v00.00.01 Last Modified: 11/08/2020",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP2",
      "name": "Discharges",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING_BAH.BOOKING_NUMBER, AT_FACT_MOV_EXT.MOVEMENT_TIME, AT_FACT_MOV_EXT.REASON_CODE, AT_FACT_MOV_EXT.TYPE, AT_FACT_MOV_EXT.DIRECTION_CODE, DT_EXT_MOVE_TO.TYPE_DESCRIPTION_TO, DT_EXT_MOVE_FROM.TYPE_DESCRIPTION_FROM, AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_DESCRIPTION, AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION AS MOVEMENT_LOCATION_FROM_DESCR35, AT_FACT_MOV_EXT.REASON, AT_DIM_DATE_EXT_MOV.DAY_DATE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_TO, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_TO, 'Establishment' AS Location_Type_To FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_To FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_To FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_To FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_To FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_TO, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_FROM, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_FROM, 'Establishment' AS Location_Type_FROM FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_From FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_From FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_From FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_From FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_FROM, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_TO, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (CASE WHEN AT_FACT_MOV_EXT.TO_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.TO_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_SK (+)) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER('DPRWS') AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_FACT_MOV_EXT.TO_LOCATION_SK = DT_EXT_MOVE_TO.SK_ID_TO (+) AND AT_FACT_MOV_EXT.TO_LOCATION_TYPE = DT_EXT_MOVE_TO.LOCATION_TYPE_TO (+)) AND (AT_FACT_MOV_EXT.FROM_LOCATION_SK = DT_EXT_MOVE_FROM.SK_ID_FROM (+) AND AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = DT_EXT_MOVE_FROM.LOCATION_TYPE_FROM (+)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'TRN', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_)) AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('31-03-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('11-08-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.REASON_CODE IN ('ETR3', 'ETR1', 'ETR2') AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, BOOKING_NUMBER, MOVEMENT_TIME, REASON_CODE, TYPE, DIRECTION_CODE, TYPE_DESCRIPTION_TO, TYPE_DESCRIPTION_FROM, ESTABLISHMENT_DESCRIPTION, MOVEMENT_LOCATION_FROM_DESCR35, REASON, DAY_DATE, DISCHARGES.DAY_DATE AS V_RELEASE_DATE, 'TBD' AS V_RECEPTION_AFTER_RELEASE_DI34 FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP2.DO10b05",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Movement Date and Time (External)",
            "legacyId": "DP2.DO103eb",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "REASON_CODE",
            "type": "string",
            "display": "Movement Reason Code (External)",
            "legacyId": "DP2.DO103fc",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "TYPE",
            "type": "string",
            "display": "Movement Type (External)",
            "legacyId": "DP2.DO103ec",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "DIRECTION_CODE",
            "type": "string",
            "display": "Movement Direction Code (External)",
            "legacyId": "DP2.DO103fd",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "TYPE_DESCRIPTION_TO",
            "type": "string",
            "display": "Movement Description (To)",
            "legacyId": "DP2.DO106ff",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "TYPE_DESCRIPTION_FROM",
            "type": "string",
            "display": "Movement Description (From)",
            "legacyId": "DP2.DO10700",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Movement Location To Description (External)",
            "legacyId": "DP2.DO1015e",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "MOVEMENT_LOCATION_FROM_DESCR35",
            "type": "string",
            "display": "Movement Location From Description (External)",
            "legacyId": "DP2.DO1015d",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "REASON",
            "type": "string",
            "display": "Movement Description (External)",
            "legacyId": "DP2.DO1015b",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DP2.DO1015c",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "V_RELEASE_DATE",
            "type": "string",
            "display": "V_RELEASE_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 13,
            "name": "V_RECEPTION_AFTER_RELEASE_DI34",
            "type": "string",
            "display": "V_RECEPTION_AFTER_RELEASE_DI34",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP9",
      "name": "Receptions after release",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING_BAH.BOOKING_NUMBER, AT_DIM_DATE_EXT_MOV.DAY_DATE, AT_FACT_MOV_EXT.REASON_CODE, AT_FACT_MOV_EXT.MOVEMENT_TIME FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_TO, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.TO_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.TO_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_SK (+)) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A0877DV', 'A0696DX', 'A5192DQ', 'A4364DM', 'A2837DJ', 'A7300CY', 'A3851CJ', 'A9308EA', 'A8114EH', 'A7755DW', 'A6176EC', 'A2081EF', 'A0240CE', 'A5963DD', 'A0630CA', 'A4569DN', 'A2676AJ', 'A4441EG', 'A0615EG', 'A0768DZ', 'A9109EJ', 'A9014EJ', 'A8024EG', 'A2953DY', 'A2691EM', 'A5915AG', 'A9345EC', 'A2101DH', 'A4368EC', 'A0513DV', 'A1278DE', 'A9765EE', 'A5431ED', 'A5993EF', 'A7678EL', 'A6469EK', 'A2765AM', 'A9734CG', 'A7321EF', 'A3126DZ', 'A3592CT', 'A8060DX', 'A1954AT', 'A6615DH', 'A3983EL', 'A4921ED', 'A5430AX', 'A1598AD', 'A2591AR', 'A1093EM', 'A4036DR', 'A5992DQ', 'A1897ED', 'A4461EF', 'A9236DW', 'A7540DJ', 'A2616DV', 'A7017DW', 'A6384CV', 'A5661DZ', 'A5022ED', 'A4677EJ', 'A2775AC', 'A8281EE', 'A6645AM', 'A7571CH', 'A4203ED', 'A5158EA', 'A7848EE', 'A9136AD', 'A2780AC', 'A5715EF', 'A7781ED', 'A9573EE', 'A5062DW', 'A5372EM', 'A1402DG', 'A1156EA', 'A2388EE', 'A5898AT', 'A2846EC', 'A7297AG', 'A7858CQ', 'A2115EC', 'A7768CX', 'A9733DV', 'A1793EA', 'A8842CK', 'A4697EK', 'A6913DK', 'A4767CK', 'A8982AK', 'A5823DZ', 'A9464DH', 'A0369DR', 'A4455AD', 'A9966EA', 'A9059EE', 'A7665EK', 'A0991EN', 'A3260AV', 'A9497EL', 'A4164EM', 'A6005EJ', 'A9362EL', 'A1441CM', 'A8966ED', 'A5842AH', 'A9220DR', 'A4163AD', 'A0894EK', 'A3639DY', 'A7523DZ', 'A3469DW', 'A9306EH', 'A9212EM', 'A8192ED', 'A8650DF', 'A3068DZ', 'A7647EE', 'A8888AY', 'A8275AK', 'A3400AK', 'A0624EH', 'A6401EG', 'A8561EE', 'A7379DT', 'A1741EA', 'A6891ED', 'A8432EA', 'A6045AE', 'A5709CE', 'A9627DG', 'A0588CM', 'A0527EE', 'A6731AY', 'A2277DG', 'A4698AH', 'A9994EE', 'A7558EC', 'A8809AV', 'A4145EG', 'A9174DQ', 'A0711DC', 'A8564CT', 'A2767EF', 'A3390CA', 'A9347CR', 'A4541AT', 'A0026DH', 'A4467DX', 'A8513EG', 'A6505DQ', 'A8084CN', 'A1261DG', 'A4158DD', 'A0155EA', 'A6105EG', 'A3318DZ', 'A2570CD', 'A1185AP', 'A7031EH', 'A9550EE', 'A4217EF', 'A0484EF', 'A9523EG', 'A1788EJ', 'A5954DQ', 'A3435ED', 'A0037EE', 'A7744DY', 'A6742CW', 'A5691AG', 'A2725AH', 'A6442EL', 'A1450EA', 'A6532DW', 'A8314CM', 'A9808EJ', 'A2543DX', 'A9698DZ', 'A9361EH', 'A5387DZ', 'A2754EE', 'A8242DX', 'A9578AC', 'A2006EH', 'A3256DN', 'A1733DZ', 'A8116CR', 'A4180EL', 'A5146EL', 'A5119DP', 'A3519DD', 'A4414EH', 'A8294EM', 'A7590EK', 'A0459EE', 'A8876DY', 'A6452CN', 'A0427DW', 'A0586DC', 'A0616EE', 'A9723DW', 'A9499AG', 'A1150CV', 'A5545DV', 'A6200EF', 'A5150EE', 'A1037EK', 'A0689CJ', 'A3423EJ', 'A5180EK', 'A4416EF', 'A9713DZ', 'A7342EC', 'A2230AX', 'A8103DX', 'A5486EE', 'A3236AQ', 'A2983DV', 'A9031EC', 'A8559DN', 'A8965EE', 'A4299AF', 'A1847CZ', 'A7260ED', 'A2845DF', 'A5087CD', 'A0609EF', 'A7353CD', 'A1324DT', 'A9721EM', 'A3998EK', 'A8098CJ', 'A7124EC', 'A5156AV', 'A7836EC', 'A9467EM', 'A6638EE', 'A9426DZ', 'A2951EM', 'A6928AT', 'A9383EG', 'A2228EE', 'A5033EC', 'A5305EE', 'A0720DR', 'A8185EH', 'A7165CE', 'A3146DH', 'A3095EH', 'A1584EH', 'A0497DZ', 'A5527AC', 'A0708AR', 'A1489CZ', 'A9017EM', 'A7539AJ', 'A6420AG', 'A0549EE', 'A2432DZ', 'A8791EF', 'A5189AN', 'A9134EF', 'A3645CH', 'A7621DM', 'A4925ED', 'A0787DX', 'A2872EF', 'A0550CJ', 'A9777DK', 'A2313DY', 'A6131EJ', 'A5402AR', 'A0901DW', 'A9073EA', 'A9043EK', 'A4902EF', 'A8925EL', 'A0148EK', 'A6969EG', 'A4516EK', 'A9933CL', 'A3064CA', 'A8273DZ', 'A2075EF', 'A8221EA', 'A9624EJ', 'A3096EJ', 'A4408EL', 'A8920EH', 'A5955EM', 'A0431EM', 'A8294CC', 'A4943DN', 'A0218DF', 'A2070EE', 'A3516EH', 'A3016AM', 'A3642DL', 'A5486CN', 'A4099DW', 'A2772DF', 'A8388EJ', 'A8769CR', 'A0191EG', 'A5016AR', 'A9645CP', 'A8744EL', 'A2234DY', 'A4284AT', 'A4924DQ', 'A7003CF', 'A8006EA', 'A8376EE', 'A2046EA', 'A6324EC', 'A5725EF', 'A6150EC', 'A3281DP', 'A5086ED', 'A7032EC', 'A0669EC', 'A4364ED', 'A5679EF', 'A8592EH', 'A0835DC', 'A6195CL', 'A0322EM', 'A9216AM', 'A4008EE', 'A8403EJ', 'A4721ED', 'A9098EH', 'A1193EE') AND AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'G4', 'R3', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'G5', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'R2', 'G1', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'NOU', 'R4', '-1', '-2', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'OUT', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'G2', 'R1', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'TRN', 'G3', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_)) AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-04-2020 14:42:38', 'DD-MM-YYYY HH24:MI:SS') AND (AT_FACT_MOV_EXT.TYPE IN ('Admission') OR AT_FACT_MOV_EXT.REASON_CODE IN ('ETR3', 'ETR1', 'ETR2')) AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'IN' AND NOT AT_FACT_MOV_EXT.REASON_CODE IN ('NOTR', 'TRN', 'INT', 'M'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, BOOKING_NUMBER, DAY_DATE, REASON_CODE, MOVEMENT_TIME FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP9.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP9.DO10b05",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DP9.DO1015c",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "REASON_CODE",
            "type": "string",
            "display": "Movement Reason Code (External)",
            "legacyId": "DP9.DO103fc",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Movement Date and Time (External)",
            "legacyId": "DP9.DO103eb",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP3",
      "name": "Load End Date",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP3.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPe",
      "name": "Final Release",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING_BAH.BOOKING_NUMBER, AT_DIM_DATE_EXT_MOV.DAY_DATE, AT_FACT_MOV_EXT.REASON_CODE, AT_FACT_MOV_EXT.MOVEMENT_TIME FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A8275AK', 'A5898AT', 'A1150CV', 'A6045AE', 'A9136AD', 'A5709CE', 'A4163AD', 'A3400AK', 'A4569DN', 'A9933CL', 'A9236DW', 'A0026DH', 'A9698DZ', 'A5158EA', 'A2115EC', 'A9059EE', 'A2591AR', 'A4441EG', 'A4414EH', 'A1324DT', 'A5372EM', 'A5955EM', 'A9212EM', 'A9467EM', 'A9017EM', 'A9220DR', 'A1793EA', 'A0991EN', 'A1278DE', 'A6615DH', 'A4455AD', 'A9174DQ', 'A2837DJ', 'A0630CA', 'A5661DZ', 'A1450EA', 'A2046EA', 'A3469DW', 'A8376EE', 'A5527AC', 'A0609EF', 'A0588CM', 'A9808EJ', 'A9734CG', 'A8294EM', 'A8513EG', 'A5963DD', 'A5062DW', 'A0787DX', 'A6176EC', 'A8281EE', 'A3146DH', 'A6928AT', 'A1741EA', 'A8564CT', 'A4180EL', 'A6742CW', 'A7539AJ', 'A4698AH', 'A0768DZ', 'A1489CZ', 'A9345EC', 'A7647EE', 'A9765EE', 'A4416EF', 'A6532DW', 'A8114EH', 'A1193EE', 'A4516EK', 'A6469EK', 'A6401EG', 'A4541AT', 'A7744DY', 'A3236AQ', 'A8116CR', 'A0711DC', 'A2101DH', 'A7540DJ', 'A8982AK', 'A2616DV', 'A7017DW', 'A9723DW', 'A2543DX', 'A8876DY', 'A0497DZ', 'A7523DZ', 'A7003CF', 'A9073EA', 'A2780AC', 'A7342EC', 'A7836EC', 'A7032EC', 'A5192DQ', 'A9627DG', 'A4902EF', 'A0615EG', 'A9306EH', 'A1037EK', 'A6913DK', 'A2951EM', 'A9721EM', 'A9499AG', 'A3260AV', 'A1261DG', 'A2775AC', 'A3642DL', 'A4099DW', 'A7300CY', 'A1897ED', 'A4721ED', 'A5823DZ', 'A9134EF', 'A1847CZ', 'A7031EH', 'A6131EJ', 'A5180EK', 'A2570CD', 'A4767CK', 'A5691AG', 'A8103DX', 'A2234DY', 'A2432DZ', 'A3519DD', 'A9966EA', 'A7558EC', 'A6150EC', 'A5486CN', 'A9347CR', 'A2872EF', 'A9733DV', 'A3064CA', 'A8388EJ', 'A8888AY', 'A7353CD', 'A2691EM', 'A5915AG', 'A0513DV', 'A6195CL', 'A7571CH', 'A0240CE', 'A3390CA', 'A4368EC', 'A8966ED', 'A5016AR', 'A0696DX', 'A8561EE', 'A4461EF', 'A6969EG', 'A8024EG', 'A1584EH', 'A5679EF', 'A8185EH', 'A6420AG', 'A8744EL', 'A8314CM', 'A8084CN') AND AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'TRN', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_)) AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('11-08-2020 17:10:25', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, BOOKING_NUMBER, DAY_DATE, REASON_CODE, MOVEMENT_TIME FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPe.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DPe.DO10b05",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DPe.DO1015c",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "REASON_CODE",
            "type": "string",
            "display": "Movement Reason Code (External)",
            "legacyId": "DPe.DO103fc",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Movement Date and Time (External)",
            "legacyId": "DPe.DO103eb",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPf",
      "name": "Final Release (1)",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING_BAH.BOOKING_NUMBER, AT_DIM_DATE_EXT_MOV.DAY_DATE, AT_FACT_MOV_EXT.REASON_CODE, AT_FACT_MOV_EXT.MOVEMENT_TIME, AT_FACT_MOV_EXT.MOVEMENT_SEQ, AT_FACT_MOV_EXT.TYPE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER('DPRWS') AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER('DPRWS') AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), 'TRN', (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_), (SELECT establishment_code FROM prompt_)) AND AT_FACT_MOV_EXT.REASON_CODE IN ('ETR1', 'ETR2', 'ETR3') AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER('DPRWS') AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND AT_FACT_MOV_EXT.TYPE = 'Release'))) AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN ('A0240CE') AND AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY IN (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER('DPRWS') AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_FACT_MOV_EXT.TYPE IN ('Temporary Absence') AND AT_FACT_MOV_EXT.REASON_CODE IN ('ETR1', 'ETR2', 'ETR3') AND AT_FACT_MOV_EXT.MOVEMENT_SEQ < ANY (SELECT DISTINCT AT_FACT_MOV_EXT.MOVEMENT_SEQ FROM BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT WHERE AT_FACT_MOV_EXT.TYPE = 'Release'))))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, BOOKING_NUMBER, DAY_DATE, REASON_CODE, MOVEMENT_TIME, MOVEMENT_SEQ, TYPE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPf.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DPf.DO10b05",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DPf.DO1015c",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "REASON_CODE",
            "type": "string",
            "display": "Movement Reason Code (External)",
            "legacyId": "DPf.DO103fc",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Movement Date and Time (External)",
            "legacyId": "DPf.DO103eb",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "MOVEMENT_SEQ",
            "type": "double",
            "display": "Movement Sequence",
            "legacyId": "DPf.DO103e5",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "TYPE",
            "type": "string",
            "display": "Movement Type (External)",
            "legacyId": "DPf.DO103ec",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "137598.RS",
      "name": "Discharges by Date",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10b05"
          },
          {
            "name": "$ref:TYPE_DESCRIPTION_FROM",
            "display": "Movement Description (From)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10700"
          },
          {
            "name": "$ref:REASON_CODE",
            "display": "Movement Reason Code (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO103fc"
          },
          {
            "name": "$ref:REASON",
            "display": "Movement Description (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1015b"
          },
          {
            "name": "$ref:V_RELEASE_DATE",
            "display": "Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Discharges].[Movement Date Only (External)]"
          },
          {
            "name": "$ref:V_RECEPTION_AFTER_RELEASE_DI34",
            "display": "Admission after release?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number])"
          }
        ]
      }
    },
    {
      "id": "213359.RS",
      "name": "Report 2",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "summary",
        "field": []
      },
      "dataset": "MISSING"
    },
    {
      "id": "213395.RS",
      "name": "Report 3",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DPf",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPf.DO10076"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPf.DO10b05"
          },
          {
            "name": "$ref:DAY_DATE",
            "display": "Movement Date Only (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPf.DO1015c"
          },
          {
            "name": "$ref:REASON_CODE",
            "display": "Movement Reason Code (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPf.DO103fc"
          },
          {
            "name": "$ref:MOVEMENT_TIME",
            "display": "Movement Date and Time (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPf.DO103eb"
          },
          {
            "name": "$ref:MOVEMENT_SEQ",
            "display": "Movement Sequence",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPf.DO103e5"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_RECEPTION_AFTER_RELEASE_DI34 :: Error: =If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FnPKM18E5gsAvUsBAHD7cl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RECEPTION_AFTER_RELEASE_DI34 :: Error: =If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FnPKM18E5gsAvUsBAHD7cl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "instance.report[1] requires property \"dataset\"",
      "entityId": "FnPKM18E5gsAvUsBAHD7cl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report Variant 213359.RS does not have corresponding dataset undefined",
      "entityId": "213359.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP2",
      "entityType": "dataset"
    }
  ]
}