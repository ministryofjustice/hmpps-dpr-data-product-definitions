{
  "id": "FmG12F4pQAQAyGQAAHBLxF4KACJIAFe4",
  "name": "MIS National HDC Releases (MIS)",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "HDC0011"
    ]
  },
  "description": "<br/>This report was built to assist the HDC taskforce to assess HDC releases accross the prison estate. However this can now be used by any establishment to assess performance against HDC releases.<br/>HDC0011 v00.00.01 Last Modified: 29/06/22",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP2",
      "name": "HDC One",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, DT_ADMISSION_ALL_STATUS.MOVEMENT_DATE, AT_OFFENDER_BOOKING.BOOKING_NUMBER, FACT_CURR_KEY_DATES_SENT.SSD, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH END AS EFFECTIVE_SENTENCE_LENGTH, CASE WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA') THEN 'Recall' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '0' THEN 'Dead' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '1' THEN 'Indeterminate Sentence' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('2', '3') THEN 'Sentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('9', '10') OR AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'CIV_RMD' THEN 'Civil Prisoner' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('8', '11') THEN 'Immigration Detainee' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('12', '13', '14') THEN 'Remand' WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, CASE WHEN AT_DIM_ASSESSMENT_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_ASSESSMENT_DATE.DAY_DATE END AS HDC_CHECKS_DONE_DATE, CASE WHEN AT_CURFEW_ASSESSMENT.PASSED_FLAG = 'Y' THEN 'YES' WHEN AT_CURFEW_ASSESSMENT.PASSED_FLAG = 'N' THEN 'NO' END AS HDC_PASSED_FLAG, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC, CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END AS HDC_DECISION_DATE, FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE, FACT_CURR_KEY_DATES_SENT.CURR_ARD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE, CASE WHEN AT_HDCED_DATE.DAY_DATE < '31/12/9000' THEN AT_HDCED_DATE.DAY_DATE END AS HDC_ELIGIBILITY_DATE_, CASE WHEN AT_CURFEW_ASSESSMENT.REVIEW_FLAG = 'Y' THEN 'YES' WHEN AT_CURFEW_ASSESSMENT.REVIEW_FLAG = 'N' THEN 'NO' END AS HDC_REVIEW_FLAG, AT_HDCRR_REFERRAL_TO.DESCRIPTION, AT_HDCRR_REFERRAL_DATE.DAY_DATE, AT_DIM_HDC_REQ_REF.REFERRED_BY, CASE WHEN AT_HDCRR_STAFF_MEMBER.STAFF_MEMBER_SK > 0 THEN AT_HDCRR_STAFF_MEMBER.LAST_NAME || ', ' || AT_HDCRR_STAFF_MEMBER.FIRST_NAME END AS HDC_REQUEST_REFERRAL_REFERRE45, AT_HDCRR_REFERRAL_TO.CODE, AT_DIM_HDC_REQ_REF.REFERRAL_INFORMATION, AT_HDCRR_RECEIVED_DATE.DAY_DATE AS HDC_REQUEST_REFERRAL_RECEIVE34, AT_HDCRR_RESPONSE_DUE.DAY_DATE AS HDC_REQUEST_REFERRAL_RESPONS38, AT_FACT_MOV_EXT.DIRECTION_CODE, AT_DIM_DATE_EXT_MOV.DAY_DATE AS MOVEMENT_DATE, AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_CODE_NK, CASE WHEN AT_MOVEMENT_EXTERNAL.TYPE = 'Release' THEN AT_MOVEMENT_EXTERNAL.REASON ELSE 'LDR' END AS RELEASE_REASON, AT_FACT_MOV_EXT.REASON, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME FROM BODIMIS.DIM_DATE AT_DIM_ASSESSMENT_DATE, BODIMIS.DIM_DATE AT_DIM_DECISION_DATE, BODIMIS.DIM_DATE AT_HDCED_DATE, BODIMIS.DIM_DATE AT_HDCRR_REFERRAL_DATE, BODIMIS.DIM_DATE AT_HDCRR_RECEIVED_DATE, BODIMIS.DIM_DATE AT_HDCRR_RESPONSE_DUE, BODIMIS.DIM_REFERENCE_CODES AT_HDCRR_REFERRAL_TO, BODIMIS.DIM_STAFF_MEMBER AT_HDCRR_STAFF_MEMBER, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT FME.OFFENDER_BOOKING_SK, MAX(FME.MOVEMENT_SEQ) AS MOVEMENT_SEQ, MAX(D.DAY_DATE) AS MOVEMENT_DATE FROM BODIMIS.FACT_MOVEMENT_EXTERNAL FME, BODIMIS.DIM_DATE D WHERE D.DATE_SK = FME.DATE_SK AND FME.TYPE = 'Admission' GROUP BY FME.OFFENDER_BOOKING_SK) DT_ADMISSION_ALL_STATUS, FACT_CURR_KEY_DATES_SENT, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, BODIMIS.DIM_HDC_REQUEST_REFERRAL AT_DIM_HDC_REQ_REF, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_MOVEMENT_EXTERNAL, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK (+)) AND (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.ASSESSMENT_DATE_SK = AT_DIM_ASSESSMENT_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.HDCED_DATE_SK = AT_HDCED_DATE.DATE_SK (+)) AND (AT_CURFEW_ASSESSMENT.DECISION_DATE_SK = AT_DIM_DECISION_DATE.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_CURFEW_ASSESSMENT.CURFEW_SEQ = AT_DIM_HDC_REQ_REF.CURFEW_SEQ (+)) AND (AT_DIM_HDC_REQ_REF.REFERRAL_DATE_SK = AT_HDCRR_REFERRAL_DATE.DATE_SK (+)) AND (AT_DIM_HDC_REQ_REF.RESPONSE_DUE_DATE_SK = AT_HDCRR_RESPONSE_DUE.DATE_SK (+)) AND (AT_DIM_HDC_REQ_REF.RECEIVED_DATE_SK = AT_HDCRR_RECEIVED_DATE.DATE_SK (+)) AND (AT_DIM_HDC_REQ_REF.REFERRAL_TO_SK = AT_HDCRR_REFERRAL_TO.REFERENCE_CODE_SK (+)) AND (AT_DIM_HDC_REQ_REF.REFERRED_STAFF_ID_SK = AT_HDCRR_STAFF_MEMBER.STAFF_MEMBER_SK (+)) AND (AT_HDCRR_REFERRAL_TO.CODE_DOMAIN (+) = 'HDC_REFERRAL') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_MOVEMENT_EXTERNAL.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_ADMISSION_ALL_STATUS.OFFENDER_BOOKING_SK (+)) AND ((TRUNC(AT_DIM_DATE_EXT_MOV.DAY_DATE) BETWEEN TO_DATE('18-05-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND TO_DATE('31-05-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS')) AND AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) AND AT_FACT_MOV_EXT.TYPE IN ('Release') AND AT_FACT_MOV_EXT.DIRECTION_CODE IN ('OUT') AND NOT FACT_CURR_KEY_DATES_SENT.CURR_HDCED_DATE IS NULL)), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, MOVEMENT_DATE, BOOKING_NUMBER, SSD, EFFECTIVE_SENTENCE_LENGTH, LEGAL_STATUS_GROUPING, HDC_CHECKS_DONE_DATE, HDC_PASSED_FLAG, HDC_ASSMENT_APP_STATUS_DESC, HDC_DECISION_DATE, CURR_HDCED_DATE, CURR_ARD_DATE, CURR_CRD_DATE, HDC_ELIGIBILITY_DATE_, HDC_REVIEW_FLAG, DESCRIPTION, DAY_DATE, REFERRED_BY, HDC_REQUEST_REFERRAL_REFERRE45, CODE, REFERRAL_INFORMATION, HDC_REQUEST_REFERRAL_RECEIVE34, HDC_REQUEST_REFERRAL_RESPONS38, DIRECTION_CODE, MOVEMENT_DATE, ESTABLISHMENT_CODE_NK, RELEASE_REASON, REASON, SURNAME, FIRST_NAME, (TO_DATE(MOVEMENT_DATE, 'DD/MM/YYYY') - TO_DATE(MOVEMENT_DATE, 'DD/MM/YYYY')) AS V_DAYS_IN_ESTAB, CASE WHEN DESCRIPTION = 'OFFENDER' THEN 'Y' END AS V_OFFENDER_REF, CASE WHEN (DESCRIPTION) = 'Prisoner Proposed Address' THEN 'Y' END AS V_PROPOSED_ADDRESS, MIN(V_PROPOSED_ADDRESS_REF_DATE) AS V_MIN_PROPOSED_ADDRESS_REFER36, MAX(V_PROPOSED_ADDRESS_REC_DATE) AS V_MAX_PROPOSED_ADDRESS_REC_D31, CASE WHEN DESCRIPTION = 'Offender Manager' THEN 'Y' END AS V_REFERRAL_TO_OM, MIN(V_OM_REFERRAL_DATE) AS V_MIN_OM_REFERRAL_DATE, MIN(V_OM_RECEIVED_DATE) AS V_MAX_OM_REC_DATE, CASE WHEN DESCRIPTION = 'OM Address Checks Risk Man' THEN 'Y' END AS V_OM_ADDRESS, MIN(V_OM_ADDRESS_REFERRAL_DATE) AS V_MIN_OM_ADDRESS_REFERRAL_DATE, MAX(V_OM_ADDRESS_RECEIVED_DATE) AS V_MAX_OM_ADDRESS_RECEIVED, CASE WHEN DESCRIPTION = 'Governor' THEN 'Y' END AS V_GOVERNOR_REFERRAL, MIN(V_GOVERNOR_REFERRAL_DATE) AS V_MIN_GOVERNOR_REFERRAL_DATE, MAX(V_GOVERNOR_RECEIVED_DATE) AS V_MAX_GOV_RECEIVED_DATE, MAX(HDC_DECISION_DATE) AS V_MAX_APPROVAL_STATUS_DATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "MOVEMENT_DATE",
            "type": "date",
            "display": "Admission Date (All Status)",
            "legacyId": "DP2.DO10b6d",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP2.DO10077",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "SSD",
            "type": "date",
            "display": "Current Sentence Start Date",
            "legacyId": "DP2.DO32d",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "EFFECTIVE_SENTENCE_LENGTH",
            "type": "string",
            "display": "Effective Sentence Length",
            "legacyId": "DP2.DO2d0",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP2.DO107cb",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "HDC_CHECKS_DONE_DATE",
            "type": "date",
            "display": "HDC Checks Done Date",
            "legacyId": "DP2.DO54a",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "HDC_PASSED_FLAG",
            "type": "string",
            "display": "HDC Passed Flag",
            "legacyId": "DP2.DO3ad",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "HDC_ASSMENT_APP_STATUS_DESC",
            "type": "string",
            "display": "HDC Status",
            "legacyId": "DP2.DO54",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "HDC_DECISION_DATE",
            "type": "date",
            "display": "HDC Decision Date",
            "legacyId": "DP2.DO3b0",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "CURR_HDCED_DATE",
            "type": "date",
            "display": "HDC Eligibility Date",
            "legacyId": "DP2.DO70",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "CURR_ARD_DATE",
            "type": "date",
            "display": "ARD (Approved Release Date)",
            "legacyId": "DP2.DO47",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "CURR_CRD_DATE",
            "type": "date",
            "display": "CRD (Conditional Release Date)",
            "legacyId": "DP2.DO48",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "HDC_ELIGIBILITY_DATE_",
            "type": "date",
            "display": "HDC Eligibility Date (Historic)",
            "legacyId": "DP2.DO2f6",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "HDC_REVIEW_FLAG",
            "type": "string",
            "display": "HDC Review Flag",
            "legacyId": "DP2.DO3ae",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "HDC Request Referral - Referral To Desc",
            "legacyId": "DP2.DO623",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "DAY_DATE",
            "type": "date",
            "display": "HDC Request Referral - Referral Date",
            "legacyId": "DP2.DO625",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "REFERRED_BY",
            "type": "string",
            "display": "HDC Request Referral - Referred By",
            "legacyId": "DP2.DO626",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "HDC_REQUEST_REFERRAL_REFERRE45",
            "type": "string",
            "display": "HDC Request Referral - Referred by Staff Member",
            "legacyId": "DP2.DO62b",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "CODE",
            "type": "string",
            "display": "HDC Request Referral - Referral To Code",
            "legacyId": "DP2.DO622",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "REFERRAL_INFORMATION",
            "type": "string",
            "display": "HDC Request Referral - Referral Information",
            "legacyId": "DP2.DO627",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "HDC_REQUEST_REFERRAL_RECEIVE34",
            "type": "date",
            "display": "HDC Request Referral - Received Date",
            "legacyId": "DP2.DO629",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "HDC_REQUEST_REFERRAL_RESPONS38",
            "type": "date",
            "display": "HDC Request Referral - Response Due Date",
            "legacyId": "DP2.DO62a",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "DIRECTION_CODE",
            "type": "string",
            "display": "Movement Direction Code (External)",
            "legacyId": "DP2.DO103fd",
            "legacySqlClass": "column"
          },
          {
            "index": 24,
            "name": "MOVEMENT_DATE",
            "type": "date",
            "display": "Movement Date",
            "legacyId": "DP2.DO10781",
            "legacySqlClass": "column"
          },
          {
            "index": 25,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Movement Location From Code (External)",
            "legacyId": "DP2.DO103ff",
            "legacySqlClass": "column"
          },
          {
            "index": 26,
            "name": "RELEASE_REASON",
            "type": "string",
            "display": "Release Reason",
            "legacyId": "DP2.DO43",
            "legacySqlClass": "column"
          },
          {
            "index": 27,
            "name": "REASON",
            "type": "string",
            "display": "Movement Description (External)",
            "legacyId": "DP2.DO1015b",
            "legacySqlClass": "column"
          },
          {
            "index": 28,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP2.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 29,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP2.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 30,
            "name": "V_DAYS_IN_ESTAB",
            "type": "string",
            "display": "V_DAYS_IN_ESTAB",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 31,
            "name": "V_OFFENDER_REF",
            "type": "string",
            "display": "V_OFFENDER_REF",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 32,
            "name": "V_PROPOSED_ADDRESS",
            "type": "string",
            "display": "V_PROPOSED_ADDRESS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 33,
            "name": "V_MIN_PROPOSED_ADDRESS_REFER36",
            "type": "string",
            "display": "V_MIN_PROPOSED_ADDRESS_REFER36",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 34,
            "name": "V_MAX_PROPOSED_ADDRESS_REC_D31",
            "type": "string",
            "display": "V_MAX_PROPOSED_ADDRESS_REC_D31",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 35,
            "name": "V_REFERRAL_TO_OM",
            "type": "string",
            "display": "V_REFERRAL_TO_OM",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 36,
            "name": "V_MIN_OM_REFERRAL_DATE",
            "type": "string",
            "display": "V_MIN_OM_REFERRAL_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 37,
            "name": "V_MAX_OM_REC_DATE",
            "type": "string",
            "display": "V_MAX_OM_REC_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 38,
            "name": "V_OM_ADDRESS",
            "type": "string",
            "display": "V_OM_ADDRESS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 39,
            "name": "V_MIN_OM_ADDRESS_REFERRAL_DATE",
            "type": "string",
            "display": "V_MIN_OM_ADDRESS_REFERRAL_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 40,
            "name": "V_MAX_OM_ADDRESS_RECEIVED",
            "type": "string",
            "display": "V_MAX_OM_ADDRESS_RECEIVED",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 41,
            "name": "V_GOVERNOR_REFERRAL",
            "type": "string",
            "display": "V_GOVERNOR_REFERRAL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 42,
            "name": "V_MIN_GOVERNOR_REFERRAL_DATE",
            "type": "string",
            "display": "V_MIN_GOVERNOR_REFERRAL_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 43,
            "name": "V_MAX_GOV_RECEIVED_DATE",
            "type": "string",
            "display": "V_MAX_GOV_RECEIVED_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 44,
            "name": "V_MAX_APPROVAL_STATUS_DATE",
            "type": "string",
            "display": "V_MAX_APPROVAL_STATUS_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP3",
      "name": "MIS Load Date",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP3.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "214316.RS",
      "name": "HDC Releases",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (HDC_ELIGIBILITY_DATE IS NOT NULL AND HDC_REVIEW_FLAG <> 'YES'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:MOVEMENT_DATE",
            "display": "Admission Date (All Status)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10b6d"
          },
          {
            "name": "$ref:V_DAYS_IN_ESTAB",
            "display": "Days in Last Establishment",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=DaysBetween([Admission Date (All Status)];[Movement Date])"
          },
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Movement Location From Code (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO103ff"
          },
          {
            "name": "$ref:REASON",
            "display": "Movement Description (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1015b"
          },
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10076"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10080"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10077"
          },
          {
            "name": "$ref:LEGAL_STATUS_GROUPING",
            "display": "Legal Status Grouping",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO107cb"
          },
          {
            "name": "$ref:V_MAX_SENTENCE_START_DATE",
            "display": "Sentence Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([Current Sentence Start Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:EFFECTIVE_SENTENCE_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO2d0"
          },
          {
            "name": "$ref:HDC_CHECKS_DONE_DATE",
            "display": "HDC Checks Done Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO54a"
          },
          {
            "name": "$ref:HDC_PASSED_FLAG",
            "display": "HDC Passed Flag",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO3ad"
          },
          {
            "name": "$ref:V_OFFENDER_REF",
            "display": "Ref to Offender ?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(([HDC Request Referral - Referral To Desc] = \"OFFENDER\");\"Y\")"
          },
          {
            "name": "$ref:V_MIN_OFFENDER_REFERRAL_DATE",
            "display": "Offender Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_Ref_to_Offender_Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_REF_REC_DATE",
            "display": "Offender Referral Received Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([v_Off_Ref_Rec_Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_PROPOSED_ADDRESS",
            "display": "Proposed Address",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(([HDC Request Referral - Referral To Desc]) = \"Prisoner Proposed Address\"; \"Y\")"
          },
          {
            "name": "$ref:V_MIN_PROPOSED_ADDRESS_REFER36",
            "display": "Proposed Address Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_Proposed_Address_Ref_Date])"
          },
          {
            "name": "$ref:V_MAX_PROPOSED_ADDRESS_REC_D31",
            "display": "Proposed Address Received Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([v_Proposed_Address_Rec_Date])"
          },
          {
            "name": "$ref:V_REFERRAL_TO_OM",
            "display": "Referral to OM",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(([HDC Request Referral - Referral To Desc] = \"Offender Manager\");\"Y\")"
          },
          {
            "name": "$ref:V_MIN_OM_REFERRAL_DATE",
            "display": "OM Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_OM_Referral_Date])"
          },
          {
            "name": "$ref:V_MAX_OM_REC_DATE",
            "display": "OM Received Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_OM_Received_Date])"
          },
          {
            "name": "$ref:V_OM_ADDRESS",
            "display": "OM Address",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(([HDC Request Referral - Referral To Desc] = \"OM Address Checks Risk Man\");\"Y\")"
          },
          {
            "name": "$ref:V_MIN_OM_ADDRESS_REFERRAL_DATE",
            "display": "OM Address Referral",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_OM_Address_Referral_Date])"
          },
          {
            "name": "$ref:V_MAX_OM_ADDRESS_RECEIVED",
            "display": "OM Address Received Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([v_OM_Address_Received_Date])"
          },
          {
            "name": "$ref:V_GOVERNOR_REFERRAL",
            "display": "Governor Referral",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(([HDC Request Referral - Referral To Desc] = \"Governor\");\"Y\")"
          },
          {
            "name": "$ref:V_MIN_GOVERNOR_REFERRAL_DATE",
            "display": "Governor Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([v_Governor_Referral_Date])"
          },
          {
            "name": "$ref:V_MAX_GOV_RECEIVED_DATE",
            "display": "Governor Received Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([v_Governor_Received_Date])"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO54"
          },
          {
            "name": "$ref:V_MAX_APPROVAL_STATUS_DATE",
            "display": "Approval Status Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([HDC Decision Date])"
          },
          {
            "name": "$ref:CURR_HDCED_DATE",
            "display": "HDC Eligibility Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO70"
          },
          {
            "name": "$ref:CURR_ARD_DATE",
            "display": "ARD (Approved Release Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO47"
          },
          {
            "name": "$ref:CURR_CRD_DATE",
            "display": "CRD (Conditional Release Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO48"
          },
          {
            "name": "$ref:MOVEMENT_DATE",
            "display": "Movement Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10781"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MAX_SENTENCE_START_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 13.\n  MAX(SSD) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FmG12F4pQAQAyGQAAHBLxF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MIN_OFFENDER_REFERRAL_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 32.\n  MIN(V_REF_TO_OFFENDER_DATE) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FmG12F4pQAQAyGQAAHBLxF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MAX_REF_REC_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 28.\n  MAX(V_OFF_REF_REC_DATE) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FmG12F4pQAQAyGQAAHBLxF4KACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report field V_MAX_SENTENCE_START_DATE does not have corresponding dataset schema field",
      "entityId": "214316.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MIN_OFFENDER_REFERRAL_DATE does not have corresponding dataset schema field",
      "entityId": "214316.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MAX_REF_REC_DATE does not have corresponding dataset schema field",
      "entityId": "214316.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP2",
      "entityType": "dataset"
    }
  ]
}