{
  "id": "okTTNgAABEbEA2MAQgOD8K7B5ps",
  "name": "MIS Print Nominal Index Card",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "PDD0010 v00.03.8"
    ]
  },
  "description": "Produces a nominal index card for a specified prisoner for the current booking; it is a record of all important information held on the system in case of a loss of the manual record, the system being inaccessible or in response to an enquiry from an outside agency i.e. Immigration. <br/>PDD0010 - v00.03.8",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3376639/DP2",
      "name": "Header",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.MIDDLE_NAME_1, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_DESCRIPTION, AT_OFFENDER_ALIAS.FIRST_NAME AS ALIAS_GIVEN_NAME_1, AT_OFFENDER_ALIAS.MIDDLE_NAME_1 AS ALIAS_GIVEN_NAME_2, AT_OFFENDER_BOOKING.GENDER_DESCRIPTION, AT_OFFENDER_BOOKING.BIRTH_PLACE, AT_OFFENDER_BOOKING.BIRTH_COUNTRY, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'Asian/Asian British: Chinese' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_DESCRIPTION, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, AT_OFFENDER_EMPLOYMENT.OCCUPATION_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_CODE, 'Not Specified') AS RELIGION_CODE, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, CASE WHEN AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL IS NULL THEN 'Unclassified' ELSE AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_LEVEL END AS CURRENT_SECURITY_CATEGORY, AT_OFFENDER_ALIAS.SURNAME AS ALIAS_SURNAME, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE, AT_OFFENDER_BOOKING.BOOKING_NUMBER, AT_OFFENDER_ALIAS.GENDER, AT_OFFENDER_ALIAS.DISPLAY_NAME, CASE WHEN DT_FIRST_RECEPTION.DAY_DATE < '31/12/9000' THEN DT_FIRST_RECEPTION.DAY_DATE ELSE NULL END AS DATE_FIRST_RECEPTION, AT_CELL.UNIT_4_DESCRIPTION FROM BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_OFFENDER_ALIAS AT_OFFENDER_ALIAS, BODIMIS.DIM_OFFENDER_EMPLOYMENT AT_OFFENDER_EMPLOYMENT, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_CURRENT_SECURITY_CATEGORY, (SELECT * FROM (SELECT m.offender_booking_sk, d.day_date, m.movement_seq, m.movement_time, ROW_NUMBER() OVER (PARTITION BY m.offender_booking_sk ORDER BY m.movement_seq) AS row_seq_filter FROM bodimis.fact_movement_external m INNER JOIN bodimis.dim_date d ON m.date_sk = d.date_sk WHERE m.direction_code = 'IN') WHERE row_seq_filter = 1) DT_FIRST_RECEPTION, BODIMIS.DIM_CELL AT_CELL WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_CELL.UNIT_4_SK = AT_OFFENDER_BOOKING.LIVING_UNIT_SK) AND (AT_OFFENDER_EMPLOYMENT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (DT_FIRST_RECEPTION.OFFENDER_BOOKING_SK = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK IS NULL OR AT_OFFENDER_ALIAS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_CURRENT_SECURITY_CATEGORY.CURRENT_SEC_CAT_FLAG (+) = 'Y') AND (AT_CURRENT_SECURITY_CATEGORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, MIDDLE_NAME_1, DATE_OF_BIRTH, MAIN_LEGAL_STATUS_DESCRIPTION, ALIAS_GIVEN_NAME_1, ALIAS_GIVEN_NAME_2, GENDER_DESCRIPTION, BIRTH_PLACE, BIRTH_COUNTRY, ETHNIC_DESCRIPTION, NATIONALITY_DESCRIPTION, OCCUPATION_DESCRIPTION, RELIGION_CODE, RELIGION_DESCRIPTION, CURRENT_SECURITY_CATEGORY, ALIAS_SURNAME, MAIN_LEGAL_STATUS_CODE, BOOKING_NUMBER, GENDER, DISPLAY_NAME, DATE_FIRST_RECEPTION, UNIT_4_DESCRIPTION FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP2.DO7b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP2.DO80",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "MIDDLE_NAME_1",
            "type": "string",
            "display": "Offender Given Name 2",
            "legacyId": "DP2.DO81",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP2.DO85",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "MAIN_LEGAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Main Legal Status Description",
            "legacyId": "DP2.DOdf",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "ALIAS_GIVEN_NAME_1",
            "type": "string",
            "display": "Alias Given Name 1",
            "legacyId": "DP2.DO8b",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ALIAS_GIVEN_NAME_2",
            "type": "string",
            "display": "Alias Given Name 2",
            "legacyId": "DP2.DO8c",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "GENDER_DESCRIPTION",
            "type": "string",
            "display": "Gender Description",
            "legacyId": "DP2.DOa9",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "BIRTH_PLACE",
            "type": "string",
            "display": "Birth Place",
            "legacyId": "DP2.DO86",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "BIRTH_COUNTRY",
            "type": "string",
            "display": "Birth Country",
            "legacyId": "DP2.DO88",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "ETHNIC_DESCRIPTION",
            "type": "string",
            "display": "Ethnic Description",
            "legacyId": "DP2.DO9d",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "NATIONALITY_DESCRIPTION",
            "type": "string",
            "display": "Nationality Description",
            "legacyId": "DP2.DOb5",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "OCCUPATION_DESCRIPTION",
            "type": "string",
            "display": "Occupation Description",
            "legacyId": "DP2.DOb7",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "RELIGION_CODE",
            "type": "string",
            "display": "Religion Code",
            "legacyId": "DP2.DOb2",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DP2.DOb3",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "CURRENT_SECURITY_CATEGORY",
            "type": "string",
            "display": "Current Security Category",
            "legacyId": "DP2.DOe1",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "ALIAS_SURNAME",
            "type": "string",
            "display": "Alias Surname",
            "legacyId": "DP2.DO89",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "MAIN_LEGAL_STATUS_CODE",
            "type": "string",
            "display": "Main Legal Status Code",
            "legacyId": "DP2.DOde",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP2.DO77",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "GENDER",
            "type": "string",
            "display": "Alias Gender",
            "legacyId": "DP2.DO70f",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "DISPLAY_NAME",
            "type": "string",
            "display": "Alias or Working Name?",
            "legacyId": "DP2.DO78f",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "DATE_FIRST_RECEPTION",
            "type": "date",
            "display": "Date First Reception",
            "legacyId": "DP2.DO106",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "UNIT_4_DESCRIPTION",
            "type": "string",
            "display": "Unit Description 4",
            "legacyId": "DP2.DO136",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP4",
      "name": "Offences",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OFFENCE.OFFENCE_CODE_NK, AT_COURT_CASE.COURT_CASE_SK, CASE WHEN AT_FACT_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE TO_CHAR(AT_FACT_SENTENCE_TERMS.YEARS) END AS CASE_TERMS_YEARS, CASE WHEN AT_FACT_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y' THEN '' ELSE TO_CHAR(AT_FACT_SENTENCE_TERMS.MONTHS) END AS CASE_TERMS_MONTHS, CASE WHEN AT_FACT_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y' THEN '' ELSE TO_CHAR(AT_FACT_SENTENCE_TERMS.DAYS) END AS CASE_TERMS_DAYS, AT_DIM_OFFENCE.OFFENCE_NAME, AT_FACT_COURT_CHARGE.MOST_SERIOUS_FLAG, AT_MIN_SENTENCE_DATE.DAY_DATE, AT_FACT_COURT_CHARGE.OFFENDER_CHARGE_ID_NK, CASE WHEN AT_FACT_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y' THEN '' ELSE TO_CHAR(AT_FACT_SENTENCE_TERMS.WEEKS) END AS CASE_TERMS_WEEKS FROM BODIMIS.DIM_DATE AT_MIN_SENTENCE_DATE, BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.FACT_SENTENCE_CHARGE AT_FACT_SENTENCE_CHARGE, BODIMIS.FACT_CASE_SENTENCE_TERM AT_FACT_SENTENCE_TERMS, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_COURT_CASE AT_COURT_CASE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT * FROM (SELECT sentence_start_date_sk, offender_booking_sk, sentence_seq_nk, sentence_type_sk, court_case_sk, sentence_termination_date_sk, expiry_date_sk, ROW_NUMBER() OVER (PARTITION BY offender_booking_sk ORDER BY sentence_start_date_sk, sentence_seq_nk) AS row_seq_filter FROM bodimis.fact_case_sentence) WHERE row_seq_filter = 1) DT_FIRST_SENTENCE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_FACT_COURT_CHARGE.OFFENDER_CHARGE_ID_NK = AT_FACT_SENTENCE_CHARGE.OFFENDER_CHARGE_ID_NK (+)) AND (AT_FACT_SENTENCE_TERMS.OFFENDER_BOOKING_SK (+) = AT_FACT_SENTENCE_CHARGE.OFFENDER_BOOKING_SK AND AT_FACT_SENTENCE_TERMS.SENTENCE_SEQ_NK (+) = AT_FACT_SENTENCE_CHARGE.SENTENCE_SEQ_NK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (DT_FIRST_SENTENCE.SENTENCE_START_DATE_SK = AT_MIN_SENTENCE_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_FIRST_SENTENCE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active'))), dataset_ AS (SELECT COURT_CASE_NUMBER, OFFENCE_CODE_NK, COURT_CASE_SK, CASE_TERMS_YEARS, CASE_TERMS_MONTHS, CASE_TERMS_DAYS, OFFENCE_NAME, MOST_SERIOUS_FLAG, DAY_DATE, OFFENDER_CHARGE_ID_NK, CASE_TERMS_WEEKS FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "COURT_CASE_NUMBER",
            "type": "string",
            "display": "Court Case Number",
            "legacyId": "DP4.DO51",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENCE_CODE_NK",
            "type": "string",
            "display": "Offence Code",
            "legacyId": "DP4.DO4a",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "COURT_CASE_SK",
            "type": "double",
            "display": "Court Case Internal Key",
            "legacyId": "DP4.DO147",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CASE_TERMS_YEARS",
            "type": "string",
            "display": "Case Terms - Years",
            "legacyId": "DP4.DO1c6",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "CASE_TERMS_MONTHS",
            "type": "string",
            "display": "Case Terms - Months",
            "legacyId": "DP4.DO1c7",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "CASE_TERMS_DAYS",
            "type": "string",
            "display": "Case Terms - Days",
            "legacyId": "DP4.DO1c8",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DP4.DO4b",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "MOST_SERIOUS_FLAG",
            "type": "string",
            "display": "Main Offence Flag",
            "legacyId": "DP4.DO4f",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Minimum Sentence Date",
            "legacyId": "DP4.DO1db",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "OFFENDER_CHARGE_ID_NK",
            "type": "double",
            "display": "Offender Charge Id Nk",
            "legacyId": "DP4.DO1d9",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "CASE_TERMS_WEEKS",
            "type": "string",
            "display": "Case Terms - Weeks",
            "legacyId": "DP4.DO5e3",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP5",
      "name": "Sentence History",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT CASE WHEN AT_LTD_DATE.DAY_DATE < '31/12/9000' THEN AT_LTD_DATE.DAY_DATE END AS LTD_, 'Not Available' AS LTD_OVERRIDE, CASE WHEN AT_PRRD_DATE.DAY_DATE < '31/12/9000' THEN AT_PRRD_DATE.DAY_DATE END AS PRRD_, CASE WHEN AT_HDCAD_DATE.DAY_DATE < '31/12/9000' THEN AT_HDCAD_DATE.DAY_DATE END AS HDC_AD_, CASE WHEN AT_HDCED_DATE.DAY_DATE < '31/12/9000' THEN AT_HDCED_DATE.DAY_DATE END AS HDC_ELIGIBILITY_DATE_, CASE WHEN AT_MTD_DATE.DAY_DATE < '31/12/9000' THEN AT_MTD_DATE.DAY_DATE END AS MTD_HISTORICAL, CASE WHEN AT_APD_DATE.DAY_DATE < '31/12/9000' THEN AT_APD_DATE.DAY_DATE END AS APD_, CASE WHEN AT_LED_DATE.DAY_DATE < '31/12/9000' THEN AT_LED_DATE.DAY_DATE END AS LED_, CASE WHEN AT_ETD_DATE.DAY_DATE < '31/12/9000' THEN AT_ETD_DATE.DAY_DATE END AS ETD_, CASE WHEN AT_PED_DATE.DAY_DATE < '31/12/9000' THEN AT_PED_DATE.DAY_DATE END AS PED_, CASE WHEN AT_SED_DATE.DAY_DATE < '31/12/9000' THEN AT_SED_DATE.DAY_DATE END AS SED_, FACT_CURR_KEY_DATES_SENT.SED, CASE WHEN AT_NPD_DATE.DAY_DATE < '31/12/9000' THEN AT_NPD_DATE.DAY_DATE END AS NPD_, CASE WHEN AT_ARD_DATE.DAY_DATE < '31/12/9000' THEN AT_ARD_DATE.DAY_DATE END AS ARD_, CASE WHEN AT_CRD_DATE.DAY_DATE < '31/12/9000' THEN AT_CRD_DATE.DAY_DATE END AS CRD_, AT_FACT_OFFENDER_SENTENCE.RECORD_DATETIME, AT_FACT_OFFENDER_SENTENCE.COMMENT_TEXT, AT_FACT_OFFENDER_SENTENCE.CALC_REASON_CODE, AT_FACT_OFFENDER_SENTENCE.CALC_REASON, CASE WHEN AT_TARIFF_DATE.DAY_DATE < '31/12/9000' THEN AT_TARIFF_DATE.DAY_DATE END AS TARIFF_DATE_, CASE WHEN DT_LIFEFLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE FACT_CURR_KEY_DATES_SENT.EFFECTIVE_SENTENCE_LENGTH END AS EFFECTIVE_SENTENCE_LENGTH, AT_FACT_OFFENDER_SENTENCE.SENTENCE_CURRENT_FLAG FROM BODIMIS.DIM_DATE AT_LTD_DATE, BODIMIS.DIM_DATE AT_PRRD_DATE, BODIMIS.DIM_DATE AT_HDCAD_DATE, BODIMIS.DIM_DATE AT_HDCED_DATE, BODIMIS.DIM_DATE AT_MTD_DATE, BODIMIS.DIM_DATE AT_APD_DATE, BODIMIS.DIM_DATE AT_LED_DATE, BODIMIS.DIM_DATE AT_ETD_DATE, BODIMIS.DIM_DATE AT_PED_DATE, BODIMIS.DIM_DATE AT_SED_DATE, BODIMIS.DIM_DATE AT_NPD_DATE, BODIMIS.DIM_DATE AT_ARD_DATE, BODIMIS.DIM_DATE AT_CRD_DATE, BODIMIS.DIM_DATE AT_TARIFF_DATE, FACT_CURR_KEY_DATES_SENT, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_OFFENDER_SENTENCE, (SELECT DISTINCT BODIMIS.FACT_CASE_SENTENCE_TERM.offender_booking_sk, BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG FROM BODIMIS.FACT_CASE_SENTENCE_TERM, BODIMIS.FACT_CASE_SENTENCE, BODIMIS.DIM_SENTENCE_STATUS dss WHERE (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_STATUS_SK = dss.sentence_status_sk) AND dss.sentence_status = 'Active' AND (BODIMIS.FACT_CASE_SENTENCE.OFFENDER_BOOKING_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.OFFENDER_BOOKING_SK) AND (BODIMIS.FACT_CASE_SENTENCE.SENTENCE_SEQ_NK = BODIMIS.FACT_CASE_SENTENCE_TERM.SENTENCE_SEQ_NK) AND (BODIMIS.FACT_CASE_SENTENCE.COURT_CASE_SK = BODIMIS.FACT_CASE_SENTENCE_TERM.COURT_CASE_SK) AND BODIMIS.FACT_CASE_SENTENCE_TERM.LIFE_SENTENCE_FLAG = 'Y') DT_LIFEFLAG, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_FACT_OFFENDER_SENTENCE.APD_DATE_SK = AT_APD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.ETD_DATE_SK = AT_ETD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.MTD_DATE_SK = AT_MTD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.LTD_DATE_SK = AT_LTD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.ARD_DATE_SK = AT_ARD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.CRD_DATE_SK = AT_CRD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.PED_DATE_SK = AT_PED_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.NPD_DATE_SK = AT_NPD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.LED_DATE_SK = AT_LED_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.SED_DATE_SK = AT_SED_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.PRRD_DATE_SK = AT_PRRD_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.HDCAD_DATE_SK = AT_HDCAD_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_FACT_OFFENDER_SENTENCE.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.HDCED_DATE_SK = AT_HDCED_DATE.DATE_SK (+)) AND (AT_FACT_OFFENDER_SENTENCE.TARIFF_DATE_SK = AT_TARIFF_DATE.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_LIFEFLAG.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT LTD_, LTD_OVERRIDE, PRRD_, HDC_AD_, HDC_ELIGIBILITY_DATE_, MTD_HISTORICAL, APD_, LED_, ETD_, PED_, SED_, SED, NPD_, ARD_, CRD_, RECORD_DATETIME, COMMENT_TEXT, CALC_REASON_CODE, CALC_REASON, TARIFF_DATE_, EFFECTIVE_SENTENCE_LENGTH, SENTENCE_CURRENT_FLAG FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "LTD_",
            "type": "date",
            "display": "LTD (Latest Transfer date) (Historical)",
            "legacyId": "DP5.DO308",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LTD_OVERRIDE",
            "type": "string",
            "display": "LTD Override",
            "legacyId": "DP5.DO99",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "PRRD_",
            "type": "date",
            "display": "PRRD (Post Recall Release Date) (Historic)",
            "legacyId": "DP5.DO89",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "HDC_AD_",
            "type": "date",
            "display": "HDC AD (Approved Date) (Historical)",
            "legacyId": "DP5.DO2f8",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "HDC_ELIGIBILITY_DATE_",
            "type": "date",
            "display": "HDC Eligibility Date (Historic)",
            "legacyId": "DP5.DO2f6",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "MTD_HISTORICAL",
            "type": "date",
            "display": "MTD (Mid Term Date) (Historical",
            "legacyId": "DP5.DO304",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "APD_",
            "type": "date",
            "display": "APD (Actual Parole Date) (Historical)",
            "legacyId": "DP5.DO2fe",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "LED_",
            "type": "date",
            "display": "LED (Licence Expiry Date ) (Historical)",
            "legacyId": "DP5.DO316",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ETD_",
            "type": "date",
            "display": "ETD (Earliest Transfer Date) (Historical)",
            "legacyId": "DP5.DO306",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "PED_",
            "type": "date",
            "display": "PED (Parole Eligibility Date) (Historical)",
            "legacyId": "DP5.DO2fc",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "SED_",
            "type": "date",
            "display": "SED (Sentence End Date) (Historical)",
            "legacyId": "DP5.DO302",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "SED",
            "type": "date",
            "display": "Sentence Completion Date",
            "legacyId": "DP5.DO6e",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "NPD_",
            "type": "date",
            "display": "NPD (Non Parole Date) (HIstorical)",
            "legacyId": "DP5.DO300",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "ARD_",
            "type": "date",
            "display": "ARD (Approved Release Date) (Historical)",
            "legacyId": "DP5.DO30d",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "CRD_",
            "type": "date",
            "display": "CRD (Conditional Release Date) (Historical)",
            "legacyId": "DP5.DO30a",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "RECORD_DATETIME",
            "type": "date",
            "display": "Sentence Last Update Date",
            "legacyId": "DP5.DO37c",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Sentence Last Update Comment",
            "legacyId": "DP5.DO37d",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "CALC_REASON_CODE",
            "type": "string",
            "display": "Sentence Last Update Reason Code",
            "legacyId": "DP5.DO383",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "CALC_REASON",
            "type": "string",
            "display": "Sentence Last Update Reason Description",
            "legacyId": "DP5.DO384",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "TARIFF_DATE_",
            "type": "date",
            "display": "Tariff Date (Historical)",
            "legacyId": "DP5.DO3b2",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "EFFECTIVE_SENTENCE_LENGTH",
            "type": "string",
            "display": "Effective Sentence Length",
            "legacyId": "DP5.DO2d0",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "SENTENCE_CURRENT_FLAG",
            "type": "string",
            "display": "Sentence Dates Current Flag",
            "legacyId": "DP5.DO2c9",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP6",
      "name": "Alerts",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_ALERT.ALERT_CODE_NK, CASE WHEN AT_ALERT.ALERT_ACTIVE_FLAG = 'Y' THEN (AT_ALERT.ALERT_CODE_NK || ' ' || AT_ALERT.ALERT_DESCRIPTION) END AS ALERT_FULL_DESCRIPTION, AT_OFFENDER_ALERT.ALERT_STATUS, CASE WHEN AT_ALERT_EXPIRY_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EXPIRY_DATE.DAY_DATE ELSE NULL END AS ALERT_EXPIRY_DATE, CASE WHEN AT_ALERT.ALERT_ACTIVE_FLAG = 'Y' THEN (AT_ALERT.ALERT_DESCRIPTION) END AS ALERT_DESCRIPTION_ONLY FROM BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EXPIRY_DATE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_EXPIRY_DATE_SK = AT_ALERT_EXPIRY_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT ALERT_CODE_NK, ALERT_FULL_DESCRIPTION, ALERT_STATUS, ALERT_EXPIRY_DATE, ALERT_DESCRIPTION_ONLY FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP6.DO8e",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_FULL_DESCRIPTION",
            "type": "string",
            "display": "Alert Full Description",
            "legacyId": "DP6.DO91",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DP6.DO94",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_EXPIRY_DATE",
            "type": "date",
            "display": "Alert Expiry Date",
            "legacyId": "DP6.DO96",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ALERT_DESCRIPTION_ONLY",
            "type": "string",
            "display": "Alert Description Only",
            "legacyId": "DP6.DO764",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP7",
      "name": "Addresses",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DT_OFFENDER_CONTACT_ADDRESS.ACTIVE_FLAG, TRIM(CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.TITLE IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.TITLE || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.FIRST_NAME || ' ' END || CASE WHEN NOT DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME IS NULL THEN DT_OFFENDER_CONTACT_ADDRESS.MIDDLE_NAME || ' ' END || DT_OFFENDER_CONTACT_ADDRESS.LAST_NAME) AS CONTACT_NAME, DT_OFFENDER_CONTACT_ADDRESS.RELATIONSHIP, DT_OFFENDER_CONTACT_ADDRESS.FLAT, DT_OFFENDER_CONTACT_ADDRESS.PREMISE, DT_OFFENDER_CONTACT_ADDRESS.STREET, DT_OFFENDER_CONTACT_ADDRESS.LOCALITY, DT_OFFENDER_CONTACT_ADDRESS.CITY, DT_OFFENDER_CONTACT_ADDRESS.COUNTY, DT_OFFENDER_CONTACT_ADDRESS.COUNTRY, DT_OFFENDER_CONTACT_ADDRESS.POST_CODE, DT_OFFENDER_CONTACT_ADDRESS.TEL_NO, DT_OFFENDER_CONTACT_ADDRESS.EXT_NO, DT_OFFENDER_CONTACT_ADDRESS.OTHER_CONTACT_SK, DT_OFFENDER_CONTACT_ADDRESS.CON_ADDR_TYPE, DT_OFFENDER_CONTACT_ADDRESS.CONADDRTYPEDESC FROM (SELECT ROW_NUMBER() OVER (PARTITION BY dooc.offender_booking_sk, dooc.relationship ORDER BY dooc.active_flag DESC, dooc.address_flag DESC, dooc.mis_load_id DESC) AS row_seq_filter, dooc.*, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'NEXTOFKIN' ELSE 'CONTACT' END AS Con_Addr_Type, CASE WHEN dooc.next_of_kin_flag = 'Y' THEN 'Next of Kin' ELSE 'Contact' END AS ConAddrTypeDesc FROM bodimis.dim_offender_other_contacts dooc) DT_OFFENDER_CONTACT_ADDRESS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK (+)) AND (DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IS NULL OR DT_OFFENDER_CONTACT_ADDRESS.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT ACTIVE_FLAG, CONTACT_NAME, RELATIONSHIP, FLAT, PREMISE, STREET, LOCALITY, CITY, COUNTY, COUNTRY, POST_CODE, TEL_NO, EXT_NO, OTHER_CONTACT_SK, CON_ADDR_TYPE, CONADDRTYPEDESC FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "ACTIVE_FLAG",
            "type": "string",
            "display": "Contact Address Active Flag",
            "legacyId": "DP7.DO752",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "CONTACT_NAME",
            "type": "string",
            "display": "Contact Name",
            "legacyId": "DP7.DO747",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "RELATIONSHIP",
            "type": "string",
            "display": "Contact Relationship",
            "legacyId": "DP7.DO748",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "FLAT",
            "type": "string",
            "display": "Contact Address Flat",
            "legacyId": "DP7.DO749",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "PREMISE",
            "type": "string",
            "display": "Contact Address Premise",
            "legacyId": "DP7.DO74a",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "STREET",
            "type": "string",
            "display": "Contact Address Street",
            "legacyId": "DP7.DO74b",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "LOCALITY",
            "type": "string",
            "display": "Contact Address Locality",
            "legacyId": "DP7.DO74c",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "CITY",
            "type": "string",
            "display": "Contact Address City",
            "legacyId": "DP7.DO74d",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "COUNTY",
            "type": "string",
            "display": "Contact Address County",
            "legacyId": "DP7.DO74e",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "COUNTRY",
            "type": "string",
            "display": "Contact Address Country",
            "legacyId": "DP7.DO74f",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "POST_CODE",
            "type": "string",
            "display": "Contact Address Post Code",
            "legacyId": "DP7.DO750",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "TEL_NO",
            "type": "string",
            "display": "Contact Address Telephone Number",
            "legacyId": "DP7.DO753",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "EXT_NO",
            "type": "string",
            "display": "Contact Address Telephone Number Ext No",
            "legacyId": "DP7.DO754",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "OTHER_CONTACT_SK",
            "type": "double",
            "display": "Contact Address ID",
            "legacyId": "DP7.DO758",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "CON_ADDR_TYPE",
            "type": "string",
            "display": "Contact Address Type",
            "legacyId": "DP7.DO755",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "CONADDRTYPEDESC",
            "type": "string",
            "display": "Contact Address Type Description",
            "legacyId": "DP7.DO75a",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP8",
      "name": "Inmate Description",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT TO_CHAR(AT_OFFENDER_BOOKING.HEIGHT_IMPERIAL_FT) || ' Feet ' || TO_CHAR(AT_OFFENDER_BOOKING.HEIGHT_IMPERIAL_IN) || ' Inches' AS HEIGHT_IMPERIAL, TO_CHAR(TRUNC(AT_OFFENDER_BOOKING.HEIGHT_METRIC / 100, 2)) || ' Metres ' AS HEIGHT_METRIC, TO_CHAR(FLOOR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL / 14)) || ' Stone ' || '  ' || TO_CHAR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL - 14 * FLOOR(AT_OFFENDER_BOOKING.WEIGHT_IMPERIAL / 14)) || ' Pounds ' AS WEIGHT_IMPERIAL, TO_CHAR(AT_OFFENDER_BOOKING.WEIGHT_METRIC) || ' Kilos ' AS WEIGHT_METRIC, AT_OFFENDER_BOOKING.HAIR_DESCRIPTION, AT_OFFENDER_BOOKING.LEFT_EYE_COLOUR_DESCRIPTION, AT_OFFENDER_BOOKING.RIGHT_EYE_COLOUR_DESCRIPTION, AT_OFFENDER_BOOKING.BUILD_DESCRIPTION, AT_OFFENDER_BOOKING.FACIAL_SHAPE_DESCRIPTION, AT_OFFENDER_PHYSICAL_MARK.BODY_PART_CODE, AT_OFFENDER_PHYSICAL_MARK.MARK_TYPE, AT_OFFENDER_PHYSICAL_MARK.SIDE_CODE, AT_OFFENDER_PHYSICAL_MARK.PART_ORIENTATION_CODE, AT_OFFENDER_BOOKING.FACIAL_HAIR_DESCRIPTION, AT_OFFENDER_PHYSICAL_MARK.COMMENT_TEXT, AT_OFFENDER_PHYSICAL_MARK.MARK, AT_OFFENDER_PHYSICAL_MARK.PART_ORIENTATION, AT_OFFENDER_PHYSICAL_MARK.SIDE, AT_OFFENDER_PHYSICAL_MARK.ID_MARK_SEQ, AT_OFFENDER_PHYSICAL_MARK.BODY_PART FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_PHYSICAL_MARK AT_OFFENDER_PHYSICAL_MARK WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_PHYSICAL_MARK.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_OFFENDER_BOOKING.BOOKING_SEQ = 1))), dataset_ AS (SELECT HEIGHT_IMPERIAL, HEIGHT_METRIC, WEIGHT_IMPERIAL, WEIGHT_METRIC, HAIR_DESCRIPTION, LEFT_EYE_COLOUR_DESCRIPTION, RIGHT_EYE_COLOUR_DESCRIPTION, BUILD_DESCRIPTION, FACIAL_SHAPE_DESCRIPTION, BODY_PART_CODE, MARK_TYPE, SIDE_CODE, PART_ORIENTATION_CODE, FACIAL_HAIR_DESCRIPTION, COMMENT_TEXT, MARK, PART_ORIENTATION, SIDE, ID_MARK_SEQ, BODY_PART FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "HEIGHT_IMPERIAL",
            "type": "string",
            "display": "Height Imperial",
            "legacyId": "DP8.DO9a",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "HEIGHT_METRIC",
            "type": "string",
            "display": "Height Metric",
            "legacyId": "DP8.DO99",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "WEIGHT_IMPERIAL",
            "type": "string",
            "display": "Weight Imperial",
            "legacyId": "DP8.DO9e",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "WEIGHT_METRIC",
            "type": "string",
            "display": "Weight Metric",
            "legacyId": "DP8.DO9f",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "HAIR_DESCRIPTION",
            "type": "string",
            "display": "Hair Colour",
            "legacyId": "DP8.DOaa",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "LEFT_EYE_COLOUR_DESCRIPTION",
            "type": "string",
            "display": "Left Eye Colour",
            "legacyId": "DP8.DOab",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "RIGHT_EYE_COLOUR_DESCRIPTION",
            "type": "string",
            "display": "Right Eye Colour",
            "legacyId": "DP8.DOac",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "BUILD_DESCRIPTION",
            "type": "string",
            "display": "Build",
            "legacyId": "DP8.DOa6",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "FACIAL_SHAPE_DESCRIPTION",
            "type": "string",
            "display": "Facial Shape",
            "legacyId": "DP8.DOa7",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "BODY_PART_CODE",
            "type": "string",
            "display": "Body Part Code",
            "legacyId": "DP8.DOa1",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "MARK_TYPE",
            "type": "string",
            "display": "Mark Type",
            "legacyId": "DP8.DOa2",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "SIDE_CODE",
            "type": "string",
            "display": "Side Code",
            "legacyId": "DP8.DOa3",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "PART_ORIENTATION_CODE",
            "type": "string",
            "display": "Part Orientation Code",
            "legacyId": "DP8.DOa4",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "FACIAL_HAIR_DESCRIPTION",
            "type": "string",
            "display": "Facial Hair",
            "legacyId": "DP8.DOa5",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Comment Text",
            "legacyId": "DP8.DO4ea",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "MARK",
            "type": "string",
            "display": "Mark Description",
            "legacyId": "DP8.DO6ca",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "PART_ORIENTATION",
            "type": "string",
            "display": "Part Orientation Description",
            "legacyId": "DP8.DO6b6",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "SIDE",
            "type": "string",
            "display": "Side Description",
            "legacyId": "DP8.DO6b7",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "ID_MARK_SEQ",
            "type": "double",
            "display": "Physical Characteristics ID",
            "legacyId": "DP8.DO6da",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "BODY_PART",
            "type": "string",
            "display": "Body Part Description",
            "legacyId": "DP8.DO6b8",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376115/DP9",
      "name": "Finance",
      "description": "MIS Finance",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_DIM_ACCOUNT_CODE_currrent.ACCOUNT_NAME, SUM(AT_FACT_OFF_ACC_CURR_BALANCE.GROSS_BALANCE) AS SUM_OF_CURRENT_ACCOUNT_BALANCE FROM BODIMIS.DIM_ACCOUNT_CODE AT_DIM_ACCOUNT_CODE_currrent, BODIMIS.FACT_OFF_ACC_CURR_BALANCE AT_FACT_OFF_ACC_CURR_BALANCE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.ALIAS_OFFENDER_SK = AT_FACT_OFF_ACC_CURR_BALANCE.ALIAS_OFFENDER_SK AND AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_DIM_ACCOUNT_CODE_currrent.ACCOUNT_CODE_SK = AT_FACT_OFF_ACC_CURR_BALANCE.ACCOUNT_CODE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */))) GROUP BY AT_DIM_ACCOUNT_CODE_currrent.ACCOUNT_NAME), dataset_ AS (SELECT ACCOUNT_NAME, SUM_OF_CURRENT_ACCOUNT_BALANCE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "ACCOUNT_NAME",
            "type": "string",
            "display": "Current Account Name",
            "legacyId": "DP9.DO56",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SUM_OF_CURRENT_ACCOUNT_BALANCE",
            "type": "double",
            "display": "Sum of Current Account Balance",
            "legacyId": "DP9.DO60e",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPa",
      "name": "Sentence Addresses",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DT_OFFENDER_ADDRESSES.ADDRESS_USAGE, DT_OFFENDER_ADDRESSES.ADDRESS_ACTIVE_FLAG, DT_OFFENDER_ADDRESSES.NO_FIXED_ADDRESS_FLAG, DT_OFFENDER_ADDRESSES.FLAT, DT_OFFENDER_ADDRESSES.PREMISE, DT_OFFENDER_ADDRESSES.STREET, DT_OFFENDER_ADDRESSES.LOCALITY, DT_OFFENDER_ADDRESSES.CITY_DESC, DT_OFFENDER_ADDRESSES.COUNTY_DESC, DT_OFFENDER_ADDRESSES.COUNTRY_DESC, DT_OFFENDER_ADDRESSES.POSTAL_CODE, DT_OFFENDER_ADDRESSES.HOME_TEL_NO, DT_OFFENDER_ADDRESSES.HOME_EXT_NO, DT_OFFENDER_ADDRESSES.FLAT || ' '|| DT_OFFENDER_ADDRESSES.PREMISE || ' '|| DT_OFFENDER_ADDRESSES.STREET || ' '|| DT_OFFENDER_ADDRESSES.LOCALITY || ' '|| DT_OFFENDER_ADDRESSES.CITY_DESC || ' '|| DT_OFFENDER_ADDRESSES.POSTAL_CODE || ' '|| DT_OFFENDER_ADDRESSES.COUNTRY_DESC, DT_OFFENDER_ADDRESSES.ADDRESS_ID_NK, DT_OFFENDER_ADDRESSES.USAGE_ACTIVE_FLAG FROM ( select ROW_NUMBER() OVER (PARTITION BY ss.OWNER_ID ORDER BY PRIMARY_FLAG desc, ss.address_active_flag desc, ss.USAGE_ACTIVE_FLAG desc, ss.usages_dttm DESC nulls last) row_seq_filter, ss.* from ( select * from ( select AT_DIM_ADDRESSES.OWNER_ID, AT_DIM_ADDRESS_USAGES.ADDRESS_ID_NK, AT_DIM_ADDRESS_USAGES.ADDRESS_USAGE, AT_DIM_ADDRESS_USAGES.ADDR_USAGE_DESCRIPTION, AT_DIM_ADDRESS_USAGES.ACTIVE_FLAG as USAGE_ACTIVE_FLAG, AT_DIM_ADDRESSES.flat, AT_DIM_ADDRESSES.premise, AT_DIM_ADDRESSES.Street, AT_DIM_ADDRESSES.locality, AT_DIM_ADDRESSES.city_code, AT_DIM_ADDRESSES.city_desc, AT_DIM_ADDRESSES.county_code, AT_DIM_ADDRESSES.county_desc, AT_DIM_ADDRESSES.postal_code, AT_DIM_ADDRESSES.COUNTRY_CODE, AT_DIM_ADDRESSES.country_desc, AT_DIM_ADDRESSES.HOME_TEL_NO, AT_DIM_ADDRESSES.HOME_EXT_NO, AT_DIM_ADDRESSES.NO_FIXED_ADDRESS_FLAG, AT_DIM_ADDRESSES.establishment_sk, AT_DIM_ADDRESSES.PRIMARY_FLAG, AT_DIM_ADDRESSES.active_flag as address_active_flag, AT_DIM_ADDRESS_USAGES.CREATE_DATETIME, AT_DIM_ADDRESS_USAGES.MODIFY_DATETIME, COALESCE(AT_DIM_ADDRESS_USAGES.modify_datetime, AT_DIM_ADDRESS_USAGES.create_datetime) as usages_dttm from BODIMIS.DIM_ADDRESS_USAGES AT_DIM_ADDRESS_USAGES inner join BODIMIS.dim_addresses AT_DIM_ADDRESSES on AT_DIM_ADDRESS_USAGES.address_id_nk = AT_DIM_ADDRESSES.address_id_nk and AT_DIM_ADDRESSES.owner_class='OFF'  ) Addr_usages --where Addr_usages.usages_dttm is not null ) ss ) DT_OFFENDER_ADDRESSES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODISTAGING.REF_OFFENDERS AT_BODISTAG_REF_OFFENDERS WHERE ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /*= #Variable('BOUSER') */ )) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_ID=AT_BODISTAG_REF_OFFENDERS.OFFENDER_ID(+) ) AND ( AT_BODISTAG_REF_OFFENDERS.ROOT_OFFENDER_ID=DT_OFFENDER_ADDRESSES.OWNER_ID(+) ) AND ( ( AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /*= #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */ ) ) AND ( AT_OFFENDER_BOOKING.BOOKING_SEQ=1 ) AND ( DT_OFFENDER_ADDRESSES.USAGE_ACTIVE_FLAG='Y' ) AND ( DT_OFFENDER_ADDRESSES.ADDRESS_ACTIVE_FLAG='Y' ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3376639/DPb",
      "name": "Movements",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_FACT_MOV_EXT.REASON, AT_DIM_DATE_EXT_MOV.DAY_DATE, AT_FACT_MOV_EXT.MOVEMENT_TIME, DT_EXT_MOVE_TO.TYPE_DESCRIPTION_TO, DT_EXT_MOVE_FROM.TYPE_DESCRIPTION_FROM FROM BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_TO, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_TO, 'Establishment' AS Location_Type_To FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_To FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_To FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_To FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_To FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_TO, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_FROM, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_FROM, 'Establishment' AS Location_Type_FROM FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_From FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_From FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_From FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_From FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_FROM, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_FACT_MOV_EXT.TO_LOCATION_SK = DT_EXT_MOVE_TO.SK_ID_TO (+) AND AT_FACT_MOV_EXT.TO_LOCATION_TYPE = DT_EXT_MOVE_TO.LOCATION_TYPE_TO (+)) AND (AT_FACT_MOV_EXT.FROM_LOCATION_SK = DT_EXT_MOVE_FROM.SK_ID_FROM (+) AND AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = DT_EXT_MOVE_FROM.LOCATION_TYPE_FROM (+)) AND ((AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_OFFENDER_BOOKING.BOOKING_SEQ = 1))), dataset_ AS (SELECT REASON, DAY_DATE, MOVEMENT_TIME, TYPE_DESCRIPTION_TO, TYPE_DESCRIPTION_FROM FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "REASON",
            "type": "string",
            "display": "Movement Description (External)",
            "legacyId": "DPb.DO15b",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DPb.DO15c",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Movement Date and Time (External)",
            "legacyId": "DPb.DO3eb",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "TYPE_DESCRIPTION_TO",
            "type": "string",
            "display": "Movement Description (To)",
            "legacyId": "DPb.DO6ff",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "TYPE_DESCRIPTION_FROM",
            "type": "string",
            "display": "Movement Description (From)",
            "legacyId": "DPb.DO700",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPd",
      "name": "Fine Payments",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_DIM_OFFENDER_FINE_PAYMENTS.PAYMENT_SEQ, AT_DIM_OFFENDER_FINE_PAYMENTS.PAYMENT_DATE, SUM(AT_DIM_OFFENDER_FINE_PAYMENTS.PAYMENT_AMOUNT) AS FINE_PAYMENT_AMOUNT, AT_DIM_OFFENDER_FINE_PAYMENTS.COMMENT_TEXT FROM BODIMIS.DIM_OFFENDER_FINE_PAYMENTS AT_DIM_OFFENDER_FINE_PAYMENTS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_DIM_OFFENDER_FINE_PAYMENTS.OFFENDER_BOOKING_SK = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_OFFENDER_BOOKING.BOOKING_SEQ = 1)) GROUP BY AT_DIM_OFFENDER_FINE_PAYMENTS.PAYMENT_SEQ, AT_DIM_OFFENDER_FINE_PAYMENTS.PAYMENT_DATE, AT_DIM_OFFENDER_FINE_PAYMENTS.COMMENT_TEXT), dataset_ AS (SELECT PAYMENT_SEQ, PAYMENT_DATE, FINE_PAYMENT_AMOUNT, COMMENT_TEXT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "PAYMENT_SEQ",
            "type": "double",
            "display": "Fine Payment Sequence",
            "legacyId": "DPd.DO57c",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "PAYMENT_DATE",
            "type": "date",
            "display": "Fine Payment Date",
            "legacyId": "DPd.DO57d",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FINE_PAYMENT_AMOUNT",
            "type": "double",
            "display": "Fine Payment Amount",
            "legacyId": "DPd.DO57e",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Fine Payment Comment Text",
            "legacyId": "DPd.DO57f",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPf",
      "name": "Court Event Dates - Court Case Level",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT * AS NOMS_NUMBER FROM (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_COURT_CASE.COURT_CASE_SK, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION, MIN(DT_SPECIAL_COURT_EVENTS.first_sentenced_date), MIN(DT_SPECIAL_COURT_EVENTS.first_convicted_date), MIN(DT_SPECIAL_COURT_EVENTS.first_remand_date), MIN(DT_SPECIAL_COURT_EVENTS.first_committed_date), MIN(DT_SPECIAL_COURT_EVENTS.first_remand_court), MIN(DT_SPECIAL_COURT_EVENTS.first_convicted_court), MIN(DT_SPECIAL_COURT_EVENTS.first_sentenced_court), MIN(DT_SPECIAL_COURT_EVENTS.first_committed_court), MIN(DT_SPECIAL_COURT_EVENTS.second_remand_date), MIN(DT_SPECIAL_COURT_EVENTS.committed_to_court), MIN(DT_SPECIAL_COURT_EVENTS.first_appeal_court), MIN(DT_SPECIAL_COURT_EVENTS.first_appeal_date), MIN(DT_SPECIAL_COURT_EVENTS.first_bailed_court), MIN(DT_SPECIAL_COURT_EVENTS.first_appeal_result), MIN(DT_SPECIAL_COURT_EVENTS.first_bailed_date), MIN(DT_SPECIAL_COURT_EVENTS.first_sentenced_court), MIN(DT_SPECIAL_COURT_EVENTS.first_sentenced_date) FROM BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_REASON, (SELECT f.offender_booking_sk, f.court_case_sk, MIN(CASE WHEN f.outcome_key = 1 THEN f.event_date END) AS first_remand_date, MIN(CASE WHEN f.outcome_key = 1 THEN f.court_description END) AS first_remand_court, MIN(CASE WHEN f.outcome_key = 1 THEN f.outcome_reason_description END) AS first_remand_result, MIN(CASE WHEN f.outcome_key = 11 THEN f.event_date END) AS second_remand_date, MIN(CASE WHEN f.outcome_key = 11 THEN f.court_description END) AS second_remand_court, MIN(CASE WHEN f.outcome_key = 11 THEN f.outcome_reason_description END) AS second_remand_result, MIN(CASE WHEN f.outcome_key = 2 THEN f.event_date END) AS first_convicted_date, MIN(CASE WHEN f.outcome_key = 2 THEN f.court_description END) AS first_convicted_court, MIN(CASE WHEN f.outcome_key = 2 THEN f.outcome_reason_description END) AS first_convicted_result, MIN(CASE WHEN f.outcome_key = 3 THEN f.event_date END) AS first_sentenced_date, MIN(CASE WHEN f.outcome_key = 3 THEN f.court_description END) AS first_sentenced_court, MIN(CASE WHEN f.outcome_key = 3 THEN f.outcome_reason_description END) AS first_sentenced_result, MIN(CASE WHEN f.outcome_key = 4 THEN f.event_date END) AS first_committed_date, MIN(CASE WHEN f.outcome_key = 4 THEN f.court_description END) AS first_committed_court, MIN(CASE WHEN f.outcome_key = 4 THEN f.outcome_reason_description END) AS first_committed_result, MIN(CASE WHEN f.outcome_key = 4 THEN f.next_date END) AS committed_to_date, MIN(CASE WHEN f.outcome_key = 4 THEN f.next_court END) AS committed_to_court, MIN(CASE WHEN f.outcome_key = 4 THEN f.next_outcome END) AS committed_to_result, MIN(CASE WHEN f.outcome_key = 5 THEN f.event_date END) AS first_appeal_date, MIN(CASE WHEN f.outcome_key = 5 THEN f.court_description END) AS first_appeal_court, MIN(CASE WHEN f.outcome_key = 5 THEN f.outcome_reason_description END) AS first_appeal_result, MIN(CASE WHEN f.outcome_key = 6 THEN f.event_date END) AS first_bailed_date, MIN(CASE WHEN f.outcome_key = 6 THEN f.court_description END) AS first_bailed_court, MIN(CASE WHEN f.outcome_key = 6 THEN f.outcome_reason_description END) AS first_bailed_result FROM (SELECT row_seq, offender_booking_sk, court_case_sk, event_dt AS event_date, court_description, outcome_reason_description, next_date, next_court, next_outcome, CASE WHEN outcome_key = 1 AND row_seq = 2 THEN 11 ELSE outcome_key END AS outcome_key FROM (SELECT oc.*, fce.*, ROW_NUMBER() OVER (PARTITION BY fce.offender_booking_sk, oc.outcome_key, fce.court_case_sk ORDER BY fce.event_time, fce.court_event_nk) AS row_seq FROM (SELECT 1 AS outcome_key, 'Remand Outcome' AS outcome_type, outcome_code FROM ((SELECT '4011', '4012', '4013', '4014', '4015', '4016', '4017', '4020', '4021', '4506', '4529', '4530', '4531', '4532', '4533', '4534', '4535', '4536', '4537', '4538', '4539', '4541', '4542', '4543', '4548', '4549', '4550', '4551', '4552', '4558', '4559', '4560', '4561', '4562', '4563', '4564', '4565', '4587', '4588', '4589', '4504', '4511', '4512', '4513', '4514', '4515', '4516', '4519', '4520', '4521', '4522', '4523', '4524', '4540', '4578', '4579', '4580', '4581' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'4011'\", \"'4012'\", \"'4013'\", \"'4014'\", \"'4015'\", \"'4016'\", \"'4017'\", \"'4020'\", \"'4021'\", \"'4506'\", \"'4529'\", \"'4530'\", \"'4531'\", \"'4532'\", \"'4533'\", \"'4534'\", \"'4535'\", \"'4536'\", \"'4537'\", \"'4538'\", \"'4539'\", \"'4541'\", \"'4542'\", \"'4543'\", \"'4548'\", \"'4549'\", \"'4550'\", \"'4551'\", \"'4552'\", \"'4558'\", \"'4559'\", \"'4560'\", \"'4561'\", \"'4562'\", \"'4563'\", \"'4564'\", \"'4565'\", \"'4587'\", \"'4588'\", \"'4589'\", \"'4504'\", \"'4511'\", \"'4512'\", \"'4513'\", \"'4514'\", \"'4515'\", \"'4516'\", \"'4519'\", \"'4520'\", \"'4521'\", \"'4522'\", \"'4523'\", \"'4524'\", \"'4540'\", \"'4578'\", \"'4579'\", \"'4580'\", \"'4581'\"))) UNION ALL SELECT 2 AS outcome_key, 'Convicted Outcome' AS outcome_type, outcome_code FROM ((SELECT '1002', '1003', '1004', '1005', '1006', '1007', '1008', '1009', '1010', '1011', '1012', '1013', '1014', '1015', '1016', '1017', '1022', '1024', '1025', '1027', '1028', '1029', '1030', '1031', '1032', '1034', '1035', '1036', '1037', '1038', '1039', '1040', '1046', '1049', '1051', '1052', '1054', '1055', '1056', '1057', '1058', '1062', '1063', '1064', '1065', '1066', '1067', '1068', '1070', '1071', '1073', '1074', '1075', '1076', '1077', '1078', '1079', '1080', '1081', '1082', '1083', '1084', '1085', '1086', '1087', '1088', '1089', '1090', '1091', '1092', '1093', '1094', '1096', '1097', '1098', '1099', '1100', '1101', '1102', '1103', '1104', '1105', '1106', '1107', '1108', '1109', '1110', '1111', '1112', '1114', '1115', '1116', '1117', '1118', '1119', '1121', '1501', '1505', '1507', '1508', '1509', '1510', '1511', '1512', '1513', '1514', '2007', '2012', '2015', '2017', '2018', '2023', '2062', '2067', '2505', '3002', '3006', '3007', '3008', '3010', '3011', '3012', '3013', '3014', '3016', '3019', '3020', '3021', '3022', '3025', '3027', '3028', '3029', '3030', '3033', '3034', '3035', '3041', '3042', '3044', '3045', '3047', '3049', '3050', '3051', '3052', '3053', '3054', '3055', '3056', '3058', '3061', '3062', '3063', '3064', '3065', '3066', '3067', '3068', '3069', '3070', '3071', '3072', '3073', '3074', '3075', '3076', '3077', '3079', '3080', '3081', '3082', '3083', '3084', '3085', '3086', '3087', '3088', '3089', '3090', '3091', '3092', '3094', '3095', '3096', '3097', '3098', '3099', '3101', '3102', '3103', '3104', '3105', '3106', '3107', '3108', '3109', '3110', '3111', '3112', '3501', '3502', '3503', '3504', '3508', '3509', '3510', '3512', '4001', '4004', '4005', '4011', '4012', '4013', '4014', '4015', '4016', '4017', '4020', '4021', '4022', '4551', '4552', '4586', '4587', '4588', 'AC', 'FPR', 'G', '1001', '1026', '1043', '1044', '1047', '1050', '1059', '1060', '1061', '1069', '1072', '1503', '1506', '2021', '3001', '3003', '3004', '3005', '3009', '3015', '3017', '3031', '3032', '3036', '3037', '3038', '3039', '3040', '3043', '3046', '3048', '3057', '3059', '3060', '3078', '3093', '3513', '4019', '4511', '4512', '4519', '4520', '4521', '4525', '4527', '4578', '4579', '4580', '4581', '4591', '5001', '5002', '5003', '5004', '5005', '5006', '5008', '5009', '5010', '5012', '5013', '5014', '5015', '5016', '5017', '5018', '5019', '5020' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'1002'\", \"'1003'\", \"'1004'\", \"'1005'\", \"'1006'\", \"'1007'\", \"'1008'\", \"'1009'\", \"'1010'\", \"'1011'\", \"'1012'\", \"'1013'\", \"'1014'\", \"'1015'\", \"'1016'\", \"'1017'\", \"'1022'\", \"'1024'\", \"'1025'\", \"'1027'\", \"'1028'\", \"'1029'\", \"'1030'\", \"'1031'\", \"'1032'\", \"'1034'\", \"'1035'\", \"'1036'\", \"'1037'\", \"'1038'\", \"'1039'\", \"'1040'\", \"'1046'\", \"'1049'\", \"'1051'\", \"'1052'\", \"'1054'\", \"'1055'\", \"'1056'\", \"'1057'\", \"'1058'\", \"'1062'\", \"'1063'\", \"'1064'\", \"'1065'\", \"'1066'\", \"'1067'\", \"'1068'\", \"'1070'\", \"'1071'\", \"'1073'\", \"'1074'\", \"'1075'\", \"'1076'\", \"'1077'\", \"'1078'\", \"'1079'\", \"'1080'\", \"'1081'\", \"'1082'\", \"'1083'\", \"'1084'\", \"'1085'\", \"'1086'\", \"'1087'\", \"'1088'\", \"'1089'\", \"'1090'\", \"'1091'\", \"'1092'\", \"'1093'\", \"'1094'\", \"'1096'\", \"'1097'\", \"'1098'\", \"'1099'\", \"'1100'\", \"'1101'\", \"'1102'\", \"'1103'\", \"'1104'\", \"'1105'\", \"'1106'\", \"'1107'\", \"'1108'\", \"'1109'\", \"'1110'\", \"'1111'\", \"'1112'\", \"'1114'\", \"'1115'\", \"'1116'\", \"'1117'\", \"'1118'\", \"'1119'\", \"'1121'\", \"'1501'\", \"'1505'\", \"'1507'\", \"'1508'\", \"'1509'\", \"'1510'\", \"'1511'\", \"'1512'\", \"'1513'\", \"'1514'\", \"'2007'\", \"'2012'\", \"'2015'\", \"'2017'\", \"'2018'\", \"'2023'\", \"'2062'\", \"'2067'\", \"'2505'\", \"'3002'\", \"'3006'\", \"'3007'\", \"'3008'\", \"'3010'\", \"'3011'\", \"'3012'\", \"'3013'\", \"'3014'\", \"'3016'\", \"'3019'\", \"'3020'\", \"'3021'\", \"'3022'\", \"'3025'\", \"'3027'\", \"'3028'\", \"'3029'\", \"'3030'\", \"'3033'\", \"'3034'\", \"'3035'\", \"'3041'\", \"'3042'\", \"'3044'\", \"'3045'\", \"'3047'\", \"'3049'\", \"'3050'\", \"'3051'\", \"'3052'\", \"'3053'\", \"'3054'\", \"'3055'\", \"'3056'\", \"'3058'\", \"'3061'\", \"'3062'\", \"'3063'\", \"'3064'\", \"'3065'\", \"'3066'\", \"'3067'\", \"'3068'\", \"'3069'\", \"'3070'\", \"'3071'\", \"'3072'\", \"'3073'\", \"'3074'\", \"'3075'\", \"'3076'\", \"'3077'\", \"'3079'\", \"'3080'\", \"'3081'\", \"'3082'\", \"'3083'\", \"'3084'\", \"'3085'\", \"'3086'\", \"'3087'\", \"'3088'\", \"'3089'\", \"'3090'\", \"'3091'\", \"'3092'\", \"'3094'\", \"'3095'\", \"'3096'\", \"'3097'\", \"'3098'\", \"'3099'\", \"'3101'\", \"'3102'\", \"'3103'\", \"'3104'\", \"'3105'\", \"'3106'\", \"'3107'\", \"'3108'\", \"'3109'\", \"'3110'\", \"'3111'\", \"'3112'\", \"'3501'\", \"'3502'\", \"'3503'\", \"'3504'\", \"'3508'\", \"'3509'\", \"'3510'\", \"'3512'\", \"'4001'\", \"'4004'\", \"'4005'\", \"'4011'\", \"'4012'\", \"'4013'\", \"'4014'\", \"'4015'\", \"'4016'\", \"'4017'\", \"'4020'\", \"'4021'\", \"'4022'\", \"'4551'\", \"'4552'\", \"'4586'\", \"'4587'\", \"'4588'\", \"'AC'\", \"'FPR'\", \"'G'\", \"'1001'\", \"'1026'\", \"'1043'\", \"'1044'\", \"'1047'\", \"'1050'\", \"'1059'\", \"'1060'\", \"'1061'\", \"'1069'\", \"'1072'\", \"'1503'\", \"'1506'\", \"'2021'\", \"'3001'\", \"'3003'\", \"'3004'\", \"'3005'\", \"'3009'\", \"'3015'\", \"'3017'\", \"'3031'\", \"'3032'\", \"'3036'\", \"'3037'\", \"'3038'\", \"'3039'\", \"'3040'\", \"'3043'\", \"'3046'\", \"'3048'\", \"'3057'\", \"'3059'\", \"'3060'\", \"'3078'\", \"'3093'\", \"'3513'\", \"'4019'\", \"'4511'\", \"'4512'\", \"'4519'\", \"'4520'\", \"'4521'\", \"'4525'\", \"'4527'\", \"'4578'\", \"'4579'\", \"'4580'\", \"'4581'\", \"'4591'\", \"'5001'\", \"'5002'\", \"'5003'\", \"'5004'\", \"'5005'\", \"'5006'\", \"'5008'\", \"'5009'\", \"'5010'\", \"'5012'\", \"'5013'\", \"'5014'\", \"'5015'\", \"'5016'\", \"'5017'\", \"'5018'\", \"'5019'\", \"'5020'\"))) UNION ALL SELECT 3 AS outcome_key, 'Sentenced Outcome' AS outcome_type, outcome_code FROM ((SELECT '1002', '1003', '1022', '1024', '1073', '1081', '1105', '1106', '1107', '1110', '1111', '1112', '1114', '1121', '1509', '1510', '3006', '1001', '4503' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'1002'\", \"'1003'\", \"'1022'\", \"'1024'\", \"'1073'\", \"'1081'\", \"'1105'\", \"'1106'\", \"'1107'\", \"'1110'\", \"'1111'\", \"'1112'\", \"'1114'\", \"'1121'\", \"'1509'\", \"'1510'\", \"'3006'\", \"'1001'\", \"'4503'\"))) UNION ALL SELECT 4 AS outcome_key, 'Committed Outcome' AS outcome_type, outcome_code FROM ((SELECT '4001', '4014', '4015', '4016', '4017', '4020', '4021', '4558', '4559', '4560', '4561', '4562', '4563', '4564', '4565' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'4001'\", \"'4014'\", \"'4015'\", \"'4016'\", \"'4017'\", \"'4020'\", \"'4021'\", \"'4558'\", \"'4559'\", \"'4560'\", \"'4561'\", \"'4562'\", \"'4563'\", \"'4564'\", \"'4565'\"))) UNION ALL SELECT 5 AS outcome_key, 'Appeal Outcome' AS outcome_type, outcome_code FROM ((SELECT '1046', '3044', '3045', '4534', '3093', '3513' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'1046'\", \"'3044'\", \"'3045'\", \"'4534'\", \"'3093'\", \"'3513'\"))) UNION ALL SELECT 6 AS outcome_key, 'Bailed Outcome' AS outcome_type, outcome_code FROM ((SELECT '4011', '4013', '4014', '4015', '4017', '4529', '4530', '4533', '4552', '4558', '4559', '4561', '4587', '4589' FROM dual) UNPIVOT(outcome_code FOR value_type IN (\"'4011'\", \"'4013'\", \"'4014'\", \"'4015'\", \"'4017'\", \"'4529'\", \"'4530'\", \"'4533'\", \"'4552'\", \"'4558'\", \"'4559'\", \"'4561'\", \"'4587'\", \"'4589'\")))) oc RIGHT OUTER JOIN (SELECT f.*, d.day_date AS event_dt, dc.court_description, dor.outcome_reason_description, LEAD(d.day_date) OVER (PARTITION BY f.offender_booking_sk, f.court_case_sk ORDER BY f.event_time, f.court_event_nk) AS next_date, LEAD(dc.court_description) OVER (PARTITION BY f.offender_booking_sk, f.court_case_sk ORDER BY f.event_time, f.court_event_nk) AS next_court, LEAD(dor.outcome_reason_description) OVER (PARTITION BY f.offender_booking_sk, f.court_case_sk ORDER BY f.event_time, f.court_event_nk) AS next_outcome FROM bodimis.fact_court_event f INNER JOIN bodimis.dim_date d ON f.event_date_sk = d.date_sk INNER JOIN bodimis.dim_court dc ON f.court_sk = dc.court_sk LEFT OUTER JOIN bodimis.dim_outcome_reason dor ON f.outcome = dor.outcome_reason_nk WHERE f.court_case_sk > 0) fce ON fce.outcome = oc.outcome_code) WHERE (row_seq = 1 OR (row_seq = 2 AND outcome_key = 1))) f GROUP BY f.offender_booking_sk, f.court_case_sk) DT_SPECIAL_COURT_EVENTS, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_COURT_CASE.OUTCOME_REASON_SK = AT_DIM_OUTCOME_REASON.OUTCOME_REASON_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = DT_SPECIAL_COURT_EVENTS.COURT_CASE_SK (+) AND AT_COURT_CASE.OFFENDER_BOOKING_SK = DT_SPECIAL_COURT_EVENTS.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active') AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */))) GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_COURT_CASE.COURT_CASE_SK, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION) _query0 FULL OUTER JOIN (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_COURT_CASE.COURT_CASE_SK, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION, MAX(CASE WHEN AT_EVENT_DATE.DAY_DATE < CURRENT_TIMESTAMP THEN AT_EVENT_DATE.DAY_DATE ELSE NULL END), MAX(CASE WHEN AT_EVENT_DATE.DAY_DATE >= CURRENT_TIMESTAMP THEN AT_EVENT_DATE.DAY_DATE ELSE NULL END) FROM BODIMIS.DIM_DATE AT_EVENT_DATE, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_REASON, BODIMIS.FACT_COURT_EVENT AT_FACT_COURT_EVENT, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_EVENT.EVENT_DATE_SK = AT_EVENT_DATE.DATE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_EVENT.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_COURT_CASE.OUTCOME_REASON_SK = AT_DIM_OUTCOME_REASON.OUTCOME_REASON_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active') AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */))) GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_COURT_CASE.COURT_CASE_SK, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION) _query1 ON _query0.OFFENDER_ID_DISPLAY = _query1.OFFENDER_ID_DISPLAY), dataset_ AS (SELECT NOMS_NUMBER FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "NOMS_NUMBER",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPf.DO10076",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP10",
      "name": "MIS Load",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP10.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP12",
      "name": "HDC Details",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_ELIGIBILITY_DATE.DAY_DATE, CASE WHEN AT_DIM_ASSESSMENT_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_ASSESSMENT_DATE.DAY_DATE END AS HDC_CHECKS_DONE_DATE, CASE WHEN AT_CURFEW_ASSESSMENT.PASSED_FLAG = 'Y' THEN 'YES' WHEN AT_CURFEW_ASSESSMENT.PASSED_FLAG = 'N' THEN 'NO' END AS HDC_PASSED_FLAG, AT_DIM_ARD_CRD_DATE.DAY_DATE AS HDC_CURFEW_CONDITION_EXPIRY_32, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC, CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END AS HDC_DECISION_DATE, CASE WHEN AT_CURFEW_ASSESSMENT.REVIEW_FLAG = 'Y' THEN 'YES' WHEN AT_CURFEW_ASSESSMENT.REVIEW_FLAG = 'N' THEN 'NO' END AS HDC_REVIEW_FLAG, AT_CURFEW_ASSESSMENT.REVIEW_REASON, AT_CURFEW_ASSESSMENT.CURFEW_SEQ FROM BODIMIS.DIM_DATE AT_DIM_ELIGIBILITY_DATE, BODIMIS.DIM_DATE AT_DIM_ASSESSMENT_DATE, BODIMIS.DIM_DATE AT_DIM_ARD_CRD_DATE, BODIMIS.DIM_DATE AT_DIM_DECISION_DATE, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.ASSESSMENT_DATE_SK = AT_DIM_ASSESSMENT_DATE.DATE_SK (+)) AND (AT_CURFEW_ASSESSMENT.ELIGIBILITY_DATE_SK = AT_DIM_ELIGIBILITY_DATE.DATE_SK (+)) AND (AT_CURFEW_ASSESSMENT.ARD_CRD_DATE_SK = AT_DIM_ARD_CRD_DATE.DATE_SK (+)) AND (AT_CURFEW_ASSESSMENT.DECISION_DATE_SK = AT_DIM_DECISION_DATE.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND ((AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_OFFENDER_BOOKING.BOOKING_SEQ = 1))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, DAY_DATE, HDC_CHECKS_DONE_DATE, HDC_PASSED_FLAG, HDC_CURFEW_CONDITION_EXPIRY_32, HDC_ASSMENT_APP_STATUS_DESC, HDC_DECISION_DATE, HDC_REVIEW_FLAG, REVIEW_REASON, CURFEW_SEQ FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP12.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DAY_DATE",
            "type": "date",
            "display": "HDC Curfew Eligibility Date",
            "legacyId": "DP12.DO549",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "HDC_CHECKS_DONE_DATE",
            "type": "date",
            "display": "HDC Checks Done Date",
            "legacyId": "DP12.DO54a",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "HDC_PASSED_FLAG",
            "type": "string",
            "display": "HDC Passed Flag",
            "legacyId": "DP12.DO3ad",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "HDC_CURFEW_CONDITION_EXPIRY_32",
            "type": "date",
            "display": "HDC Curfew Condition Expiry Date",
            "legacyId": "DP12.DO58",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "HDC_ASSMENT_APP_STATUS_DESC",
            "type": "string",
            "display": "HDC Status",
            "legacyId": "DP12.DO54",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "HDC_DECISION_DATE",
            "type": "date",
            "display": "HDC Decision Date",
            "legacyId": "DP12.DO3b0",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "HDC_REVIEW_FLAG",
            "type": "string",
            "display": "HDC Review Flag",
            "legacyId": "DP12.DO3ae",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "REVIEW_REASON",
            "type": "string",
            "display": "HDC Review Reason",
            "legacyId": "DP12.DO3af",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "CURFEW_SEQ",
            "type": "string",
            "display": "HDC Curfew Sequence",
            "legacyId": "DP12.DO548",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP13",
      "name": "Court Case Conditions",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_DIM_COMMUNITY_CONDITIONS.DESCRIPTION, AT_FACT_OFF_SENT_COND.LENGTH, AT_FACT_OFF_SENT_COND.LENGTH_UNIT, AT_FACT_OFF_SENT_COND.CONDITION_RECOMMENDED_FLAG, AT_FACT_OFF_SENT_COND.START_DATE, AT_DIM_SCC_COND_STATUS.DESCRIPTION AS CONDITION_STATUS, AT_FACT_OFF_SENT_COND.LONG_COMMENT_TEXT, CASE WHEN NOT AT_DIM_SCC_COND_CURFEW.DESCRIPTION IS NULL THEN AT_DIM_SCC_COND_CURFEW.DESCRIPTION WHEN NOT AT_DIM_SCC_COND_EX.DESCRIPTION IS NULL THEN AT_DIM_SCC_COND_EX.DESCRIPTION WHEN NOT AT_DIM_SCC_COND_MH_PROV.DESCRIPTION IS NULL THEN AT_DIM_SCC_COND_MH_PROV.DESCRIPTION WHEN NOT AT_DIM_SCC_COND_ATPROV.DESCRIPTION IS NULL THEN AT_DIM_SCC_COND_ATPROV.DESCRIPTION WHEN NOT AT_DIM_SCC_COND_ACPROV.DESCRIPTION IS NULL THEN AT_DIM_SCC_COND_ACPROV.DESCRIPTION WHEN NOT AT_DIM_SCC_COND_REVIEW.DESCRIPTION IS NULL THEN AT_DIM_SCC_COND_REVIEW.DESCRIPTION WHEN NOT AT_DIM_SCC_COND_ACT.DESCRIPTION IS NULL THEN AT_DIM_SCC_COND_ACT.DESCRIPTION WHEN NOT AT_FS_PROG_SERVICE.DESCRIPTION IS NULL THEN AT_FS_PROG_SERVICE.DESCRIPTION END AS DETAIL_DESCRIPTION, AT_FACT_OFF_SENT_COND.COMMENT_TEXT, AT_FACT_OFF_SENT_COND.OFFENDER_SENT_CONDITION_ID_NK FROM BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.DIM_COMMUNITY_CONDITIONS AT_DIM_COMMUNITY_CONDITIONS, BODIMIS.FACT_OFFENDER_SENT_CONDITIONS AT_FACT_OFF_SENT_COND, BODIMIS.DIM_SENT_CONDITION_CODES AT_DIM_SCC_COND_STATUS, BODIMIS.DIM_PROGRAMME_SERVICE AT_FS_PROG_SERVICE, BODIMIS.DIM_SENT_CONDITION_CODES AT_DIM_SCC_COND_CURFEW, BODIMIS.DIM_SENT_CONDITION_CODES AT_DIM_SCC_COND_EX, BODIMIS.DIM_SENT_CONDITION_CODES AT_DIM_SCC_COND_MH_PROV, BODIMIS.DIM_SENT_CONDITION_CODES AT_DIM_SCC_COND_REVIEW, BODIMIS.DIM_SENT_CONDITION_CODES AT_DIM_SCC_COND_ACPROV, BODIMIS.DIM_SENT_CONDITION_CODES AT_DIM_SCC_COND_ATPROV, BODIMIS.DIM_SENT_CONDITION_CODES AT_DIM_SCC_COND_ACT, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_OFF_SENT_COND.PROGRAM_ID = AT_FS_PROG_SERVICE.PROGRAM_ID (+)) AND (AT_DIM_COMMUNITY_CONDITIONS.COMM_CONDITION_SK (+) = AT_FACT_OFF_SENT_COND.COMM_CONDITION_SK) AND (AT_DIM_SCC_COND_CURFEW.DOMAIN (+) = 'COND_CURFEW') AND (AT_DIM_SCC_COND_EX.DOMAIN (+) = 'COND_EXCLUDE') AND (AT_DIM_SCC_COND_MH_PROV.DOMAIN (+) = 'COND_MH_PROV') AND (AT_DIM_SCC_COND_ATPROV.DOMAIN (+) = 'COND_AT_PROV') AND (AT_DIM_SCC_COND_REVIEW.DOMAIN (+) = 'COND_REVIEW') AND (AT_DIM_SCC_COND_STATUS.DOMAIN (+) = 'ACTIVE_TYPE') AND (AT_DIM_SCC_COND_ACPROV.DOMAIN (+) = 'COND_AC_PROV') AND (AT_DIM_SCC_COND_ACT.DOMAIN (+) = 'COND_ACT') AND (AT_FACT_OFF_SENT_COND.COND_ACT_TYPE = AT_DIM_SCC_COND_ACT.CODE (+)) AND (AT_DIM_SCC_COND_MH_PROV.CODE (+) = AT_FACT_OFF_SENT_COND.MENTAL_HEALTH_PROVIDER) AND (AT_DIM_SCC_COND_EX.CODE (+) = AT_FACT_OFF_SENT_COND.EXCLUSION_CODE) AND (AT_FACT_OFF_SENT_COND.ATTENDANCE_CENTRE = AT_DIM_SCC_COND_ACPROV.CODE (+)) AND (AT_DIM_SCC_COND_CURFEW.CODE (+) = AT_FACT_OFF_SENT_COND.CURFEW_PROVIDER) AND (AT_FACT_OFF_SENT_COND.CONDITION_STATUS = AT_DIM_SCC_COND_STATUS.CODE (+)) AND (AT_FACT_OFF_SENT_COND.REVIEW_CODE = AT_DIM_SCC_COND_REVIEW.CODE (+)) AND (AT_FACT_OFF_SENT_COND.ALCOHOL_TREATMENT_PROVIDER = AT_DIM_SCC_COND_ATPROV.CODE (+)) AND (AT_FACT_SENTENCE.OFFENDER_BOOKING_SK = AT_FACT_OFF_SENT_COND.OFFENDER_BOOKING_SK (+) AND AT_FACT_SENTENCE.SENTENCE_SEQ_NK = AT_FACT_OFF_SENT_COND.SENTENCE_SEQ (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_SENTENCE.COURT_CASE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND NOT AT_DIM_COMMUNITY_CONDITIONS.DESCRIPTION IS NULL)), dataset_ AS (SELECT DESCRIPTION, LENGTH, LENGTH_UNIT, CONDITION_RECOMMENDED_FLAG, START_DATE, CONDITION_STATUS, LONG_COMMENT_TEXT, DETAIL_DESCRIPTION, COMMENT_TEXT, OFFENDER_SENT_CONDITION_ID_NK FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Condition Requirement",
            "legacyId": "DP13.DO4f5",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LENGTH",
            "type": "double",
            "display": "Condition Length",
            "legacyId": "DP13.DO4f6",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "LENGTH_UNIT",
            "type": "string",
            "display": "Condition Unit",
            "legacyId": "DP13.DO4f7",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CONDITION_RECOMMENDED_FLAG",
            "type": "string",
            "display": "Condition Recommended",
            "legacyId": "DP13.DO500",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "START_DATE",
            "type": "date",
            "display": "Condition Start Date",
            "legacyId": "DP13.DO4ff",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "CONDITION_STATUS",
            "type": "string",
            "display": "Condition Status",
            "legacyId": "DP13.DO501",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "LONG_COMMENT_TEXT",
            "type": "string",
            "display": "Condition Comment",
            "legacyId": "DP13.DO4f9",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "DETAIL_DESCRIPTION",
            "type": "string",
            "display": "Detail Description",
            "legacyId": "DP13.DO4f4",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "Details Comment",
            "legacyId": "DP13.DO4f8",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "OFFENDER_SENT_CONDITION_ID_NK",
            "type": "double",
            "display": "Condition ID",
            "legacyId": "DP13.DO503",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP14",
      "name": "Fine Amounts",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT SUM(AT_FACT_SENTENCE.FINE_AMOUNT) AS FINE_AMOUNT_, AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION, AT_COURT_CASE.COURT_CASE_SK, AT_DIM_SENTENCE_TYPE.SENTENCE_DESCRIPTION, AT_DIM_SENTENCE_TYPE.SENTENCE_CATEGORY_NK, AT_DIM_SENTENCE_TYPE.SENTENCE_CODE_NK, AT_DIM_SENTENCE_TYPE.SENTENCE_TYPE FROM BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_REASON, BODIMIS.DIM_SENTENCE_TYPE AT_DIM_SENTENCE_TYPE, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_COURT_CASE AT_COURT_CASE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_COURT_CASE.OUTCOME_REASON_SK = AT_DIM_OUTCOME_REASON.OUTCOME_REASON_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_SENTENCE.COURT_CASE_SK (+)) AND (AT_FACT_SENTENCE.SENTENCE_TYPE_SK = AT_DIM_SENTENCE_TYPE.SENTENCE_TYPE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active')) GROUP BY AT_COURT_CASE.COURT_CASE_NUMBER, AT_DIM_OUTCOME_REASON.OUTCOME_REASON_DESCRIPTION, AT_COURT_CASE.COURT_CASE_SK, AT_DIM_SENTENCE_TYPE.SENTENCE_DESCRIPTION, AT_DIM_SENTENCE_TYPE.SENTENCE_CATEGORY_NK, AT_DIM_SENTENCE_TYPE.SENTENCE_CODE_NK, AT_DIM_SENTENCE_TYPE.SENTENCE_TYPE HAVING SUM(AT_FACT_SENTENCE.FINE_AMOUNT) > 0), dataset_ AS (SELECT FINE_AMOUNT_, COURT_CASE_NUMBER, OUTCOME_REASON_DESCRIPTION, COURT_CASE_SK, SENTENCE_DESCRIPTION, SENTENCE_CATEGORY_NK, SENTENCE_CODE_NK, SENTENCE_TYPE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "FINE_AMOUNT_",
            "type": "double",
            "display": "Fine Amount (Non Aggregated)",
            "legacyId": "DP14.DO58c",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "COURT_CASE_NUMBER",
            "type": "string",
            "display": "Court Case Number",
            "legacyId": "DP14.DO51",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OUTCOME_REASON_DESCRIPTION",
            "type": "string",
            "display": "Court Case Outcome",
            "legacyId": "DP14.DO52",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "COURT_CASE_SK",
            "type": "double",
            "display": "Court Case Internal Key",
            "legacyId": "DP14.DO147",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "SENTENCE_DESCRIPTION",
            "type": "string",
            "display": "Sentence Description",
            "legacyId": "DP14.DO14f",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "SENTENCE_CATEGORY_NK",
            "type": "string",
            "display": "Sentence Category",
            "legacyId": "DP14.DO1b1",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "SENTENCE_CODE_NK",
            "type": "string",
            "display": "Sentence Code",
            "legacyId": "DP14.DO1b0",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "SENTENCE_TYPE",
            "type": "string",
            "display": "Sentence Type",
            "legacyId": "DP14.DO14e",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP1e",
      "name": "HDC Refusal Reasons",
      "description": "MIS Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_ELIGIBILITY_DATE.DAY_DATE, CASE WHEN AT_DIM_ASSESSMENT_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_ASSESSMENT_DATE.DAY_DATE END AS HDC_CHECKS_DONE_DATE, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC, CASE WHEN AT_DIM_DECISION_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_DECISION_DATE.DAY_DATE END AS HDC_DECISION_DATE, AT_CURFEW_ASSESSMENT.CURFEW_SEQ, AT_DIM_HDC_STATUS_REASON.HDC_STATUS_REASON FROM BODIMIS.DIM_DATE AT_DIM_ELIGIBILITY_DATE, BODIMIS.DIM_DATE AT_DIM_ASSESSMENT_DATE, BODIMIS.DIM_DATE AT_DIM_DECISION_DATE, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_HDC_STATUS_REASON AT_DIM_HDC_STATUS_REASON, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.ASSESSMENT_DATE_SK = AT_DIM_ASSESSMENT_DATE.DATE_SK (+)) AND (AT_CURFEW_ASSESSMENT.ELIGIBILITY_DATE_SK = AT_DIM_ELIGIBILITY_DATE.DATE_SK (+)) AND (AT_CURFEW_ASSESSMENT.DECISION_DATE_SK = AT_DIM_DECISION_DATE.DATE_SK) AND (AT_CURFEW_ASSESSMENT.OFFENDER_CURFEW_ID = AT_DIM_HDC_STATUS_REASON.OFFENDER_CURFEW_ID (+)) AND (AT_DIM_HDC_STATUS_REASON.HDC_STATUS_TYPE = 'Refusal') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND ((AT_OFFENDER_BOOKING.BOOKING_SEQ = 1) AND (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, DAY_DATE, HDC_CHECKS_DONE_DATE, HDC_ASSMENT_APP_STATUS_DESC, HDC_DECISION_DATE, CURFEW_SEQ, HDC_STATUS_REASON FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP1e.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DAY_DATE",
            "type": "date",
            "display": "HDC Curfew Eligibility Date",
            "legacyId": "DP1e.DO549",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "HDC_CHECKS_DONE_DATE",
            "type": "date",
            "display": "HDC Checks Done Date",
            "legacyId": "DP1e.DO54a",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "HDC_ASSMENT_APP_STATUS_DESC",
            "type": "string",
            "display": "HDC Status",
            "legacyId": "DP1e.DO54",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "HDC_DECISION_DATE",
            "type": "date",
            "display": "HDC Decision Date",
            "legacyId": "DP1e.DO3b0",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "CURFEW_SEQ",
            "type": "string",
            "display": "HDC Curfew Sequence",
            "legacyId": "DP1e.DO548",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "HDC_STATUS_REASON",
            "type": "string",
            "display": "Reasons for Refusal",
            "legacyId": "DP1e.DO5b",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DP1f",
      "name": "Languages",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_LANGUAGE.LANGUAGE_DESC, CASE WHEN AT_OFFENDER_LANGUAGE.language_type_nk = 'PRIM' THEN 'Primary' WHEN AT_OFFENDER_LANGUAGE.language_type_nk = 'SEC' THEN 'Secondary' WHEN AT_OFFENDER_LANGUAGE.language_type_nk = 'PREF_SPEAK' THEN 'Preferred Spoken' WHEN AT_OFFENDER_LANGUAGE.language_type_nk = 'PREF_WRITE' THEN 'Preferred Written' END AS LANGUAGE_TYPE_DESCRIPTION, AT_OFFENDER_LANGUAGE.READING_SKILL_DESC, AT_OFFENDER_LANGUAGE.WRITING_SKILL_DESC, AT_OFFENDER_LANGUAGE.SPEAKING_SKILL_DESC, AT_OFFENDER_LANGUAGE.NUMERACY_SKILL_DESC, AT_OFFENDER_LANGUAGE.INTERPRETER_REQUESTED_FLAG, AT_OFFENDER_LANGUAGE.COMMENT_TEXT FROM BODIMIS.DIM_OFFENDER_LANGUAGE AT_OFFENDER_LANGUAGE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_LANGUAGE.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND ((AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_OFFENDER_BOOKING.BOOKING_SEQ = 1))), dataset_ AS (SELECT LANGUAGE_DESC, LANGUAGE_TYPE_DESCRIPTION, READING_SKILL_DESC, WRITING_SKILL_DESC, SPEAKING_SKILL_DESC, NUMERACY_SKILL_DESC, INTERPRETER_REQUESTED_FLAG, COMMENT_TEXT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "LANGUAGE_DESC",
            "type": "string",
            "display": "Language Description",
            "legacyId": "DP1f.DOac5",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LANGUAGE_TYPE_DESCRIPTION",
            "type": "string",
            "display": "Language Type Description",
            "legacyId": "DP1f.DOace",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "READING_SKILL_DESC",
            "type": "string",
            "display": "Reading Skill Description",
            "legacyId": "DP1f.DOac6",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "WRITING_SKILL_DESC",
            "type": "string",
            "display": "Writing Skill Description",
            "legacyId": "DP1f.DOac7",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "SPEAKING_SKILL_DESC",
            "type": "string",
            "display": "Speaking Skill Description",
            "legacyId": "DP1f.DOac8",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "NUMERACY_SKILL_DESC",
            "type": "string",
            "display": "Numeracy Skill Description",
            "legacyId": "DP1f.DOac9",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "INTERPRETER_REQUESTED_FLAG",
            "type": "string",
            "display": "Interpreter Requested Flag",
            "legacyId": "DP1f.DOaca",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "COMMENT_TEXT",
            "type": "string",
            "display": "English Comprehension Comment",
            "legacyId": "DP1f.DOacb",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375377/DP21",
      "name": "Adjudications",
      "description": "MIS Incidents",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, DT_OFFENDER_ADJUDICATION.REPORT_DATE, DT_OFFENDER_ADJUDICATION.AGENCY_INCIDENT_ID_NK, DT_OFFENDER_ADJUDICATION.OIC_INCIDENT_ID, AT_ADJUDICATION_ESTAB.ESTABLISHMENT_CODE_NK, AT_DIM_OIC_OFFENCE_CHARGE.OIC_OFFENCE_CODE, AT_DIM_OIC_OFFENCE_CHARGE.DESCRIPTION, AT_FACT_INCIDENT_CHARGE_RESULT.FINDING_CODE, AT_INCIDENT_SANCTION.DESCRIPTION AS SANCTION_DESCRIPTION, BODIMIS.FACT_INCIDENT_SANCTION.STATUS, BODIMIS.FACT_INCIDENT_SANCTION.COMPENSATION_AMOUNT, BODIMIS.FACT_INCIDENT_SANCTION.SANCTION_MONTHS, BODIMIS.FACT_INCIDENT_SANCTION.SANCTION_DAYS FROM BODIMIS.FACT_INCIDENT_CHARGE_RESULT AT_FACT_INCIDENT_CHARGE_RESULT, BODIMIS.DIM_REFERENCE_CODES AT_INCIDENT_SANCTION, BODIMIS.DIM_ESTABLISHMENT AT_ADJUDICATION_ESTAB, BODIMIS.DIM_OIC_OFFENCE AT_DIM_OIC_OFFENCE_CHARGE, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, (SELECT a.oic_incident_id, c.offender_booking_sk, c.agency_incident_id_nk, c.charge_seq_nk, c.oic_offence_sk, a.oic_hearing_id_nk, a.party_seq_nk, a.establishment_sk, c.report_date, a.oic_hearing_type, a.notification_charge_date_sk FROM bodimis.fact_incident_charge c LEFT OUTER JOIN bodimis.fact_offender_adjudication a ON c.agency_incident_id_nk = a.agency_incident_id_nk AND c.offender_booking_sk = a.offender_booking_sk) DT_OFFENDER_ADJUDICATION, BODIMIS.FACT_INCIDENT_SANCTION WHERE (AT_DIM_OIC_OFFENCE_CHARGE.OIC_OFFENCE_SK = DT_OFFENDER_ADJUDICATION.OIC_OFFENCE_SK) AND (DT_OFFENDER_ADJUDICATION.OFFENDER_BOOKING_SK = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_ADJUDICATION_ESTAB.ESTABLISHMENT_SK (+) = DT_OFFENDER_ADJUDICATION.ESTABLISHMENT_SK) AND (DT_OFFENDER_ADJUDICATION.AGENCY_INCIDENT_ID_NK = AT_FACT_INCIDENT_CHARGE_RESULT.AGENCY_INCIDENT_ID (+) AND DT_OFFENDER_ADJUDICATION.OIC_HEARING_ID_NK = AT_FACT_INCIDENT_CHARGE_RESULT.OIC_HEARING_ID_NK (+) AND DT_OFFENDER_ADJUDICATION.OFFENDER_BOOKING_SK = AT_FACT_INCIDENT_CHARGE_RESULT.OFFENDER_BOOKING_SK (+) AND DT_OFFENDER_ADJUDICATION.CHARGE_SEQ_NK = AT_FACT_INCIDENT_CHARGE_RESULT.CHARGE_SEQ (+)) AND (AT_FACT_INCIDENT_CHARGE_RESULT.OIC_HEARING_ID_NK = BODIMIS.FACT_INCIDENT_SANCTION.OIC_HEARING_ID (+) AND AT_FACT_INCIDENT_CHARGE_RESULT.RESULT_SEQ_NK = BODIMIS.FACT_INCIDENT_SANCTION.RESULT_SEQ (+)) AND (AT_INCIDENT_SANCTION.CODE (+) = BODIMIS.FACT_INCIDENT_SANCTION.OIC_SANCTION_CODE) AND (AT_INCIDENT_SANCTION.CODE_DOMAIN (+) = 'OIC_SANCT') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY = (SELECT PRISONER_NUMBER FROM prompt_ /* = #Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1) */)) AND (AT_OFFENDER_BOOKING.BOOKING_SEQ = 1))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, REPORT_DATE, AGENCY_INCIDENT_ID_NK, OIC_INCIDENT_ID, ESTABLISHMENT_CODE_NK, OIC_OFFENCE_CODE, DESCRIPTION, FINDING_CODE, SANCTION_DESCRIPTION, STATUS, COMPENSATION_AMOUNT, SANCTION_MONTHS, SANCTION_DAYS FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "prisoner_number",
          "filterType": "text",
          "reportFieldType": "string",
          "display": "Enter NOMS Number",
          "description": "@Prompt('Enter NOMS Number',,,mono,free,Not_Persistent,User:1)",
          "mandatory": "true"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP21.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "REPORT_DATE",
            "type": "date",
            "display": "Incident Reported Date",
            "legacyId": "DP21.DO751",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "AGENCY_INCIDENT_ID_NK",
            "type": "double",
            "display": "Agency Incident ID",
            "legacyId": "DP21.DO759",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "OIC_INCIDENT_ID",
            "type": "double",
            "display": "OIC Incident ID",
            "legacyId": "DP21.DO75a",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Adjudication Establishment Code",
            "legacyId": "DP21.DO6c1",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "OIC_OFFENCE_CODE",
            "type": "string",
            "display": "Charge Code",
            "legacyId": "DP21.DO282",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Charge Description",
            "legacyId": "DP21.DO26d",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "FINDING_CODE",
            "type": "string",
            "display": "Hearing Finding",
            "legacyId": "DP21.DO26e",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "SANCTION_DESCRIPTION",
            "type": "string",
            "display": "Sanction Description",
            "legacyId": "DP21.DO764",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "STATUS",
            "type": "string",
            "display": "Sanction Status",
            "legacyId": "DP21.DO762",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "COMPENSATION_AMOUNT",
            "type": "double",
            "display": "Sanction Compensation Amount",
            "legacyId": "DP21.DO760",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "SANCTION_MONTHS",
            "type": "double",
            "display": "Sanction Months",
            "legacyId": "DP21.DO75f",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "SANCTION_DAYS",
            "type": "double",
            "display": "Sanction Days",
            "legacyId": "DP21.DO761",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "197224.RS",
      "name": "Personal Description",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP5",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE SENTENCE_DATES_CURRENT_FLAG = 'Y')"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:DPF_DO224",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          }
        ]
      }
    },
    {
      "id": "197804.RS",
      "name": "Case and Case Offences",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DPf",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-section",
        "field": [
          {
            "name": "$ref:PAYMENT_SEQ",
            "display": "Fine Payment Sequence",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPd.DO57c"
          },
          {
            "name": "$ref:PAYMENT_DATE",
            "display": "Fine Payment Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPd.DO57d"
          },
          {
            "name": "$ref:FINE_PAYMENT_AMOUNT",
            "display": "Fine Payment Amount",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DPd.DO57e"
          },
          {
            "name": "$ref:COMMENT_TEXT",
            "display": "Fine Payment Comment Text",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPd.DO57f"
          }
        ]
      }
    },
    {
      "id": "147976.RS",
      "name": "Sentence History",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP5",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-section",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOde"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "198176.RS",
      "name": "Personal Details",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ALIAS_OR_WORKING_NAME_ = 'Alias')"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOde"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "146665.RS",
      "name": "Movements",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DPb",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOde"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "146825.RS",
      "name": "Financial Details",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376115/DP9",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOde"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "195029.RS",
      "name": "HDC Details",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP12",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-section",
        "field": [
          {
            "name": "$ref:HDC_ELIGIBILITY_DATE_",
            "display": "HDC Eligibility Date (Historic)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO2f6"
          },
          {
            "name": "$ref:HDC_AD_",
            "display": "HDC AD (Approved Date) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO2f8"
          },
          {
            "name": "$ref:CRD_",
            "display": "CRD (Conditional Release Date) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO30a"
          },
          {
            "name": "$ref:SED_",
            "display": "SED (Sentence End Date) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO302"
          },
          {
            "name": "$ref:PED_",
            "display": "PED (Parole Eligibility Date) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO2fc"
          },
          {
            "name": "$ref:APD_",
            "display": "APD (Actual Parole Date) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO2fe"
          },
          {
            "name": "$ref:LED_",
            "display": "LED (Licence Expiry Date ) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO316"
          },
          {
            "name": "$ref:PRRD_",
            "display": "PRRD (Post Recall Release Date) (Historic)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO89"
          },
          {
            "name": "$ref:NPD_",
            "display": "NPD (Non Parole Date) (HIstorical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO300"
          },
          {
            "name": "$ref:ETD_",
            "display": "ETD (Earliest Transfer Date) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO306"
          },
          {
            "name": "$ref:MTD_HISTORICAL",
            "display": "MTD (Mid Term Date) (Historical",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO304"
          },
          {
            "name": "$ref:LTD_",
            "display": "LTD (Latest Transfer date) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO308"
          },
          {
            "name": "$ref:ARD_",
            "display": "ARD (Approved Release Date) (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO30d"
          },
          {
            "name": "$ref:TARIFF_DATE_",
            "display": "Tariff Date (Historical)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DO3b2"
          }
        ]
      }
    },
    {
      "id": "194652.RS",
      "name": "Court Case Licence",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP13",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-section",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOde"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    },
    {
      "id": "199497.RS",
      "name": "Languages",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP2",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:COMMENT_TEXT",
            "display": "English Comprehension Comment",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP1f.DOacb"
          }
        ]
      }
    },
    {
      "id": "200145.RS",
      "name": "Adjudications",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP21",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO7b"
          },
          {
            "name": "$ref:DATE_OF_BIRTH",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO85"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_CODE",
            "display": "Main Legal Status Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOde"
          },
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO77"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOa9"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expecting ). Line 1, Col: 2177.\n  ESS_USAGES.address_id_nk = AT_DIM_ADDRESSES.address_id_nk and AT_DIM_ADDRESSES.owner_class='OFF'  ) \u001b[4mAddr_usages\u001b[0m --where Addr_usages.usages_dttm is not null ) ss ) DT_OFFENDER_ADDRESSES, BODIMIS.DIM_OFFENDER_BOOK]",
      "entityId": "okTTNgAABEbEA2MAQgOD8K7B5ps",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Dataset does not have any schema fields (comments -- in query)",
      "entityId": "3375368/DPa",
      "entityType": "dataset"
    },
    {
      "type": "schema",
      "error": "Report field DPF_DO224 does not have corresponding dataset schema field",
      "entityId": "197224.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field PAYMENT_SEQ does not have corresponding dataset schema field",
      "entityId": "197804.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field PAYMENT_DATE does not have corresponding dataset schema field",
      "entityId": "197804.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field FINE_PAYMENT_AMOUNT does not have corresponding dataset schema field",
      "entityId": "197804.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field COMMENT_TEXT does not have corresponding dataset schema field",
      "entityId": "197804.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OFFENDER_ID_DISPLAY does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_CODE does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "147976.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OFFENDER_ID_DISPLAY does not have corresponding dataset schema field",
      "entityId": "146665.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "146665.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "146665.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_CODE does not have corresponding dataset schema field",
      "entityId": "146665.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "146665.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "146665.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OFFENDER_ID_DISPLAY does not have corresponding dataset schema field",
      "entityId": "146825.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "146825.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "146825.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_CODE does not have corresponding dataset schema field",
      "entityId": "146825.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "146825.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "146825.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field HDC_ELIGIBILITY_DATE_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field HDC_AD_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field CRD_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SED_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field PED_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field APD_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field LED_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field PRRD_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field NPD_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field ETD_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MTD_HISTORICAL does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field LTD_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field ARD_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field TARIFF_DATE_ does not have corresponding dataset schema field",
      "entityId": "195029.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field OFFENDER_ID_DISPLAY does not have corresponding dataset schema field",
      "entityId": "194652.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "194652.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "194652.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_CODE does not have corresponding dataset schema field",
      "entityId": "194652.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "194652.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "194652.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field COMMENT_TEXT does not have corresponding dataset schema field",
      "entityId": "199497.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field SURNAME does not have corresponding dataset schema field",
      "entityId": "200145.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DATE_OF_BIRTH does not have corresponding dataset schema field",
      "entityId": "200145.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field MAIN_LEGAL_STATUS_CODE does not have corresponding dataset schema field",
      "entityId": "200145.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field BOOKING_NUMBER does not have corresponding dataset schema field",
      "entityId": "200145.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field GENDER_DESCRIPTION does not have corresponding dataset schema field",
      "entityId": "200145.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP5",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3376115/DP9",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "unable to generate test sql",
      "entityId": "3375368/DPa",
      "entityType": "dataset"
    }
  ]
}