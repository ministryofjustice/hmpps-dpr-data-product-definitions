{
  "id": "okY52lsACVAbBIUAKAWD8LAVnaM",
  "name": "ORS View Accommodation Details By Establishment",
  "description": "This report allows the user to view accommodation details for any wing of a single establishment or for the whole establishment. <br/>ACC0007 - v2 Last Modified 07/08/2023",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "ACC0007 v2"
    ]
  },
  "datasource": [
    {
      "id": "nomis",
      "name": "NOMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "nomis"
    }
  ],
  "dataset": [
    {
      "id": "3377299/DP6",
      "name": "Accomodation Details",
      "description": "OR - Demographics",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT * FROM ( SELECT DISTINCT AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)), nvl(sum(DT_CERTCELL_CNA.CNA_NO),0) FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.REFERENCE_CODES AT_CELL_USAGE_DESCRIPTION, (  SELECT DISTINCT decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) as UnitCode1 , AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID, AT_AGENCY_INTERNAL_LOCATION_L4.Parent_Internal_Location_ID, AT_AGENCY_INTERNAL_LOCATION_L4.OPERATION_CAPACITY, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_code, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_type, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_id, AT_AGENCY_INTERNAL_LOCATION_L4.CNA_NO FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4 WHERE AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_Location_type = 'CELL' and AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY >0 and AT_AGENCY_INTERNAL_LOCATION_L4.CERTIFIED_FLAG='Y' ) DT_CERTCELL_CNA, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, OMS_OWNER.LIVING_UNITS AT_LIVING_UNITS WHERE ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=AT_LIVING_UNITS.LIVING_UNIT_ID ) AND ( AT_LIVING_UNITS.HOUSING_UNIT_TYPE NOT IN ('OU','REC') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=AT_WING_ESTABLISHMENT.AGY_LOC_ID ) AND ( AT_WING_ESTABLISHMENT.AGY_LOC_ID=WING_CASELOAD_SECURITY.CASELOAD_ID ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=DT_CERTCELL_CNA.AGY_LOC_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=DT_CERTCELL_CNA.PARENT_INTERNAL_LOCATION_ID(+) ) AND ( AT_CELL_USAGE_DESCRIPTION.DOMAIN(+)='LIV_UN_RSN' AND AT_CELL_USAGE_DESCRIPTION.ACTIVE_FLAG(+)='Y' ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE=AT_CELL_USAGE_DESCRIPTION.CODE(+) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( ( AT_LIVING_UNITS.AGY_LOC_ID||'-'||AT_LIVING_UNITS.LEVEL_1_CODE IN ('All') or 'All' in ('All') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.UNIT_TYPE is not null ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) != ('RECP') ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) NOT IN('COURT','CSWAP','ECL','TAP','CMOV','CELL_MV') ) AND AT_WING_ESTABLISHMENT.AGY_LOC_ID = (SELECT establishment_code from prompt_) AND (WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_)) ) GROUP BY AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)) ) _query0 FULL OUTER JOIN ( SELECT DISTINCT AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)), nvl(sum(DT_WING_CAPACITY.OPERATION_CAPACITY),0), nvl(sum(DT_WING_CAPACITY.OPERATION_CAPACITY),0) FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.REFERENCE_CODES AT_CELL_USAGE_DESCRIPTION, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, ( /*gives occupancy, baseline and max capacities etc for wings/blocks REGARDLESS of whether or not they are certified or active*/ SELECT DISTINCT decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) as UnitCode1 , AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID, AT_AGENCY_INTERNAL_LOCATION_L4.OPERATION_CAPACITY, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_code, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_type, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_id FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4 WHERE AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_Location_type IN( 'WING','BLK') and AT_AGENCY_INTERNAL_LOCATION_L4.OPERATION_CAPACITY>0 and AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID IN (select agy_loc_id from oms_owner.agency_locations where housing_lev_1_code IN( 'WING','BLK')) ) DT_WING_CAPACITY, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, OMS_OWNER.LIVING_UNITS AT_LIVING_UNITS WHERE ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=DT_WING_CAPACITY.INTERNAL_LOCATION_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=DT_WING_CAPACITY.AGY_LOC_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=AT_LIVING_UNITS.LIVING_UNIT_ID ) AND ( AT_LIVING_UNITS.HOUSING_UNIT_TYPE NOT IN ('OU','REC') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=AT_WING_ESTABLISHMENT.AGY_LOC_ID ) AND ( AT_WING_ESTABLISHMENT.AGY_LOC_ID=WING_CASELOAD_SECURITY.CASELOAD_ID ) AND ( AT_CELL_USAGE_DESCRIPTION.DOMAIN(+)='LIV_UN_RSN' AND AT_CELL_USAGE_DESCRIPTION.ACTIVE_FLAG(+)='Y' ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE=AT_CELL_USAGE_DESCRIPTION.CODE(+) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( ( AT_LIVING_UNITS.AGY_LOC_ID||'-'||AT_LIVING_UNITS.LEVEL_1_CODE IN ('All') or 'All' in ('All') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.UNIT_TYPE is not null ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) != ('RECP') ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) NOT IN('COURT','CSWAP','ECL','TAP','CMOV','CELL_MV') ) AND AT_WING_ESTABLISHMENT.AGY_LOC_ID = (SELECT establishment_code from prompt_) AND (WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_)) ) GROUP BY AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)) ) _query1 ON _query0.OFFENDER_ID_DISPLAY = _query1.OFFENDER_ID_DISPLAY ( SELECT DISTINCT AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)), nvl(sum(DT_CERTCELL_CNA.CNA_NO),0) FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.REFERENCE_CODES AT_CELL_USAGE_DESCRIPTION, (  SELECT DISTINCT decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) as UnitCode1 , AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID, AT_AGENCY_INTERNAL_LOCATION_L4.Parent_Internal_Location_ID, AT_AGENCY_INTERNAL_LOCATION_L4.OPERATION_CAPACITY, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_code, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_type, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_id, AT_AGENCY_INTERNAL_LOCATION_L4.CNA_NO FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4 WHERE AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_Location_type = 'CELL' and AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY >0 and AT_AGENCY_INTERNAL_LOCATION_L4.CERTIFIED_FLAG='Y' ) DT_CERTCELL_CNA, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, OMS_OWNER.LIVING_UNITS AT_LIVING_UNITS WHERE ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=AT_LIVING_UNITS.LIVING_UNIT_ID ) AND ( AT_LIVING_UNITS.HOUSING_UNIT_TYPE NOT IN ('OU','REC') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=AT_WING_ESTABLISHMENT.AGY_LOC_ID ) AND ( AT_WING_ESTABLISHMENT.AGY_LOC_ID=WING_CASELOAD_SECURITY.CASELOAD_ID ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=DT_CERTCELL_CNA.AGY_LOC_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=DT_CERTCELL_CNA.PARENT_INTERNAL_LOCATION_ID(+) ) AND ( AT_CELL_USAGE_DESCRIPTION.DOMAIN(+)='LIV_UN_RSN' AND AT_CELL_USAGE_DESCRIPTION.ACTIVE_FLAG(+)='Y' ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE=AT_CELL_USAGE_DESCRIPTION.CODE(+) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( ( AT_LIVING_UNITS.AGY_LOC_ID||'-'||AT_LIVING_UNITS.LEVEL_1_CODE IN ('All') or 'All' in ('All') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.UNIT_TYPE is not null ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) != ('RECP') ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) NOT IN('COURT','CSWAP','ECL','TAP','CMOV','CELL_MV') ) AND AT_WING_ESTABLISHMENT.AGY_LOC_ID = (SELECT establishment_code from prompt_) AND (WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_)) ) GROUP BY AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)) ) _query0 FULL OUTER JOIN ( SELECT DISTINCT AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)), sum(DT_TAP_BY_LOC.TEMPABS) FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.REFERENCE_CODES AT_CELL_USAGE_DESCRIPTION, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, (  SELECT AT_OFFENDERS_LOCATIONS.AGY_LOC_ID, AT_AGENCY_INTERNAL_LOCATION_L4.parent_INTERNAL_LOCATION_ID, COUNT( DISTINCT AT_OFFENDER.OFFENDER_ID_DISPLAY) as TempAbs FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS AT_OFFENDER_EXTERNAL_MOVEMENTS WHERE ( AT_OFFENDER.OFFENDER_ID(+)=AT_OFFENDER_BOOKING.OFFENDER_ID ) AND ( AT_OFFENDER_BOOKING.LIVING_UNIT_ID=AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=AT_OFFENDERS_LOCATIONS.AGY_LOC_ID(+) ) and AT_OFFENDER_BOOKING.ACTIVE_FLAG='Y' AND ( AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE='INST' ) AND AT_OFFENDER_EXTERNAL_MOVEMENTS.DIRECTION_CODE = 'OUT' and AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_TYPE='TAP' And AT_OFFENDER_EXTERNAL_MOVEMENTS.ACTIVE_FLAG = 'Y' AND AT_OFFENDER_BOOKING.IN_OUT_STATUS = 'OUT' And (AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID, AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_DATE, AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_TIME) in (Select OFFENDER_BOOK_ID, Max(MOVEMENT_DATE), Max(MOVEMENT_TIME) From OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS Group By OFFENDER_BOOK_ID) GROUP BY AT_OFFENDERS_LOCATIONS.AGY_LOC_ID, AT_AGENCY_INTERNAL_LOCATION_L4.parent_INTERNAL_LOCATION_ID ) DT_TAP_BY_LOC, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, OMS_OWNER.LIVING_UNITS AT_LIVING_UNITS WHERE ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=DT_TAP_BY_LOC.AGY_LOC_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=DT_TAP_BY_LOC.PARENT_INTERNAL_LOCATION_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=AT_LIVING_UNITS.LIVING_UNIT_ID ) AND ( AT_LIVING_UNITS.HOUSING_UNIT_TYPE NOT IN ('OU','REC') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=AT_WING_ESTABLISHMENT.AGY_LOC_ID ) AND ( AT_WING_ESTABLISHMENT.AGY_LOC_ID=WING_CASELOAD_SECURITY.CASELOAD_ID ) AND ( AT_CELL_USAGE_DESCRIPTION.DOMAIN(+)='LIV_UN_RSN' AND AT_CELL_USAGE_DESCRIPTION.ACTIVE_FLAG(+)='Y' ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE=AT_CELL_USAGE_DESCRIPTION.CODE(+) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( ( AT_LIVING_UNITS.AGY_LOC_ID||'-'||AT_LIVING_UNITS.LEVEL_1_CODE IN ('All') or 'All' in ('All') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.UNIT_TYPE is not null ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) != ('RECP') ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) NOT IN('COURT','CSWAP','ECL','TAP','CMOV','CELL_MV') ) AND AT_WING_ESTABLISHMENT.AGY_LOC_ID = (SELECT establishment_code from prompt_) AND (WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_)) ) GROUP BY AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)) ) _query3 ON _query0.OFFENDER_ID_DISPLAY = _query3.OFFENDER_ID_DISPLAY ( SELECT DISTINCT AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)), nvl(sum(DT_CERTCELL_CNA.CNA_NO),0) FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.REFERENCE_CODES AT_CELL_USAGE_DESCRIPTION, (  SELECT DISTINCT decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) as UnitCode1 , AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID, AT_AGENCY_INTERNAL_LOCATION_L4.Parent_Internal_Location_ID, AT_AGENCY_INTERNAL_LOCATION_L4.OPERATION_CAPACITY, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_code, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_type, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_id, AT_AGENCY_INTERNAL_LOCATION_L4.CNA_NO FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4 WHERE AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_Location_type = 'CELL' and AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY >0 and AT_AGENCY_INTERNAL_LOCATION_L4.CERTIFIED_FLAG='Y' ) DT_CERTCELL_CNA, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, OMS_OWNER.LIVING_UNITS AT_LIVING_UNITS WHERE ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=AT_LIVING_UNITS.LIVING_UNIT_ID ) AND ( AT_LIVING_UNITS.HOUSING_UNIT_TYPE NOT IN ('OU','REC') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=AT_WING_ESTABLISHMENT.AGY_LOC_ID ) AND ( AT_WING_ESTABLISHMENT.AGY_LOC_ID=WING_CASELOAD_SECURITY.CASELOAD_ID ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=DT_CERTCELL_CNA.AGY_LOC_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=DT_CERTCELL_CNA.PARENT_INTERNAL_LOCATION_ID(+) ) AND ( AT_CELL_USAGE_DESCRIPTION.DOMAIN(+)='LIV_UN_RSN' AND AT_CELL_USAGE_DESCRIPTION.ACTIVE_FLAG(+)='Y' ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE=AT_CELL_USAGE_DESCRIPTION.CODE(+) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( ( AT_LIVING_UNITS.AGY_LOC_ID||'-'||AT_LIVING_UNITS.LEVEL_1_CODE IN ('All') or 'All' in ('All') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.UNIT_TYPE is not null ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) != ('RECP') ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) NOT IN('COURT','CSWAP','ECL','TAP','CMOV','CELL_MV') ) AND AT_WING_ESTABLISHMENT.AGY_LOC_ID = (SELECT establishment_code from prompt_) AND (WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_)) ) GROUP BY AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)) ) _query0 FULL OUTER JOIN ( SELECT DISTINCT AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)), nvl(sum(DT_ACTCERT_CELLS.CAPACITY),0), nvl(sum(DT_ACTCERT_CELLS.CNA_NO),0), nvl(sum(DT_ACTCERT_CELLS.OPERATION_CAPACITY),0), nvl(sum(DT_ACTCERT_CELLS.NO_OF_OCCUPANT),0) FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.REFERENCE_CODES AT_CELL_USAGE_DESCRIPTION, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, (  SELECT DISTINCT decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) as UnitCode1 , AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID, AT_AGENCY_INTERNAL_LOCATION_L4.OPERATION_CAPACITY, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_code, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_type, AT_AGENCY_INTERNAL_LOCATION_L4.internal_location_id, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, AT_AGENCY_INTERNAL_LOCATION_L4.CNA_NO, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT FROM OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4 WHERE AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_Location_type = 'CELL' and AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY >0 and AT_AGENCY_INTERNAL_LOCATION_L4.ACTIVE_FLAG='Y' and AT_AGENCY_INTERNAL_LOCATION_L4.CERTIFIED_FLAG='Y' ) DT_ACTCERT_CELLS, OMS_OWNER.LIVING_UNITS AT_LIVING_UNITS WHERE ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=AT_LIVING_UNITS.LIVING_UNIT_ID ) AND ( AT_LIVING_UNITS.HOUSING_UNIT_TYPE NOT IN ('OU','REC') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=AT_WING_ESTABLISHMENT.AGY_LOC_ID ) AND ( AT_WING_ESTABLISHMENT.AGY_LOC_ID=WING_CASELOAD_SECURITY.CASELOAD_ID ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID=DT_ACTCERT_CELLS.AGY_LOC_ID(+) ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID=DT_ACTCERT_CELLS.INTERNAL_LOCATION_ID(+) ) AND ( AT_CELL_USAGE_DESCRIPTION.DOMAIN(+)='LIV_UN_RSN' AND AT_CELL_USAGE_DESCRIPTION.ACTIVE_FLAG(+)='Y' ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE=AT_CELL_USAGE_DESCRIPTION.CODE(+) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_) ) AND ( ( AT_LIVING_UNITS.AGY_LOC_ID||'-'||AT_LIVING_UNITS.LEVEL_1_CODE IN ('All') or 'All' in ('All') ) AND ( AT_AGENCY_INTERNAL_LOCATION_L4.UNIT_TYPE is not null ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) != ('RECP') ) AND ( decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)) NOT IN('COURT','CSWAP','ECL','TAP','CMOV','CELL_MV') ) AND AT_WING_ESTABLISHMENT.AGY_LOC_ID = (SELECT establishment_code from prompt_) AND (WING_CASELOAD_SECURITY.USERNAME=(SELECT username from context_)) ) GROUP BY AT_WING_ESTABLISHMENT.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,1))-1)), substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,length(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID)+2,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)), AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.DEACTIVATE_REASON_CODE, AT_CELL_USAGE_DESCRIPTION.DESCRIPTION, AT_AGENCY_INTERNAL_LOCATION_L4.REACTIVATE_DATE, AT_AGENCY_INTERNAL_LOCATION_L4.COMMENT_TEXT, AT_AGENCY_INTERNAL_LOCATION_L4.CAPACITY, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3))-1)), decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2)+1,decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3),0,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION),instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,2))-1)), AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.NO_OF_OCCUPANT, AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, decode(instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4),0,null,substr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,4)+1,length(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)-instr(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION,'-',1,3)-1)) ) _query5 ON _query0.OFFENDER_ID_DISPLAY = _query5.OFFENDER_ID_DISPLAY), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": []
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "84636.RS",
      "name": "Accommodation Details by Wing",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377299/DP6",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:DP6_DO472",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5B8",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DOBD3",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO91E",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5BA",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5BC",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DOA28",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_PHYSICAL_VACANCIES",
            "display": "Spaces Out of Use ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Operational Capacity]-[Lock-Up Figure]-[Temporary Absence]"
          }
        ]
      }
    },
    {
      "id": "122720.RS",
      "name": "Accommodation Details by Wing Incl. deactivated cells",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377299/DP6",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:DP6_DO472",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5B8",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DOBD3",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO91E",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5BA",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5BC",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DOA28",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_PHYSICAL_VACANCIES",
            "display": "Spaces Out of Use ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Operational Capacity]-[Lock-Up Figure]-[Temporary Absence]"
          }
        ]
      }
    },
    {
      "id": "122102.RS",
      "name": "Accommodation Details by Landing",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377299/DP6",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:DP6_DO472",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO471",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5B8",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO91E",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5BA",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5BC",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DOA28",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_PHYSICAL_VACANCIES_LANDING",
            "display": "Spaces Out of Use ",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[CNA Certified and Active]-[Lock-Up Figure]-[Temporary Absence]"
          }
        ]
      }
    },
    {
      "id": "122005.RS",
      "name": "Accommodation Details by Cell",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377299/DP6",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:DP6_DO427",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO97B",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO91E",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO1096",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DO5BA",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:DP6_DOA28",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": ""
          },
          {
            "name": "$ref:V_PHYSICAL_VACANCIES_CELL_LE31",
            "display": "Physical Vacancies",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[CNA Certified and Active]-[Current Cell Occupants]"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid",
      "entityId": "okY52lsACVAbBIUAKAWD8LAVnaM",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Dataset does not have any schema fields",
      "entityId": "3377299/DP6",
      "entityType": "dataset"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO472 does not have corresponding dataset schema field",
      "entityId": "84636.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5B8 does not have corresponding dataset schema field",
      "entityId": "84636.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DOBD3 does not have corresponding dataset schema field",
      "entityId": "84636.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO91E does not have corresponding dataset schema field",
      "entityId": "84636.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5BA does not have corresponding dataset schema field",
      "entityId": "84636.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5BC does not have corresponding dataset schema field",
      "entityId": "84636.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DOA28 does not have corresponding dataset schema field",
      "entityId": "84636.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_PHYSICAL_VACANCIES does not have corresponding dataset schema field",
      "entityId": "84636.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO472 does not have corresponding dataset schema field",
      "entityId": "122720.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5B8 does not have corresponding dataset schema field",
      "entityId": "122720.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DOBD3 does not have corresponding dataset schema field",
      "entityId": "122720.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO91E does not have corresponding dataset schema field",
      "entityId": "122720.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5BA does not have corresponding dataset schema field",
      "entityId": "122720.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5BC does not have corresponding dataset schema field",
      "entityId": "122720.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DOA28 does not have corresponding dataset schema field",
      "entityId": "122720.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_PHYSICAL_VACANCIES does not have corresponding dataset schema field",
      "entityId": "122720.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO472 does not have corresponding dataset schema field",
      "entityId": "122102.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO471 does not have corresponding dataset schema field",
      "entityId": "122102.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5B8 does not have corresponding dataset schema field",
      "entityId": "122102.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO91E does not have corresponding dataset schema field",
      "entityId": "122102.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5BA does not have corresponding dataset schema field",
      "entityId": "122102.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5BC does not have corresponding dataset schema field",
      "entityId": "122102.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DOA28 does not have corresponding dataset schema field",
      "entityId": "122102.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_PHYSICAL_VACANCIES_LANDING does not have corresponding dataset schema field",
      "entityId": "122102.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO427 does not have corresponding dataset schema field",
      "entityId": "122005.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO97B does not have corresponding dataset schema field",
      "entityId": "122005.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO91E does not have corresponding dataset schema field",
      "entityId": "122005.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO1096 does not have corresponding dataset schema field",
      "entityId": "122005.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DO5BA does not have corresponding dataset schema field",
      "entityId": "122005.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field DP6_DOA28 does not have corresponding dataset schema field",
      "entityId": "122005.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_PHYSICAL_VACANCIES_CELL_LE31 does not have corresponding dataset schema field",
      "entityId": "122005.RS",
      "entityType": "variant"
    },
    {
      "type": "sqlQuery",
      "error": "Error: NJS-005: invalid value for parameter 1",
      "entityId": "3377299/DP6",
      "entityType": "dataset"
    }
  ]
}