{
  "id": "FiPYiQG3QQ8AuNEoAAAXHbUAACJIAGc1",
  "name": "MIS DRAFT NSR-5177 Staff Assault Q and A Report",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "INCXXXX v0.9"
    ]
  },
  "description": "Returns a detailed list of questions and answers relating to specified incidents<br/>INCXXXX v1.0 Last Modified: 23/08/23",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375377/DP2",
      "name": "Q and A",
      "description": "MIS - Incidents",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_INCIDENT.INCIDENT_CASE_ID, INITCAP(AT_INCIDENT_TYPE.INCIDENT_TYPE_DESC) AS INCIDENT_TYPE, AT_INCIDENT.INCIDENT_TEXT, AT_INCIDENT.INCIDENT_CASE_ID AS INCIDENT_CODE, AT_INCIDENT_QUESTION.QUE_SEQ, AT_INCIDENT_QUESTION.QUESTION_DESCRIPTION, AT_INCIDENT_ANSWER.ANSWER_DESCRIPTION, AT_INCIDENT_QUESTIONNAIRE.RESPONSE_COMMENT_TEXT FROM BODIMIS.FACT_INCIDENT_QUESTIONNAIRE AT_INCIDENT_QUESTIONNAIRE, BODIMIS.FACT_INCIDENT AT_INCIDENT, BODIMIS.DIM_INCIDENT_STATUS AT_INCIDENT_STATUS, BODIMIS.DIM_INCIDENT_TYPE AT_INCIDENT_TYPE, BODIMIS.DIM_INCIDENT_QUESTION AT_INCIDENT_QUESTION, BODIMIS.DIM_INCIDENT_ANSWER AT_INCIDENT_ANSWER WHERE (AT_INCIDENT.INCIDENT_STATUS_SK = AT_INCIDENT_STATUS.INCIDENT_STATUS_SK) AND (AT_INCIDENT_QUESTIONNAIRE.INCIDENT_CASE_ID = AT_INCIDENT.INCIDENT_CASE_ID) AND (AT_INCIDENT_ANSWER.INCIDENT_QUESTION_SK = AT_INCIDENT_QUESTION.INCIDENT_QUESTION_SK) AND (AT_INCIDENT_QUESTIONNAIRE.INCIDENT_ANSWER_SK = AT_INCIDENT_ANSWER.INCIDENT_ANSWER_SK) AND (AT_INCIDENT_QUESTION.QUESTIONNAIRE_ID = AT_INCIDENT_TYPE.QUESTIONNAIRE_ID) AND (AT_INCIDENT_STATUS.INCIDENT_STATUS_ID_NK <> 'DUP') AND (AT_INCIDENT_STATUS.INCIDENT_STATUS_ID_NK <> 'DUP') AND (AT_INCIDENT_STATUS.INCIDENT_STATUS_ID_NK <> 'DUP') AND (AT_INCIDENT_STATUS.INCIDENT_STATUS_ID_NK <> 'DUP') AND AT_INCIDENT.INCIDENT_CASE_ID IN (4037502, 4015727, 4056292, 4063055, 4041992, 4085597, 4068435, 3992585, 4073536, 4084367, 4078223, 3999900, 3996381, 4027540, 4096031, 4042027, 4061390, 4071160, 4017514, 4036238, 4036524, 4101722, 4019133, 3995988, 4011294, 4098033, 4056699, 3995095, 4034333, 4009605, 4092900, 4042321, 4103464, 4065629, 4004426, 4086725, 4083769, 4004427, 4004253, 4014489, 4085942, 4064797, 4020150, 4048136, 4015710, 3999312, 4017659, 4030689, 3998665, 4080422, 4033486, 4112310, 4015845, 4040255, 4035604, 4069211, 4071872, 4011782, 4081841, 4026653, 4009908, 4029126, 4064712, 4104641, 4035926, 4008345, 4100585, 4063210, 4064917, 4073870, 4005396, 4082957, 4006485, 4069614, 4057928, 4096154, 4025401, 4019450, 4105629, 4100705, 4092042, 4094161, 4061261, 4079262, 4057503, 4087036, 4050502, 4006222, 4047375, 4082509, 3993031, 4033986, 4097131, 4098098, 4076529, 4012932, 4083390, 4032556, 4067403, 4021607, 4019220, 4016727, 4018895, 4029925, 4037863, 4003391, 4005286, 4032408, 4048569, 4058376, 4024008, 4028826, 4086020, 4099546, 3997116, 4063694, 4085619, 4080282, 4007315, 4030617, 4020118, 4022556, 4022935, 4026340, 4063009, 4076527, 4037296, 4049688, 4065246, 4000849, 4083463, 4079599, 4075481, 4076953, 4103299, 3992133, 4060950, 4068940, 4073858, 4007963, 4086568, 4021627, 4007908, 4082358, 4002593, 4034312, 4100444, 4057125, 4050622, 4050869, 4032402, 4059634, 4029138, 4055148, 4032696, 4049298, 4048308, 4084492, 4010214, 4056194, 4040264, 4095996, 4021416, 4053298, 4086094, 4027239, 4082270, 4086798, 4097329, 4101325, 4089550, 4061028, 4090894, 4090901, 4101813, 4091595, 4041531, 4094559, 4038817, 4093304, 4000790, 4070599, 4046712, 4003488, 4037261, 4096368, 4011799, 4071421, 4018601, 4000249, 4051474, 4071438, 4029827, 4070647, 4010509, 4045706, 4025497, 4094200, 4008486, 4016526, 4012396, 4099748, 4088932, 4077739, 4076353, 4063116, 4016996, 4104847, 4079044, 4014012, 4032522, 4002225, 4074465, 4075442, 4010053, 4075824, 4095296, 4090304, 3994370, 4084943, 4000508, 4024052, 4001272, 3993803, 4023167, 4048408, 4068410, 4064691, 4068284, 4068267, 4092426, 4076992, 4065605, 4037120, 4042941, 4104097, 4013653, 4021646, 4029690, 4012340, 4045510, 4052148, 4086771, 4059317, 4063449, 4094224, 4063583, 4105058, 4044735, 4013355, 4049314, 4014328, 4075886, 4092963, 4079001, 4093718, 4078036, 4103769, 4070166, 4040040, 4068750, 4068729, 4054031, 4068778, 4086937, 4067074, 4080366, 4089397, 4018222, 4016753, 4049262, 4107137, 4032187, 4025897, 4003971, 4094300, 4036722, 4018320, 4007114, 4056674, 4064756, 4087705, 4094440, 4025973, 4008255, 4057931, 4076058, 4023972, 4038544, 4001230, 4044636, 4007436, 4064768, 4020927, 4104160, 4025107, 4016758, 4030210, 4076761, 4075361, 4047435, 4000973, 4040059, 4013373, 4074587, 4010210, 4080121, 4093992, 4101594, 4021780, 4060828, 4091032, 4069033, 4098123, 4041669, 4020981, 4039599, 4099284, 4017306, 4039981, 4081834, 4050376, 4043831, 4101319, 4063491, 4015986, 3996467, 4006132, 4016939, 4004366, 4069397, 4053841, 4049075, 4006754, 4045697, 4012325, 4090168, 4041670, 4071762, 4053635, 4060472, 4104142, 4006493, 4100909, 4079184, 4069644, 4097237, 4001537, 4087355, 4037302) AND (AT_INCIDENT_STATUS.INCIDENT_STATUS_ID_NK <> 'DUP')), dataset_ AS (SELECT INCIDENT_CASE_ID, INCIDENT_TYPE, INCIDENT_TEXT, INCIDENT_CODE, QUE_SEQ, QUESTION_DESCRIPTION, ANSWER_DESCRIPTION, RESPONSE_COMMENT_TEXT FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "INCIDENT_CASE_ID",
            "type": "double",
            "display": "Incident Number",
            "legacyId": "DP2.DOb",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "INCIDENT_TYPE",
            "type": "string",
            "display": "Incident Type",
            "legacyId": "DP2.DO9",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "INCIDENT_TEXT",
            "type": "string",
            "display": "Incident Text",
            "legacyId": "DP2.DO297",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "INCIDENT_CODE",
            "type": "double",
            "display": "Incident Code",
            "legacyId": "DP2.DO1a",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "QUE_SEQ",
            "type": "double",
            "display": "Incident Question Number",
            "legacyId": "DP2.DO69f",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "QUESTION_DESCRIPTION",
            "type": "string",
            "display": "Incident Question Description",
            "legacyId": "DP2.DO1d",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "ANSWER_DESCRIPTION",
            "type": "string",
            "display": "Incident Response Description",
            "legacyId": "DP2.DO1f",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "RESPONSE_COMMENT_TEXT",
            "type": "string",
            "display": "Incident Response Additional Comment",
            "legacyId": "DP2.DO299",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375377/DP3",
      "name": "MIS Load",
      "description": "MIS - Incidents",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL)) AND NOT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE IS NULL), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP3.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "160783.RS",
      "name": "Incident Q & A Extract",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375377/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:INCIDENT_CASE_ID",
            "display": "Incident Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DOb"
          },
          {
            "name": "$ref:QUE_SEQ",
            "display": "Incident Question Number",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO69f"
          },
          {
            "name": "$ref:QUESTION_DESCRIPTION",
            "display": "Incident Question Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1d"
          },
          {
            "name": "$ref:ANSWER_DESCRIPTION",
            "display": "Incident Response Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1f"
          },
          {
            "name": "$ref:RESPONSE_COMMENT_TEXT",
            "display": "Incident Response Additional Comment",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO299"
          },
          {
            "name": "$ref:INCIDENT_TYPE",
            "display": "Incident Type",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO9"
          },
          {
            "name": "$ref:INCIDENT_TEXT",
            "display": "Incident Text",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO297"
          }
        ]
      }
    }
  ],
  "errors": []
}