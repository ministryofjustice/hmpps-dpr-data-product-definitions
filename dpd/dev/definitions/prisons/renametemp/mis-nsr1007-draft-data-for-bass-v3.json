{
  "id": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
  "name": "MIS NSR1007 DRAFT Data for BASS v3",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "MOV0075 v00.00.01",
      "BASS"
    ]
  },
  "description": "<br/>MOV0075 v00.00.01 Last Modified: 08/04/2020",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3375368/DP2",
      "name": "Discharges",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING_BAH.BOOKING_NUMBER, AT_ST_DT.DAY_DATE, AT_OFFENDER_BOOKING.GENDER_DESCRIPTION, AT_FACT_MOV_EXT.MOVEMENT_TIME, AT_FACT_MOV_EXT.REASON_CODE, AT_FACT_MOV_EXT.TYPE, AT_FACT_MOV_EXT.DIRECTION_CODE, DT_EXT_MOVE_TO.TYPE_DESCRIPTION_TO, DT_EXT_MOVE_FROM.TYPE_DESCRIPTION_FROM, AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_DESCRIPTION, AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION AS MOVEMENT_LOCATION_FROM_DESCR35, AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_DESCRIPTION, CASE WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_ALP_CDE18', 'LR_ALP_CDE21') THEN 'Recall' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '0' THEN 'Dead' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '1' THEN 'Indeterminate Sentence' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('2', '3') THEN 'Sentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('9', '10') OR AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'CIV_RMD' THEN 'Civil Prisoner' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('8', '11') THEN 'Immigration Detainee' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('12', '13', '14') THEN 'Remand' WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_FACT_MOV_EXT.REASON, AT_DIM_DATE_EXT_MOV.DAY_DATE AS MOVEMENT_DATE_ONLY_, CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END AS DATE_OF_BIRTH, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, FACT_CURR_KEY_DATES_SENT.CURR_ARD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_CRD_DATE, FACT_CURR_KEY_DATES_SENT.CURR_HDCAD_DATE, AT_HDCED_NOOUTER.DAY_DATE AS HDCED, CASE WHEN AT_DIM_ASSESSMENT_DATE.DAY_DATE < '31/12/9000' THEN AT_DIM_ASSESSMENT_DATE.DAY_DATE END AS HDC_CHECKS_DONE_DATE, CASE WHEN AT_CURFEW_ASSESSMENT.PASSED_FLAG = 'Y' THEN 'YES' WHEN AT_CURFEW_ASSESSMENT.PASSED_FLAG = 'N' THEN 'NO' END AS HDC_PASSED_FLAG, CASE WHEN AT_CURFEW_ASSESSMENT.REVIEW_FLAG = 'Y' THEN 'YES' WHEN AT_CURFEW_ASSESSMENT.REVIEW_FLAG = 'N' THEN 'NO' END AS HDC_REVIEW_FLAG, AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_DESC FROM BODIMIS.DIM_DATE AT_HDCED_NOOUTER, BODIMIS.DIM_DATE AT_DIM_ASSESSMENT_DATE, BODIMIS.FACT_CURFEW_ASSESSMENT AT_CURFEW_ASSESSMENT, BODIMIS.DIM_HDC_ASSESSMNT_APP_STATUS AT_DIM_HDC_ASST_APP_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.DIM_DATE AT_ST_DT, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_TO, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_TO, 'Establishment' AS Location_Type_To FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_To FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_To FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_To FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_To FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_TO, (SELECT BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_SK AS SK_ID_FROM, BODIMIS.DIM_ESTABLISHMENT.ESTABLISHMENT_DESCRIPTION AS TYPE_DESCRIPTION_FROM, 'Establishment' AS Location_Type_FROM FROM BODIMIS.DIM_ESTABLISHMENT UNION ALL SELECT BODIMIS.DIM_PROBATION_OFFICE.PROBATION_OFFICE_SK, BODIMIS.DIM_PROBATION_OFFICE.PROB_OFFICE_DESCRIPTION, 'Probation Office' AS Location_Type_From FROM BODIMIS.DIM_PROBATION_OFFICE UNION ALL SELECT BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_SK, BODIMIS.DIM_OUTSIDE_LOCATION.OUTSIDE_LOCATION_DESCRIPTION, 'Outside Location' AS Location_Type_From FROM BODIMIS.DIM_OUTSIDE_LOCATION UNION ALL SELECT BODIMIS.DIM_CITY.CITY_SK, BODIMIS.DIM_CITY.DESCRIPTION, 'City' AS Location_Type_From FROM BODIMIS.DIM_CITY UNION ALL SELECT BODIMIS.DIM_COURT.COURT_SK, BODIMIS.DIM_COURT.COURT_DESCRIPTION, 'Court' AS Location_Type_From FROM BODIMIS.DIM_COURT UNION ALL SELECT address_id_nk, TRIM(CASE WHEN no_fixed_address_flag = 'Y' THEN 'No fixed address' ELSE CASE WHEN NOT flat IS NULL THEN flat || '  ' END || CASE WHEN NOT premise IS NULL THEN premise || '  ' END || CASE WHEN NOT street IS NULL THEN street || '  ' END || CASE WHEN NOT locality IS NULL THEN locality || '  ' END || CASE WHEN NOT city_desc IS NULL THEN city_desc || '  ' END || CASE WHEN NOT county_desc IS NULL THEN county_desc || '  ' END || CASE WHEN NOT postal_code IS NULL THEN postal_code || '  ' END || CASE WHEN NOT country_desc IS NULL THEN country_desc END END), 'Home Leave Address' FROM bodimis.dim_addresses) DT_EXT_MOVE_FROM, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_TO, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.DIM_DATE AT_DOB, FACT_CURR_KEY_DATES_SENT, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY, BODIMIS.FACT_OFFENDER_SENTENCE AT_FACT_CURR_SENT WHERE (AT_CURFEW_ASSESSMENT.HDC_ASSMENT_APP_STATUS_SK = AT_DIM_HDC_ASST_APP_STATUS.HDC_ASSMENT_APP_STATUS_SK (+)) AND (AT_CURFEW_ASSESSMENT.ASSESSMENT_DATE_SK = AT_DIM_ASSESSMENT_DATE.DATE_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_FACT_CURR_SENT.OFFENDER_BOOKING_SK) AND (AT_FACT_CURR_SENT.SENTENCE_CURRENT_FLAG = 'Y') AND (AT_FACT_CURR_SENT.HDCED_DATE_SK = AT_HDCED_NOOUTER.DATE_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = FACT_CURR_KEY_DATES_SENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (CASE WHEN AT_FACT_MOV_EXT.TO_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.TO_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_SK (+)) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_FACT_MOV_EXT.TO_LOCATION_SK = DT_EXT_MOVE_TO.SK_ID_TO (+) AND AT_FACT_MOV_EXT.TO_LOCATION_TYPE = DT_EXT_MOVE_TO.LOCATION_TYPE_TO (+)) AND (AT_FACT_MOV_EXT.FROM_LOCATION_SK = DT_EXT_MOVE_FROM.SK_ID_FROM (+) AND AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = DT_EXT_MOVE_FROM.LOCATION_TYPE_FROM (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_CURFEW_ASSESSMENT.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND (AT_ST_DT.DATE_SK = AT_OFFENDER_BOOKING_BAH.BOOKING_BEGIN_DATE_SK) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('30-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, BOOKING_NUMBER, DAY_DATE, GENDER_DESCRIPTION, MOVEMENT_TIME, REASON_CODE, TYPE, DIRECTION_CODE, TYPE_DESCRIPTION_TO, TYPE_DESCRIPTION_FROM, ESTABLISHMENT_DESCRIPTION, MOVEMENT_LOCATION_FROM_DESCR35, MAIN_LEGAL_STATUS_DESCRIPTION, LEGAL_STATUS_GROUPING, REASON, MOVEMENT_DATE_ONLY_, DATE_OF_BIRTH, OFFENDER_AGE, CURR_ARD_DATE, CURR_CRD_DATE, CURR_HDCAD_DATE, HDCED, HDC_CHECKS_DONE_DATE, HDC_PASSED_FLAG, HDC_REVIEW_FLAG, HDC_ASSMENT_APP_STATUS_DESC, 'TBD' AS TRUNCATE_AGE_ON_RELEASE, 'TBD' AS V_SEX_ALL, 'TBD' AS V_MAX_CONCAT_ALL_OFFENCES, CASE WHEN ACCT.ALERT_CODE_NK IS NULL THEN 'No' ELSE 'Yes' END AS V_ACCT_ALERT, CASE WHEN ALERTS.ALERT_CODE_NK = 'XTACT' THEN 'Yes' END AS V_XTACT_ALERT, CASE WHEN ALERTS.ALERT_CODE_NK = 'XLDEPORT' THEN 'Yes' END AS V_DEPORT_ALERT, CASE WHEN DEPORT.OUTCOME_REASON_DESCRIPTION IS NULL THEN (DEPORT.RESULT_2_DESCRIPTION) ELSE CASE WHEN DEPORT.RESULT_2_DESCRIPTION IS NULL THEN 'No' ELSE 'Yes' END END AS V_DEPORTATION_RESULT, OFFENDER_ADDRESS_NO_FIXED_ABODE_FLAG AS V_NFA_, 'TBD' AS V_MAX_CONCAT_ADDRESS_USAGE, OFFENDER_ADDRESS_FULL AS V_PRIMARY_ADDRESS, CASE WHEN ASSESSMENT_CODE = 'HRR' THEN 'Yes' ELSE 'No' END AS V_HOMLESSNESS_REFERRAL, 'TBD' AS V_HDCED, DISCHARGES.MOVEMENT_DATE_ONLY_ AS V_RELEASE_DATE, 'TBD' AS V_RECEPTION_AFTER_RELEASE_DI34 FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP2.DO10b05",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Booking Start Date",
            "legacyId": "DP2.DO10b0b",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "GENDER_DESCRIPTION",
            "type": "string",
            "display": "Gender Description",
            "legacyId": "DP2.DO100a9",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "MOVEMENT_TIME",
            "type": "date",
            "display": "Movement Date and Time (External)",
            "legacyId": "DP2.DO103eb",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "REASON_CODE",
            "type": "string",
            "display": "Movement Reason Code (External)",
            "legacyId": "DP2.DO103fc",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "TYPE",
            "type": "string",
            "display": "Movement Type (External)",
            "legacyId": "DP2.DO103ec",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "DIRECTION_CODE",
            "type": "string",
            "display": "Movement Direction Code (External)",
            "legacyId": "DP2.DO103fd",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "TYPE_DESCRIPTION_TO",
            "type": "string",
            "display": "Movement Description (To)",
            "legacyId": "DP2.DO106ff",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "TYPE_DESCRIPTION_FROM",
            "type": "string",
            "display": "Movement Description (From)",
            "legacyId": "DP2.DO10700",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Movement Location To Description (External)",
            "legacyId": "DP2.DO1015e",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "MOVEMENT_LOCATION_FROM_DESCR35",
            "type": "string",
            "display": "Movement Location From Description (External)",
            "legacyId": "DP2.DO1015d",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "MAIN_LEGAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Main Legal Status Description",
            "legacyId": "DP2.DO100df",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP2.DO107cb",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "REASON",
            "type": "string",
            "display": "Movement Description (External)",
            "legacyId": "DP2.DO1015b",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "MOVEMENT_DATE_ONLY_",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DP2.DO1015c",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "DATE_OF_BIRTH",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP2.DO10085",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DP2.DO10082",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "CURR_ARD_DATE",
            "type": "date",
            "display": "ARD (Approved Release Date)",
            "legacyId": "DP2.DO47",
            "legacySqlClass": "column"
          },
          {
            "index": 19,
            "name": "CURR_CRD_DATE",
            "type": "date",
            "display": "CRD (Conditional Release Date)",
            "legacyId": "DP2.DO48",
            "legacySqlClass": "column"
          },
          {
            "index": 20,
            "name": "CURR_HDCAD_DATE",
            "type": "date",
            "display": "HDC AD (Approved Date)",
            "legacyId": "DP2.DO97",
            "legacySqlClass": "column"
          },
          {
            "index": 21,
            "name": "HDCED",
            "type": "date",
            "display": "HDCED",
            "legacyId": "DP2.DO612",
            "legacySqlClass": "column"
          },
          {
            "index": 22,
            "name": "HDC_CHECKS_DONE_DATE",
            "type": "date",
            "display": "HDC Checks Done Date",
            "legacyId": "DP2.DO54a",
            "legacySqlClass": "column"
          },
          {
            "index": 23,
            "name": "HDC_PASSED_FLAG",
            "type": "string",
            "display": "HDC Passed Flag",
            "legacyId": "DP2.DO3ad",
            "legacySqlClass": "column"
          },
          {
            "index": 24,
            "name": "HDC_REVIEW_FLAG",
            "type": "string",
            "display": "HDC Review Flag",
            "legacyId": "DP2.DO3ae",
            "legacySqlClass": "column"
          },
          {
            "index": 25,
            "name": "HDC_ASSMENT_APP_STATUS_DESC",
            "type": "string",
            "display": "HDC Status",
            "legacyId": "DP2.DO54",
            "legacySqlClass": "column"
          },
          {
            "index": 26,
            "name": "TRUNCATE_AGE_ON_RELEASE",
            "type": "string",
            "display": "TRUNCATE_AGE_ON_RELEASE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 27,
            "name": "V_SEX_ALL",
            "type": "string",
            "display": "V_SEX_ALL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 28,
            "name": "V_MAX_CONCAT_ALL_OFFENCES",
            "type": "string",
            "display": "V_MAX_CONCAT_ALL_OFFENCES",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 29,
            "name": "V_ACCT_ALERT",
            "type": "string",
            "display": "V_ACCT_ALERT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 30,
            "name": "V_XTACT_ALERT",
            "type": "string",
            "display": "V_XTACT_ALERT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 31,
            "name": "V_DEPORT_ALERT",
            "type": "string",
            "display": "V_DEPORT_ALERT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 32,
            "name": "V_DEPORTATION_RESULT",
            "type": "string",
            "display": "V_DEPORTATION_RESULT",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 33,
            "name": "V_NFA_",
            "type": "string",
            "display": "V_NFA_",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 34,
            "name": "V_MAX_CONCAT_ADDRESS_USAGE",
            "type": "string",
            "display": "V_MAX_CONCAT_ADDRESS_USAGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 35,
            "name": "V_PRIMARY_ADDRESS",
            "type": "string",
            "display": "V_PRIMARY_ADDRESS",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 36,
            "name": "V_HOMLESSNESS_REFERRAL",
            "type": "string",
            "display": "V_HOMLESSNESS_REFERRAL",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 37,
            "name": "V_HDCED",
            "type": "string",
            "display": "V_HDCED",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 38,
            "name": "V_RELEASE_DATE",
            "type": "string",
            "display": "V_RELEASE_DATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 39,
            "name": "V_RECEPTION_AFTER_RELEASE_DI34",
            "type": "string",
            "display": "V_RECEPTION_AFTER_RELEASE_DI34",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DP9",
      "name": "Receptions after release",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING_BAH.BOOKING_NUMBER, AT_DIM_DATE_EXT_MOV.DAY_DATE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING_BAH, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_TO, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.FACT_BED_ASSIGNMENT_HISTORY AT_BED_ASSIGNMENT_HISTORY WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.TO_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.TO_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_SK (+)) AND (AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING_BAH.OFFENDER_BOOKING_SK = AT_BED_ASSIGNMENT_HISTORY.OFFENDER_BOOKING_SK) AND (AT_ESTABLISHMENT_EXT_MOV_TO.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Admission' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'IN' AND NOT AT_FACT_MOV_EXT.REASON_CODE IN ('NOTR', 'TRN', 'INT', 'M'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, BOOKING_NUMBER, DAY_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP9.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "BOOKING_NUMBER",
            "type": "string",
            "display": "Booking Number",
            "legacyId": "DP9.DO10b05",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "DAY_DATE",
            "type": "date",
            "display": "Movement Date Only (External)",
            "legacyId": "DP9.DO1015c",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP8",
      "name": "Alerts",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('30-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE' AND AT_ALERT.ALERT_CODE_NK IN ('SO', 'SONR', 'SOR', 'SR', 'XCSEA', 'XSO', 'SSHO', 'SC', 'XLDEPORT', 'XTACT'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK, ALERT_EFFECTIVE_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP8.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DP8.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DP8.DO10095",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPe",
      "name": "ACCT",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_ALERT.ALERT_CODE_NK, CASE WHEN AT_ALERT_EFFECT_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EFFECT_DATE.DAY_DATE ELSE NULL END AS ALERT_EFFECTIVE_DATE, AT_OFFENDER_ALERT.ALERT_STATUS, CASE WHEN AT_ALERT_EXPIRY_DATE.DAY_DATE < '31/12/9000' THEN AT_ALERT_EXPIRY_DATE.DAY_DATE ELSE NULL END AS ALERT_EXPIRY_DATE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.DIM_DATE AT_ALERT_EFFECT_DATE, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT, BODIMIS.DIM_DATE AT_ALERT_EXPIRY_DATE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_ALERT.ALERT_DATE_SK = AT_ALERT_EFFECT_DATE.DATE_SK (+)) AND (AT_OFFENDER_ALERT.ALERT_EXPIRY_DATE_SK = AT_ALERT_EXPIRY_DATE.DATE_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('30-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND AT_ALERT.ALERT_CODE_NK = 'HA')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CODE_NK, ALERT_EFFECTIVE_DATE, ALERT_STATUS, ALERT_EXPIRY_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPe.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CODE_NK",
            "type": "string",
            "display": "Alert Code",
            "legacyId": "DPe.DO1008e",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ALERT_EFFECTIVE_DATE",
            "type": "date",
            "display": "Alert Effective Date",
            "legacyId": "DPe.DO10095",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ALERT_STATUS",
            "type": "string",
            "display": "Alert Status",
            "legacyId": "DPe.DO10094",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ALERT_EXPIRY_DATE",
            "type": "date",
            "display": "Alert Expiry Date",
            "legacyId": "DPe.DO10096",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DPf",
      "name": "Homeless",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_OFFENDER_ASSESSMENTS.ASSESSMENT_CODE, AT_DIM_OFFENDER_ASSESSMENTS.ASSESSMENT_DATE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_DIM_OFFENDER_ASSESSMENTS, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT WHERE (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_DIM_OFFENDER_ASSESSMENTS.OFFENDER_BOOKING_SK (+)) AND (AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('30-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND AT_DIM_OFFENDER_ASSESSMENTS.ASSESSMENT_CODE = 'HRR')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ASSESSMENT_CODE, ASSESSMENT_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPf.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ASSESSMENT_CODE",
            "type": "string",
            "display": "Assessment Code",
            "legacyId": "DPf.DO10825",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "ASSESSMENT_DATE",
            "type": "date",
            "display": "Assessment Date",
            "legacyId": "DPf.DO10824",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP11",
      "name": "Primary address",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, DT_OFFENDER_ADDRESSES.NO_FIXED_ADDRESS_FLAG, DT_OFFENDER_ADDRESSES.PRIMARY_FLAG, DT_OFFENDER_ADDRESSES.ADDR_USAGE_DESCRIPTION, DT_OFFENDER_ADDRESSES.FLAT || ' '|| DT_OFFENDER_ADDRESSES.PREMISE || ' '|| DT_OFFENDER_ADDRESSES.STREET || ' '|| DT_OFFENDER_ADDRESSES.LOCALITY || ' '|| DT_OFFENDER_ADDRESSES.CITY_DESC || ' '|| DT_OFFENDER_ADDRESSES.POSTAL_CODE || ' '|| DT_OFFENDER_ADDRESSES.COUNTRY_DESC FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, ( select ROW_NUMBER() OVER (PARTITION BY ss.OWNER_ID ORDER BY PRIMARY_FLAG desc, ss.address_active_flag desc, ss.USAGE_ACTIVE_FLAG desc, ss.usages_dttm DESC nulls last) row_seq_filter, ss.* from ( select * from ( select AT_DIM_ADDRESSES.OWNER_ID, AT_DIM_ADDRESS_USAGES.ADDRESS_ID_NK, AT_DIM_ADDRESS_USAGES.ADDRESS_USAGE, AT_DIM_ADDRESS_USAGES.ADDR_USAGE_DESCRIPTION, AT_DIM_ADDRESS_USAGES.ACTIVE_FLAG as USAGE_ACTIVE_FLAG, AT_DIM_ADDRESSES.flat, AT_DIM_ADDRESSES.premise, AT_DIM_ADDRESSES.Street, AT_DIM_ADDRESSES.locality, AT_DIM_ADDRESSES.city_code, AT_DIM_ADDRESSES.city_desc, AT_DIM_ADDRESSES.county_code, AT_DIM_ADDRESSES.county_desc, AT_DIM_ADDRESSES.postal_code, AT_DIM_ADDRESSES.COUNTRY_CODE, AT_DIM_ADDRESSES.country_desc, AT_DIM_ADDRESSES.HOME_TEL_NO, AT_DIM_ADDRESSES.HOME_EXT_NO, AT_DIM_ADDRESSES.NO_FIXED_ADDRESS_FLAG, AT_DIM_ADDRESSES.establishment_sk, AT_DIM_ADDRESSES.PRIMARY_FLAG, AT_DIM_ADDRESSES.active_flag as address_active_flag, AT_DIM_ADDRESS_USAGES.CREATE_DATETIME, AT_DIM_ADDRESS_USAGES.MODIFY_DATETIME, COALESCE(AT_DIM_ADDRESS_USAGES.modify_datetime, AT_DIM_ADDRESS_USAGES.create_datetime) as usages_dttm from BODIMIS.DIM_ADDRESS_USAGES AT_DIM_ADDRESS_USAGES inner join BODIMIS.dim_addresses AT_DIM_ADDRESSES on AT_DIM_ADDRESS_USAGES.address_id_nk = AT_DIM_ADDRESSES.address_id_nk and AT_DIM_ADDRESSES.owner_class='OFF'  ) Addr_usages --where Addr_usages.usages_dttm is not null ) ss ) DT_OFFENDER_ADDRESSES, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODISTAGING.REF_OFFENDERS AT_BODISTAG_REF_OFFENDERS WHERE ( AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK ) AND ( AT_DIM_DATE_EXT_MOV.DATE_SK=AT_FACT_MOV_EXT.DATE_SK ) AND ( case when AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' then AT_FACT_MOV_EXT.FROM_LOCATION_SK end = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK(+) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID=CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username from context_) AND CSL.ENDYEAR >= to_char(sysdate,'YYYY')-6 ) ) AND ( AT_OFFENDER_BOOKING.OFFENDER_ID=AT_BODISTAG_REF_OFFENDERS.OFFENDER_ID(+) ) AND ( AT_BODISTAG_REF_OFFENDERS.ROOT_OFFENDER_ID=DT_OFFENDER_ADDRESSES.OWNER_ID(+) ) AND ( AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ( 'ACKLINGTON (HMP)','ALBANY (HMP)','ALDINGTON (HMP)','ALTCOURSE (HMP)','ASHFIELD (HMP)','ASHWELL (HMP)','ASKHAM GRANGE (HMP & YOI)','AYLESBURY (HMP)','BEDFORD (HMP)','BELMARSH (HMP)','BERWYN (HMP)','BIRMINGHAM (HMP)','BLAKENHURST (HMP)','BLANTYRE HOUSE (HMP)','BLUNDESTON (HMP)','BRINSFORD (HMP)','BRISTOL (HMP)','BRIXTON (HMP)','BROCKHILL (HMP & YOI)','BRONZEFIELD (HMP)','BUCKLEY HALL (HMP)','BULLINGDON (HMP)','BULLWOOD HALL (HMP)','BURE (HMP)','CAMP HILL (HMP)','CAMPSFIELD HOUSE (HMYOI)','CANTERBURY (HMP)','CARDIFF (HMP)','CASTINGTON (HMP & YOI)','CHANNINGS WOOD (HMP)','CHELMSFORD (HMP)','CLELAND (HMP)','COLCHESTER (HMYOI)','COLDINGLEY (HMP)','COOKHAM WOOD (HMP)','DARTMOOR (HMP)','DEERBOLT (HMPYOI)','DONCASTER (HMP)','DORCHESTER (HMP)','DOVEGATE (HMP)','DOWNVIEW (HMP)','DRAKE HALL (HMP & YOI)','DURHAM (HMP)','Dover Immigration Removal Centre','EAST SUTTON PARK (HMP & YOI)','EASTWOOD PARK (HMP)','EDMUNDS HILL (HMP)','ELMLEY (HMP)','ERLESTOKE (HMP)','EVERTHORPE (HMP)','EXETER (HMP)','FEATHERSTONE (HMP)','FELTHAM (HMP & YOI)','FINNAMORE (HMYOI)','FORD (HMP)','FOREST BANK (HMP & YOI)','FOSTON HALL (HMP)','FRANKLAND (HMP)','FULL SUTTON (HMP)','GARTH (HMP)','GARTREE (HMP)','GLEN PARVA (HMPYOI & RC)','GLOUCESTER (HMP)','GRENDON (HMP)','GUYS MARSH (HMP)','HATFIELD (HMP & YOI)','HAVERIGG (HMP)','HEWELL GRANGE (HMP)','HIGH DOWN (HMP)','HIGHPOINT (HMP)','HINDLEY (HMP & YOI)','HMP HEWELL','HOLLESLEY BAY (HMP)','HOLLOWAY (HMP)','HOLME HOUSE (HMP)','HULL (HMP)','HUMBER (HMP)','HUNTERCOMBE (HMP)','Haslar Immigration Removal Centre','ISIS HMP/YOI','ISLE OF WIGHT (HMP)','KENNET (HMP)','KINGSTON (HMP)','KIRKHAM (HMP)','KIRKLEVINGTON GRANGE (HMP)','LANCASTER CASTLE (HMP)','LANCASTER FARMS (HMP)','LATCHMERE HOUSE (HMP)','LEEDS (HMP)','LEICESTER (HMP)','LEWES (HMP)','LEYHILL (HMP)','LINCOLN (HMP)','LINDHOLME (HMP)','LITTLEHEY (HMP)','LIVERPOOL (HMP)','LONG LARTIN (HMP)','LOW NEWTON (HMP)','LOWDHAM GRANGE (HMP)','MAIDSTONE (HMP)','MANCHESTER (HMP)','MEDWAY (STC)','MOORLAND (HMP & YOI)','MORTON HALL IMMIGRATION REMOVAL CENTRE','NEW HALL (HMP)','NORTH SEA CAMP (HMP)','NORTHALLERTON (HMP)','NORTHEYE (HMP)','NORTHUMBERLAND (HMP)','NORWICH (HMP & YOI)','NOTTINGHAM (HMP)','OAKWOOD (HMP)','ONLEY (HMP)','OXFORD (HMP)','PARC (HMP)','PARKHURST (HMP)','PENTONVILLE (HMP)','PETERBOROUGH (HMP)','PETERBOROUGH FEMALE HMP','PORTLAND (HMPYOI)','PRESCOED (HMP & YOI)','PRESTON (HMP)','PUCKLECHURCH (HMRC)','RANBY (HMP)','READING (HMP & YOI)','RISLEY (HMP)','ROCHESTER (HMP & YOI)','ROLLESTONE (HMP)','RUDGATE (HMP)','RYE HILL (HMP)','SEND (HMP)','SHEPTON MALLET (HMP)','SHREWSBURY (HMP)','SPRING HILL (HMP)','STAFFORD (HMP)','STANDFORD HILL (HMP)','STOCKEN (HMP)','STOKE HEATH (HMPYOI)','STYAL (HMP & YOI)','SUDBURY (HMP & YOI)','SWALESIDE (HMP)','SWANSEA (HMP)','SWINFEN HALL (HMP)','THAMESIDE (HMP)','THE MOUNT (HMP)','THE VERNE (HMP)','THE WEARE (HMP)','THORN CROSS (HMPYOI)','THORP ARCH (HMP)','USK (HMP)','WAKEFIELD (HMP)','WANDSWORTH (HMP)','WARREN HILL (HMP)','WAYLAND (HMP)','WEALSTUN (HMP)','WELLINGBOROUGH (HMP)','WERRINGTON (HMPYOI)','WETHERBY (HMPYOI)','WHATTON (HMP)','WHITEMOOR (HMP)','WINCHESTER (HMP)','WOLDS (HMP)','WOODHILL (HMP)','WORMWOOD SCRUBS (HMP)','WYMOTT (HMP)' ) AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= '01-11-2020 00:00:00' AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= '30-11-2020 00:00:00' AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND ( DT_OFFENDER_ADDRESSES.ADDRESS_ACTIVE_FLAG='Y' ) AND DT_OFFENDER_ADDRESSES.PRIMARY_FLAG = 'Y' )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3375368/DP13",
      "name": "Deport",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_DESCRIPTION, AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_DESCRIPTION AS RESULT_2_DESCRIPTION FROM BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_RSN_CRG_RESULT1, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_RSN_CRG_RESULT2, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_1_DESC_SK = AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_2_DESC_SK = AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active') AND AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('30-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND (AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_DESCRIPTION IN ('Deportation Recommended', 'Immigration Decision to Deport') OR AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_DESCRIPTION IN ('Immigration Decision to Deport', 'Deportation Recommended')))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OUTCOME_REASON_DESCRIPTION, RESULT_2_DESCRIPTION FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP13.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OUTCOME_REASON_DESCRIPTION",
            "type": "string",
            "display": "Result 1 Description",
            "legacyId": "DP13.DO5e4",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "RESULT_2_DESCRIPTION",
            "type": "string",
            "display": "Result 2 Description",
            "legacyId": "DP13.DO5e6",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP14",
      "name": "SOPO / SXResults",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_DESCRIPTION, AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_DESCRIPTION AS RESULT_2_DESCRIPTION FROM BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_RSN_CRG_RESULT1, BODIMIS.DIM_OUTCOME_REASON AT_DIM_OUTCOME_RSN_CRG_RESULT2, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_1_DESC_SK = AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_SK (+)) AND (AT_FACT_COURT_CHARGE.RESULT_2_DESC_SK = AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active') AND AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('30-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND (AT_DIM_OUTCOME_RSN_CRG_RESULT1.OUTCOME_REASON_DESCRIPTION IN ('Sexual offences prevention order', 'Interim Risk of sexual harm order', 'Interim Sex Offender Order', 'Interim sexual offences prevention order', 'Notification order - sex offender', 'Restraining order Sexual offence', 'Risk of sexual harm order', 'Sex Offender Order', 'Sex Offenders Notice') OR AT_DIM_OUTCOME_RSN_CRG_RESULT2.OUTCOME_REASON_DESCRIPTION IN ('Interim Risk of sexual harm order', 'Interim Sex Offender Order', 'Interim sexual offences prevention order', 'Notification order - sex offender', 'Restraining order Sexual offence', 'Risk of sexual harm order', 'Sex Offender Order', 'Sex Offenders Notice', 'Sexual offences prevention order')))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OUTCOME_REASON_DESCRIPTION, RESULT_2_DESCRIPTION FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP14.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OUTCOME_REASON_DESCRIPTION",
            "type": "string",
            "display": "Result 1 Description",
            "legacyId": "DP14.DO5e4",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "RESULT_2_DESCRIPTION",
            "type": "string",
            "display": "Result 2 Description",
            "legacyId": "DP14.DO5e6",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP15",
      "name": "Sex Offence",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_OFFENCE.OFFENCE_NAME, CASE WHEN AT_DIM_OFFENCE.OFFENCE_SK > 0 THEN (AT_DIM_OFFENCE.OFFENCE_CODE_NK) ELSE '-' END AS OFFENCE_CJIT_CODE FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active') AND AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('30-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT' AND CASE WHEN AT_DIM_OFFENCE.OFFENCE_SK > 0 THEN (AT_DIM_OFFENCE.OFFENCE_CODE_NK) ELSE '-' END IN ('SX03000-001N', 'SX03001', 'SX03001-004N', 'SX03001A', 'SX03001A-004AN', 'SX03001B', 'SX03001C', 'SX03002', 'SX03002A', 'SX03002C', 'SX03003', 'SX03003A', 'SX03003C', 'SX03004', 'SX03004A', 'SX03004C', 'SX03005', 'SX03005-006N', 'SX03005A', 'SX03005B', 'SX03005C', 'SX03006', 'SX03006A', 'SX03006B', 'SX03006C', 'SX03007', 'SX03007-008N', 'SX03007A', 'SX03007C', 'SX03008', 'SX03008A', 'SX03008C', 'SX03009', 'SX03009-012N', 'SX03009A', 'SX03009C', 'SX03010', 'SX03010A', 'SX03010C', 'SX03011', 'SX03011A', 'SX03011C', 'SX03012', 'SX03012A', 'SX03012C', 'SX03013', 'SX03013-014N', 'SX03013A', 'SX03013B', 'SX03013C', 'SX03014', 'SX03014A', 'SX03014B', 'SX03014C', 'SX03015', 'SX03015-016N', 'SX03015A', 'SX03015C', 'SX03016', 'SX03016A', 'SX03016C', 'SX03017', 'SX03017-018N', 'SX03017A', 'SX03017B', 'SX03017C', 'SX03018', 'SX03018A', 'SX03018B', 'SX03018C', 'SX03019', 'SX03019-022N', 'SX03019A', 'SX03019C', 'SX03020', 'SX03020A', 'SX03020C', 'SX03021', 'SX03021A', 'SX03021C', 'SX03022', 'SX03022A', 'SX03022C', 'SX03023', 'SX03023A', 'SX03023B', 'SX03023C', 'SX03024', 'SX03024A', 'SX03024C', 'SX03025', 'SX03025A', 'SX03025C', 'SX03026', 'SX03026A', 'SX03026C', 'SX03027', 'SX03027-042N', 'SX03027A', 'SX03027C', 'SX03028', 'SX03028A', 'SX03028C', 'SX03029', 'SX03029A', 'SX03029C', 'SX03030', 'SX03030A', 'SX03030C', 'SX03031', 'SX03031-044N', 'SX03031A', 'SX03031B', 'SX03032', 'SX03032A', 'SX03033', 'SX03033A', 'SX03034', 'SX03034A', 'SX03035', 'SX03035-038N', 'SX03035A', 'SX03036', 'SX03036A', 'SX03037', 'SX03037A', 'SX03038', 'SX03038A', 'SX03039', 'SX03039A', 'SX03040', 'SX03040A', 'SX03041', 'SX03041A', 'SX03042', 'SX03042A', 'SX03043', 'SX03043A', 'SX03044', 'SX03044A', 'SX03045', 'SX03045-046N', 'SX03046', 'SX03047', 'SX03047A', 'SX03048', 'SX03048-049N', 'SX03049', 'SX03050', 'SX03050-192N', 'SX03051', 'SX03052', 'SX03053', 'SX03054', 'SX03054-057N', 'SX03055', 'SX03056', 'SX03057', 'SX03058', 'SX03058-059N', 'SX03059', 'SX03060', 'SX03060-200N', 'SX03061', 'SX03062', 'SX03062-175N', 'SX03062C', 'SX03063', 'SX03063C', 'SX03064', 'SX03064C', 'SX03065', 'SX03065C', 'SX03066', 'SX03066C', 'SX03067', 'SX03067C', 'SX03068', 'SX03068C', 'SX03069', 'SX03069C', 'SX03070', 'SX03070-077N', 'SX03071', 'SX03072', 'SX03073', 'SX03074', 'SX03075', 'SX03076', 'SX03077', 'SX03078', 'SX03078-081N', 'SX03079', 'SX03080', 'SX03081', 'SX03082', 'SX03082-085N', 'SX03083', 'SX03084', 'SX03085', 'SX03086', 'SX03087', 'SX03088', 'SX03088-089N', 'SX03089', 'SX03090', 'SX03090-091N', 'SX03091', 'SX03092', 'SX03093', 'SX03094', 'SX03094-097N', 'SX03095', 'SX03096', 'SX03097', 'SX03098', 'SX03098-099N', 'SX03099', 'SX03100', 'SX03101', 'SX03102', 'SX03102-111N', 'SX03103', 'SX03104', 'SX03105', 'SX03106', 'SX03106A', 'SX03107', 'SX03108', 'SX03109', 'SX03110', 'SX03111', 'SX03112', 'SX03112-113N', 'SX03113', 'SX03113A', 'SX03114', 'SX03114-115N', 'SX03115', 'SX03116', 'SX03116-117N', 'SX03116C', 'SX03117', 'SX03117C', 'SX03118', 'SX03119', 'SX03120', 'SX03121', 'SX03122', 'SX03123', 'SX03124', 'SX03125', 'SX03126', 'SX03127', 'SX03128', 'SX03129', 'SX03129-132N', 'SX03129A', 'SX03130', 'SX03131', 'SX03132', 'SX03133', 'SX03133-136N', 'SX03133B', 'SX03134', 'SX03136', 'SX03137', 'SX03145', 'SX03146', 'SX03147', 'SX03148', 'SX03149', 'SX03149A', 'SX03150', 'SX03150A', 'SX03151', 'SX03152', 'SX03153', 'SX03154', 'SX03156', 'SX03157', 'SX03157B', 'SX03158', 'SX03158A', 'SX03159', 'SX03160', 'SX03161', 'SX03161A', 'SX03162', 'SX03162A', 'SX03163', 'SX03164', 'SX03164-188N', 'SX03165', 'SX03166', 'SX03167', 'SX03168', 'SX03169', 'SX03170', 'SX03170A', 'SX03171', 'SX03172', 'SX03172C', 'SX03173', 'SX03173C', 'SX03174', 'SX03174C', 'SX03175', 'SX03175C', 'SX03176', 'SX03177', 'SX03178', 'SX03179', 'SX03180', 'SX03181', 'SX03181C', 'SX03182', 'SX03182C', 'SX03183', 'SX03183C', 'SX03184', 'SX03184C', 'SX03185', 'SX03186', 'SX03187', 'SX03188', 'SX03189', 'SX03190', 'SX03191', 'SX03192', 'SX03193', 'SX03194', 'SX03195', 'SX03196', 'SX03197', 'SX03198', 'SX03199', 'SX03200', 'SX03201', 'SX03201A', 'SX03202', 'SX03203', 'SX03204', 'SX03205', 'SX03206', 'SX03207', 'SX03208', 'SX03209', 'SX03210', 'SX03210A', 'SX03211', 'SX03211A', 'SX03212', 'SX03213', 'SX03214', 'SX03215', 'SX03216', 'SX03217', 'SX03218', 'SX03219', 'SX03220', 'SX03220A', 'SX03221', 'SX03222', 'SX03223', 'SX03224', 'SX03224A', 'SX03225', 'SX03225A', 'SX03226', 'SX03226A', 'SX03227', 'SX03227C', 'SX03228', 'SX03228C', 'SX03229', 'SX03230', 'SX03230A', 'SX03231', 'SX03232', 'SX03233', 'SX03234', 'SX03501', 'SX03502', 'SX03503', 'SX03504', 'SX03505', 'SX03506', 'SX03507', 'SX03508', 'SX03509', 'SX03510', 'SX03511', 'SX03512', 'SX03513', 'SX03514', 'SX03515', 'SX03516', 'SX03517', 'SX03518', 'SX03519', 'SX03520', 'SX03521', 'SX03522', 'SX03523', 'SX03524', 'SX03525', 'SX03526', 'SX03527', 'SX03528', 'SX03529', 'SX03530', 'SX03531', 'SX03532', 'SX56001', 'SX56002', 'SX56003', 'SX56004', 'SX56004N', 'SX56005', 'SX56005-006N', 'SX56006', 'SX56007', 'SX56007N', 'SX56008', 'SX56008N', 'SX56009', 'SX56010', 'SX56011', 'SX56013', 'SX56013-122N', 'SX56013A', 'SX56013A-019AN', 'SX56014', 'SX56014-074N', 'SX56014A', 'SX56015', 'SX56015A', 'SX56016', 'SX56016A', 'SX56017', 'SX56017A', 'SX56018', 'SX56018A', 'SX56019', 'SX56019A', 'SX56021', 'SX56021-120N', 'SX56022', 'SX56023', 'SX56023A', 'SX56024', 'SX56024A', 'SX56025', 'SX56025-029N', 'SX56026', 'SX56026A', 'SX56026B', 'SX56027', 'SX56028', 'SX56029', 'SX56029A', 'SX56030', 'SX56031', 'SX56031N', 'SX56032', 'SX56032N', 'SX56033', 'SX56035', 'SX56036', 'SX56037', 'SX56037N', 'SX56038', 'SX56038N', 'SX56039', 'SX56039-118N', 'SX56040', 'SX56041', 'SX56042', 'SX56042N', 'SX56043', 'SX56043N', 'SX56044', 'SX56045', 'SX56046', 'SX56046N', 'SX56047', 'SX56047-050N', 'SX56048', 'SX56049', 'SX56050', 'SX56051', 'SX56051-052N', 'SX56051-052NA', 'SX56052', 'SX56053', 'SX56053N', 'SX56054', 'SX56057', 'SX56058', 'SX56063', 'SX56064', 'SX56065', 'SX56066', 'SX56067', 'SX56068', 'SX56069', 'SX56070', 'SX56070-072N', 'SX56070A', 'SX56071A', 'SX56072', 'SX56072A', 'SX56073', 'SX56073A', 'SX56074', 'SX56075', 'SX56076', 'SX56077', 'SX56078', 'SX56079', 'SX56080', 'SX56081', 'SX56082', 'SX56083', 'SX56084', 'SX56085', 'SX56086', 'SX56087', 'SX56087-088N', 'SX56087A', 'SX56088', 'SX56088A', 'SX56089', 'SX56090', 'SX56091', 'SX56092', 'SX56096', 'SX56096C', 'SX56097', 'SX56099', 'SX56100', 'SX56101', 'SX56102', 'SX56103', 'SX56104', 'SX56105', 'SX56106', 'SX56107', 'SX56108', 'SX56109', 'SX56110', 'SX56111', 'SX56112', 'SX56113', 'SX56114', 'SX56115', 'SX56116', 'SX56118', 'SX56119', 'SX56120', 'SX56121', 'SX56122', 'SX56123', 'SX67001', 'SX67001N', 'SX67002', 'SX67002N', 'SX85001', 'SX85004', 'SX85007'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OFFENCE_NAME, OFFENCE_CJIT_CODE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP15.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DP15.DO4b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OFFENCE_CJIT_CODE",
            "type": "string",
            "display": "Offence CJIT Code",
            "legacyId": "DP15.DO49",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP3",
      "name": "Load End Date",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP3.DO104dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3375368/DP16",
      "name": "All Offences",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_OFFENCE.OFFENCE_NAME, CASE WHEN AT_DIM_OFFENCE.OFFENCE_SK > 0 THEN (AT_DIM_OFFENCE.OFFENCE_CODE_NK) ELSE '-' END AS OFFENCE_CJIT_CODE FROM BODIMIS.DIM_OFFENCE AT_DIM_OFFENCE, BODIMIS.FACT_COURT_CHARGE AT_FACT_COURT_CHARGE, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_EXT_MOV_FROM, BODIMIS.DIM_DATE AT_DIM_DATE_EXT_MOV, BODIMIS.FACT_MOVEMENT_EXTERNAL AT_FACT_MOV_EXT, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_FACT_COURT_CHARGE.OFFENCE_SK = AT_DIM_OFFENCE.OFFENCE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_CHARGE.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_FACT_MOV_EXT.OFFENDER_BOOKING_SK (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK) AND (AT_DIM_DATE_EXT_MOV.DATE_SK = AT_FACT_MOV_EXT.DATE_SK) AND (CASE WHEN AT_FACT_MOV_EXT.FROM_LOCATION_TYPE = 'Establishment' THEN AT_FACT_MOV_EXT.FROM_LOCATION_SK END = AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND ((AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active') AND AT_ESTABLISHMENT_EXT_MOV_FROM.ESTABLISHMENT_DESCRIPTION IN ('ACKLINGTON (HMP)', 'ALBANY (HMP)', 'ALDINGTON (HMP)', 'ALTCOURSE (HMP)', 'ASHFIELD (HMP)', 'ASHWELL (HMP)', 'ASKHAM GRANGE (HMP & YOI)', 'AYLESBURY (HMP)', 'BEDFORD (HMP)', 'BELMARSH (HMP)', 'BERWYN (HMP)', 'BIRMINGHAM (HMP)', 'BLAKENHURST (HMP)', 'BLANTYRE HOUSE (HMP)', 'BLUNDESTON (HMP)', 'BRINSFORD (HMP)', 'BRISTOL (HMP)', 'BRIXTON (HMP)', 'BROCKHILL (HMP & YOI)', 'BRONZEFIELD (HMP)', 'BUCKLEY HALL (HMP)', 'BULLINGDON (HMP)', 'BULLWOOD HALL (HMP)', 'BURE (HMP)', 'CAMP HILL (HMP)', 'CAMPSFIELD HOUSE (HMYOI)', 'CANTERBURY (HMP)', 'CARDIFF (HMP)', 'CASTINGTON (HMP & YOI)', 'CHANNINGS WOOD (HMP)', 'CHELMSFORD (HMP)', 'CLELAND (HMP)', 'COLCHESTER (HMYOI)', 'COLDINGLEY (HMP)', 'COOKHAM WOOD (HMP)', 'DARTMOOR (HMP)', 'DEERBOLT (HMPYOI)', 'DONCASTER (HMP)', 'DORCHESTER (HMP)', 'DOVEGATE (HMP)', 'DOWNVIEW (HMP)', 'DRAKE HALL (HMP & YOI)', 'DURHAM (HMP)', 'Dover Immigration Removal Centre', 'EAST SUTTON PARK (HMP & YOI)', 'EASTWOOD PARK (HMP)', 'EDMUNDS HILL (HMP)', 'ELMLEY (HMP)', 'ERLESTOKE (HMP)', 'EVERTHORPE (HMP)', 'EXETER (HMP)', 'FEATHERSTONE (HMP)', 'FELTHAM (HMP & YOI)', 'FINNAMORE (HMYOI)', 'FORD (HMP)', 'FOREST BANK (HMP & YOI)', 'FOSTON HALL (HMP)', 'FRANKLAND (HMP)', 'FULL SUTTON (HMP)', 'GARTH (HMP)', 'GARTREE (HMP)', 'GLEN PARVA (HMPYOI & RC)', 'GLOUCESTER (HMP)', 'GRENDON (HMP)', 'GUYS MARSH (HMP)', 'HATFIELD (HMP & YOI)', 'HAVERIGG (HMP)', 'HEWELL GRANGE (HMP)', 'HIGH DOWN (HMP)', 'HIGHPOINT (HMP)', 'HINDLEY (HMP & YOI)', 'HMP HEWELL', 'HOLLESLEY BAY (HMP)', 'HOLLOWAY (HMP)', 'HOLME HOUSE (HMP)', 'HULL (HMP)', 'HUMBER (HMP)', 'HUNTERCOMBE (HMP)', 'Haslar Immigration Removal Centre', 'ISIS HMP/YOI', 'ISLE OF WIGHT (HMP)', 'KENNET (HMP)', 'KINGSTON (HMP)', 'KIRKHAM (HMP)', 'KIRKLEVINGTON GRANGE (HMP)', 'LANCASTER CASTLE (HMP)', 'LANCASTER FARMS (HMP)', 'LATCHMERE HOUSE (HMP)', 'LEEDS (HMP)', 'LEICESTER (HMP)', 'LEWES (HMP)', 'LEYHILL (HMP)', 'LINCOLN (HMP)', 'LINDHOLME (HMP)', 'LITTLEHEY (HMP)', 'LIVERPOOL (HMP)', 'LONG LARTIN (HMP)', 'LOW NEWTON (HMP)', 'LOWDHAM GRANGE (HMP)', 'MAIDSTONE (HMP)', 'MANCHESTER (HMP)', 'MEDWAY (STC)', 'MOORLAND (HMP & YOI)', 'MORTON HALL IMMIGRATION REMOVAL CENTRE', 'NEW HALL (HMP)', 'NORTH SEA CAMP (HMP)', 'NORTHALLERTON (HMP)', 'NORTHEYE (HMP)', 'NORTHUMBERLAND (HMP)', 'NORWICH (HMP & YOI)', 'NOTTINGHAM (HMP)', 'OAKWOOD (HMP)', 'ONLEY (HMP)', 'OXFORD (HMP)', 'PARC (HMP)', 'PARKHURST (HMP)', 'PENTONVILLE (HMP)', 'PETERBOROUGH (HMP)', 'PETERBOROUGH FEMALE HMP', 'PORTLAND (HMPYOI)', 'PRESCOED (HMP & YOI)', 'PRESTON (HMP)', 'PUCKLECHURCH (HMRC)', 'RANBY (HMP)', 'READING (HMP & YOI)', 'RISLEY (HMP)', 'ROCHESTER (HMP & YOI)', 'ROLLESTONE (HMP)', 'RUDGATE (HMP)', 'RYE HILL (HMP)', 'SEND (HMP)', 'SHEPTON MALLET (HMP)', 'SHREWSBURY (HMP)', 'SPRING HILL (HMP)', 'STAFFORD (HMP)', 'STANDFORD HILL (HMP)', 'STOCKEN (HMP)', 'STOKE HEATH (HMPYOI)', 'STYAL (HMP & YOI)', 'SUDBURY (HMP & YOI)', 'SWALESIDE (HMP)', 'SWANSEA (HMP)', 'SWINFEN HALL (HMP)', 'THAMESIDE (HMP)', 'THE MOUNT (HMP)', 'THE VERNE (HMP)', 'THE WEARE (HMP)', 'THORN CROSS (HMPYOI)', 'THORP ARCH (HMP)', 'USK (HMP)', 'WAKEFIELD (HMP)', 'WANDSWORTH (HMP)', 'WARREN HILL (HMP)', 'WAYLAND (HMP)', 'WEALSTUN (HMP)', 'WELLINGBOROUGH (HMP)', 'WERRINGTON (HMPYOI)', 'WETHERBY (HMPYOI)', 'WHATTON (HMP)', 'WHITEMOOR (HMP)', 'WINCHESTER (HMP)', 'WOLDS (HMP)', 'WOODHILL (HMP)', 'WORMWOOD SCRUBS (HMP)', 'WYMOTT (HMP)') AND AT_DIM_DATE_EXT_MOV.DAY_DATE >= TO_DATE('01-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_DIM_DATE_EXT_MOV.DAY_DATE <= TO_DATE('30-11-2020 00:00:00', 'DD-MM-YYYY HH24:MI:SS') AND AT_FACT_MOV_EXT.TYPE = 'Release' AND AT_FACT_MOV_EXT.DIRECTION_CODE = 'OUT')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, OFFENCE_NAME, OFFENCE_CJIT_CODE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP16.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "OFFENCE_NAME",
            "type": "string",
            "display": "Offence Name",
            "legacyId": "DP16.DO4b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OFFENCE_CJIT_CODE",
            "type": "string",
            "display": "Offence CJIT Code",
            "legacyId": "DP16.DO49",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "137598.RS",
      "name": "Discharges by Date",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE HDC_REVIEW_FLAG IS NULL)"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:BOOKING_NUMBER",
            "display": "Booking Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10b05"
          },
          {
            "name": "$ref:DAY_DATE",
            "display": "Booking Start Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10b0b"
          },
          {
            "name": "$ref:GENDER_DESCRIPTION",
            "display": "Gender Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO100a9"
          },
          {
            "name": "$ref:TRUNCATE_AGE_ON_RELEASE",
            "display": "Age on Release",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Truncate([v_Age_on_release];0)"
          },
          {
            "name": "$ref:V_SEX_ALL",
            "display": "Sex Offences, Orders or Alerts?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_Sex_Offender_alerts] = \"Yes\" Or [v_SOPO_Result] = \"Yes\" Or[v_SX_Offences?] = \"Yes\"; \"Yes\";\"No\")"
          },
          {
            "name": "$ref:V_MAX_CONCAT_ALL_OFFENCES",
            "display": "Offences",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_all_offences] Where ([v_All_Offences]= [v_Max_All_offences]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_ACCT_ALERT",
            "display": "ACCT on booking?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([ACCT].[Alert Code]);\"No\";\"Yes\")"
          },
          {
            "name": "$ref:V_MAX_ACCT_EFFECTIVE_DATE",
            "display": "Start Date of latest ACCT",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([ACCT].[Alert Effective Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_ACCT_EXPIRY_DATE",
            "display": "Expiry Date of latest ACCT",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([Alert Expiry Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_XTACT_ALERT",
            "display": "TACT Alert?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alerts].[Alert Code] = \"XTACT\";\"Yes\")"
          },
          {
            "name": "$ref:V_DEPORT_ALERT",
            "display": "Deport Alert?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alerts].[Alert Code] = \"XLDEPORT\";\"Yes\")"
          },
          {
            "name": "$ref:V_DEPORTATION_RESULT",
            "display": "Deport Result Outcome",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([Deport].[Result 1 Description]);([Deport].[Result 2 Description]);If(IsNull([Deport].[Result 2 Description]);\"No\";\"Yes\"))"
          },
          {
            "name": "$ref:V_NFA_",
            "display": "NFA?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offender Address No Fixed Abode Flag]"
          },
          {
            "name": "$ref:V_MAX_CONCAT_ADDRESS_USAGE",
            "display": "Primary address usage",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_Concat_Address_Usage] Where ([Offender Address Usage Desc]= [v_Max_Address_Usage]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_PRIMARY_ADDRESS",
            "display": "Primary Address",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Offender Address Full]"
          },
          {
            "name": "$ref:V_HOMLESSNESS_REFERRAL",
            "display": "Homeless Referral created?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Assessment Code] = \"HRR\"; \"Yes\";\"No\")"
          },
          {
            "name": "$ref:V_ASSESSMENT_DATE",
            "display": "Homeless Referral Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Max([Assessment Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:LEGAL_STATUS_GROUPING",
            "display": "Legal Status Grouping",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO107cb"
          },
          {
            "name": "$ref:MAIN_LEGAL_STATUS_DESCRIPTION",
            "display": "Main Legal Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO100df"
          },
          {
            "name": "$ref:TYPE_DESCRIPTION_FROM",
            "display": "Movement Description (From)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO10700"
          },
          {
            "name": "$ref:REASON_CODE",
            "display": "Movement Reason Code (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO103fc"
          },
          {
            "name": "$ref:REASON",
            "display": "Movement Description (External)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO1015b"
          },
          {
            "name": "$ref:HDC_CHECKS_DONE_DATE",
            "display": "HDC Checks Done Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO54a"
          },
          {
            "name": "$ref:HDC_PASSED_FLAG",
            "display": "HDC Passed Flag",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO3ad"
          },
          {
            "name": "$ref:HDC_ASSMENT_APP_STATUS_DESC",
            "display": "HDC Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO54"
          },
          {
            "name": "$ref:V_HDCED",
            "display": "HDCED",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([HDCED] = '31/12/9000'; \" \";[HDCED])"
          },
          {
            "name": "$ref:CURR_HDCAD_DATE",
            "display": "HDC AD (Approved Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO97"
          },
          {
            "name": "$ref:CURR_ARD_DATE",
            "display": "ARD (Approved Release Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO47"
          },
          {
            "name": "$ref:CURR_CRD_DATE",
            "display": "CRD (Conditional Release Date)",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO48"
          },
          {
            "name": "$ref:V_RELEASE_DATE",
            "display": "Actual Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Discharges].[Movement Date Only (External)]"
          },
          {
            "name": "$ref:V_RECEPTION_AFTER_RELEASE_DI34",
            "display": "Admission after release?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number])"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:TRUNCATE_AGE_ON_RELEASE :: Error: =Truncate([v_Age_on_release];0) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_SEX_ALL :: Error: =If([v_Sex_Offender_alerts] = \"Yes\" Or [v_SOPO_Result] = \"Yes\" Or[v_SX_Offences?] = \"Yes\"; \"Yes\";\"No\") ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_ALL_OFFENCES :: Error: =[v_concat_all_offences] Where ([v_All_Offences]= [v_Max_All_offences]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:73",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_ADDRESS_USAGE :: Error: =[v_Concat_Address_Usage] Where ([Offender Address Usage Desc]= [v_Max_Address_Usage]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:88",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_PRIMARY_ADDRESS :: ReferenceError: error is not defined",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_HOMLESSNESS_REFERRAL :: ReferenceError: error is not defined",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_HDCED :: Error: =If([HDCED] = '31/12/9000'; \" \";[HDCED]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_RECEPTION_AFTER_RELEASE_DI34 :: Error: =If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:TRUNCATE_AGE_ON_RELEASE :: Error: =Truncate([v_Age_on_release];0) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_SEX_ALL :: Error: =If([v_Sex_Offender_alerts] = \"Yes\" Or [v_SOPO_Result] = \"Yes\" Or[v_SX_Offences?] = \"Yes\"; \"Yes\";\"No\") ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_ALL_OFFENCES :: Error: =[v_concat_all_offences] Where ([v_All_Offences]= [v_Max_All_offences]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:73",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MAX_ACCT_EFFECTIVE_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 35.\n  MAX(ACCT.ALERT_EFFECTIVE_DATE) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_MAX_ACCT_EXPIRY_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 27.\n  MAX(ALERT_EXPIRY_DATE) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_ADDRESS_USAGE :: Error: =[v_Concat_Address_Usage] Where ([Offender Address Usage Desc]= [v_Max_Address_Usage]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:88",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_PRIMARY_ADDRESS :: ReferenceError: error is not defined",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HOMLESSNESS_REFERRAL :: ReferenceError: error is not defined",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_ASSESSMENT_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 25.\n  MAX(ASSESSMENT_DATE) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_HDCED :: Error: =If([HDCED] = '31/12/9000'; \" \";[HDCED]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_RECEPTION_AFTER_RELEASE_DI34 :: Error: =If(Max([v_Reception_date_after_release] >= ([v_release_date]));\"Yes\";\"No\") In ([NOMS Number]) ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::fixSqlFormatting sql is not valid [Expecting ). Line 1, Col: 1871.\n  ESS_USAGES.address_id_nk = AT_DIM_ADDRESSES.address_id_nk and AT_DIM_ADDRESSES.owner_class='OFF'  ) \u001b[4mAddr_usages\u001b[0m --where Addr_usages.usages_dttm is not null ) ss ) DT_OFFENDER_ADDRESSES, BODIMIS.DIM_ESTABLISHMENT]",
      "entityId": "FrltTl98EwwATEQBAHCrTl8WACJIAFJ8",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Dataset does not have any schema fields (comments -- in query)",
      "entityId": "3375368/DP11",
      "entityType": "dataset"
    },
    {
      "type": "schema",
      "error": "Report field V_MAX_ACCT_EFFECTIVE_DATE does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_MAX_ACCT_EXPIRY_DATE does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_ASSESSMENT_DATE does not have corresponding dataset schema field",
      "entityId": "137598.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DP2",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "unable to generate test sql",
      "entityId": "3375368/DP11",
      "entityType": "dataset"
    }
  ]
}