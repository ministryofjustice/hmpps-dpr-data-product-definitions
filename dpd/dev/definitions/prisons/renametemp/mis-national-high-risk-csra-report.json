{
  "id": "Fn6fq1rjEAYAkmsBAHDbel8AACJIAFe4",
  "name": "MIS National High Risk CSRA Report ",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "ACC0058",
      "High Risk CSRA"
    ]
  },
  "description": "Shows High Risk CSRA information for all prisoners in an establishment. The Report has been designed for HQ staff, however, the report may also benefit Establishments<br/>ACC0058 v00.00.01 Last Modified: 16/03/2018 ",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3376639/DP0",
      "name": "Current CSRA",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_DIM_OFFENDER_ASSESSMENTS.ASSESSMENT_DATE, AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_CSRA_REVIEW_DATE, AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_CSRA_LEVEL, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION, COUNT(DISTINCT (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY)) AS COUNT_OF_OFFENDERS FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_ASSESSMENT AT_DIM_OFFENDER_ASSESSMENTS WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_DIM_OFFENDER_ASSESSMENTS.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ('All') OR 'All' IN ('All')) AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_CSRA_FLAG = 'Y' AND AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_CSRA_LEVEL = 'High') GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_DIM_OFFENDER_ASSESSMENTS.ASSESSMENT_DATE, AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_CSRA_REVIEW_DATE, AT_DIM_OFFENDER_ASSESSMENTS.CURRENT_CSRA_LEVEL, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, UNIT_4_SHORT_DESCRIPTION, ASSESSMENT_DATE, CURRENT_CSRA_REVIEW_DATE, CURRENT_CSRA_LEVEL, ESTABLISHMENT_CODE_NK, ESTABLISHMENT_DESCRIPTION, COUNT_OF_OFFENDERS, 'TBD' AS V_AVERAGE, CASE WHEN V_CURRENTCSRALEVEL = 'High' THEN V_CSRACURRENTREVIEWDATE ELSE '-' END AS V_CSRAREVIEWDATEHIGHONLY FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP0.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP0.DO7b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP0.DO80",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP0.DOa7c",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "ASSESSMENT_DATE",
            "type": "date",
            "display": "Assessment Date",
            "legacyId": "DP0.DO824",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "CURRENT_CSRA_REVIEW_DATE",
            "type": "date",
            "display": "CSRA - Current Review Date",
            "legacyId": "DP0.DO82f",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CURRENT_CSRA_LEVEL",
            "type": "string",
            "display": "CSRA - Current Level",
            "legacyId": "DP0.DO831",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Associated Establishment Code",
            "legacyId": "DP0.DO7b2",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Associated Establishment Name",
            "legacyId": "DP0.DO7b1",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "COUNT_OF_OFFENDERS",
            "type": "double",
            "display": "Count of Offenders",
            "legacyId": "DP0.DO655",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "V_AVERAGE",
            "type": "string",
            "display": "V_AVERAGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 11,
            "name": "V_CSRAREVIEWDATEHIGHONLY",
            "type": "string",
            "display": "V_CSRAREVIEWDATEHIGHONLY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3376639/DP3",
      "name": "All Prisoners",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, COUNT(DISTINCT (AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY)) AS COUNT_OF_OFFENDERS, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ('All') OR 'All' IN ('All')) AND (AT_OFFENDER_BOOKING.MIS_CURRENT_RECORD_IND = 'Y') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y')) GROUP BY AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SURNAME, FIRST_NAME, UNIT_4_SHORT_DESCRIPTION, COUNT_OF_OFFENDERS, ESTABLISHMENT_CODE_NK, ESTABLISHMENT_DESCRIPTION, 'TBD' AS V_AVERAGE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP3.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DP3.DO7b",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DP3.DO80",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DP3.DOa7c",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "COUNT_OF_OFFENDERS",
            "type": "double",
            "display": "Count of Offenders",
            "legacyId": "DP3.DO655",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Associated Establishment Code",
            "legacyId": "DP3.DO7b2",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Associated Establishment Name",
            "legacyId": "DP3.DO7b1",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "V_AVERAGE",
            "type": "string",
            "display": "V_AVERAGE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3376639/DP1",
      "name": "MIS Load",
      "description": "MIS Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP1.DO4dd",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "201252.RS",
      "name": "Cat B Local",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('DONCASTER (HMP)','LEICESTER (HMP)','LIVERPOOL (HMP)','HULL (HMP)','BRISTOL (HMP)','DURHAM (HMP)','LEEDS (HMP)','HOLME HOUSE (HMP)','EXETER (HMP)','NOTTINGHAM (HMP)','ALTCOURSE (HMP)','PRESTON (HMP)','PETERBOROUGH (HMP)','NORWICH (HMP & YOI)','LINCOLN (HMP)','WINCHESTER (HMP)','FOREST BANK (HMP & YOI)','PARC (HMP)','BEDFORD (HMP)','CHELMSFORD (HMP)','HIGH DOWN (HMP)','CARDIFF (HMP)','LEWES (HMP)','PENTONVILLE (HMP)','BIRMINGHAM (HMP)','WORMWOOD SCRUBS (HMP)','ELMLEY (HMP)','SWANSEA (HMP)','HMP HEWELL','THAMESIDE (HMP)','BULLINGDON (HMP)','WANDSWORTH (HMP)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "204826.RS",
      "name": "Cat B Trainer",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('GARTH (HMP)','GARTREE (HMP)','LOWDHAM GRANGE (HMP)','DOVEGATE (HMP)','SWALESIDE (HMP)','ISLE OF WIGHT (HMP)','RYE HILL (HMP)','GRENDON (HMP)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "204882.RS",
      "name": "Cat C Trainer",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('HUMBER (HMP)','MOORLAND (HMP & YOI)','HAVERIGG (HMP)','BUCKLEY HALL (HMP)','WEALSTUN (HMP)','SWINFEN HALL (HMP)','LANCASTER FARMS (HMP)','STOKE HEATH (HMPYOI)','RISLEY (HMP)','HINDLEY (HMP & YOI)','NORTHUMBERLAND (HMP)','BERWYN (HMP)','STOCKEN (HMP)','ONLEY (HMP)','WYMOTT (HMP)','WARREN HILL (HMP)','BURE (HMP)','DARTMOOR (HMP)','ERLESTOKE (HMP)','CHANNINGS WOOD (HMP)','PORTLAND (HMPYOI)','FEATHERSTONE (HMP)','LITTLEHEY (HMP)','WAYLAND (HMP)','HIGHPOINT (HMP)','GUYS MARSH (HMP)','WHATTON (HMP)','OAKWOOD (HMP)','ASHFIELD (HMP)','ROCHESTER (HMP & YOI)','BRIXTON (HMP)','HUNTERCOMBE (HMP)','STAFFORD (HMP)','MAIDSTONE (HMP)','USK (HMP)','THE MOUNT (HMP)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "204928.RS",
      "name": "Core Local",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('WOODHILL (HMP)','MANCHESTER (HMP)','BELMARSH (HMP)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "204974.RS",
      "name": "Dispersal",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('FRANKLAND (HMP)','LONG LARTIN (HMP)','WHITEMOOR (HMP)','FULL SUTTON (HMP)','WAKEFIELD (HMP)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "205020.RS",
      "name": "Women",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('NEW HALL (HMP)','FOSTON HALL (HMP)','LOW NEWTON (HMP)','BRONZEFIELD (HMP)','PETERBOROUGH FEMALE HMP','EASTWOOD PARK (HMP)','DOWNVIEW (HMP)','SEND (HMP)','STYAL (HMP & YOI)','DRAKE HALL (HMP & YOI)','EAST SUTTON PARK (HMP & YOI)','ASKHAM GRANGE (HMP & YOI)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "205064.RS",
      "name": "IRC",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('MORTON HALL IMMIGRATION REMOVAL CENTRE','THE VERNE IMMIGRATION REMOVAL CENTRE'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "205110.RS",
      "name": "Open",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('THORN CROSS (HMPYOI)','KIRKLEVINGTON GRANGE (HMP)','KIRKHAM (HMP)','NORTH SEA CAMP (HMP)','HOLLESLEY BAY (HMP)','STANDFORD HILL (HMP)','SPRING HILL (HMP)','LEYHILL (HMP)','SUDBURY (HMP & YOI)','FORD (HMP)','HATFIELD (HMP & YOI)','PRESCOED (HMP & YOI)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "205154.RS",
      "name": "Working Prison",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('LINDHOLME (HMP)','RANBY (HMP)','COLDINGLEY (HMP)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "205198.RS",
      "name": "Young Adult",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('DEERBOLT (HMPYOI)','AYLESBURY (HMP)','ISIS HMP/YOI','BRINSFORD (HMP)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "205242.RS",
      "name": "YP",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE ASSOCIATED_ESTABLISHMENT_NAME IN ('WETHERBY (HMPYOI)','WERRINGTON (HMPYOI)','COOKHAM WOOD (HMP)','FELTHAM (HMP & YOI)','MEDWAY (STC)'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO7b2"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP3.DO655"
          },
          {
            "name": "$ref:COUNT_OF_OFFENDERS",
            "display": "Count of Offenders",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO655"
          },
          {
            "name": "$ref:V_DIFFERENCE_IN_POP",
            "display": "% of HR CSRA    Red - Above Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=([Current CSRA].[Count of Offenders]/[All Prisoners].[Count of Offenders])"
          },
          {
            "name": "$ref:V_AVERAGE",
            "display": "Average",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Average([v_Difference_in_pop]) In Report"
          }
        ]
      }
    },
    {
      "id": "203646.RS",
      "name": "Detail",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DP0",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP0.DO76"
          },
          {
            "name": "$ref:V_CSRAREVIEWDATEHIGHONLY",
            "display": "Assessment Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([v_CurrentCSRALevel]=\"High\";[v_CSRACurrentReviewDate];\"-\")"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_AVERAGE :: Error: =Average([v_Difference_in_pop]) In Report ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "Fn6fq1rjEAYAkmsBAHDbel8AACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_DIFFERENCE_IN_POP :: Error: argument 'sql': 'float' object cannot be converted to 'PyString'",
      "entityId": "Fn6fq1rjEAYAkmsBAHDbel8AACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_AVERAGE :: Error: =Average([v_Difference_in_pop]) In Report ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "Fn6fq1rjEAYAkmsBAHDbel8AACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_AVERAGE :: Error: =Average([v_Difference_in_pop]) In Report ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "Fn6fq1rjEAYAkmsBAHDbel8AACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_DIFFERENCE_IN_POP :: Error: argument 'sql': 'float' object cannot be converted to 'PyString'",
      "entityId": "Fn6fq1rjEAYAkmsBAHDbel8AACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_AVERAGE :: Error: =Average([v_Difference_in_pop]) In Report ==> Error: Expected expression but \"=\" found.\n at undefined:1:1",
      "entityId": "Fn6fq1rjEAYAkmsBAHDbel8AACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "201252.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "204826.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "204882.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "204928.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "204974.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "205020.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "205064.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "205110.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "205154.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "205198.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_DIFFERENCE_IN_POP does not have corresponding dataset schema field",
      "entityId": "205242.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3376639/DP0",
      "entityType": "dataset"
    }
  ]
}