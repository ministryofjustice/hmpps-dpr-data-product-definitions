{
  "id": "FlCbiwEPMAgAozg8AADn7oLRACJIAGE1",
  "name": "ORS HMIP Unallocated and Unemployed Prisoners",
  "description": "This report shows the active prisoners who are on the wait list, whether approved or pending and another tab for rejected.  The report also displays the Prisoners current activities, Prisoners who are unemployed but on a Wait List, also those who are not allocated and not on Wait List.  The list is for HMIP and excludes Indeterminate Sentenced Prisoners<br/>IOP0009 - v1.0 Last Modified: 01/03/2022",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "IOP0009",
      "Activities",
      "Wait List",
      "Current Activities",
      "Rejected",
      "HMIP"
    ]
  },
  "datasource": [
    {
      "id": "nomis",
      "name": "NOMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "nomis"
    }
  ],
  "dataset": [
    {
      "id": "3377239/DP8",
      "name": "Current Prisoners",
      "description": "OR - Activities",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER.LAST_NAME, SUBSTR(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, LENGTH(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID) + 2, LENGTH(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)) AS UNIT_DESCRIPTION_4_SHORT, DT_ADMISSION.ADMISSION_DATE, CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_OFFENDERS_LOCATIONS.DESCRIPTION, CURR_EFF_SENT_LEN.CURR_EFF_SENT_LEN, AT_OFFENDER.BIRTH_DATE, CASE WHEN AT_OFFENDER.RACE_CODE = 'W8' THEN 'W3' WHEN AT_OFFENDER.RACE_CODE = 'O1' THEN 'A4' ELSE AT_OFFENDER.RACE_CODE END AS ETHNIC_CODE FROM OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS, OMS_OWNER.IMPRISONMENT_STATUSES AT_IMPRISON_STATUSES, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, (SELECT DISTINCT m.OFFENDER_BOOK_ID, MAX(m.MOVEMENT_TIME) AS ADMISSION_DATE FROM OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS m, OMS_OWNER.offender_bookings h WHERE h.booking_status = 'O' AND h.active_flag = 'Y' AND m.direction_code = 'IN' AND m.Movement_type = 'ADM' AND m.to_agy_loc_id = h.agy_loc_id AND h.offender_book_id = m.offender_book_id GROUP BY m.OFFENDER_BOOK_ID) DT_ADMISSION, USER_ACCESSIBLE_CASELOADS, (SELECT OFF_BOOK.OFFENDER_BOOK_ID, CASE WHEN LIFE_FLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE SENT_CALC.EFFECTIVE_SENTENCE_LENGTH END AS CURR_EFF_SENT_LEN FROM (SELECT DISTINCT OFFENDER_SENTENCE_TERMS.OFFENDER_BOOK_ID, OFFENDER_SENTENCE_TERMS.LIFE_SENTENCE_FLAG FROM OFFENDER_SENTENCE_TERMS WHERE OFFENDER_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y') LIFE_FLAG, OMS_OWNER.OFFENDER_SENT_CALCULATIONS SENT_CALC, OMS_OWNER.OFFENDER_BOOKINGS OFF_BOOK WHERE (OFF_BOOK.OFFENDER_BOOK_ID = SENT_CALC.OFFENDER_BOOK_ID (+)) AND (LIFE_FLAG.OFFENDER_BOOK_ID (+) = SENT_CALC.OFFENDER_BOOK_ID) AND SENT_CALC.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE SENT_CALC.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) CURR_EFF_SENT_LEN, OMS_OWNER.OFFENDER_IMPRISON_STATUSES AT_OFFENDER_IMPRISON_STATUSES WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_ID = AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS = 'Y' OR AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS IS NULL) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = USER_ACCESSIBLE_CASELOADS.CASELOAD_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID = AT_WING_ESTABLISHMENT.AGY_LOC_ID) AND (AT_WING_ESTABLISHMENT.AGY_LOC_ID = WING_CASELOAD_SECURITY.CASELOAD_ID) AND (CURR_EFF_SENT_LEN.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS (+) = AT_OFFENDER_IMPRISON_STATUSES.IMPRISONMENT_STATUS) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = DT_ADMISSION.OFFENDER_BOOK_ID (+)) AND (WING_CASELOAD_SECURITY.USERNAME = (SELECT username FROM context_)) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND ((AT_OFFENDERS_LOCATIONS.AGY_LOC_ID IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END <> 'Indeterminate Sentence')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, LAST_NAME, UNIT_DESCRIPTION_4_SHORT, ADMISSION_DATE, LEGAL_STATUS_GROUPING, DESCRIPTION, CURR_EFF_SENT_LEN, BIRTH_DATE, ETHNIC_CODE, CURR_EFF_SENT_LEN AS V_EFFECTIVE_SENT_LENGTH, CASE WHEN V_CURRENT_RELEASE_DATE IS NULL THEN '-' ELSE V_CURRENT_RELEASE_DATE END AS V_RELEASEDATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP8.DO10044",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LAST_NAME",
            "type": "string",
            "display": "Last Name",
            "legacyId": "DP8.DO10045",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "UNIT_DESCRIPTION_4_SHORT",
            "type": "string",
            "display": "Unit Description 4 Short",
            "legacyId": "DP8.DO10427",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ADMISSION_DATE",
            "type": "date",
            "display": "Admission Date",
            "legacyId": "DP8.DO10c6a",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP8.DO1108a",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Establishment Name",
            "legacyId": "DP8.DO1033b",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CURR_EFF_SENT_LEN",
            "type": "string",
            "display": "Current Effective Sentence Length",
            "legacyId": "DP8.DO10bf6",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "BIRTH_DATE",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP8.DO10075",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DP8.DO10088",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "V_EFFECTIVE_SENT_LENGTH",
            "type": "string",
            "display": "V_EFFECTIVE_SENT_LENGTH",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 10,
            "name": "V_RELEASEDATE",
            "type": "string",
            "display": "V_RELEASEDATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3377239/DP2",
      "name": "Wait List",
      "description": "OR - Activities",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_WAIT_LIST.OFFENDER_PROGRAM_STATUS, DT_ADMISSION.ADMISSION_DATE, AT_OFFENDER.OFFENDER_ID_DISPLAY, CURR_EFF_SENT_LEN.CURR_EFF_SENT_LEN, AT_OFFENDER.LAST_NAME, SUBSTR(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, LENGTH(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID) + 2, LENGTH(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)) AS UNIT_DESCRIPTION_4_SHORT, AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS, DT_IEP_BAND_LAST.IEP_LEVEL, AT_WAIT_LIST_ACTIVITIES.DESCRIPTION, AT_WAIT_LIST.REFERRAL_PRIORITY, AT_WAIT_LIST.REFERRAL_DATE, CASE WHEN AT_WAIT_LIST.WAITLIST_DECISION_CODE = 'PEN' THEN 'Pending' WHEN AT_WAIT_LIST.WAITLIST_DECISION_CODE = 'APP' THEN 'Approved' WHEN AT_WAIT_LIST.WAITLIST_DECISION_CODE = 'REJ' THEN 'Rejected' WHEN AT_WAIT_LIST.WAITLIST_DECISION_CODE = 'ALL' THEN 'Allocated' ELSE AT_WAIT_LIST.WAITLIST_DECISION_CODE END AS WAITLIST_DECISION, TRUNC(CURRENT_TIMESTAMP) AS TODAY_, AT_WAIT_LIST.REFERRAL_COMMENT_TEXT, CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_OFFENDERS_LOCATIONS.DESCRIPTION AS ESTABLISHMENT_NAME, AT_OFFENDER.BIRTH_DATE, CASE WHEN AT_OFFENDER.RACE_CODE = 'W8' THEN 'W3' WHEN AT_OFFENDER.RACE_CODE = 'O1' THEN 'A4' ELSE AT_OFFENDER.RACE_CODE END AS ETHNIC_CODE FROM OMS_OWNER.OFFENDER_PROGRAM_PROFILES AT_WAIT_LIST, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, (SELECT iep_level, description, agy_loc_id, offender_book_id, iep_date FROM (SELECT iep.iep_level, rc.description, iep.agy_loc_id, iep.offender_book_id, iep.iep_date, ROW_NUMBER() OVER (PARTITION BY iep.offender_book_id ORDER BY iep.iep_time DESC, iep.iep_level_seq DESC) AS row_seq_filter FROM oms_owner.offender_iep_levels iep LEFT OUTER JOIN oms_owner.reference_codes rc ON iep.iep_level = rc.code AND rc.domain = 'IEP_LEVEL') WHERE row_seq_filter = 1) DT_IEP_BAND_LAST, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.AGENCY_LOCATIONS AT_PROG_ESTABLISHMENT, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, OMS_OWNER.COURSE_ACTIVITIES AT_WAIT_LIST_ACTIVITIES, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS, OMS_OWNER.IMPRISONMENT_STATUSES AT_IMPRISON_STATUSES, (SELECT DISTINCT m.OFFENDER_BOOK_ID, MAX(m.MOVEMENT_TIME) AS ADMISSION_DATE FROM OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS m, OMS_OWNER.offender_bookings h WHERE h.booking_status = 'O' AND h.active_flag = 'Y' AND m.direction_code = 'IN' AND m.Movement_type = 'ADM' AND m.to_agy_loc_id = h.agy_loc_id AND h.offender_book_id = m.offender_book_id GROUP BY m.OFFENDER_BOOK_ID) DT_ADMISSION, (SELECT OFF_BOOK.OFFENDER_BOOK_ID, CASE WHEN LIFE_FLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE SENT_CALC.EFFECTIVE_SENTENCE_LENGTH END AS CURR_EFF_SENT_LEN FROM (SELECT DISTINCT OFFENDER_SENTENCE_TERMS.OFFENDER_BOOK_ID, OFFENDER_SENTENCE_TERMS.LIFE_SENTENCE_FLAG FROM OFFENDER_SENTENCE_TERMS WHERE OFFENDER_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y') LIFE_FLAG, OMS_OWNER.OFFENDER_SENT_CALCULATIONS SENT_CALC, OMS_OWNER.OFFENDER_BOOKINGS OFF_BOOK WHERE (OFF_BOOK.OFFENDER_BOOK_ID = SENT_CALC.OFFENDER_BOOK_ID (+)) AND (LIFE_FLAG.OFFENDER_BOOK_ID (+) = SENT_CALC.OFFENDER_BOOK_ID) AND SENT_CALC.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE SENT_CALC.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) CURR_EFF_SENT_LEN, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, USER_ACCESSIBLE_CASELOADS, OMS_OWNER.OFFENDER_IMPRISON_STATUSES AT_OFFENDER_IMPRISON_STATUSES WHERE (AT_PROG_ESTABLISHMENT.AGENCY_LOCATION_TYPE = 'INST') AND (AT_WAIT_LIST.AGY_LOC_ID = AT_PROG_ESTABLISHMENT.AGY_LOC_ID) AND (AT_WAIT_LIST.CRS_ACTY_ID = AT_WAIT_LIST_ACTIVITIES.CRS_ACTY_ID) AND (AT_WAIT_LIST.AGY_LOC_ID = AT_WAIT_LIST_ACTIVITIES.AGY_LOC_ID) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_WAIT_LIST.OFFENDER_BOOK_ID) AND (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_ID = AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS = 'Y' OR AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS IS NULL) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (DT_IEP_BAND_LAST.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = USER_ACCESSIBLE_CASELOADS.CASELOAD_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID = AT_WING_ESTABLISHMENT.AGY_LOC_ID) AND (AT_WING_ESTABLISHMENT.AGY_LOC_ID = WING_CASELOAD_SECURITY.CASELOAD_ID) AND (CURR_EFF_SENT_LEN.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS (+) = AT_OFFENDER_IMPRISON_STATUSES.IMPRISONMENT_STATUS) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = DT_ADMISSION.OFFENDER_BOOK_ID (+)) AND (WING_CASELOAD_SECURITY.USERNAME = (SELECT username FROM context_)) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND ((AT_OFFENDERS_LOCATIONS.AGY_LOC_ID IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END <> 'Indeterminate Sentence' AND AT_PROG_ESTABLISHMENT.AGY_LOC_ID IN ((SELECT establishment_code FROM prompt_)) AND AT_WAIT_LIST.OFFENDER_PROGRAM_STATUS = 'WAIT' AND AT_WAIT_LIST.WAITLIST_DECISION_CODE IN ('APP', 'PEN', 'REJ'))), dataset_ AS (SELECT OFFENDER_PROGRAM_STATUS, ADMISSION_DATE, OFFENDER_ID_DISPLAY, CURR_EFF_SENT_LEN, LAST_NAME, UNIT_DESCRIPTION_4_SHORT, IMPRISONMENT_STATUS, IEP_LEVEL, DESCRIPTION, REFERRAL_PRIORITY, REFERRAL_DATE, WAITLIST_DECISION, TODAY_, REFERRAL_COMMENT_TEXT, LEGAL_STATUS_GROUPING, ESTABLISHMENT_NAME, BIRTH_DATE, ETHNIC_CODE, 'TBD' AS V_MAX_CONCAT_WAIT_LIST_ACTIV31, CASE WHEN V_CURRENT_RELEASE_DATE IS NULL THEN '-' ELSE V_CURRENT_RELEASE_DATE END AS V_RELEASEDATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_PROGRAM_STATUS",
            "type": "string",
            "display": "Offender Program Status",
            "legacyId": "DP2.DO443",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ADMISSION_DATE",
            "type": "date",
            "display": "Admission Date",
            "legacyId": "DP2.DO10c6a",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP2.DO10044",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "CURR_EFF_SENT_LEN",
            "type": "string",
            "display": "Current Effective Sentence Length",
            "legacyId": "DP2.DO10bf6",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "LAST_NAME",
            "type": "string",
            "display": "Last Name",
            "legacyId": "DP2.DO10045",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "UNIT_DESCRIPTION_4_SHORT",
            "type": "string",
            "display": "Unit Description 4 Short",
            "legacyId": "DP2.DO10427",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "IMPRISONMENT_STATUS",
            "type": "string",
            "display": "Main Legal Status",
            "legacyId": "DP2.DO103c7",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "IEP_LEVEL",
            "type": "string",
            "display": "IEP Level",
            "legacyId": "DP2.DO10715",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Wait List Activity",
            "legacyId": "DP2.DO442",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "REFERRAL_PRIORITY",
            "type": "string",
            "display": "Referral Priority",
            "legacyId": "DP2.DO43a",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "REFERRAL_DATE",
            "type": "date",
            "display": "Referral Date",
            "legacyId": "DP2.DO439",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "WAITLIST_DECISION",
            "type": "string",
            "display": "Waitlist Decision",
            "legacyId": "DP2.DO438",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "TODAY_",
            "type": "date",
            "display": "Today (Date only)",
            "legacyId": "DP2.DO10712",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "REFERRAL_COMMENT_TEXT",
            "type": "string",
            "display": "Referral Comment Text",
            "legacyId": "DP2.DO43b",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP2.DO1108a",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "ESTABLISHMENT_NAME",
            "type": "string",
            "display": "Establishment Name",
            "legacyId": "DP2.DO1033b",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "BIRTH_DATE",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP2.DO10075",
            "legacySqlClass": "column"
          },
          {
            "index": 17,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DP2.DO10088",
            "legacySqlClass": "column"
          },
          {
            "index": 18,
            "name": "V_MAX_CONCAT_WAIT_LIST_ACTIV31",
            "type": "string",
            "display": "V_MAX_CONCAT_WAIT_LIST_ACTIV31",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 19,
            "name": "V_RELEASEDATE",
            "type": "string",
            "display": "V_RELEASEDATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3377239/DP5",
      "name": "Current Activities",
      "description": "OR - Activities",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER.LAST_NAME, SUBSTR(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, LENGTH(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID) + 2, LENGTH(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)) AS UNIT_DESCRIPTION_4_SHORT, V_OFFENDER_COURSE_EVENTS.DESCRIPTION, AT_PROGRAM_PROFILES.OFFENDER_START_DATE, AT_PROGRAM_SERVICES.DESCRIPTION AS ACTIVITY_TYPE, CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, DT_ADMISSION.ADMISSION_DATE, AT_OFFENDERS_LOCATIONS.DESCRIPTION AS ESTABLISHMENT_NAME, AT_OFFENDER.BIRTH_DATE, CASE WHEN AT_OFFENDER.RACE_CODE = 'W8' THEN 'W3' WHEN AT_OFFENDER.RACE_CODE = 'O1' THEN 'A4' ELSE AT_OFFENDER.RACE_CODE END AS ETHNIC_CODE FROM V_OFFENDER_COURSE_EVENTS, OMS_OWNER.COURSE_SCHEDULES AT_COURSE_SCHEDULES, OMS_OWNER.OFFENDER_PROGRAM_PROFILES AT_PROGRAM_PROFILES, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, OMS_OWNER.COURSE_ACTIVITIES AT_COURSE_ACTIVITIES, OMS_OWNER.PROGRAM_SERVICES AT_PROGRAM_SERVICES, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS, OMS_OWNER.IMPRISONMENT_STATUSES AT_IMPRISON_STATUSES, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, (SELECT DISTINCT m.OFFENDER_BOOK_ID, MAX(m.MOVEMENT_TIME) AS ADMISSION_DATE FROM OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS m, OMS_OWNER.offender_bookings h WHERE h.booking_status = 'O' AND h.active_flag = 'Y' AND m.direction_code = 'IN' AND m.Movement_type = 'ADM' AND m.to_agy_loc_id = h.agy_loc_id AND h.offender_book_id = m.offender_book_id GROUP BY m.OFFENDER_BOOK_ID) DT_ADMISSION, USER_ACCESSIBLE_CASELOADS, OMS_OWNER.OFFENDER_IMPRISON_STATUSES AT_OFFENDER_IMPRISON_STATUSES WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = V_OFFENDER_COURSE_EVENTS.OFFENDER_BOOK_ID) AND (V_OFFENDER_COURSE_EVENTS.CRS_SCH_ID = AT_COURSE_SCHEDULES.CRS_SCH_ID AND V_OFFENDER_COURSE_EVENTS.CRS_ACTY_ID = AT_COURSE_SCHEDULES.CRS_ACTY_ID) AND (AT_COURSE_SCHEDULES.CRS_ACTY_ID = AT_COURSE_ACTIVITIES.CRS_ACTY_ID) AND (AT_COURSE_ACTIVITIES.PROGRAM_ID = AT_PROGRAM_SERVICES.PROGRAM_ID) AND (AT_PROGRAM_PROFILES.OFF_PRGREF_ID = V_OFFENDER_COURSE_EVENTS.OFF_PRGREF_ID) AND (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_ID = AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS = 'Y' OR AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS IS NULL) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = USER_ACCESSIBLE_CASELOADS.CASELOAD_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID = AT_WING_ESTABLISHMENT.AGY_LOC_ID) AND (AT_WING_ESTABLISHMENT.AGY_LOC_ID = WING_CASELOAD_SECURITY.CASELOAD_ID) AND (AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS (+) = AT_OFFENDER_IMPRISON_STATUSES.IMPRISONMENT_STATUS) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = DT_ADMISSION.OFFENDER_BOOK_ID (+)) AND (WING_CASELOAD_SECURITY.USERNAME = (SELECT username FROM context_)) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND ((AT_OFFENDERS_LOCATIONS.AGY_LOC_ID IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END <> 'Indeterminate Sentence' AND (NOT V_OFFENDER_COURSE_EVENTS.EVENT_STATUS IN ('CANC', 'SUS')) AND V_OFFENDER_COURSE_EVENTS.AGY_LOC_ID IN ((SELECT establishment_code FROM prompt_)) AND V_OFFENDER_COURSE_EVENTS.EVENT_DATE >= TRUNC(CURRENT_TIMESTAMP) AND (AT_PROGRAM_PROFILES.OFFENDER_END_DATE IS NULL OR AT_PROGRAM_PROFILES.OFFENDER_END_DATE >= TRUNC(CURRENT_TIMESTAMP)))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, LAST_NAME, UNIT_DESCRIPTION_4_SHORT, DESCRIPTION, OFFENDER_START_DATE, ACTIVITY_TYPE, LEGAL_STATUS_GROUPING, ADMISSION_DATE, ESTABLISHMENT_NAME, BIRTH_DATE, ETHNIC_CODE, CURR_EFF_SENT_LEN AS V_EFFECTIVE_SENT_LENGTH, CASE WHEN V_CURRENT_RELEASE_DATE IS NULL THEN '-' ELSE V_CURRENT_RELEASE_DATE END AS V_RELEASEDATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DP5.DO10044",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LAST_NAME",
            "type": "string",
            "display": "Last Name",
            "legacyId": "DP5.DO10045",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "UNIT_DESCRIPTION_4_SHORT",
            "type": "string",
            "display": "Unit Description 4 Short",
            "legacyId": "DP5.DO10427",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Activity Description",
            "legacyId": "DP5.DOd6",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "OFFENDER_START_DATE",
            "type": "date",
            "display": "Offender Activity Enrollment Start Date",
            "legacyId": "DP5.DOba",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "ACTIVITY_TYPE",
            "type": "string",
            "display": "Activity Type",
            "legacyId": "DP5.DOa9",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DP5.DO1108a",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "ADMISSION_DATE",
            "type": "date",
            "display": "Admission Date",
            "legacyId": "DP5.DO10c6a",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ESTABLISHMENT_NAME",
            "type": "string",
            "display": "Establishment Name",
            "legacyId": "DP5.DO1033b",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "BIRTH_DATE",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DP5.DO10075",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DP5.DO10088",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "V_EFFECTIVE_SENT_LENGTH",
            "type": "string",
            "display": "V_EFFECTIVE_SENT_LENGTH",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 12,
            "name": "V_RELEASEDATE",
            "type": "string",
            "display": "V_RELEASEDATE",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3377239/DPa",
      "name": "Sentence Date",
      "description": "OR - Activities",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER.LAST_NAME, SUBSTR(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION, LENGTH(AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID) + 2, LENGTH(AT_AGENCY_INTERNAL_LOCATION_L4.DESCRIPTION)) AS UNIT_DESCRIPTION_4_SHORT, DT_ADMISSION.ADMISSION_DATE, CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END AS LEGAL_STATUS_GROUPING, AT_OFFENDERS_LOCATIONS.DESCRIPTION, CURR_EFF_SENT_LEN.CURR_EFF_SENT_LEN, AT_OFFENDER.BIRTH_DATE, CASE WHEN AT_OFFENDER.RACE_CODE = 'W8' THEN 'W3' WHEN AT_OFFENDER.RACE_CODE = 'O1' THEN 'A4' ELSE AT_OFFENDER.RACE_CODE END AS ETHNIC_CODE, AT_SENT_ORDERS.COURT_DATE, CASE WHEN NOT AT_OFFENDER_RELEASE_DETAILS.RELEASE_DATE IS NULL THEN AT_OFFENDER_RELEASE_DETAILS.RELEASE_DATE WHEN AT_OFFENDER_RELEASE_DETAILS.RELEASE_DATE IS NULL THEN DT_LAST_RELEASE_DATE.LAST_REL_DATE ELSE NULL END AS CURRENT_RELEASE_DATE FROM OMS_OWNER.OFFENDER_SENTENCES AT_OFFENDER_SENTENCES, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.AGENCY_INTERNAL_LOCATIONS AT_AGENCY_INTERNAL_LOCATION_L4, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_OFFENDERS_LOCATIONS, OMS_OWNER.AGENCY_LOCATIONS AT_WING_ESTABLISHMENT, OMS_OWNER.CASELOAD_AGENCY_LOCATIONS AT_CASELOAD_LOCATIONS, OMS_OWNER.IMPRISONMENT_STATUSES AT_IMPRISON_STATUSES, USER_ACCESSIBLE_CASELOADS WING_CASELOAD_SECURITY, (SELECT DISTINCT m.OFFENDER_BOOK_ID, MAX(m.MOVEMENT_TIME) AS ADMISSION_DATE FROM OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS m, OMS_OWNER.offender_bookings h WHERE h.booking_status = 'O' AND h.active_flag = 'Y' AND m.direction_code = 'IN' AND m.Movement_type = 'ADM' AND m.to_agy_loc_id = h.agy_loc_id AND h.offender_book_id = m.offender_book_id GROUP BY m.OFFENDER_BOOK_ID) DT_ADMISSION, USER_ACCESSIBLE_CASELOADS, (SELECT OFF_BOOK.OFFENDER_BOOK_ID, CASE WHEN LIFE_FLAG.LIFE_SENTENCE_FLAG = 'Y' THEN 'Life' ELSE SENT_CALC.EFFECTIVE_SENTENCE_LENGTH END AS CURR_EFF_SENT_LEN FROM (SELECT DISTINCT OFFENDER_SENTENCE_TERMS.OFFENDER_BOOK_ID, OFFENDER_SENTENCE_TERMS.LIFE_SENTENCE_FLAG FROM OFFENDER_SENTENCE_TERMS WHERE OFFENDER_SENTENCE_TERMS.LIFE_SENTENCE_FLAG = 'Y') LIFE_FLAG, OMS_OWNER.OFFENDER_SENT_CALCULATIONS SENT_CALC, OMS_OWNER.OFFENDER_BOOKINGS OFF_BOOK WHERE (OFF_BOOK.OFFENDER_BOOK_ID = SENT_CALC.OFFENDER_BOOK_ID (+)) AND (LIFE_FLAG.OFFENDER_BOOK_ID (+) = SENT_CALC.OFFENDER_BOOK_ID) AND SENT_CALC.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE SENT_CALC.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) CURR_EFF_SENT_LEN, OMS_OWNER.ORDERS AT_SENT_ORDERS, OMS_OWNER.OFFENDER_RELEASE_DETAILS AT_OFFENDER_RELEASE_DETAILS, (SELECT AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID, CASE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.HDCAD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.HDCAD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.APD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.APD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.PRRD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.PRRD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.ARD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.ARD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.ARD_CALCULATED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.ARD_CALCULATED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.CRD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.CRD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.CRD_CALCULATED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.CRD_CALCULATED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.NPD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.NPD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.NPD_CALCULATED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.NPD_CALCULATED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.MTD_OVERRIDED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.MTD_OVERRIDED_DATE WHEN NOT AT_OFFENDER_SENT_CALCULATIONS.MTD_CALCULATED_DATE IS NULL THEN AT_OFFENDER_SENT_CALCULATIONS.MTD_CALCULATED_DATE ELSE NULL END AS Last_Rel_Date, EFFECTIVE_SENTENCE_LENGTH FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS AT_OFFENDER_SENT_CALCULATIONS WHERE AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_SENT_CALCULATION_ID = (SELECT MAX(A.OFFENDER_SENT_CALCULATION_ID) FROM OMS_OWNER.OFFENDER_SENT_CALCULATIONS A WHERE AT_OFFENDER_SENT_CALCULATIONS.OFFENDER_BOOK_ID = A.OFFENDER_BOOK_ID)) DT_LAST_RELEASE_DATE, OMS_OWNER.OFFENDER_IMPRISON_STATUSES AT_OFFENDER_IMPRISON_STATUSES WHERE (AT_OFFENDER.OFFENDER_ID = AT_OFFENDER_BOOKING.OFFENDER_ID) AND (AT_OFFENDER_BOOKING.LIVING_UNIT_ID = AT_AGENCY_INTERNAL_LOCATION_L4.INTERNAL_LOCATION_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_SENTENCES.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS = 'Y' OR AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS IS NULL) AND (AT_OFFENDERS_LOCATIONS.AGENCY_LOCATION_TYPE = 'INST') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = AT_OFFENDER_RELEASE_DETAILS.OFFENDER_BOOK_ID (+)) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND (AT_OFFENDERS_LOCATIONS.AGY_LOC_ID = USER_ACCESSIBLE_CASELOADS.CASELOAD_ID) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = DT_LAST_RELEASE_DATE.OFFENDER_BOOK_ID (+)) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDER_BOOKING.AGY_LOC_ID) AND (AT_CASELOAD_LOCATIONS.AGY_LOC_ID = AT_OFFENDERS_LOCATIONS.AGY_LOC_ID (+)) AND (NOT AT_CASELOAD_LOCATIONS.AGY_LOC_ID IN ('OUT', 'TRN') AND NOT AT_CASELOAD_LOCATIONS.CASELOAD_ID IN ('ADMINC', 'CADM_I', 'MULTI')) AND (AT_AGENCY_INTERNAL_LOCATION_L4.AGY_LOC_ID = AT_WING_ESTABLISHMENT.AGY_LOC_ID) AND (AT_WING_ESTABLISHMENT.AGY_LOC_ID = WING_CASELOAD_SECURITY.CASELOAD_ID) AND (CURR_EFF_SENT_LEN.OFFENDER_BOOK_ID (+) = AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID) AND (AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS (+) = AT_OFFENDER_IMPRISON_STATUSES.IMPRISONMENT_STATUS) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID = DT_ADMISSION.OFFENDER_BOOK_ID (+)) AND (AT_SENT_ORDERS.ORDER_ID = AT_OFFENDER_SENTENCES.ORDER_ID) AND (WING_CASELOAD_SECURITY.USERNAME = (SELECT username FROM context_)) AND (USER_ACCESSIBLE_CASELOADS.USERNAME = (SELECT username FROM context_)) AND (AT_OFFENDER_SENTENCES.SENTENCE_CATEGORY <> 'LICENCE' AND NOT AT_OFFENDER_SENTENCES.SENTENCE_CALC_TYPE LIKE '%AGG%') AND ((AT_OFFENDERS_LOCATIONS.AGY_LOC_ID IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND CASE WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_EDSU18') THEN 'Recall' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '0' THEN 'Dead' WHEN AT_IMPRISON_STATUSES.BAND_CODE = '1' THEN 'Indeterminate Sentence' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('2', '3') THEN 'Sentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('9', '10') OR AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'CIV_RMD' THEN 'Civil Prisoners' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('8', '11') THEN 'Immigration Detainees' WHEN AT_IMPRISON_STATUSES.BAND_CODE IN ('12', '13', '14') THEN 'Remand' WHEN AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END <> 'Indeterminate Sentence')), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, LAST_NAME, UNIT_DESCRIPTION_4_SHORT, ADMISSION_DATE, LEGAL_STATUS_GROUPING, DESCRIPTION, CURR_EFF_SENT_LEN, BIRTH_DATE, ETHNIC_CODE, COURT_DATE, CURRENT_RELEASE_DATE FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPa.DO10044",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "LAST_NAME",
            "type": "string",
            "display": "Last Name",
            "legacyId": "DPa.DO10045",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "UNIT_DESCRIPTION_4_SHORT",
            "type": "string",
            "display": "Unit Description 4 Short",
            "legacyId": "DPa.DO10427",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "ADMISSION_DATE",
            "type": "date",
            "display": "Admission Date",
            "legacyId": "DPa.DO10c6a",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "LEGAL_STATUS_GROUPING",
            "type": "string",
            "display": "Legal Status Grouping",
            "legacyId": "DPa.DO1108a",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "DESCRIPTION",
            "type": "string",
            "display": "Establishment Name",
            "legacyId": "DPa.DO1033b",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "CURR_EFF_SENT_LEN",
            "type": "string",
            "display": "Current Effective Sentence Length",
            "legacyId": "DPa.DO10bf6",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "BIRTH_DATE",
            "type": "date",
            "display": "Date of Birth",
            "legacyId": "DPa.DO10075",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DPa.DO10088",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "COURT_DATE",
            "type": "date",
            "display": "Sentence.Sentence Date",
            "legacyId": "DPa.DO110e7",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "CURRENT_RELEASE_DATE",
            "type": "date",
            "display": "Current Release Date",
            "legacyId": "DPa.DO10b29",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "166716.RS",
      "name": "Unemployed with Wait List",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377239/DP2",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_EFFECTIVE_SENT_LENGTH <> 'Life' AND V_MAX_CONCAT_WAIT_LIST_ACTIV31 IS NOT NULL AND V_UNEMPLOYED_ IS NOT NULL AND WAITLIST_DECISION <> 'Rejected'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_NAME",
            "display": "Establishment Name",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO1033b"
          },
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP2.DO10044"
          },
          {
            "name": "$ref:V_SENT_START_DATE",
            "display": "Sent Start Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([Sentence].[Sentence Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_MAX_CONCAT_WAIT_LIST_ACTIV31",
            "display": "Wait List Activity",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[v_concat_wait_list_activity] Where ([v_waitlist activity]= [v_Max_wait_list_activity]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_RELEASEDATE",
            "display": "Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Current_Release_Date]);\"-\";[v_Current_Release_Date])"
          },
          {
            "name": "$ref:WAITLIST_DECISION",
            "display": "Waitlist Decision",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP2.DO438"
          }
        ]
      }
    },
    {
      "id": "167629.RS",
      "name": "Unemployed No Wait List ",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377239/DP5",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_EFFECTIVE_SENT_LENGTH <> 'Life' AND V_UNEMPLOYED_ IS NOT NULL AND V_UNEMPLOYED_ <> 'Unemployed - On waiting list' AND V_OFFENDER_PROGRAM_STATUS IN ('[NULL_VALUE]')))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10044"
          },
          {
            "name": "$ref:LAST_NAME",
            "display": "Last Name",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10045"
          },
          {
            "name": "$ref:BIRTH_DATE",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10075"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10088"
          },
          {
            "name": "$ref:UNIT_DESCRIPTION_4_SHORT",
            "display": "Unit Description 4 Short",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10427"
          },
          {
            "name": "$ref:V_SENT_START_DATE",
            "display": "Sentence Start Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([Sentence].[Sentence Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_EFFECTIVE_SENT_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Current Effective Sentence Length]"
          },
          {
            "name": "$ref:ADMISSION_DATE",
            "display": "Admission Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10c6a"
          },
          {
            "name": "$ref:OFFENDER_START_DATE",
            "display": "Offender Activity Enrollment Start Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DOba"
          },
          {
            "name": "$ref:ACTIVITY_TYPE",
            "display": "Activity Type",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DOa9"
          },
          {
            "name": "$ref:V_UNEMPLOYED",
            "display": "Unemployed Activity Allocated",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If ([Activity Type] InList(\"Unemployed Prisoners\";\"Other - Unemployed Prisoners\";\"SAA Not in work\"))Then[Activity Description]"
          },
          {
            "name": "$ref:V_RELEASEDATE",
            "display": "Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Current_Release_Date]);\"-\";[v_Current_Release_Date])"
          }
        ]
      }
    },
    {
      "id": "166799.RS",
      "name": "Unallocated No Wait List",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377239/DP8",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_CURRENT_ACTIVITY IS NULL AND V_EFFECTIVE_SENT_LENGTH <> 'Life' AND (V_WAITLIST_ACTIVITY IS NULL OR V_REJECTED = 1)))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP8.DO10044"
          },
          {
            "name": "$ref:BIRTH_DATE",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP8.DO10075"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP8.DO10088"
          },
          {
            "name": "$ref:V_SENT_START_DATE",
            "display": "Sent Start Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([Sentence].[Sentence Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_EFFECTIVE_SENT_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Current Effective Sentence Length]"
          },
          {
            "name": "$ref:ADMISSION_DATE",
            "display": "Admission Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP8.DO10c6a"
          },
          {
            "name": "$ref:V_RELEASEDATE",
            "display": "Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Current_Release_Date]);\"-\";[v_Current_Release_Date])"
          }
        ]
      }
    },
    {
      "id": "167302.RS",
      "name": "Current Activities",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3377239/DP5",
      "filter": {
        "name": "prefilter_",
        "query": "prefilter_ AS (SELECT * FROM dataset_ WHERE (V_UNEMPLOYED NOT(IN ('Incapacity','Incapacity - PAY','Not Available For Work','Retired','Retired - PAY','Temporary Incapacity FT','Unemployed AM','Unemployed FT','Unemployed F/T Pay','Unemployed PM','Unemployed prisoners')) AND ACTIVITY_TYPE NOT(IN ('Unemployed Prisoners')) AND V_EFFECTIVE_SENT_LENGTH <> 'Life'))"
      },
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10044"
          },
          {
            "name": "$ref:LAST_NAME",
            "display": "Last Name",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10045"
          },
          {
            "name": "$ref:BIRTH_DATE",
            "display": "Date of Birth",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10075"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10088"
          },
          {
            "name": "$ref:UNIT_DESCRIPTION_4_SHORT",
            "display": "Unit Description 4 Short",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10427"
          },
          {
            "name": "$ref:LEGAL_STATUS_GROUPING",
            "display": "Legal Status Grouping",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO1108a"
          },
          {
            "name": "$ref:V_SENT_START_DATE",
            "display": "Sentence Start Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=Min([Sentence].[Sentence Date]) In ([NOMS Number])"
          },
          {
            "name": "$ref:V_EFFECTIVE_SENT_LENGTH",
            "display": "Effective Sentence Length",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=[Current Effective Sentence Length]"
          },
          {
            "name": "$ref:ADMISSION_DATE",
            "display": "Admission Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DP5.DO10c6a"
          },
          {
            "name": "$ref:OFFENDER_START_DATE",
            "display": "Offender Activity Enrollment Start Date",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DOba"
          },
          {
            "name": "$ref:ACTIVITY_TYPE",
            "display": "Activity Type",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DOa9"
          },
          {
            "name": "$ref:DESCRIPTION",
            "display": "Activity Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DP5.DOd6"
          },
          {
            "name": "$ref:V_RELEASEDATE",
            "display": "Release Date",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If(IsNull([v_Current_Release_Date]);\"-\";[v_Current_Release_Date])"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_SENT_START_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 32.\n  MIN(SENTENCE.SENTENCE_DATE) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FlCbiwEPMAgAozg8AADn7oLRACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_MAX_CONCAT_WAIT_LIST_ACTIV31 :: Error: =[v_concat_wait_list_activity] Where ([v_waitlist activity]= [v_Max_wait_list_activity]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:90",
      "entityId": "FlCbiwEPMAgAozg8AADn7oLRACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_SENT_START_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 32.\n  MIN(SENTENCE.SENTENCE_DATE) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FlCbiwEPMAgAozg8AADn7oLRACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_MAX_CONCAT_WAIT_LIST_ACTIV31 :: Error: =[v_concat_wait_list_activity] Where ([v_waitlist activity]= [v_Max_wait_list_activity]) In ([NOMS Number]) ==> Error: Expected end of input but \"I\" found.\n at undefined:1:90",
      "entityId": "FlCbiwEPMAgAozg8AADn7oLRACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_SENT_START_DATE :: Error: Invalid expression / Unexpected token. Line 1, Col: 32.\n  MIN(SENTENCE.SENTENCE_DATE) IN \u001b[4m,\u001b[0mOFFENDER_ID_DISPLAY,",
      "entityId": "FlCbiwEPMAgAozg8AADn7oLRACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_UNEMPLOYED :: Error: argument 'sql': 'NoneType' object cannot be converted to 'PyString'",
      "entityId": "FlCbiwEPMAgAozg8AADn7oLRACJIAGE1",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report field V_SENT_START_DATE does not have corresponding dataset schema field",
      "entityId": "166716.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_SENT_START_DATE does not have corresponding dataset schema field",
      "entityId": "167629.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_UNEMPLOYED does not have corresponding dataset schema field",
      "entityId": "167629.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_SENT_START_DATE does not have corresponding dataset schema field",
      "entityId": "166799.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_SENT_START_DATE does not have corresponding dataset schema field",
      "entityId": "167302.RS",
      "entityType": "variant"
    },
    {
      "type": "sqlQuery",
      "error": "Error: ORA-00904: \"V_CURRENT_RELEASE_DATE\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/",
      "entityId": "3377239/DP8",
      "entityType": "dataset"
    },
    {
      "type": "sqlQuery",
      "error": "Error: ORA-00904: \"V_CURRENT_RELEASE_DATE\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/",
      "entityId": "3377239/DP2",
      "entityType": "dataset"
    },
    {
      "type": "sqlQuery",
      "error": "Error: ORA-00904: \"V_CURRENT_RELEASE_DATE\": invalid identifier\nHelp: https://docs.oracle.com/error-help/db/ora-00904/",
      "entityId": "3377239/DP5",
      "entityType": "dataset"
    }
  ]
}