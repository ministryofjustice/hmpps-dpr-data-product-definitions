{
  "id": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
  "name": "MIS Prisoner Characteristics Report",
  "metadata": {
    "version": "1.0.0",
    "tags": [
      "Prisoner Characteristics"
    ]
  },
  "description": "Lists a prison population to show Marital Status, Maternity Status, Religion, Sexual Orientation, Age, Ethinc Code, Disability Flag, Care Leaver? and Foreign National? flag (this includes every offender with Nationality field being anything other than 'British', 'Stateless', 'Unknown' and 'Refused') across the prison population as well as those recalled back to custody. The report prompts the user to select one or more establishments.<br/>PDD0091 - v3.0 Last Modified: 01/12/2020",
  "datasource": [
    {
      "id": "bodmis",
      "name": "BODMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "bodmis"
    }
  ],
  "dataset": [
    {
      "id": "3376639/DPb",
      "name": "Characteristics",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_OFFENDER_BOOKING.MARITAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.MATERNITY_STATUS_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'W3' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'A4' ELSE AT_DIM_ETHNICITY_CODES.CODE END AS ETHNIC_CODE, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_OFFENDER_BOOKING.NATIONALITY_CODE, COALESCE(AT_OFFENDER_BOOKING.RELIGION_CODE, 'Not Specified') AS RELIGION_CODE, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'White: Gypsy or Irish Traveller' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'Asian/Asian British: Chinese' ELSE AT_DIM_ETHNICITY_CODES.DESCRIPTION END AS ETHNIC_DESCRIPTION FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB WHERE (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, MARITAL_STATUS_DESCRIPTION, MATERNITY_STATUS_DESCRIPTION, RELIGION_DESCRIPTION, SEX_ORIENTATION_DESCRIPTION, SURNAME, FIRST_NAME, OFFENDER_AGE, NATIONALITY_DESCRIPTION, ESTABLISHMENT_CODE_NK, ESTABLISHMENT_DESCRIPTION, ETHNIC_CODE, UNIT_4_SHORT_DESCRIPTION, NATIONALITY_CODE, RELIGION_CODE, ETHNIC_DESCRIPTION, CASE WHEN DISABILITY_ACTIVE_FLAG = 'Y' THEN 'Y' END AS V_DISABILITY, CASE WHEN ALERT_CATEGORY_CODE = 'L' THEN 'Y' ELSE 'N' END AS V_CARE_LEAVER FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPb.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "MARITAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Marital Status Description",
            "legacyId": "DPb.DOaf",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "MATERNITY_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Maternity Status",
            "legacyId": "DPb.DOb0",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DPb.DOb3",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "SEX_ORIENTATION_DESCRIPTION",
            "type": "string",
            "display": "Sexual Orientation Description",
            "legacyId": "DPb.DO970",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DPb.DO7b",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DPb.DO80",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DPb.DO82",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "NATIONALITY_DESCRIPTION",
            "type": "string",
            "display": "Nationality Description",
            "legacyId": "DPb.DOb5",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Associated Establishment Code",
            "legacyId": "DPb.DO7b2",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Associated Establishment Name",
            "legacyId": "DPb.DO7b1",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DPb.DO9b",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DPb.DOa7c",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "NATIONALITY_CODE",
            "type": "string",
            "display": "Nationality Code",
            "legacyId": "DPb.DOb4",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "RELIGION_CODE",
            "type": "string",
            "display": "Religion Code",
            "legacyId": "DPb.DOb2",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "ETHNIC_DESCRIPTION",
            "type": "string",
            "display": "Ethnic Description",
            "legacyId": "DPb.DO9d",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "V_DISABILITY",
            "type": "string",
            "display": "V_DISABILITY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 17,
            "name": "V_CARE_LEAVER",
            "type": "string",
            "display": "V_CARE_LEAVER",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3375368/DPa",
      "name": "LR Characteristics",
      "description": "MIS - Sentence",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, AT_DIM_SENTENCE_TYPE.SENTENCE_DESCRIPTION, AT_OFFENDER_BOOKING.MARITAL_STATUS_DESCRIPTION, AT_OFFENDER_BOOKING.MATERNITY_STATUS_DESCRIPTION, COALESCE(AT_OFFENDER_BOOKING.RELIGION_DESCRIPTION, 'Not Specified') AS RELIGION_DESCRIPTION, AT_OFFENDER_BOOKING.SEX_ORIENTATION_DESCRIPTION, AT_OFFENDER_BOOKING.SURNAME, AT_OFFENDER_BOOKING.FIRST_NAME, AT_OFFENDER_BOOKING.NATIONALITY_DESCRIPTION, FLOOR((MONTHS_BETWEEN((TRUNC(CURRENT_TIMESTAMP)), (CASE WHEN AT_DOB.DAY_DATE < '31/12/9000' THEN AT_DOB.DAY_DATE END))) / 12) AS OFFENDER_AGE, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK, AT_ESTABLISHMENT_TAP.ESTABLISHMENT_DESCRIPTION, CASE WHEN AT_DIM_ETHNICITY_CODES.CODE = 'MERGE' THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE IS NULL THEN 'Code Missing' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'W8' THEN 'W3' WHEN AT_DIM_ETHNICITY_CODES.CODE = 'O1' THEN 'A4' ELSE AT_DIM_ETHNICITY_CODES.CODE END AS ETHNIC_CODE, AT_DIM_LOCATION.UNIT_4_SHORT_DESCRIPTION, AT_OFFENDER_BOOKING.NATIONALITY_CODE, COALESCE(AT_OFFENDER_BOOKING.RELIGION_CODE, 'Not Specified') AS RELIGION_CODE FROM BODIMIS.DIM_CELL AT_DIM_LOCATION, BODIMIS.FACT_CASE_SENTENCE AT_FACT_SENTENCE, BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_SENTENCE_TYPE AT_DIM_SENTENCE_TYPE, BODIMIS.FACT_COURT_EVENT AT_FACT_COURT_EVENT, BODIMIS.DIM_ETHNICITY_CODES AT_DIM_ETHNICITY_CODES, BODIMIS.DIM_COURT_CASE_STATUS AT_DIM_COURT_CASE_STATUS, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_DATE AT_DOB, BODIMIS.DIM_COURT_CASE AT_COURT_CASE WHERE (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_COURT_EVENT.COURT_CASE_SK (+)) AND (AT_COURT_CASE.COURT_CASE_STATUS_SK = AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS_SK (+)) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_COURT_CASE.OFFENDER_BOOKING_SK (+)) AND (AT_OFFENDER_BOOKING.BIRTH_DATE_SK = AT_DOB.DATE_SK) AND (AT_COURT_CASE.COURT_CASE_SK = AT_FACT_SENTENCE.COURT_CASE_SK (+)) AND (AT_FACT_SENTENCE.SENTENCE_TYPE_SK = AT_DIM_SENTENCE_TYPE.SENTENCE_TYPE_SK (+)) AND (AT_DIM_ETHNICITY_CODES.CODE (+) = AT_OFFENDER_BOOKING.ETHNICITY_CODE) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_COURT_CASE.OFFENDER_BOOKING_SK IS NULL OR AT_COURT_CASE.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER((SELECT username FROM context_ /* = #Variable('BOUSER') */)) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.LIVING_UNIT_SK = AT_DIM_LOCATION.UNIT_4_SK (+)) AND ((CASE WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE IN ('14FTR_ORA', '14FTRHDC_ORA', 'CUR_ORA', 'FTR/08', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'FTR_SCH15', 'FTRSCH15_ORA', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_LASPO', 'LR_DLP', 'LR_DPP', 'LR_EPP', 'LR_ES', 'LR_HDC', 'LR_IPP', 'LR_LASPO_AR', 'LR_LASPO_DR', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SEC236A', 'LR_SEC91_ORA', 'LR_YOI', 'LR_YOI_ORA', 'FTRSCH18_ORA', 'FTRSCH18', 'LR_EDS18', 'LR_EDS21', 'LR_SOPC18', 'LR_SOPC21', 'LRSEC250_ORA', 'LR_ALP_CDE18', 'LR_ALP_CDE21') THEN 'Recall' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '0' THEN 'Dead' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND = '1' THEN 'Indeterminate Sentence' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('2', '3') THEN 'Sentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('4', '5', '6', '7') THEN 'Convicted Unsentenced' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('9', '10') OR AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'CIV_RMD' THEN 'Civil Prisoner' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('8', '11') THEN 'Immigration Detainee' WHEN AT_OFFENDER_BOOKING.LEGAL_STATUS_BAND IN ('12', '13', '14') THEN 'Remand' WHEN AT_OFFENDER_BOOKING.MAIN_LEGAL_STATUS_CODE = 'UNKNOWN' THEN 'Unknown' ELSE 'Other' END = 'Recall' OR AT_DIM_SENTENCE_TYPE.SENTENCE_CODE_NK IN ('HDR', 'CUR', 'FTR', 'CUR_ORA', 'FTR_ORA', 'FTR_HDC_ORA', 'FTRSCH15_ORA', 'HDR_ORA', 'LR_ORA', '14FTR_ORA', 'LR_YOI_ORA', 'LR_SEC91_ORA', '14FTRHDC_ORA', 'LR_SEC236A', 'LR', 'CUR', 'HDR', 'LR_LASPO_AR', 'LR_LASPO_DR', 'FTR_HDC', 'LR_MLP', 'LR_ALP', 'LR_DLP', 'LR_ALP_LASPO', 'FTR_SCH15', 'LR', 'LR_LIFE', 'LR_LIFE', 'LR_IPP', 'LR_ES', 'LR_EPP', 'LR_DPP', 'LR_DPP', '14FTRHDC_ORA', '14FTR_ORA', 'CUR', 'CUR_ORA', 'FTR', 'FTRSCH18', 'FTRSCH18_ORA', 'FTR_HDC', 'FTR_HDC_ORA', 'FTR_ORA', 'HDR', 'HDR_ORA', 'LR', 'LR_ALP', 'LR_ALP_CDE18', 'LR_ALP_CDE21', 'LR_DLP', 'LR_EDS18', 'LR_EDS21', 'LR_LIFE', 'LR_MLP', 'LR_ORA', 'LR_SOPC18', 'LR_SOPC21', 'LR_YOI_ORA', 'LRSEC250_ORA') OR AT_FACT_COURT_EVENT.OUTCOME = '1501') AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y') AND (AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */) OR 'All' IN (SELECT ESTABLISHMENT_CODE FROM prompt_ /* = #Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69) */)) AND (AT_DIM_COURT_CASE_STATUS.COURT_CASE_STATUS = 'Active'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, SENTENCE_DESCRIPTION, MARITAL_STATUS_DESCRIPTION, MATERNITY_STATUS_DESCRIPTION, RELIGION_DESCRIPTION, SEX_ORIENTATION_DESCRIPTION, SURNAME, FIRST_NAME, NATIONALITY_DESCRIPTION, OFFENDER_AGE, ESTABLISHMENT_CODE_NK, ESTABLISHMENT_DESCRIPTION, ETHNIC_CODE, UNIT_4_SHORT_DESCRIPTION, NATIONALITY_CODE, RELIGION_CODE, CASE WHEN DISABILITY_ACTIVE_FLAG = 'Y' THEN 'Y' END AS V_DISABILITY, CASE WHEN ALERT_CATEGORY_CODE = 'L' THEN 'Y' ELSE 'N' END AS V_CARE_LEAVER FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "@Prompt('Establishment Code (All for all)','A','Associated Establishment\\Associated Establishment Code',multi,free,Not_Persistent,User:69)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPa.DO10076",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "SENTENCE_DESCRIPTION",
            "type": "string",
            "display": "Sentence Name",
            "legacyId": "DPa.DO3d",
            "legacySqlClass": "column"
          },
          {
            "index": 2,
            "name": "MARITAL_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Marital Status Description",
            "legacyId": "DPa.DO100af",
            "legacySqlClass": "column"
          },
          {
            "index": 3,
            "name": "MATERNITY_STATUS_DESCRIPTION",
            "type": "string",
            "display": "Maternity Status",
            "legacyId": "DPa.DO100b0",
            "legacySqlClass": "column"
          },
          {
            "index": 4,
            "name": "RELIGION_DESCRIPTION",
            "type": "string",
            "display": "Religion Description",
            "legacyId": "DPa.DO100b3",
            "legacySqlClass": "column"
          },
          {
            "index": 5,
            "name": "SEX_ORIENTATION_DESCRIPTION",
            "type": "string",
            "display": "Sexual Orientation Description",
            "legacyId": "DPa.DO10970",
            "legacySqlClass": "column"
          },
          {
            "index": 6,
            "name": "SURNAME",
            "type": "string",
            "display": "Offender Surname",
            "legacyId": "DPa.DO1007b",
            "legacySqlClass": "column"
          },
          {
            "index": 7,
            "name": "FIRST_NAME",
            "type": "string",
            "display": "Offender Given Name 1",
            "legacyId": "DPa.DO10080",
            "legacySqlClass": "column"
          },
          {
            "index": 8,
            "name": "NATIONALITY_DESCRIPTION",
            "type": "string",
            "display": "Nationality Description",
            "legacyId": "DPa.DO100b5",
            "legacySqlClass": "column"
          },
          {
            "index": 9,
            "name": "OFFENDER_AGE",
            "type": "double",
            "display": "Offender Age",
            "legacyId": "DPa.DO10082",
            "legacySqlClass": "column"
          },
          {
            "index": 10,
            "name": "ESTABLISHMENT_CODE_NK",
            "type": "string",
            "display": "Associated Establishment Code",
            "legacyId": "DPa.DO107b2",
            "legacySqlClass": "column"
          },
          {
            "index": 11,
            "name": "ESTABLISHMENT_DESCRIPTION",
            "type": "string",
            "display": "Associated Establishment Name",
            "legacyId": "DPa.DO107b1",
            "legacySqlClass": "column"
          },
          {
            "index": 12,
            "name": "ETHNIC_CODE",
            "type": "string",
            "display": "Ethnic Code",
            "legacyId": "DPa.DO1009b",
            "legacySqlClass": "column"
          },
          {
            "index": 13,
            "name": "UNIT_4_SHORT_DESCRIPTION",
            "type": "string",
            "display": "Prisoner Location",
            "legacyId": "DPa.DO10a7c",
            "legacySqlClass": "column"
          },
          {
            "index": 14,
            "name": "NATIONALITY_CODE",
            "type": "string",
            "display": "Nationality Code",
            "legacyId": "DPa.DO100b4",
            "legacySqlClass": "column"
          },
          {
            "index": 15,
            "name": "RELIGION_CODE",
            "type": "string",
            "display": "Religion Code",
            "legacyId": "DPa.DO100b2",
            "legacySqlClass": "column"
          },
          {
            "index": 16,
            "name": "V_DISABILITY",
            "type": "string",
            "display": "V_DISABILITY",
            "legacyId": "???",
            "legacySqlClass": "alias"
          },
          {
            "index": 17,
            "name": "V_CARE_LEAVER",
            "type": "string",
            "display": "V_CARE_LEAVER",
            "legacyId": "???",
            "legacySqlClass": "alias"
          }
        ]
      }
    },
    {
      "id": "3376639/DP9",
      "name": "MIS load",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT DISTINCT BODIMIS.ETL_LOAD_LOG.BUSINESS_DATE FROM BODIMIS.ETL_LOAD_LOG WHERE (BODIMIS.ETL_LOAD_LOG.LOAD_ID = (SELECT MAX(LOAD_ID) FROM BODIMIS.ETL_LOAD_LOG WHERE NOT LOAD_END_DATETIME IS NULL))), dataset_ AS (SELECT BUSINESS_DATE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "BUSINESS_DATE",
            "type": "date",
            "display": "Latest Business Date Available",
            "legacyId": "DP9.DO4dd",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DPd",
      "name": "Disability",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE IS NULL THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'I' THEN 'N' WHEN BODIMIS.DIM_OFFENDER_PERSONAL_CARE.TYPE = 'DISAB' AND BODIMIS.DIM_OFFENDER_PERSONAL_CARE.STATUS = 'ON' AND NOT BODIMIS.DIM_OFFENDER_PERSONAL_CARE.CODE IN ('ND', 'PRD', 'RD', 'NR') THEN 'Y' ELSE 'N' END AS DISABILITY_ACTIVE_FLAG FROM BODIMIS.DIM_ESTABLISHMENT AT_ESTABLISHMENT_TAP, BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_OFFENDER_PERSONAL_CARE WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = (SELECT username FROM context_) AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (AT_OFFENDER_BOOKING.ESTABLISHMENT_SK = AT_ESTABLISHMENT_TAP.ESTABLISHMENT_SK) AND (AT_ESTABLISHMENT_TAP.ACTIVE_FLAG = 'Y') AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = BODIMIS.DIM_OFFENDER_PERSONAL_CARE.OFFENDER_BOOKING_SK (+)) AND ((AT_ESTABLISHMENT_TAP.ESTABLISHMENT_CODE_NK IN ((SELECT establishment_code FROM prompt_)) OR 'All' IN ((SELECT establishment_code FROM prompt_))) AND (AT_OFFENDER_BOOKING.ACTIVE_FLAG = 'Y'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, DISABILITY_ACTIVE_FLAG FROM dataset_base_)",
      "parameters": [
        {
          "index": 0,
          "name": "establishment_code",
          "filterType": "autocomplete",
          "reportFieldType": "string",
          "display": "Establishment",
          "description": "(SELECT establishment_code from prompt_)",
          "mandatory": "true",
          "referenceType": "establishment"
        }
      ],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPd.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "DISABILITY_ACTIVE_FLAG",
            "type": "string",
            "display": "Disability Active Flag",
            "legacyId": "DPd.DOa9d",
            "legacySqlClass": "column"
          }
        ]
      }
    },
    {
      "id": "3376639/DPe",
      "name": "Alerts",
      "description": "MIS - Demographics",
      "datasource": "bodmis",
      "query": "dataset_base_ AS (SELECT AT_OFFENDER_BOOKING.OFFENDER_ID_DISPLAY, CASE WHEN AT_ALERT.ALERT_ACTIVE_FLAG = 'Y' THEN AT_ALERT.ALERT_TYPE_NK END AS ALERT_CATEGORY_CODE FROM BODIMIS.DIM_OFFENDER_BOOKING AT_OFFENDER_BOOKING, BODIMIS.DIM_ALERT AT_ALERT, BODIMIS.FACT_OFFENDER_ALERT AT_OFFENDER_ALERT WHERE (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK = AT_OFFENDER_ALERT.OFFENDER_BOOKING_SK (+)) AND (AT_ALERT.ALERT_SK (+) = AT_OFFENDER_ALERT.ALERT_SK) AND (AT_OFFENDER_BOOKING.OFFENDER_BOOKING_SK IN (SELECT CSL.OFFENDER_BOOKING_SK FROM BODIMIS.DIM_STAFF_ACCESSIBLE_CASELOAD SAC, BODIMIS.DIM_CASELOAD_SECURITY_LIST CSL WHERE SAC.CASELOAD_ID = CSL.CASELOAD_CODE AND SAC.USERNAME = UPPER('DPRWS') AND CSL.ENDYEAR >= TO_CHAR(CURRENT_TIMESTAMP, 'YYYY') - 6)) AND (CASE WHEN AT_ALERT.ALERT_ACTIVE_FLAG = 'Y' THEN AT_ALERT.ALERT_TYPE_NK END = 'L' AND (AT_OFFENDER_ALERT.ALERT_STATUS = 'ACTIVE'))), dataset_ AS (SELECT OFFENDER_ID_DISPLAY, ALERT_CATEGORY_CODE FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": [
          {
            "index": 0,
            "name": "OFFENDER_ID_DISPLAY",
            "type": "string",
            "display": "NOMS Number",
            "legacyId": "DPe.DO76",
            "legacySqlClass": "column"
          },
          {
            "index": 1,
            "name": "ALERT_CATEGORY_CODE",
            "type": "string",
            "display": "Alert Category Code",
            "legacyId": "DPe.DO92",
            "legacySqlClass": "column"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "135969.RS",
      "name": "All Prisoners",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DPb",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DO7b2"
          },
          {
            "name": "$ref:OFFENDER_ID_DISPLAY",
            "display": "NOMS Number",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacyId": "DPb.DO76"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DO7b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DO80"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DOa7c"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DO9b"
          },
          {
            "name": "$ref:OFFENDER_AGE",
            "display": "Offender Age",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DO82"
          },
          {
            "name": "$ref:V_NATIONALITY_IN_LIST_WITH_N31",
            "display": "FN?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "= If IsNull([Characteristics].[Nationality Description])Then \"Not Recorded\" Else If Not ([Characteristics].[Nationality Description] InList(\"British\";\"Refused\";\"Stateless\";\"Unknown\")) Then \"Y\" Else \"N\""
          },
          {
            "name": "$ref:NATIONALITY_CODE",
            "display": "Nationality Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DOb4"
          },
          {
            "name": "$ref:RELIGION_CODE",
            "display": "Religion Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DOb2"
          },
          {
            "name": "$ref:MATERNITY_STATUS_DESCRIPTION",
            "display": "Maternity Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DOb0"
          },
          {
            "name": "$ref:MARITAL_STATUS_DESCRIPTION",
            "display": "Marital Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DOaf"
          },
          {
            "name": "$ref:SEX_ORIENTATION_DESCRIPTION",
            "display": "Sexual Orientation Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DO970"
          },
          {
            "name": "$ref:V_DISABILITY",
            "display": "Disability Flag?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Disability Active Flag]=\"Y\"; \"Y\")"
          },
          {
            "name": "$ref:V_CARE_LEAVER",
            "display": "Care Leaver?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alert Category Code]=\"L\"; \"Y\"; \"N\")"
          }
        ]
      }
    },
    {
      "id": "136429.RS",
      "name": "LR Prisoners",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3375368/DPa",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:ESTABLISHMENT_CODE_NK",
            "display": "Associated Establishment Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO107b2"
          },
          {
            "name": "$ref:SURNAME",
            "display": "Offender Surname",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO1007b"
          },
          {
            "name": "$ref:FIRST_NAME",
            "display": "Offender Given Name 1",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO10080"
          },
          {
            "name": "$ref:UNIT_4_SHORT_DESCRIPTION",
            "display": "Prisoner Location",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO10a7c"
          },
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO1009b"
          },
          {
            "name": "$ref:OFFENDER_AGE",
            "display": "Offender Age",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO10082"
          },
          {
            "name": "$ref:V_NATIONALITY_LR_IN_LIST_WIT34",
            "display": "FN?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "= If IsNull([LR Characteristics].[Nationality Description])Then \"Not Recorded\" Else If Not ([LR Characteristics].[Nationality Description] InList(\"British\";\"Refused\";\"Stateless\";\"Unknown\")) Then \"Y\" Else \"N\""
          },
          {
            "name": "$ref:NATIONALITY_CODE",
            "display": "Nationality Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO100b4"
          },
          {
            "name": "$ref:RELIGION_CODE",
            "display": "Religion Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO100b2"
          },
          {
            "name": "$ref:MATERNITY_STATUS_DESCRIPTION",
            "display": "Maternity Status",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO100b0"
          },
          {
            "name": "$ref:MARITAL_STATUS_DESCRIPTION",
            "display": "Marital Status Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO100af"
          },
          {
            "name": "$ref:SEX_ORIENTATION_DESCRIPTION",
            "display": "Sexual Orientation Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPa.DO10970"
          },
          {
            "name": "$ref:V_DISABILITY",
            "display": "Disability Flag?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Disability Active Flag]=\"Y\"; \"Y\")"
          },
          {
            "name": "$ref:V_CARE_LEAVER",
            "display": "Care Leaver?",
            "formula": "",
            "visible": "true",
            "sortable": false,
            "defaultsort": false,
            "legacySql": "=If([Alert Category Code]=\"L\"; \"Y\"; \"N\")"
          }
        ]
      }
    },
    {
      "id": "137299.RS",
      "name": "Descriptions",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376639/DPb",
      "feature": [
        {
          "type": "print"
        }
      ],
      "specification": {
        "template": "list-tab",
        "field": [
          {
            "name": "$ref:ETHNIC_CODE",
            "display": "Ethnic Code",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DO9b"
          },
          {
            "name": "$ref:ETHNIC_DESCRIPTION",
            "display": "Ethnic Description",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false,
            "legacyId": "DPb.DO9d"
          }
        ]
      }
    }
  ],
  "errors": [
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_DISABILITY :: ReferenceError: error is not defined",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_CARE_LEAVER :: ReferenceError: error is not defined",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_NATIONALITY_IN_LIST_WITH_N31 :: Error: argument 'sql': 'NoneType' object cannot be converted to 'PyString'",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DISABILITY :: ReferenceError: error is not defined",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_CARE_LEAVER :: ReferenceError: error is not defined",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_DISABILITY :: ReferenceError: error is not defined",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::resolveCTEs parse error for : $ref:V_CARE_LEAVER :: ReferenceError: error is not defined",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations unable to append column : V_NATIONALITY_LR_IN_LIST_WIT34 :: Error: argument 'sql': 'NoneType' object cannot be converted to 'PyString'",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_DISABILITY :: ReferenceError: error is not defined",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "enhanced",
      "error": "dataset::injectCalculations parse error for : $ref:V_CARE_LEAVER :: ReferenceError: error is not defined",
      "entityId": "FugO21uduAEAMJUAAHAbSl8DACJIAFe4",
      "entityType": "dpd"
    },
    {
      "type": "schema",
      "error": "Report field V_NATIONALITY_IN_LIST_WITH_N31 does not have corresponding dataset schema field",
      "entityId": "135969.RS",
      "entityType": "variant"
    },
    {
      "type": "schema",
      "error": "Report field V_NATIONALITY_LR_IN_LIST_WIT34 does not have corresponding dataset schema field",
      "entityId": "136429.RS",
      "entityType": "variant"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3376639/DPb",
      "entityType": "dataset"
    },
    {
      "type": "athenQuery",
      "error": "Error: Error: Query failed: GENERIC_USER_ERROR: Failed To Get Query Passthrough Schema",
      "entityId": "3375368/DPa",
      "entityType": "dataset"
    }
  ]
}