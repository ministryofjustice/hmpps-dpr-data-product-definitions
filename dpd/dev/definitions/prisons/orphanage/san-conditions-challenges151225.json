{
  "id": "san001",
  "name": "Support for Additional Needs (SAN) reports service",
  "description": "Support for Additional Needs (SAN) reports service.",
  "metadata": {
    "author": "TBC",
    "owner": "TBC",
    "version": "1.0.0"
  },
  "datasource": [
    {
      "id": "datamart",
      "name": "datamart"
    }
  ],
  "dataset": [
    {
      "id": "san-dataset",
      "name": "Applications",
      "datasource": "datamart",
      "query": "SELECT    prison_number,    first_name,    last_name,    birth_date,    sex_code,    current_location,    has_need,    has_aln_need,    has_ldd_need,    conditions_restricting_mobility_dexterity,    other_language_speech_communication_disorder,    dyspraxia_developmental_coordination_disorder,    acquired_brain_injury,    dyslexia,    autism_spectrum_condition,    attention_deficit_hyperactivity_disorder_adhd_add,    dyscalculia,    other_learning_disability,    mental_health,    visual_impairment,    other_disability_or_health_condition_not_listed_above,    other,    downs_syndrome,    developmental_language_disorder,    neurodegenerative_condition,    foetal_alcohol_spectrum_disorder,    hearing_impairment,    tourettes_syndrome_tic_disorder,    other_long_term_medical_condition,    other_neurological_condition,    challenge_physical_skills,    challenge_attention_organising_time,    challenge_processing_speed,    challenge_numeracy_skills,    challenge_sensory,    challenge_language_comm_skills,    challenge_emotions_feelings,    challenge_literacy_skills,    challenge_memory    from datamart.prison_domains.supportforadditionalneeds_prisoner_challenges_and_conditions",
      "parameters": [],
      "schema": {
        "field": [
          {
            "name": "prison_number",
            "type": "string",
            "display": "Number"
          },

          {
            "name": "first_name",
            "type": "string",
            "display": ""
          },
          {
            "name": "last_name",
            "type": "string",
            "display": ""
          },
          {
            "name": "birth_date",
            "type": "string",
			"formula": "format_date(${birth_date}, 'dd/MM/yyyy')",
            "display": "Date of Birth"
          },
          {
            "name": "sex_code",
            "type": "string",
            "display": ""
          },
          {
            "name": "current_location",
            "type": "string",
            "display": ""
          },
          {
            "name": "has_need",
            "type": "string",
            "display": ""
          },
          {
            "name": "has_aln_need",
            "type": "string",
            "display": ""
          },
          {
            "name": "has_ldd_need",
            "type": "string",
            "display": ""
          },
          {
            "name": "conditions_restricting_mobility_dexterity",
            "type": "string",
            "display": "conditions_restricting_mobility_dexterity"
          },
          {
            "name": "other_language_speech_communication_disorder",
            "type": "string",
            "display": "other_language_speech_communication_disorder"
          },
          {
            "name": "dyspraxia_developmental_coordination_disorder",
            "type": "string",
            "display": "dyspraxia_developmental_coordination_disorder"
          },
          {
            "name": "acquired_brain_injury",
            "type": "string",
            "display": "acquired_brain_injury"
          },
          {
            "name": "dyslexia",
            "type": "string",
            "display": "dyslexia"
          },
          {
            "name": "autism_spectrum_condition",
            "type": "string",
            "display": "autism_spectrum_condition"
          },
          {
            "name": "attention_deficit_hyperactivity_disorder_adhd_add",
            "type": "string",
            "display": "attention_deficit_hyperactivity_disorder_adhd_add"
          },
          {
            "name": "dyscalculia",
            "type": "string",
            "display": "dyscalculia"
          },
          {
            "name": "other_learning_disability",
            "type": "string",
            "display": "other_learning_disability"
          },
          {
            "name": "mental_health",
            "type": "string",
            "display": "mental_health"
          },
          {
            "name": "visual_impairment",
            "type": "string",
            "display": "visual_impairment"
          },
          {
            "name": "other_disability_or_health_condition_not_listed_above",
            "type": "string",
            "display": "other_disability_or_health_condition_not_listed_above"
          },
          {
            "name": "other",
            "type": "string",
            "display": "other"
          },
          {
            "name": "downs_syndrome",
            "type": "string",
            "display": "downs_syndrome"
          },
          {
            "name": "developmental_language_disorder",
            "type": "string",
            "display": "developmental_language_disorder"
          },
          {
            "name": "neurodegenerative_condition",
            "type": "string",
            "display": "neurodegenerative_condition"
          },
          {
            "name": "foetal_alcohol_spectrum_disorder",
            "type": "string",
            "display": "foetal_alcohol_spectrum_disorder"
          },
          {
            "name": "hearing_impairment",
            "type": "string",
            "display": "hearing_impairment"
          },
          {
            "name": "tourettes_syndrome_tic_disorder",
            "type": "string",
            "display": "tourettes_syndrome_tic_disorder"
          },
          {
            "name": "other_long_term_medical_condition",
            "type": "string",
            "display": "other_long_term_medical_condition"
          },
          {
            "name": "other_neurological_condition",
            "type": "string",
            "display": "other_neurological_condition"
          },
          {
            "name": "challenge_physical_skills",
            "type": "string",
            "display": "challenge_physical_skills"
          },
          {
            "name": "challenge_attention_organising_time",
            "type": "string",
            "display": "challenge_attention_organising_time"
          },
          {
            "name": "challenge_processing_speed",
            "type": "string",
            "display": "challenge_processing_speed"
          },
          {
            "name": "challenge_numeracy_skills",
            "type": "string",
            "display": "challenge_numeracy_skills"
          },
          {
            "name": "challenge_sensory",
            "type": "string",
            "display": "challenge_sensory"
          },
          {
            "name": "challenge_language_comm_skills",
            "type": "string",
            "display": "challenge_language_comm_skills"
          },
          {
            "name": "challenge_emotions_feelings",
            "type": "string",
            "display": "challenge_emotions_feelings"
          },
          {
            "name": "challenge_literacy_skills",
            "type": "string",
            "display": "challenge_literacy_skills"
          },
          {
            "name": "challenge_memory",
            "type": "string",
            "display": "challenge_memory"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
				"ROLE_SAN_EDITOR",
				"ROLE_SAN_EDUCATION_MANAGER",
                "ROLE_PRISONS_REPORTING_USER"
              ]
            }
          ]
        }
      ]
    },
    {
      "id": "caseload",
      "type": "row-level",
      "action": [
        "(current_location='${caseload}')"
      ],
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "exists": [
                "${caseload}"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "san-prisoner-conditions-and-challenges-report",
      "name": "Prisoner conditions and challenges",
      "description": "Prisoner conditions and challenges by caseload.",
      "classification": "Official",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "$ref:san-dataset",
      "feature": [
        {
          "type": "share|save|email|print|download"
        }
      ],
"metadata" : {
      "hints" : ["interactive"]
    },
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:last_name",
            "display": "Prisoner name",
			"formula": "make_url('https://prisoner-${env}.digital.prison.service.justice.gov.uk/prisoner/${prison_number}','${first_name}, ${last_name}',TRUE)",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "birth_date",
			"formula": "format_date(${birth_date}, 'dd/MM/yyyy')",
            "display": "Date of Birth",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:has_need",
            "display": "has_need",
            "visible": "true",
            "sortable": "false",
            "filter": {
              "type": "multiselect",
			  "interactive": "true",
              "staticoptions": [
                {
                  "name": "true",
                  "display": "True"
                },
                {
                  "name": "false",
                  "display": "False"
                }
              ]
            }
          },
          {
            "name": "$ref:has_aln_need",
            "display": "has_aln_need",
            "visible": "true",
            "sortable": "false",
            "filter": {
              "type": "multiselect",
			  "interactive": "true",
              "staticoptions": [
                {
                  "name": "true",
                  "display": "True"
                },
                {
                  "name": "false",
                  "display": "False"
                }
              ]
            }
          },
          {
            "name": "$ref:has_ldd_need",
            "display": "has_ldd_need",
            "filter": {
              "type": "multiselect",
			  "interactive": "true",
              "staticoptions": [
                {
                  "name": "true",
                  "display": "True"
                },
                {
                  "name": "false",
                  "display": "False"
                }
              ]
            }
          },
          {
            "name": "$ref:conditions_restricting_mobility_dexterity",
            "display": "conditions_restricting_mobility_dexterity",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:other_language_speech_communication_disorder",
            "display": "other_language_speech_communication_disorder",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:dyspraxia_developmental_coordination_disorder",
            "display": "dyspraxia_developmental_coordination_disorder",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:acquired_brain_injury",
            "display": "acquired_brain_injury",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:dyslexia",
            "display": "dyslexia",
			"visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:autism_spectrum_condition",
            "display": "autism_spectrum_condition"
          },
          {
            "name": "$ref:attention_deficit_hyperactivity_disorder_adhd_add",
            "display": "attention_deficit_hyperactivity_disorder_adhd_add"
          },
          {
            "name": "$ref:dyscalculia",
            "display": "dyscalculia"
          },
          {
            "name": "$ref:other_learning_disability",
            "display": "other_learning_disability"
          },
          {
            "name": "$ref:mental_health",
            "display": "mental_health"
          },
          {
            "name": "$ref:visual_impairment",
            "display": "visual_impairment"
          },
          {
            "name": "$ref:other_disability_or_health_condition_not_listed_above",
            "display": "other_disability_or_health_condition_not_listed_above"
          },
          {
            "name": "$ref:other",
            "display": "other"
          },
          {
            "name": "$ref:downs_syndrome",
            "display": "downs_syndrome"
          },
          {
            "name": "$ref:developmental_language_disorder",

            "display": "developmental_language_disorder"
          },
          {
            "name": "$ref:neurodegenerative_condition",
            "display": "neurodegenerative_condition"
          },
          {
            "name": "$ref:foetal_alcohol_spectrum_disorder",
            "display": "foetal_alcohol_spectrum_disorder"
          },
          {
            "name": "$ref:hearing_impairment",
            "display": "hearing_impairment"
          },
          {
            "name": "$ref:tourettes_syndrome_tic_disorder",
            "display": "tourettes_syndrome_tic_disorder"
          },
          {
            "name": "$ref:other_long_term_medical_condition",
            "display": "other_long_term_medical_condition"
          },
          {
            "name": "$ref:other_neurological_condition",
            "type": "string",
            "display": "other_neurological_condition"
          },
          {
            "name": "$ref:challenge_physical_skills",
            "display": "challenge_physical_skills"
          },
          {
            "name": "$ref:challenge_attention_organising_time",
            "display": "challenge_attention_organising_time"
          },
          {
            "name": "$ref:challenge_processing_speed",
            "display": "challenge_processing_speed"
          },
          {
            "name": "$ref:challenge_numeracy_skills",
            "display": "challenge_numeracy_skills"
          },
          {
            "name": "$ref:challenge_sensory",
            "display": "challenge_sensory"
          },
          {
            "name": "$ref:challenge_language_comm_skills",
            "display": "challenge_language_comm_skills"
          },
          {
            "name": "$ref:challenge_emotions_feelings",
            "display": "challenge_emotions_feelings"
          },
          {
            "name": "$ref:challenge_literacy_skills",
            "display": "challenge_literacy_skills"
          },
          {
            "name": "$ref:challenge_memory",
            "display": "challenge_memory"
          }
        ]
      }
    }
  ]
}
