{
  "id": "san001",
  "name": "Additional Needs report",
  "description": "The report returns a list of people in an establishment and indicates whether they have needs, specific conditions, or challenges. The report can be filtered to show relevant columns. Some information may have been recorded at a previous establishment.",
  "metadata": {
    "author": "TBC",
    "owner": "TBC",
    "version": "1.0.0"
  },
  "datasource": [
    {
      "id": "datamart",
      "name": "datamart"
    }
  ],
  "dataset": [
    {
      "id": "san-dataset",
      "name": "Applications",
      "datasource": "datamart",
      "query": "SELECT    prison_number,    age,    sex_code,ethnicity_code,    ethnicity, cell_location,   current_location, has_need,    has_aln_need,    has_ldd_need,    conditions_restricting_mobility_dexterity,    other_language_speech_communication_disorder,    dyspraxia_developmental_coordination_disorder,    acquired_brain_injury,    dyslexia,    autism_spectrum_condition,    attention_deficit_hyperactivity_disorder_adhd_add,    dyscalculia,    other_learning_disability,    mental_health,    visual_impairment,    other_disability_or_health_condition_not_listed_above,    other,    downs_syndrome,    developmental_language_disorder,    neurodegenerative_condition,    foetal_alcohol_spectrum_disorder,    hearing_impairment,    tourettes_syndrome_tic_disorder,    other_long_term_medical_condition,    other_neurological_condition,    challenge_physical_skills,    challenge_attention_organising_time,    challenge_processing_speed,    challenge_numeracy_skills,    challenge_sensory,    challenge_language_comm_skills,    challenge_emotions_feelings,    challenge_literacy_skills,    challenge_memory    from supportforadditionalneeds_prisoner_challenges_and_conditions",
      "parameters": [],
      "schema": {
        "field": [
          {
            "name": "prison_number",
            "type": "string",
            "display": "Number"
          },
          {
            "name": "age",
            "type": "string",
            "display": "Age"
          },
          {
            "name": "sex_code",
            "type": "string",
            "display": "Sex"
          },
          {
            "name": "ethnicity_code",
            "type": "string"
          },
          {
            "name": "ethnicity",
            "type": "string",
            "display": "Ethnicity"
          },
          {
            "name": "cell_location",
            "type": "string",
            "display": "Cell location"
          },
          {
            "name": "current_location",
            "type": "string",
            "display": "Current prison"
          },
          {
            "name": "has_need",
            "type": "string",
            "display": "Has a need"
          },
          {
            "name": "has_aln_need",
            "type": "string",
            "display": "Has an ALN need"
          },
          {
            "name": "has_ldd_need",
            "type": "string",
            "display": "Has an LDD need"
          },
          {
            "name": "conditions_restricting_mobility_dexterity",
            "type": "string",
            "display": "Restricted mobility or dexterity condition"
          },
          {
            "name": "other_language_speech_communication_disorder",
            "type": "string",
            "display": "Other language, speech or communication disorders"
          },
          {
            "name": "dyspraxia_developmental_coordination_disorder",
            "type": "string",
            "display": "Dyspraxia or developmental coordination disorder"
          },
          {
            "name": "acquired_brain_injury",
            "type": "string",
            "display": "Acquired brain injury"
          },
          {
            "name": "dyslexia",
            "type": "string",
            "display": "Dyslexia"
          },
          {
            "name": "autism_spectrum_condition",
            "type": "string",
            "display": "Autism spectrum disorder"
          },
          {
            "name": "attention_deficit_hyperactivity_disorder_adhd_add",
            "type": "string",
            "display": "Attention deficit hyperactivity disorder (ADHD or ADD)"
          },
          {
            "name": "dyscalculia",
            "type": "string",
            "display": "Dyscalculia"
          },
          {
            "name": "other_learning_disability",
            "type": "string",
            "display": "Other learning difficulties"
          },
          {
            "name": "mental_health",
            "type": "string",
            "display": "Mental health condition"
          },
          {
            "name": "visual_impairment",
            "type": "string",
            "display": "Visual impairment"
          },
          {
            "name": "other_disability_or_health_condition_not_listed_above",
            "type": "string",
            "display": "Other disabilities or health conditions"
          },
          {
            "name": "other",
            "type": "string",
            "display": "Other"
          },
          {
            "name": "downs_syndrome",
            "type": "string",
            "display": "Down's syndrome"
          },
          {
            "name": "developmental_language_disorder",
            "type": "string",
            "display": "Developmental language disorder"
          },
          {
            "name": "neurodegenerative_condition",
            "type": "string",
            "display": "Neurodegenerative condition"
          },
          {
            "name": "foetal_alcohol_spectrum_disorder",
            "type": "string",
            "display": "Foetal alcohol spectrum disorder"
          },
          {
            "name": "hearing_impairment",
            "type": "string",
            "display": "Hearing impairment"
          },
          {
            "name": "tourettes_syndrome_tic_disorder",
            "type": "string",
            "display": "Tourette's syndrome or tic disorder"
          },
          {
            "name": "other_long_term_medical_condition",
            "type": "string",
            "display": "Other long term medical conditions"
          },
          {
            "name": "other_neurological_condition",
            "type": "string",
            "display": "Other neurological conditions"
          },
          {
            "name": "challenge_physical_skills",
            "type": "string",
            "display": "Physical skills and coordination"
          },
          {
            "name": "challenge_attention_organising_time",
            "type": "string",
            "display": "Attention, organising and time management"
          },
          {
            "name": "challenge_processing_speed",
            "type": "string",
            "display": "Processing speed"
          },
          {
            "name": "challenge_numeracy_skills",
            "type": "string",
            "display": "Numeracy skills"
          },
          {
            "name": "challenge_sensory",
            "type": "string",
            "display": "Sensory"
          },
          {
            "name": "challenge_language_comm_skills",
            "type": "string",
            "display": "Language and communication skills"
          },
          {
            "name": "challenge_emotions_feelings",
            "type": "string",
            "display": "Emotions and feelings"
          },
          {
            "name": "challenge_literacy_skills",
            "type": "string",
            "display": "Literacy skills"
          },
          {
            "name": "challenge_memory",
            "type": "string",
            "display": "Memory"
          }
        ]
      }
    },
    {
      "id": "ethnicities",
      "name": "ethnicities",
      "datasource": "datamart",
      "query": "select code, description from prisons.nomis_reference_codes where domain = 'ETHNICITY' and active_flag = 'Y' order by list_seq",
      "schema": {
        "field": [
          {
            "name": "code",
            "type": "string"
          },
          {
            "name": "description",
            "type": "string"
          }
        ]
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": [
                "${role}",
                "ROLE_SAN_EDITOR",
                "ROLE_SAN_EDUCATION_MANAGER"
              ]
            }
          ]
        }
      ]
    },
    {
      "id": "caseload",
      "type": "row-level",
      "action": [
        "(current_location='${caseload}')"
      ],
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "exists": [
                "${caseload}"
              ]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "san-additional-needs-report",
      "name": "Additional Needs report",
      "description": "The report returns a list of people in an establishment and indicates whether they have needs, specific conditions, or challenges. The report can be filtered to show relevant columns. Some information may have been recorded at a previous establishment.",
      "classification": "Official",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "$ref:san-dataset",
      "feature": [
        {
          "type": "share|save|email|print|download"
        }
      ],
      "metadata" : {
        "hints" : ["interactive"]
      },
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:prison_number",
            "display": "Prisoner Number",
            "formula": "make_url('https://prisoner-${env}.digital.prison.service.justice.gov.uk/prisoner/${prison_number}','${prison_number}',TRUE)",
            "visible": "true",
            "sortable": false,
            "defaultsort": false
          },
          {
            "name": "age",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "sex_code",
            "visible": "false",
            "sortable": false,
            "defaultsort": false
          },
          {
            "name": "$ref:ethnicity_code",
            "display": "Ethnicity",
            "formula": "${ethnicity}",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "cell_location",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:has_need",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:has_aln_need",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:has_ldd_need",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:conditions_restricting_mobility_dexterity",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:other_language_speech_communication_disorder",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:dyspraxia_developmental_coordination_disorder",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:acquired_brain_injury",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:dyslexia",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:autism_spectrum_condition",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:attention_deficit_hyperactivity_disorder_adhd_add",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:dyscalculia",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:other_learning_disability",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:mental_health",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:visual_impairment",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:other_disability_or_health_condition_not_listed_above",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:other",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:downs_syndrome",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:developmental_language_disorder",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:neurodegenerative_condition",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:foetal_alcohol_spectrum_disorder",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:hearing_impairment",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:tourettes_syndrome_tic_disorder",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:other_long_term_medical_condition",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:other_neurological_condition",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_physical_skills",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_attention_organising_time",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_processing_speed",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_numeracy_skills",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_sensory",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_language_comm_skills",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_emotions_feelings",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_literacy_skills",
            "visible": "true",
            "sortable": "false"
          },
          {
            "name": "$ref:challenge_memory",
            "visible": "true",
            "sortable": "false"
          }
        ]
      }
    }
  ]
}
